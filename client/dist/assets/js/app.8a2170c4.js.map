{"version":3,"file":"assets/js/app.8a2170c4.js","mappings":"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pC,MAAA,oBACA,CAAAoC,KAAA,MAAApC,MAAA,oBACA,CAAAoC,KAAA,MAAApC,MAAA,oBACA,CAAAoC,KAAA,MAAApC,MAAA,oBACA,CAAAoC,KAAA,MAAApC,MAAA,oBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,cAAApC,MAAA,qBACA,CAAAoC,KAAA,mBAAApC,MAAA,qBACA,CAAAoC,KAAA,OAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,OAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAAApC,MAAA,qBACA,CAAAoC,KAAA,MAA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","sources":["webpack://KonomiTV/./src/App.vue","webpack://KonomiTV/./src/App.vue?74c6","webpack://KonomiTV/./src/components/Vuetify/VTabItem.ts","webpack://KonomiTV/./src/components/Vuetify/VTabsBar.ts","webpack://KonomiTV/./src/components/Vuetify/VTabs.ts","webpack://KonomiTV/./src/components/Vuetify/VTabsItems.ts","webpack://KonomiTV/./src/plugins/vuetify.ts","webpack://KonomiTV/./src/utils/Utils.ts","webpack://KonomiTV/./src/utils/ChannelUtils.ts","webpack://KonomiTV/./src/message.ts","webpack://KonomiTV/./src/services/Users.ts","webpack://KonomiTV/./src/stores/UserStore.ts","webpack://KonomiTV/./src/services/APIClient.ts","webpack://KonomiTV/./src/services/Settings.ts","webpack://KonomiTV/./src/stores/SettingsStore.ts","webpack://KonomiTV/./src/utils/CommentUtils.ts","webpack://KonomiTV/./src/utils/PlayerUtils.ts","webpack://KonomiTV/./src/utils/ProgramUtils.ts","webpack://KonomiTV/./src/utils/index.ts","webpack://KonomiTV/./src/views/Login.vue","webpack://KonomiTV/./src/components/Header.vue","webpack://KonomiTV/./src/components/Header.vue?5d06","webpack://KonomiTV/./src/components/Navigation.vue","webpack://KonomiTV/./src/components/BottomNavigation.vue","webpack://KonomiTV/./src/components/BottomNavigation.vue?ff7d","webpack://KonomiTV/./src/services/Version.ts","webpack://KonomiTV/./src/stores/VersionStore.ts","webpack://KonomiTV/src/components/Navigation.vue","webpack://KonomiTV/./src/components/Navigation.vue?018b","webpack://KonomiTV/./src/components/Navigation.vue?bd43","webpack://KonomiTV/src/views/Login.vue","webpack://KonomiTV/./src/views/Login.vue?1e11","webpack://KonomiTV/./src/views/Login.vue?f5d0","webpack://KonomiTV/./src/views/NotFound.vue","webpack://KonomiTV/src/views/NotFound.vue","webpack://KonomiTV/./src/views/NotFound.vue?8eb5","webpack://KonomiTV/./src/views/NotFound.vue?dbe0","webpack://KonomiTV/./src/views/Register.vue","webpack://KonomiTV/src/views/Register.vue","webpack://KonomiTV/./src/views/Register.vue?e0a4","webpack://KonomiTV/./src/views/Register.vue?709e","webpack://KonomiTV/./src/views/Settings/Account.vue","webpack://KonomiTV/./src/views/Settings/Base.vue","webpack://KonomiTV/src/views/Settings/Base.vue","webpack://KonomiTV/./src/views/Settings/Base.vue?3069","webpack://KonomiTV/./src/views/Settings/Base.vue?13e1","webpack://KonomiTV/src/views/Settings/Account.vue","webpack://KonomiTV/./src/views/Settings/Account.vue?a57f","webpack://KonomiTV/./src/views/Settings/Account.vue?d79e","webpack://KonomiTV/./src/views/Settings/Caption.vue","webpack://KonomiTV/src/views/Settings/Caption.vue","webpack://KonomiTV/./src/views/Settings/Caption.vue?a351","webpack://KonomiTV/./src/views/Settings/Caption.vue?3a40","webpack://KonomiTV/./src/views/Settings/Capture.vue","webpack://KonomiTV/src/views/Settings/Capture.vue","webpack://KonomiTV/./src/views/Settings/Capture.vue?64fc","webpack://KonomiTV/./src/views/Settings/Capture.vue?6493","webpack://KonomiTV/./src/views/Settings/DataBroadcasting.vue","webpack://KonomiTV/src/views/Settings/DataBroadcasting.vue","webpack://KonomiTV/./src/views/Settings/DataBroadcasting.vue?13a1","webpack://KonomiTV/./src/views/Settings/DataBroadcasting.vue?a0d2","webpack://KonomiTV/./src/views/Settings/General.vue","webpack://KonomiTV/./src/components/Settings/PinnedChannelSettings.vue","webpack://KonomiTV/./src/services/Programs.ts","webpack://KonomiTV/./src/services/Channels.ts","webpack://KonomiTV/./src/stores/ChannelsStore.ts","webpack://KonomiTV/src/components/Settings/PinnedChannelSettings.vue","webpack://KonomiTV/./src/components/Settings/PinnedChannelSettings.vue?55f0","webpack://KonomiTV/./src/components/Settings/PinnedChannelSettings.vue?cc7e","webpack://KonomiTV/src/views/Settings/General.vue","webpack://KonomiTV/./src/views/Settings/General.vue?74e9","webpack://KonomiTV/./src/views/Settings/General.vue?1430","webpack://KonomiTV/./src/views/Settings/Index.vue","webpack://KonomiTV/src/views/Settings/Index.vue","webpack://KonomiTV/./src/views/Settings/Index.vue?1f82","webpack://KonomiTV/./src/views/Settings/Index.vue?ea37","webpack://KonomiTV/./src/views/Settings/Jikkyo.vue","webpack://KonomiTV/./src/components/Settings/CommentMuteSettings.vue","webpack://KonomiTV/src/components/Settings/CommentMuteSettings.vue","webpack://KonomiTV/./src/components/Settings/CommentMuteSettings.vue?68d1","webpack://KonomiTV/./src/components/Settings/CommentMuteSettings.vue?5678","webpack://KonomiTV/./src/services/Niconico.ts","webpack://KonomiTV/src/views/Settings/Jikkyo.vue","webpack://KonomiTV/./src/views/Settings/Jikkyo.vue?089f","webpack://KonomiTV/./src/views/Settings/Jikkyo.vue?e1ab","webpack://KonomiTV/./src/views/Settings/Quality.vue","webpack://KonomiTV/src/views/Settings/Quality.vue","webpack://KonomiTV/./src/views/Settings/Quality.vue?bed8","webpack://KonomiTV/./src/views/Settings/Quality.vue?3968","webpack://KonomiTV/./src/views/Settings/Server.vue","webpack://KonomiTV/src/views/Settings/Server.vue","webpack://KonomiTV/./src/views/Settings/Server.vue?80ef","webpack://KonomiTV/./src/views/Settings/Server.vue?c8b5","webpack://KonomiTV/./src/views/Settings/Twitter.vue","webpack://KonomiTV/./src/services/Twitter.ts","webpack://KonomiTV/src/views/Settings/Twitter.vue","webpack://KonomiTV/./src/views/Settings/Twitter.vue?b368","webpack://KonomiTV/./src/views/Settings/Twitter.vue?8f70","webpack://KonomiTV/./src/views/TV/Home.vue","webpack://KonomiTV/src/views/TV/Home.vue","webpack://KonomiTV/./src/views/TV/Home.vue?1175","webpack://KonomiTV/./src/views/TV/Home.vue?6763","webpack://KonomiTV/./src/views/TV/Watch.vue","webpack://KonomiTV/./src/components/Watch/Watch.vue","webpack://KonomiTV/./src/components/Watch/Header.vue","webpack://KonomiTV/./src/services/Videos.ts","webpack://KonomiTV/./src/stores/PlayerStore.ts","webpack://KonomiTV/src/components/Watch/Header.vue","webpack://KonomiTV/./src/components/Watch/Header.vue?eb23","webpack://KonomiTV/./src/components/Watch/Header.vue?659e","webpack://KonomiTV/./src/components/Watch/KeyboardShortcutList.vue","webpack://KonomiTV/src/components/Watch/KeyboardShortcutList.vue","webpack://KonomiTV/./src/components/Watch/KeyboardShortcutList.vue?7a64","webpack://KonomiTV/./src/components/Watch/KeyboardShortcutList.vue?8051","webpack://KonomiTV/./src/components/Watch/Navigation.vue","webpack://KonomiTV/src/components/Watch/Navigation.vue","webpack://KonomiTV/./src/components/Watch/Navigation.vue?16b4","webpack://KonomiTV/./src/components/Watch/Navigation.vue?1f95","webpack://KonomiTV/./src/components/Watch/Panel.vue","webpack://KonomiTV/./src/components/Watch/Panel/Channel.vue","webpack://KonomiTV/src/components/Watch/Panel/Channel.vue","webpack://KonomiTV/./src/components/Watch/Panel/Channel.vue?26e6","webpack://KonomiTV/./src/components/Watch/Panel/Channel.vue?0805","webpack://KonomiTV/./src/components/Watch/Panel/Comment.vue","webpack://KonomiTV/src/components/Watch/Panel/Comment.vue","webpack://KonomiTV/./src/components/Watch/Panel/Comment.vue?6e0b","webpack://KonomiTV/./src/components/Watch/Panel/Comment.vue?13fe","webpack://KonomiTV/./src/components/Watch/Panel/Program.vue","webpack://KonomiTV/src/components/Watch/Panel/Program.vue","webpack://KonomiTV/./src/components/Watch/Panel/Program.vue?a052","webpack://KonomiTV/./src/components/Watch/Panel/Program.vue?39bd","webpack://KonomiTV/./src/components/Watch/Panel/RecordedProgram.vue","webpack://KonomiTV/src/components/Watch/Panel/RecordedProgram.vue","webpack://KonomiTV/./src/components/Watch/Panel/RecordedProgram.vue?4642","webpack://KonomiTV/./src/components/Watch/Panel/RecordedProgram.vue?8365","webpack://KonomiTV/./src/components/Watch/Panel/Remocon.vue","webpack://KonomiTV/src/components/Watch/Panel/Remocon.vue","webpack://KonomiTV/./src/components/Watch/Panel/Remocon.vue?7fe5","webpack://KonomiTV/./src/components/Watch/Panel/Remocon.vue?95ac","webpack://KonomiTV/./src/components/Watch/Panel/Series.vue","webpack://KonomiTV/src/components/Watch/Panel/Series.vue","webpack://KonomiTV/./src/components/Watch/Panel/Series.vue?aeca","webpack://KonomiTV/./src/components/Watch/Panel/Series.vue?d60e","webpack://KonomiTV/./src/components/Watch/Panel/Twitter.vue","webpack://KonomiTV/src/components/Watch/Panel/Twitter.vue","webpack://KonomiTV/./src/components/Watch/Panel/Twitter.vue?61e8","webpack://KonomiTV/./src/components/Watch/Panel/Twitter.vue?14c9","webpack://KonomiTV/src/components/Watch/Panel.vue","webpack://KonomiTV/./src/components/Watch/Panel.vue?986b","webpack://KonomiTV/./src/components/Watch/Panel.vue?263e","webpack://KonomiTV/./src/components/Watch/Player.vue","webpack://KonomiTV/src/components/Watch/Player.vue","webpack://KonomiTV/./src/components/Watch/Player.vue?552d","webpack://KonomiTV/./src/components/Watch/Player.vue?71e5","webpack://KonomiTV/src/components/Watch/Watch.vue","webpack://KonomiTV/./src/components/Watch/Watch.vue?bfaf","webpack://KonomiTV/./src/components/Watch/Watch.vue?9e2d","webpack://KonomiTV/./src/services/player/managers/KeyboardShortcutManager.ts","webpack://KonomiTV/./src/services/Captures.ts","webpack://KonomiTV/./src/workers/CaptureCompositorProxy.ts","webpack://KonomiTV/./src/services/player/managers/CaptureManager.ts","webpack://KonomiTV/./src/services/player/managers/LiveCommentManager.ts","webpack://KonomiTV/./src/workers/LivePSIArchivedDataDecoderProxy.ts","webpack://KonomiTV/./src/services/player/managers/LiveDataBroadcastingManager.ts","webpack://KonomiTV/./src/services/player/managers/LiveEventManager.ts","webpack://KonomiTV/./src/services/player/managers/MediaSessionManager.ts","webpack://KonomiTV/./src/services/player/PlayerController.ts","webpack://KonomiTV/src/views/TV/Watch.vue","webpack://KonomiTV/./src/views/TV/Watch.vue?ad13","webpack://KonomiTV/./src/views/TV/Watch.vue?f307","webpack://KonomiTV/./src/views/Videos/Watch.vue","webpack://KonomiTV/src/views/Videos/Watch.vue","webpack://KonomiTV/./src/views/Videos/Watch.vue?08a6","webpack://KonomiTV/./src/views/Videos/Watch.vue?0a18","webpack://KonomiTV/./src/router/index.ts","webpack://KonomiTV/./src/service-worker.ts","webpack://KonomiTV/./src/main.ts","webpack://KonomiTV/webpack/bootstrap","webpack://KonomiTV/webpack/runtime/chunk loaded","webpack://KonomiTV/webpack/runtime/compat get default export","webpack://KonomiTV/webpack/runtime/define property getters","webpack://KonomiTV/webpack/runtime/get javascript chunk filename","webpack://KonomiTV/webpack/runtime/global","webpack://KonomiTV/webpack/runtime/hasOwnProperty shorthand","webpack://KonomiTV/webpack/runtime/make namespace object","webpack://KonomiTV/webpack/runtime/node module decorator","webpack://KonomiTV/webpack/runtime/publicPath","webpack://KonomiTV/webpack/runtime/jsonp chunk loading","webpack://KonomiTV/webpack/startup"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-app',{attrs:{\"id\":\"app\"}},[_c('transition',[_c('router-view')],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=76cfc04b\"\nvar script = {}\nimport style0 from \"./App.vue?vue&type=style&index=0&id=76cfc04b&prod&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\r\nimport { VueConstructor, VNode } from 'vue';\r\nimport VTabItem from 'vuetify/lib/components/VTabs/VTabItem';\r\n\r\n// VTabItem は VWindowItem を extend() して実装されている\r\nexport default (VTabItem as VueConstructor).extend({\r\n    render (h): VNode {\r\n        return h('transition', {\r\n            props: {\r\n                name: (this as any).computedTransition,\r\n            },\r\n            on: {\r\n                // Handlers for enter windows.\r\n                beforeEnter: (this as any).onBeforeTransition,\r\n                afterEnter: (this as any).onAfterTransition,\r\n                enterCancelled: (this as any).onTransitionCancelled,\r\n\r\n                // Handlers for leave windows.\r\n                beforeLeave: (this as any).onBeforeTransition,\r\n                afterLeave: (this as any).onAfterTransition,\r\n                leaveCancelled: (this as any).onTransitionCancelled,\r\n\r\n                // Enter handler for height transition.\r\n                enter: (this as any).onEnter,\r\n            }\r\n        // this.showLazyContent() を通さずに常にレンダリングされるようにする\r\n        // 本来は実際に表示されている時だけレンダリングし、負荷を減らすための処理\r\n        // ただチャンネルリストのレンダリングは重いので、最初からレンダリングされていた方がタブの初回切り替えが早くなる\r\n        }, [(this as any).genWindowItem()]);\r\n    }\r\n});\r\n","\r\nimport { VueConstructor } from 'vue';\r\nimport { GroupableInstance } from 'vuetify/lib/components/VItemGroup/VItemGroup';\r\nimport VTabsBar from 'vuetify/lib/components/VTabs/VTabsBar';\r\n\r\n// VTabsBar は VItemGroup を extend() して実装されている\r\nexport default (VTabsBar as VueConstructor).extend({\r\n    data() {\r\n        return {\r\n            // 一応型定義をしておく\r\n            items: [] as GroupableInstance[],\r\n        };\r\n    },\r\n    methods: {\r\n\r\n        // タブのデータ配列の先頭に新しい要素が追加されるとそのタブのアニメーションの向きが逆になるバグがあるので、VItemGroup 側の挙動をオーバーライドする\r\n        // DOM 上も VNode 上も正しい順序で並んでいるが、this.items に関しては追加された順になっていてしまっていて齟齬が発生するのが原因\r\n        // ref: https://github.com/vuetifyjs/vuetify/issues/13862\r\n        register(item: GroupableInstance) {\r\n\r\n            // 現在アクティブなタブの VueComponent を取得\r\n            const activeItem = this.items[(this as any).internalIndex];\r\n\r\n            // 要素を items に追加\r\n            this.items.push(item);\r\n\r\n            // this.$slots.default に VNode が、items には単に VueComponent が入っているので、事前に VNode の順番に合わせて並べ替える\r\n            // こうすることで、追加された順ではなく元のデータ配列通りの順番になる\r\n            this.items.sort((a, b) => {\r\n\r\n                // VueComponent の key が一致する this.$slots.default 内の VNode を探す\r\n                const index_a = this.$slots.default!.findIndex((element) => {\r\n                    return a.$vnode.key === element.key;\r\n                });\r\n                const index_b = this.$slots.default!.findIndex((element) => {\r\n                    return b.$vnode.key === element.key;\r\n                });\r\n\r\n                // index 順で並び替え\r\n                return index_a - index_b;\r\n            });\r\n\r\n            item.$on('change', () => (this as any).onClick(item));\r\n            if ((this as any).mandatory && !(this as any).selectedValues.length) {\r\n                (this as any).updateMandatory();\r\n            }\r\n\r\n            // 追加された要素のソート後のインデックスを取得して更新する\r\n            (this as any).updateItem(item, this.items.indexOf(item));\r\n\r\n            // ソート後の現在アクティブなタブのインデックスを取得し直し、設定する\r\n            // 配列の末尾以外に追加された場合はインデックスが1つずつずれてしまうため、インデックスを設定し直す必要がある\r\n            if (activeItem !== undefined) {\r\n                (this as any).updateInternalValue(this.items.indexOf(activeItem));\r\n            }\r\n        },\r\n\r\n        unregister(item: GroupableInstance) {\r\n\r\n            // 現在アクティブなタブの VueComponent を取得\r\n            const activeItem = this.items[(this as any).internalIndex];\r\n\r\n            // 継承元の unregister() の処理を呼び出す（いわゆる super() ）\r\n            // ref: https://github.com/vuejs/vue/issues/2977\r\n            (this.constructor as any).super.options.methods.unregister.call(this, item);\r\n\r\n            // 配列の末尾以外から削除された場合はインデックスが1つずつずれてしまうため、インデックスを設定し直す必要がある\r\n            if (activeItem !== undefined) {\r\n                (this as any).updateInternalValue(this.items.indexOf(activeItem));\r\n            }\r\n        }\r\n    }\r\n});\r\n","\r\nimport { VueConstructor, VNode } from 'vue';\r\nimport VTabs from 'vuetify/lib/components/VTabs/VTabs';\r\nimport { convertToUnit } from 'vuetify/lib/util/helpers';\r\n\r\nimport VTabsBar from '@/components/Vuetify/VTabsBar';\r\n\r\nexport default (VTabs as VueConstructor).extend({\r\n    methods: {\r\n\r\n        // VTabsBar は VTabs から暗黙的に生成されるコンポーネントのため、直接上書きすることができない\r\n        // そこで VTabs 自体も上書きし、VTabs で $createElement() される時の VTabsBar を自前でオーバーライドしたものに差し替える\r\n        // ビルド済みのファイルには型定義が入っていないので any を多用せざるを得ない…\r\n        genBar(items: VNode[], slider: VNode | null) {\r\n            const data = {\r\n                style: {\r\n                    height: convertToUnit((this as any).height),\r\n                },\r\n                props: {\r\n                    activeClass: (this as any).activeClass,\r\n                    centerActive: (this as any).centerActive,\r\n                    dark: (this as any).dark,\r\n                    light: (this as any).light,\r\n                    mandatory: !(this as any).optional,\r\n                    mobileBreakpoint: (this as any).mobileBreakpoint,\r\n                    nextIcon: (this as any).nextIcon,\r\n                    prevIcon: (this as any).prevIcon,\r\n                    showArrows: (this as any).showArrows,\r\n                    value: (this as any).internalValue,\r\n                },\r\n                on: {\r\n                    'call:slider': (this as any).callSlider,\r\n                    change: (val: any) => {\r\n                        (this as any).internalValue = val;\r\n                    },\r\n                },\r\n                ref: 'items',\r\n            };\r\n\r\n            (this as any).setTextColor((this as any).computedColor, data);\r\n            (this as any).setBackgroundColor((this as any).backgroundColor, data);\r\n\r\n            // ここでオーバーライドした VTabsBar を使うのが最重要\r\n            // これをやるためだけにわざわざ VTabs に関してもオーバーライドする羽目になってる…\r\n            return (this as any).$createElement(VTabsBar, data, [\r\n                (this as any).genSlider(slider),\r\n                items,\r\n            ]);\r\n        }\r\n    }\r\n});\r\n","\r\nimport { VueConstructor } from 'vue';\r\nimport { GroupableInstance } from 'vuetify/lib/components/VItemGroup/VItemGroup';\r\nimport VTabsItems from 'vuetify/lib/components/VTabs/VTabsItems';\r\n\r\n// VTabsItems は VItemGroup と VWindow を extend() して実装されている\r\nexport default (VTabsItems as VueConstructor).extend({\r\n    data() {\r\n        return {\r\n            // 一応型定義をしておく\r\n            items: [] as GroupableInstance[],\r\n        };\r\n    },\r\n    methods: {\r\n\r\n        // タブのデータ配列の先頭に新しい要素が追加されるとそのタブのアニメーションの向きが逆になるバグがあるので、VItemGroup 側の挙動をオーバーライドする\r\n        // DOM 上も VNode 上も正しい順序で並んでいるが、this.items に関しては追加された順になっていてしまっていて齟齬が発生するのが原因\r\n        // ref: https://github.com/vuetifyjs/vuetify/issues/13862\r\n        register(item: GroupableInstance) {\r\n\r\n            // 現在アクティブなタブの VueComponent を取得\r\n            const activeItem = this.items[(this as any).internalIndex];\r\n\r\n            // 要素を items に追加\r\n            this.items.push(item);\r\n\r\n            // this.$slots.default に VNode が、items には単に VueComponent が入っているので、事前に VNode の順番に合わせて並べ替える\r\n            // こうすることで、追加された順ではなく元のデータ配列通りの順番になる\r\n            this.items.sort((a, b) => {\r\n\r\n                // VueComponent の key が一致する this.$slots.default 内の VNode を探す\r\n                const index_a = this.$slots.default!.findIndex((element) => {\r\n                    return a.$vnode.key === element.key;\r\n                });\r\n                const index_b = this.$slots.default!.findIndex((element) => {\r\n                    return b.$vnode.key === element.key;\r\n                });\r\n\r\n                // index 順で並び替え\r\n                return index_a - index_b;\r\n            });\r\n\r\n            item.$on('change', () => (this as any).onClick(item));\r\n            if ((this as any).mandatory && !(this as any).selectedValues.length) {\r\n                (this as any).updateMandatory();\r\n            }\r\n\r\n            // 追加された要素のソート後のインデックスを取得して更新する\r\n            (this as any).updateItem(item, this.items.indexOf(item));\r\n\r\n            // ソート後の現在アクティブなタブのインデックスを取得し直し、設定する\r\n            // 配列の末尾以外に追加された場合はインデックスが1つずつずれてしまうため、インデックスを設定し直す必要がある\r\n            if (activeItem !== undefined) {\r\n                // 値が異なるときだけ更新する\r\n                // こうしないと、Safari で変なアニメーションがついてしまう\r\n                if (this.items.indexOf(activeItem) !== (this as any).internalValue) {\r\n                    (this as any).updateInternalValue(this.items.indexOf(activeItem));\r\n                }\r\n            }\r\n        },\r\n\r\n        unregister(item: GroupableInstance) {\r\n\r\n            // 現在アクティブなタブの VueComponent を取得\r\n            const activeItem = this.items[(this as any).internalIndex];\r\n\r\n            // 継承元の unregister() の処理を呼び出す（いわゆる super() ）\r\n            // ref: https://github.com/vuejs/vue/issues/2977\r\n            (this.constructor as any).super.options.methods.unregister.call(this, item);\r\n\r\n            // 配列の末尾以外から削除された場合はインデックスが1つずつずれてしまうため、インデックスを設定し直す必要がある\r\n            if (activeItem !== undefined) {\r\n                (this as any).updateInternalValue(this.items.indexOf(activeItem));\r\n            }\r\n        },\r\n\r\n        // 最初のタブから最後のタブに遷移するとアニメーションの向きが逆になるバグがあるので、VWindow 側の挙動をオーバーライドする\r\n        // 本来は VCarousel 用の動作だが、VTabsItems も VWindow を継承しているので、それが適用されてしまっているらしい\r\n        // ref: https://github.com/yuwu9145/vuetify/blob/master/packages/vuetify/src/components/VWindow/VWindow.ts#L239-L252\r\n        updateReverse(val: number, oldVal: number) {\r\n\r\n            const itemsLength = this.items.length;\r\n            const lastIndex = itemsLength - 1;\r\n\r\n            if (itemsLength <= 2) return val < oldVal;\r\n\r\n            // continuous が false の時、常に val < oldVal の結果を返す\r\n            if (!(this as any).continuous) return val < oldVal;\r\n\r\n            if (val === lastIndex && oldVal === 0) {\r\n                return true;\r\n            } else if (val === 0 && oldVal === lastIndex) {\r\n                return false;\r\n            } else {\r\n                return val < oldVal;\r\n            }\r\n        }\r\n    }\r\n});\r\n","\r\nimport Vue from 'vue';\r\nimport { VSnackbar, VBtn, VIcon } from 'vuetify/lib';\r\nimport Vuetify from 'vuetify/lib/framework';\r\n\r\n\r\nVue.use(Vuetify);\r\n\r\n// vuetify-message-snackbar を使うのに必要\r\nVue.component('v-snackbar', VSnackbar);\r\nVue.component('v-btn', VBtn);\r\nVue.component('v-icon', VIcon);\r\n\r\nexport default new Vuetify({\r\n    theme: {\r\n        dark: true,\r\n        themes: {\r\n            dark: {\r\n                primary: '#E64F97',\r\n                secondary: '#E33157',\r\n                twitter: {\r\n                    base: '#4F82E6',\r\n                    lighten1: '#799FEC',\r\n                    lighten2: '#41A5F1',\r\n                },\r\n                gray: '#66514C',\r\n                black: '#110A09',\r\n                background: {\r\n                    base: '#1E1310',\r\n                    lighten1: '#2F221F',\r\n                    lighten2: '#433532',\r\n                    lighten3: '#4c3c38',\r\n                },\r\n                text: {\r\n                    base: '#FFEAEA',\r\n                    darken1: '#D9C7C7',\r\n                    darken2: '#8E7F7E',\r\n                    darken3: '#786968',\r\n                }\r\n            }\r\n        },\r\n        options: {\r\n            customProperties: true,\r\n        },\r\n    },\r\n});\r\n","\r\n/**\r\n * 共通ユーティリティ\r\n */\r\nexport default class Utils {\r\n\r\n    // バージョン情報\r\n    // ビルド時の環境変数 (vue.config.js に記載) から取得\r\n    static readonly version: string = process.env.VUE_APP_VERSION as string;\r\n\r\n    // バックエンドの API のベース URL\r\n    // Worker からも参照できるように self.location を使う\r\n    static readonly api_base_url = (() => {\r\n        if (process.env.NODE_ENV === 'development') {\r\n            // デバッグ時はポートを 7000 に強制する\r\n            return `${self.location.protocol}//${self.location.hostname}:7000/api`;\r\n        } else {\r\n            // ビルド後は同じポートを使う\r\n            return `${self.location.protocol}//${self.location.host}/api`;\r\n        }\r\n    })();\r\n\r\n\r\n    /**\r\n     * アクセストークンを LocalStorage から取得する\r\n     * @returns JWT アクセストークン（ログインしていない場合は null が返る）\r\n     */\r\n    static getAccessToken(): string | null {\r\n\r\n        // LocalStorage の取得結果をそのまま返す\r\n        // LocalStorage.getItem() はキーが存在しなければ（=ログインしていなければ）null を返す\r\n        return localStorage.getItem('KonomiTV-AccessToken');\r\n    }\r\n\r\n\r\n    /**\r\n     * アクセストークンを LocalStorage に保存する\r\n     * @param access_token 発行された JWT アクセストークン\r\n     */\r\n    static saveAccessToken(access_token: string): void {\r\n\r\n        // そのまま LocalStorage に保存\r\n        localStorage.setItem('KonomiTV-AccessToken', access_token);\r\n    }\r\n\r\n\r\n    /**\r\n     * アクセストークンを LocalStorage から削除する\r\n     * アクセストークンを削除することで、ログアウト相当になる\r\n     */\r\n    static deleteAccessToken(): void {\r\n\r\n        // LocalStorage に KonomiTV-AccessToken キーが存在しない\r\n        if (localStorage.getItem('KonomiTV-AccessToken') === null) return;\r\n\r\n        // KonomiTV-AccessToken キーを削除\r\n        localStorage.removeItem('KonomiTV-AccessToken');\r\n    }\r\n\r\n\r\n    /**\r\n     * ブラウザが実行されている OS に応じて、\"Alt\" または \"Option\" を返す\r\n     * キーボードショートカットのコンビネーションキーの説明を OS によって分けるために使う\r\n     * @returns ブラウザが実行されている OS が macOS なら Option を、それ以外なら Alt を返す\r\n     */\r\n    static AltOrOption(): 'Alt' | 'Option' {\r\n        return Utils.isMacOS() ? 'Option' : 'Alt';\r\n    }\r\n\r\n\r\n    /**\r\n     * ブラウザが実行されている OS に応じて、\"Ctrl\" または \"Cmd\" を返す\r\n     * キーボードショートカットのコンビネーションキーの説明を OS によって分けるために使う\r\n     * @returns ブラウザが実行されている OS が macOS なら Cmd を、それ以外なら Ctrl を返す\r\n     */\r\n    static CtrlOrCmd(): 'Ctrl' | 'Cmd' {\r\n        return Utils.isMacOS() ? 'Cmd' : 'Ctrl';\r\n    }\r\n\r\n\r\n    /**\r\n     * 再帰的にオブジェクトを凍結する\r\n     * ref: https://unyacat.net/2021/01/20/vue-freeze-faster/\r\n     * @param object 凍結するオブジェクト\r\n     * @returns 再帰的に凍結されたオブジェクト\r\n     */\r\n    static deepObjectFreeze<T extends object>(object: T): T {\r\n        Object.keys(object).forEach(prop => {\r\n            if (typeof object[prop] === 'object' && !Object.isFrozen(object[prop])) Utils.deepObjectFreeze(object[prop]);\r\n        });\r\n        return Object.freeze(object);\r\n    }\r\n\r\n\r\n    /**\r\n     * Blob に格納されているデータをブラウザにダウンロードさせる\r\n     * @param blob Blob オブジェクト\r\n     * @param filename 保存するファイル名\r\n     */\r\n    static downloadBlobData(blob: Blob, filename: string): void {\r\n\r\n        // Blob URL を発行\r\n        const blob_url = URL.createObjectURL(blob);\r\n\r\n        // 画像をダウンロード\r\n        const link = document.createElement('a');\r\n        link.download = filename;\r\n        link.href = blob_url;\r\n        link.click();\r\n\r\n        // Blob URL を破棄\r\n        URL.revokeObjectURL(blob_url);\r\n    }\r\n\r\n\r\n    /**\r\n     * innerHTML しても問題ないように HTML の特殊文字をエスケープする\r\n     * PHP の htmlspecialchars() と似たようなもの\r\n     * @param content HTML エスケープされてないテキスト\r\n     * @returns HTML エスケープされたテキスト\r\n     */\r\n    static escapeHTML(content: string): string {\r\n\r\n        // HTML エスケープが必要な文字\r\n        // ref: https://www.php.net/manual/ja/function.htmlspecialchars.php\r\n        const html_escape_table = {\r\n            '&': '&amp;',\r\n            '\"': '&quot;',\r\n            '\\'': '&apos;',\r\n            '<': '&lt;',\r\n            '>': '&gt;',\r\n        };\r\n\r\n        // ref: https://qiita.com/noriaki/items/4bfef8d7cf85dc1035b3\r\n        return content.replace(/[&\"'<>]/g, (match) => {\r\n            return html_escape_table[match];\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * OAuth 連携時のポップアップを画面中央に表示するための windowFeatures 文字列を取得する\r\n     * ref: https://qiita.com/catatsuy/items/babce8726ea78f5d25b1\r\n     * @returns window.open() で使う windowFeatures 文字列\r\n     */\r\n    static getWindowFeatures(): string {\r\n\r\n        // ポップアップウインドウのサイズ\r\n        const popupSizeWidth = 650;\r\n        const popupSizeHeight = window.screen.height >= 800 ? 800 : window.screen.height - 100;\r\n\r\n        // ポップアップウインドウの位置\r\n        const posTop = (window.screen.height - popupSizeHeight) / 2;\r\n        const posLeft = (window.screen.width - popupSizeWidth) / 2;\r\n\r\n        return `toolbar=0,status=0,top=${posTop},left=${posLeft},width=${popupSizeWidth},height=${popupSizeHeight},modal=yes,alwaysRaised=yes`;\r\n    }\r\n\r\n\r\n    /**\r\n     * 現在フォーカスを持っている要素に指定された CSS クラスが付与されているか\r\n     * @param class_name 存在を確認する CSS クラス名\r\n     * @returns document.activeElement が class_name で指定したクラスを持っているかどうか\r\n     */\r\n    static hasActiveElementClass(class_name: string): boolean {\r\n        if (document.activeElement === null) return false;\r\n        return document.activeElement.classList.contains(class_name);\r\n    }\r\n\r\n\r\n    /**\r\n     * ブラウザが Firefox かどうか\r\n     * @returns ブラウザが Firefox なら true を返す\r\n     */\r\n    static isFirefox(): boolean {\r\n        return /Firefox/i.test(navigator.userAgent);\r\n    }\r\n\r\n\r\n    /**\r\n     * デバイスの OS が macOS かどうか\r\n     * キーボードショートカットで使うキーを OS によって分けるために使う\r\n     * @returns デバイスの OS が macOS なら true を返す\r\n     */\r\n    static isMacOS(): boolean {\r\n        // iPhone・iPad で純正キーボードを接続した場合も一応想定して、iPhone・iPad も含める\r\n        return /iPhone|iPad|Macintosh/i.test(navigator.userAgent);\r\n    }\r\n\r\n\r\n    /**\r\n     * ブラウザが Safari かどうか\r\n     * @returns ブラウザが Safari なら true を返す\r\n     */\r\n    static isSafari(): boolean {\r\n        return /Safari/i.test(navigator.userAgent) && !/Chrome/i.test(navigator.userAgent);\r\n    }\r\n\r\n\r\n    /**\r\n     * モバイルデバイス (スマホ・タブレット) かどうか\r\n     * @returns モバイルデバイス (スマホ・タブレット) なら true を返す\r\n     */\r\n    static isMobileDevice(): boolean {\r\n        // Macintosh が入っているのは、iPadOS は既定でデスクトップ表示モードが有効になっていて、UA だけでは Mac と判別できないため\r\n        // Mac にタッチパネル付きの機種は存在しないので、'ontouchend' in document で判定できる\r\n        // Windows タブレットはマウスやキーボードを付けたら普通の PC になるケースもあって判断が非常に難しく、需要も少ないため除外している\r\n        return /iPhone|iPad|iPod|Macintosh|Android|Mobile/i.test(navigator.userAgent) && 'ontouchend' in document;\r\n    }\r\n\r\n\r\n    /**\r\n     * 表示画面がタブレット横画面かどうか (メディアクエリの定義は variables.scss と同一)\r\n     * @returns タブレット横画面なら true を返す\r\n     */\r\n    static isTabletHorizontal(): boolean {\r\n        return window.matchMedia('(min-width: 1000.01px) and (max-width: 1264px) and (max-height: 850px)').matches;\r\n    }\r\n\r\n\r\n    /**\r\n     * 表示画面がタブレット縦画面かどうか (メディアクエリの定義は variables.scss と同一)\r\n     * @returns タブレット縦画面なら true を返す\r\n     */\r\n    static isTabletVertical(): boolean {\r\n        return window.matchMedia('(min-width: 600.1px) and (max-width: 850px) and (min-height: 850.01px)').matches;\r\n    }\r\n\r\n\r\n    /**\r\n     * 表示画面がスマホ横画面かどうか\r\n     * @returns スマホ横画面なら true を返す\r\n     */\r\n    static isSmartphoneHorizontal(): boolean {\r\n        return window.matchMedia('(max-width: 1000px) and (max-height: 500px)').matches;\r\n    }\r\n\r\n\r\n    /**\r\n     * 表示画面がスマホ縦画面かどうか (メディアクエリの定義は variables.scss と同一)\r\n     * @returns スマホ縦画面なら true を返す\r\n     */\r\n    static isSmartphoneVertical(): boolean {\r\n        return window.matchMedia('(max-width: 600px) and (min-height: 375.01px)').matches;\r\n    }\r\n\r\n\r\n    /**\r\n     * 表示端末がタッチデバイスかどうか (Utils.isMobileDevice() とは異なり、モバイルデバイスかどうかは問わない)\r\n     * おそらく Windows タブレットや Chromebook なども含まれる\r\n     * @returns タッチデバイスなら true を返す\r\n     */\r\n    static isTouchDevice(): boolean {\r\n        return window.matchMedia('(hover: none)').matches;\r\n    }\r\n\r\n\r\n    /**\r\n     * 任意の桁で切り捨てする\r\n     * ref: https://qiita.com/nagito25/items/0293bc317067d9e6c560#comment-87f0855f388953843037\r\n     * @param value 切り捨てする数値\r\n     * @param base どの桁で切り捨てするか (-1 → 10の位 / 3 → 小数第3位）\r\n     * @return 切り捨てした値\r\n     */\r\n    static mathFloor(value: number, base: number = 0): number {\r\n        return Math.floor(value * (10**base)) / (10**base);\r\n    }\r\n\r\n\r\n    /**\r\n     * async/await でスリープ的なもの\r\n     * @param seconds 待機する秒数 (ミリ秒単位ではないので注意)\r\n     * @returns Promise を返すので、await sleep(1); のように使う\r\n     */\r\n    static async sleep(seconds: number): Promise<number> {\r\n        return await new Promise(resolve => setTimeout(resolve, seconds * 1000));\r\n    }\r\n\r\n\r\n    /**\r\n     * 現在時刻の UNIX タイムスタンプ (秒単位) を取得する (デバッグ用)\r\n     * @returns 現在時刻の UNIX タイムスタンプ (秒単位)\r\n     */\r\n    static time(): number {\r\n        return Date.now() / 1000;\r\n    }\r\n\r\n\r\n    /**\r\n     * 指定された値の型の名前を取得する\r\n     * ref: https://qiita.com/amamamaou/items/ef0b797156b324bb4ef3\r\n     * @returns 指定された値の型の名前\r\n     */\r\n    static typeof(value: any): string {\r\n        return Object.prototype.toString.call(value).slice(8, -1).toLowerCase();\r\n    }\r\n\r\n\r\n    /**\r\n     * 文字列中に含まれる URL をリンクの HTML に置き換える\r\n     * @param text 置換対象の文字列\r\n     * @returns URL をリンクに置換した文字列\r\n     */\r\n    static URLtoLink(text: string): string {\r\n\r\n        // HTML の特殊文字で表示がバグらないように、事前に HTML エスケープしておく\r\n        text = Utils.escapeHTML(text);\r\n\r\n        // ref: https://www.softel.co.jp/blogs/tech/archives/6099\r\n        const pattern = /(https?:\\/\\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/ig;\r\n        return text.replace(pattern, '<a href=\"$1\" target=\"_blank\">$1</a>');\r\n    }\r\n\r\n\r\n    /**\r\n     * デバイスがオンラインになるまで待機する\r\n     * @returns Promise を返すので、await waitUntilOnline(); のように使う\r\n     */\r\n    static async waitUntilOnline(): Promise<void> {\r\n        return await new Promise(resolve => {\r\n            window.addEventListener('online', () => resolve());\r\n        });\r\n    }\r\n}\r\n","\r\nimport { ChannelType } from '@/services/Channels';\r\n\r\n\r\n/**\r\n * チャンネル周りのユーティリティ\r\n */\r\nexport class ChannelUtils {\r\n\r\n    /**\r\n     * display_channel_id からチャンネルタイプを取得する\r\n     * @param display_channel_id display_channel_id\r\n     * @returns チャンネルタイプ (不正な display_channel_id の場合は null)\r\n     */\r\n    static getChannelType(display_channel_id: string): ChannelType | null {\r\n        try {\r\n            const result = display_channel_id.match('(?<channel_type>[a-z]+)[0-9]+')!.groups!.channel_type.toUpperCase();\r\n            switch (result) {\r\n                case 'GR': return 'GR';\r\n                case 'BS': return 'BS';\r\n                case 'CS': return 'CS';\r\n                case 'CATV': return 'CATV';\r\n                case 'SKY': return 'SKY';\r\n                case 'STARDIGIO': return 'STARDIGIO';\r\n                // 正規表現ではエラーになっていないが、ChannelType のいずれにもマッチしない\r\n                default: return null;\r\n            }\r\n        } catch (e) {\r\n            // 何かしらエラーが発生したということは display_channel_id が不正\r\n            return null;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * チャンネルの実況勢いから「多」「激多」「祭」を取得する\r\n     * ref: https://ja.wikipedia.org/wiki/%E3%83%8B%E3%82%B3%E3%83%8B%E3%82%B3%E5%AE%9F%E6%B3%81\r\n     * @param jikkyo_force チャンネルの実況勢い\r\n     * @returns normal（普通）or many（多）or so-many（激多）or festival（祭）\r\n     */\r\n    static getChannelForceType(jikkyo_force: number | null): 'normal' | 'many' | 'so-many' | 'festival' {\r\n\r\n        // 実況勢いが null（=対応する実況チャンネルがない）\r\n        if (jikkyo_force === null) return 'normal';\r\n\r\n        // 実況勢いが 500 コメント以上（祭）\r\n        if (jikkyo_force >= 500) return 'festival';\r\n        // 実況勢いが 200 コメント以上（激多）\r\n        if (jikkyo_force >= 200) return 'so-many';\r\n        // 実況勢いが 100 コメント以上（多）\r\n        if (jikkyo_force >= 100) return 'many';\r\n\r\n        // それ以外\r\n        return 'normal';\r\n    }\r\n\r\n\r\n    /**\r\n     * チャンネル名から対応する局タグを取得する\r\n     * とりあえず三大首都圏 + BS のみ対応\r\n     * @param channel_name チャンネル名\r\n     * @returns 局タグ (一致するものがない場合は null)\r\n     */\r\n    static getChannelHashtag(channel_name: string): string | null {\r\n        // NHK\r\n        if (channel_name.startsWith('NHK総合')) {\r\n            return '#nhk';\r\n        } else if (channel_name.startsWith('NHKEテレ')) {\r\n            return '#etv';\r\n        // 民放\r\n        } else if (channel_name.startsWith('日テレ')) {\r\n            return '#ntv';\r\n        } else if (channel_name.startsWith('読売テレビ')) {\r\n            return '#ytv';\r\n        } else if (channel_name.startsWith('中京テレビ')) {\r\n            return '#chukyotv';\r\n        } else if (channel_name.startsWith('テレビ朝日')) {\r\n            return '#tvasahi';\r\n        } else if (channel_name.startsWith('ABCテレビ')) {\r\n            return '#abc';\r\n        } else if (channel_name.startsWith('メ~テレ') || channel_name.startsWith('メ〜テレ')) {\r\n            return '#nagoyatv';\r\n        } else if (channel_name.startsWith('TBS') && !channel_name.includes('TBSチャンネル')) {\r\n            return '#tbs';\r\n        } else if (channel_name.startsWith('MBS')) {\r\n            return '#mbs';\r\n        } else if (channel_name.startsWith('CBC')) {\r\n            return '#cbc';\r\n        } else if (channel_name.startsWith('テレビ東京')) {\r\n            return '#tvtokyo';\r\n        } else if (channel_name.startsWith('テレビ大阪')) {\r\n            return '#tvo';\r\n        } else if (channel_name.startsWith('テレビ愛知')) {\r\n            return '#tva';\r\n        } else if (channel_name.startsWith('フジテレビ')) {\r\n            return '#fujitv';\r\n        } else if (channel_name.startsWith('関西テレビ')) {\r\n            return '#kantele';\r\n        } else if (channel_name.startsWith('東海テレビ')) {\r\n            return '#tokaitv';\r\n        // 独立局\r\n        } else if (channel_name.startsWith('TOKYO MX')) {\r\n            return '#tokyomx';\r\n        } else if (channel_name.startsWith('tvk')) {\r\n            return '#tvk';\r\n        } else if (channel_name.startsWith('チバテレ')) {\r\n            return '#chibatv';\r\n        } else if (channel_name.startsWith('テレ玉')) {\r\n            return '#teletama';\r\n        } else if (channel_name.startsWith('サンテレビ')) {\r\n            return '#suntv';\r\n        } else if (channel_name.startsWith('KBS京都')) {\r\n            return '#kbs';\r\n        // BS・CS\r\n        } else if (channel_name.startsWith('NHKBS1')) {\r\n            return '#nhkbs1';\r\n        } else if (channel_name.startsWith('NHKBSプレミアム')) {\r\n            return '#nhkbsp';\r\n        } else if (channel_name.startsWith('BS日テレ')) {\r\n            return '#bsntv';\r\n        } else if (channel_name.startsWith('BS朝日')) {\r\n            return '#bsasahi';\r\n        } else if (channel_name.startsWith('BS-TBS')) {\r\n            return '#bstbs';\r\n        } else if (channel_name.startsWith('BSテレ東')) {\r\n            return '#bstvtokyo';\r\n        } else if (channel_name.startsWith('BSフジ')) {\r\n            return '#bsfuji';\r\n        } else if (channel_name.startsWith('BS11イレブン')) {\r\n            return '#bs11';\r\n        } else if (channel_name.startsWith('BS12トゥエルビ')) {\r\n            return '#bs12';\r\n        } else if (channel_name.startsWith('AT-X')) {\r\n            return '#at_x';\r\n        }\r\n\r\n        return null;\r\n    }\r\n}\r\n","\r\nimport { MessageOption, MessageType } from 'vuetify-message-snackbar/src/message';\r\n\r\n\r\ninterface MessageReturnValue {\r\n    close(): void;\r\n    again(): void;\r\n}\r\n\r\n// Vue コンポーネント以外からも this.$message を使えるようにするための (強引な) ラッパー\r\n// …だったのだが、defineComponent に移行した結果 this.$message が使えなくなったので結局こっちに統一した\r\n// 将来的にはちゃんと実装する予定\r\nexport default {\r\n    success(message: MessageType | MessageOption): MessageReturnValue {\r\n        // @ts-ignore\r\n        return window.KonomiTVVueInstance?.$message.success(message);\r\n    },\r\n    info(message: MessageType | MessageOption): MessageReturnValue {\r\n        // @ts-ignore\r\n        return window.KonomiTVVueInstance?.$message.info(message);\r\n    },\r\n    warning(message: MessageType | MessageOption): MessageReturnValue {\r\n        // @ts-ignore\r\n        return window.KonomiTVVueInstance?.$message.warning(message);\r\n    },\r\n    error(message: MessageType | MessageOption): MessageReturnValue {\r\n        // @ts-ignore\r\n        return window.KonomiTVVueInstance?.$message.error(message);\r\n    },\r\n    show(message: MessageType | MessageOption): MessageReturnValue {\r\n        // @ts-ignore\r\n        return window.KonomiTVVueInstance?.$message.show(message);\r\n    }\r\n};\r\n","\r\nimport Message from '@/message';\r\nimport APIClient from '@/services/APIClient';\r\n\r\n\r\n/** ユーザーアカウントの情報を表すインターフェイス */\r\nexport interface IUser {\r\n    id: number;\r\n    name: string;\r\n    is_admin: boolean;\r\n    niconico_user_id: number | null;\r\n    niconico_user_name: string | null;\r\n    niconico_user_premium: boolean | null;\r\n    twitter_accounts: ITwitterAccount[];\r\n    created_at: string;\r\n    updated_at: string;\r\n}\r\n\r\n/** ユーザーアカウントに紐づく Twitter アカウントの情報を表すインターフェイス */\r\nexport interface ITwitterAccount {\r\n    id: number;\r\n    name: string;\r\n    screen_name: string;\r\n    icon_url: string;\r\n    is_oauth_session: boolean;\r\n    created_at: string;\r\n    updated_at: string;\r\n}\r\n\r\n/** ユーザーアカウントのアクセストークンを表すインターフェイス */\r\nexport interface IUserAccessToken {\r\n    access_token: string;\r\n    token_type: string;\r\n}\r\n\r\nexport interface IUserCreateRequest {\r\n    username: string;\r\n    password: string;\r\n}\r\nexport interface IUserUpdateRequest {\r\n    username?: string;\r\n    password?: string;\r\n}\r\nexport interface IUserUpdateRequestForAdmin {\r\n    username?: string;\r\n    password?: string;\r\n    is_admin?: boolean;\r\n}\r\n\r\n\r\nclass Users {\r\n\r\n    /**\r\n     * ユーザーアカウントを作成する\r\n     * @param user_create_request ユーザー名とパスワード\r\n     * @returns 作成したユーザーアカウントの情報 or アカウント作成に失敗した場合は null\r\n     */\r\n    static async createUser(user_create_request: IUserCreateRequest): Promise<IUser | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.post<IUser>('/users', user_create_request);\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            switch (response.data.detail) {\r\n                case 'Specified username is duplicated': {\r\n                    Message.error('ユーザー名が重複しています。');\r\n                    break;\r\n                }\r\n                case 'Specified username is not accepted due to system limitations': {\r\n                    Message.error('ユーザー名に token と me は使えません。');\r\n                    break;\r\n                }\r\n                default: {\r\n                    APIClient.showGenericError(response, 'アカウントを作成できませんでした。');\r\n                    break;\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        return response.data;\r\n    }\r\n\r\n\r\n    /**\r\n     * ユーザーアカウントのアクセストークンを発行する\r\n     * @param username ユーザー名\r\n     * @param password パスワード\r\n     * @returns 発行したアクセストークン or ログインに失敗した場合は null\r\n     */\r\n    static async createUserAccessToken(username: string, password: string): Promise<IUserAccessToken | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.post<IUserAccessToken>('/users/token', new URLSearchParams({username, password}));\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            switch (response.data.detail) {\r\n                case 'Incorrect username': {\r\n                    Message.error('ログインできませんでした。そのユーザー名のアカウントは存在しません。');\r\n                    break;\r\n                }\r\n                case 'Incorrect password': {\r\n                    Message.error('ログインできませんでした。パスワードを間違えていませんか？');\r\n                    break;\r\n                }\r\n                default: {\r\n                    APIClient.showGenericError(response, 'ログインできませんでした。');\r\n                    break;\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        return response.data;\r\n    }\r\n\r\n\r\n    /**\r\n     * 現在ログイン中のユーザーアカウントの情報を取得する\r\n     * @returns ログイン中のユーザーアカウントの情報 or ログインしていない場合は null\r\n     */\r\n    static async fetchUser(): Promise<IUser | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.get<IUser>('/users/me');\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, 'アカウント情報を取得できませんでした。');\r\n            return null;\r\n        }\r\n\r\n        return response.data;\r\n    }\r\n\r\n\r\n    /**\r\n     * 現在ログイン中のユーザーアカウントのアイコンを取得する\r\n     * @returns ログイン中のユーザーアカウントのアイコンの Blob URL or ログインしていない場合は null\r\n     */\r\n    static async fetchUserIcon(): Promise<string | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.get('/users/me/icon', {responseType: 'blob'});\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, 'アイコン画像を取得できませんでした。');\r\n            return null;\r\n        }\r\n\r\n        return URL.createObjectURL(response.data);\r\n    }\r\n\r\n\r\n    /**\r\n     * 現在ログイン中のユーザーアカウントの情報を更新する\r\n     * @param user_update_request ユーザー名 or パスワード\r\n     */\r\n    static async updateUser(user_update_request: IUserUpdateRequest): Promise<void> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.put('/users/me', user_update_request);\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            switch (response.data.detail) {\r\n                case 'Specified username is duplicated': {\r\n                    Message.error('ユーザー名が重複しています。');\r\n                    break;\r\n                }\r\n                case 'Specified username is not accepted due to system limitations': {\r\n                    Message.error('ユーザー名に token と me は使えません。');\r\n                    break;\r\n                }\r\n                default: {\r\n                    APIClient.showGenericError(response, 'アカウント情報を更新できませんでした。');\r\n                    break;\r\n                }\r\n            }\r\n            return;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 現在ログイン中のユーザーアカウントのアイコン画像を更新する\r\n     * @param icon アイコンの File オブジェクト\r\n     */\r\n    static async updateUserIcon(icon: File): Promise<void> {\r\n\r\n        // アイコン画像の File オブジェクト (= Blob) を FormData に入れる\r\n        // multipart/form-data で送るために必要\r\n        // ref: https://r17n.page/2020/02/04/nodejs-axios-file-upload-api/\r\n        const form_data = new FormData();\r\n        form_data.append('image', icon);\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.put('/users/me/icon', form_data, {headers: {'Content-Type': 'multipart/form-data'}});\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            switch (response.data.detail) {\r\n                case 'Please upload JPEG or PNG image': {\r\n                    Message.error('JPEG または PNG 画像をアップロードしてください。');\r\n                    break;\r\n                }\r\n                default: {\r\n                    APIClient.showGenericError(response, 'アイコン画像を更新できませんでした。');\r\n                    break;\r\n                }\r\n            }\r\n            return;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 現在ログイン中のユーザーアカウントを削除する\r\n     */\r\n    static async deleteUser(): Promise<void> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.delete('/users/me');\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, 'アカウントを削除できませんでした。');\r\n            return;\r\n        }\r\n    }\r\n}\r\n\r\nexport default Users;\r\n","\r\nimport { defineStore } from 'pinia';\r\n\r\nimport Message from '@/message';\r\nimport Users, { IUser, IUserUpdateRequest } from '@/services/Users';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils from '@/utils';\r\n\r\n\r\n/**\r\n * 現在ログイン中のユーザーアカウントの情報を共有するストア\r\n */\r\nconst useUserStore = defineStore('user', {\r\n    state: () => ({\r\n\r\n        // 現在ログイン中かどうか\r\n        is_logged_in: false as boolean,\r\n\r\n        // ログイン済みのユーザーの情報\r\n        user: null as IUser | null,\r\n\r\n        // ログイン済みのユーザーのアイコン画像の Blob URL\r\n        user_icon_url: null as string | null,\r\n    }),\r\n    getters: {\r\n\r\n        /**\r\n         * ログイン済みのユーザーのニコニコアカウントのユーザーアイコンの URL (ニコニコアカウントと連携されている場合のみ)\r\n         */\r\n        user_niconico_icon_url(): string | null {\r\n            if (this.user === null || this.user.niconico_user_id === null) {\r\n                return null;\r\n            }\r\n            const user_id_slice = this.user.niconico_user_id.toString().slice(0, 4);\r\n            return `https://secure-dcdn.cdn.nimg.jp/nicoaccount/usericon/${user_id_slice}/${this.user.niconico_user_id}.jpg`;\r\n        }\r\n    },\r\n    actions: {\r\n\r\n        /**\r\n         * アカウントを作成する\r\n         * @param username ユーザー名\r\n         * @param password パスワード\r\n         * @returns アカウント作成に成功した場合は true\r\n         */\r\n        async register(username: string, password: string): Promise<boolean> {\r\n\r\n            // アカウントを作成\r\n            const result = await Users.createUser({username, password});\r\n            if (result === null) {\r\n                console.log('Register failed.');\r\n                return false;  // アカウント作成失敗 (エラーハンドリングは services 層で行われる)\r\n            }\r\n\r\n            // 作成したアカウントでログイン\r\n            await this.login(username, password, true);\r\n            console.log('Register successful.');\r\n            Message.success('アカウントを作成しました。');\r\n            return true;\r\n        },\r\n\r\n        /**\r\n         * ログイン処理を行う\r\n         * @param username ユーザー名\r\n         * @param password パスワード\r\n         * @param silent ログインしたことをメッセージで通知しない場合は true\r\n         * @returns ログインに成功した場合は true\r\n         */\r\n        async login(username: string, password: string, silent: boolean = false): Promise<boolean> {\r\n\r\n            // アクセストークンを発行\r\n            const access_token = await Users.createUserAccessToken(username, password);\r\n            if (access_token === null) {\r\n                console.log('Login failed.');\r\n                this.logout(true);\r\n                return false;  // ログイン失敗 (エラーハンドリングは services 層で行われる)\r\n            }\r\n\r\n            // 取得したアクセストークンを保存\r\n            console.log('Login successful.');\r\n            Utils.saveAccessToken(access_token.access_token);\r\n            this.is_logged_in = true;\r\n\r\n            // ユーザーアカウントの情報を取得\r\n            await this.fetchUser(true);\r\n\r\n            if (silent === false) {\r\n                Message.success('ログインしました。');\r\n            }\r\n\r\n            return true;\r\n        },\r\n\r\n        /**\r\n         * ログアウト処理を行う\r\n         * @param silent ログアウトしたことをメッセージで通知しない場合は true\r\n         */\r\n        logout(silent: boolean = false): void {\r\n\r\n            // 設定の同期を無効化\r\n            const settings_store = useSettingsStore();\r\n            settings_store.settings.sync_settings = false;\r\n\r\n            // ブラウザからアクセストークンを削除\r\n            // これをもってログアウトしたことになる（それ以降の Axios のリクエストにはアクセストークンが含まれなくなる）\r\n            Utils.deleteAccessToken();\r\n\r\n            // 未ログイン状態に設定\r\n            this.is_logged_in = false;\r\n            this.user = null;\r\n            this.user_icon_url = '';\r\n\r\n            if (silent === false) {\r\n                Message.success('ログアウトしました。');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * 現在ログイン中のユーザーアカウントの情報を取得する\r\n         * すでに取得済みの情報がある場合は API リクエストを行わずにそれを返す\r\n         * @param force 強制的に API リクエストを行う場合は true\r\n         * @returns ログイン中のユーザーアカウントの情報 or ログインしていない場合は null\r\n         */\r\n        async fetchUser(force: boolean = false): Promise<IUser | null> {\r\n\r\n            // LocalStorage にアクセストークンが保存されていない場合 (= 非ログイン状態) は常に null を返す\r\n            if (Utils.getAccessToken() === null) {\r\n                return null;\r\n            }\r\n\r\n            // すでにログイン済みのユーザーアカウントの情報がある場合はそれを返す\r\n            // force が true の場合は無視される\r\n            if (this.user !== null && force === false) {\r\n                return this.user;\r\n            }\r\n\r\n            // ユーザーアカウントの情報を取得する\r\n            const user = await Users.fetchUser();\r\n            if (user === null) {\r\n                // この時点で無効などの理由でアクセストークンが削除されている場合、ログアウトする\r\n                if (Utils.getAccessToken() === null) {\r\n                    this.logout(true);\r\n                }\r\n                return null;\r\n            }\r\n            this.is_logged_in = true;\r\n            this.user = user;\r\n\r\n            // ユーザーアカウントのアイコン画像の Blob URL を取得する\r\n            const user_icon_url = await Users.fetchUserIcon();\r\n            if (user_icon_url === null) {\r\n                return null;\r\n            }\r\n            this.user_icon_url = user_icon_url;\r\n\r\n            return this.user;\r\n        },\r\n\r\n        /**\r\n         * 現在ログイン中のユーザーアカウントの情報を更新する\r\n         * @param user_update_request ユーザー名 or パスワード\r\n         */\r\n        async updateUser(user_update_request: IUserUpdateRequest): Promise<void> {\r\n\r\n            // ユーザーアカウントの情報を更新する\r\n            await Users.updateUser(user_update_request);\r\n\r\n            // ユーザーアカウントの情報を再取得する\r\n            await this.fetchUser(true);\r\n\r\n            if (user_update_request.username !== undefined) {\r\n                Message.show('ユーザー名を更新しました。');\r\n            } else if (user_update_request.password !== undefined) {\r\n                Message.show('パスワードを更新しました。');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * 現在ログイン中のユーザーアカウントのアイコン画像を更新する\r\n         * @param icon アイコンの File オブジェクト\r\n         */\r\n        async updateUserIcon(icon: File): Promise<void> {\r\n\r\n            // ユーザーアカウントのアイコン画像を更新する\r\n            await Users.updateUserIcon(icon);\r\n\r\n            // ユーザーアカウントの情報を再取得する\r\n            await this.fetchUser(true);\r\n\r\n            Message.show('アイコン画像を更新しました。');\r\n        },\r\n\r\n        /**\r\n         * 現在ログイン中のユーザーアカウントを削除する\r\n         */\r\n        async deleteUser(): Promise<void> {\r\n\r\n            // ユーザーアカウントを削除する\r\n            await Users.deleteUser();\r\n\r\n            // ログアウトする\r\n            this.logout(true);\r\n\r\n            Message.show('アカウントを削除しました。');\r\n        }\r\n    }\r\n});\r\n\r\nexport default useUserStore;\r\n","\r\n/**\r\n * services/ 直下の各クラスは、KonomiTV サーバーへの API リクエストを抽象化し、\r\n * API レスポンスの受け取りと、エラーが発生した際のエラーハンドリング (エラーメッセージ表示) までを責務として負う\r\n */\r\n\r\nimport axios, { AxiosError, AxiosRequestConfig, AxiosResponse } from 'axios';\r\n\r\nimport Message from '@/message';\r\nimport useUserStore from '@/stores/UserStore';\r\nimport Utils from '@/utils';\r\n\r\n\r\n/** API リクエスト成功時のレスポンスを表すインターフェイス */\r\nexport interface ISuccessResponse<T> {\r\n    type: 'success';\r\n    status: number;\r\n    data: T;\r\n}\r\n\r\n/** API リクエスト失敗時のレスポンスを表すインターフェイス */\r\nexport interface IErrorResponse {\r\n    type: 'error';\r\n    status: number;\r\n    data: IErrorResponseData;\r\n    error: AxiosError<IErrorResponseData>;\r\n}\r\n\r\n/**\r\n * API リクエスト失敗時にサーバーから返されるエラーレスポンスを表すインターフェイス\r\n * HTTP リクエスト自体が失敗した場合は、detail に AxiosError のエラーメッセージが入る\r\n */\r\nexport interface IErrorResponseData {\r\n    detail: string | {\r\n        type: string;\r\n        loc: (string | number)[];\r\n        msg: string;\r\n        input?: any;\r\n        url?: string;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * services/ 以下の各クラスから呼び出される、Axios の薄いラッパー\r\n * エラーハンドリングを容易にするために、レスポンスを ISuccessResponse と IErrorResponse に分けて返す\r\n * ref: https://zenn.dev/engineer_titan/articles/291c9fccb338e2\r\n */\r\nclass APIClient {\r\n\r\n    /**\r\n     * Axios で HTTP リクエストを送信し、レスポンスを受け取る\r\n     * @param request AxiosRequestConfig\r\n     * @returns 成功なら ISuccessResponse 、失敗なら IErrorResponse を返す\r\n     */\r\n    static async request<T>(request: AxiosRequestConfig): Promise<ISuccessResponse<T> | IErrorResponse> {\r\n\r\n        // API のベース URL を設定 (config.baseURL が指定されていない場合のみ)\r\n        if (request.baseURL === undefined) {\r\n            request.baseURL = Utils.api_base_url;\r\n        }\r\n\r\n        // リクエストヘッダーが指定されていない場合は空のオブジェクトを設定\r\n        if (request.headers === undefined) {\r\n            request.headers = {};\r\n        }\r\n\r\n        // 外部サイトへの HTTP/HTTPS リクエストでは実行しない\r\n        if (request.url?.startsWith('http') === false) {\r\n\r\n            // アクセストークンが取得できたら (=ログインされていれば)\r\n            // 取得したアクセストークンを Authorization ヘッダーに Bearer トークンとしてセット\r\n            // これを忘れると当然ながらログインしていない扱いになる\r\n            const access_token = Utils.getAccessToken();\r\n            if (access_token !== null) {\r\n                request.headers['Authorization'] = `Bearer ${access_token}`;\r\n            }\r\n\r\n            // KonomiTV クライアントのバージョンを設定\r\n            // 今のところ使わないが、将来的にクライアントとサーバーを分離することを見据えて念のため\r\n            request.headers['X-KonomiTV-Version'] = Utils.version;\r\n        }\r\n\r\n        // リクエストのタイムアウト時間を30秒に設定\r\n        request.timeout = 30 * 1000;\r\n\r\n        // リクエストのタイムアウト時に、一般的な ECONNABORTED の代わりに ETIMEDOUT を送出する\r\n        request.transitional = {\r\n            clarifyTimeoutError: true,\r\n        };\r\n\r\n        // Axios で HTTP リクエストを送信し、レスポンスを受け取る\r\n        const result: AxiosResponse<T> | AxiosError<IErrorResponseData> = await axios.request(request).catch((error) => error);\r\n\r\n        // エラーが発生した場合は IErrorResponse を返す\r\n        if (result instanceof AxiosError) {\r\n            console.error(result);\r\n\r\n            // エラーレスポンスがあれば、エラー内容と AxiosError を IErrorResponse に入れて返す\r\n            if (result.response) {\r\n                return {\r\n                    type: 'error',\r\n                    status: result.response.status,\r\n                    data: result.response.data,  // data には IErrorResponseData が入る\r\n                    error: result,  // AxiosError をそのまま入れる\r\n                };\r\n\r\n            // エラーレスポンスがない場合は、AxiosError のみを IErrorResponse に入れて返す\r\n            } else {\r\n                return {\r\n                    type: 'error',\r\n                    status: NaN,  // ステータスコードは取得できないので NaN にする\r\n                    data: {detail: result.message},  // data.detail に AxiosError のエラーメッセージを入れる\r\n                    error: result,  // AxiosError をそのまま入れる\r\n                };\r\n            }\r\n\r\n        // 正常にレスポンスが返ってきた場合は ISuccessResponse を返す\r\n        } else {\r\n            return {\r\n                type: 'success',\r\n                status: result.status,\r\n                data: result.data,\r\n            };\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * GET リクエストを送信する\r\n     * @param url リクエスト先の URL\r\n     * @returns 成功なら ISuccessResponse 、失敗なら IErrorResponse を返す\r\n     */\r\n    static async get<T = any, D = any>(url: string, config?: AxiosRequestConfig<D>): Promise<ISuccessResponse<T> | IErrorResponse> {\r\n        const request: AxiosRequestConfig = {\r\n            url: url,\r\n            method: 'GET',\r\n            ...config,\r\n        };\r\n        return await APIClient.request<T>(request);\r\n    }\r\n\r\n\r\n    /**\r\n     * POST リクエストを送信する\r\n     * @param url リクエスト先の URL\r\n     * @returns 成功なら ISuccessResponse 、失敗なら IErrorResponse を返す\r\n     */\r\n    static async post<T = any, D = any>(url: string, data?: D, config?: AxiosRequestConfig<D>): Promise<ISuccessResponse<T> | IErrorResponse> {\r\n        const request: AxiosRequestConfig = {\r\n            url: url,\r\n            method: 'POST',\r\n            data: data,\r\n            ...config,\r\n        };\r\n        return await APIClient.request<T>(request);\r\n    }\r\n\r\n\r\n    /**\r\n     * PUT リクエストを送信する\r\n     * @param url リクエスト先の URL\r\n     * @returns 成功なら ISuccessResponse 、失敗なら IErrorResponse を返す\r\n     */\r\n    static async put<T = any, D = any>(url: string, data?: D, config?: AxiosRequestConfig<D>): Promise<ISuccessResponse<T> | IErrorResponse> {\r\n        const request: AxiosRequestConfig = {\r\n            url: url,\r\n            method: 'PUT',\r\n            data: data,\r\n            ...config,\r\n        };\r\n        return await APIClient.request<T>(request);\r\n    }\r\n\r\n\r\n    /**\r\n     * DELETE リクエストを送信する\r\n     * @param url リクエスト先の URL\r\n     * @returns 成功なら ISuccessResponse 、失敗なら IErrorResponse を返す\r\n     */\r\n    static async delete<T = any, D = any>(url: string, config?: AxiosRequestConfig<D>): Promise<ISuccessResponse<T> | IErrorResponse> {\r\n        const request: AxiosRequestConfig = {\r\n            url: url,\r\n            method: 'DELETE',\r\n            ...config,\r\n        };\r\n        return await APIClient.request<T>(request);\r\n    }\r\n\r\n\r\n    /**\r\n     * 一般的なエラーメッセージの共通処理\r\n     * エラーメッセージを SnackBar で表示する\r\n     * @param error_response API から返されたエラーレスポンス\r\n     * @param template エラーメッセージのテンプレート（「アカウント情報を取得できませんでした。」など)\r\n     */\r\n    static showGenericError(error_response: IErrorResponse, template: string): void {\r\n        const user_store = useUserStore();\r\n        switch (error_response.data.detail) {\r\n            case 'Not authenticated': {\r\n                user_store.logout(true);\r\n                Message.error(`${template}\\nログインし直してください。`);\r\n                return;\r\n            }\r\n            case 'Access token data is invalid': {\r\n                user_store.logout(true);\r\n                Message.error(`${template}\\nログインセッションが不正です。もう一度ログインし直してください。`);\r\n                return;\r\n            }\r\n            case 'Access token is invalid': {\r\n                user_store.logout(true);\r\n                Message.error(`${template}\\nログインセッションの有効期限が切れています。もう一度ログインし直してください。`);\r\n                return;\r\n            }\r\n            case 'User associated with access token does not exist': {\r\n                user_store.logout(true);\r\n                Message.error(`${template}\\nログインセッションに紐づくユーザーが存在しないか、削除されています。`);\r\n                return;\r\n            }\r\n            default: {\r\n                if (Number.isNaN(error_response.status)) {\r\n                    // HTTP リクエスト自体が失敗し、HTTP ステータスコードが取得できなかった場合\r\n                    if (error_response.error.code === AxiosError.ECONNABORTED) {\r\n                        // ネットワーク接続エラーの場合\r\n                        Message.error(`${template}\\nサーバーへの接続が切断されました。(${error_response.error.message})`);\r\n                    } else if (error_response.error.code === AxiosError.ETIMEDOUT) {\r\n                        // タイムアウトの場合\r\n                        Message.error(`${template}\\nサーバーへの接続がタイムアウトしました。(${error_response.error.message})`);\r\n                    } else if (error_response.error.code === AxiosError.ERR_NETWORK) {\r\n                        // 予期しないネットワークエラーの場合\r\n                        Message.error(`${template}\\n予期しないネットワークエラーが発生しました。(${error_response.error.message})`);\r\n                    } else {\r\n                        // それ以外のエラーの場合\r\n                        Message.error(`${template}(${error_response.error.message})`);\r\n                    }\r\n                } else {\r\n                    // HTTP リクエスト自体は成功したが、API からエラーレスポンスが返ってきた場合\r\n                    Message.error(`${template}(HTTP Error ${error_response.status} / ${error_response.data.detail})`);\r\n                }\r\n                return;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default APIClient;\r\n","\r\nimport APIClient from '@/services/APIClient';\r\n\r\n\r\n/**\r\n * サーバーに保存されるクライアント設定を表すインターフェース\r\n * サーバー側の app.schemas.ClientSettings と\r\n * client/src/stores/SettingsStore.ts 内の sync_settings_keys で定義されているものと同じ\r\n */\r\nexport interface IClientSettings {\r\n    pinned_channel_ids: string[];\r\n    // showed_panel_last_time: 同期無効\r\n    // selected_twitter_account_id: 同期無効\r\n    saved_twitter_hashtags: string[];\r\n    panel_display_state: 'RestorePreviousState' | 'AlwaysDisplay' | 'AlwaysFold';\r\n    tv_panel_active_tab: 'Program' | 'Channel' | 'Comment' | 'Twitter';\r\n    video_panel_active_tab: 'RecordedProgram' | 'Series' | 'Comment' | 'Twitter';\r\n    tv_channel_selection_requires_alt_key: boolean;\r\n    // tv_streaming_quality: 同期無効\r\n    // tv_streaming_quality_cellular: 同期無効\r\n    // tv_data_saver_mode: 同期無効\r\n    // tv_data_saver_mode_cellular: 同期無効\r\n    // tv_low_latency_mode: 同期無効\r\n    // tv_low_latency_mode_cellular: 同期無効\r\n    // video_streaming_quality: 同期無効\r\n    // video_streaming_quality_cellular: 同期無効\r\n    // video_data_saver_mode: 同期無効\r\n    // video_data_saver_mode_cellular: 同期無効\r\n    caption_font: string;\r\n    always_border_caption_text: boolean;\r\n    specify_caption_opacity: boolean;\r\n    caption_opacity: number;\r\n    tv_show_superimpose: boolean;\r\n    video_show_superimpose: boolean;\r\n    // tv_show_data_broadcasting: 同期無効\r\n    // capture_copy_to_clipboard: 同期無効\r\n    capture_save_mode: 'Browser' | 'UploadServer' | 'Both';\r\n    capture_caption_mode: 'VideoOnly' | 'CompositingCaption' | 'Both';\r\n    // sync_settings: 同期無効\r\n    comment_speed_rate: number;\r\n    comment_font_size: number;\r\n    close_comment_form_after_sending: boolean;\r\n    muted_comment_keywords: IMutedCommentKeywords[];\r\n    muted_niconico_user_ids: string[];\r\n    mute_vulgar_comments: boolean;\r\n    mute_abusive_discriminatory_prejudiced_comments: boolean;\r\n    mute_big_size_comments: boolean;\r\n    mute_fixed_comments: boolean;\r\n    mute_colored_comments: boolean;\r\n    mute_consecutive_same_characters_comments: boolean;\r\n    fold_panel_after_sending_tweet: boolean;\r\n    reset_hashtag_when_program_switches: boolean;\r\n    auto_add_watching_channel_hashtag: boolean;\r\n    twitter_active_tab: 'Search' | 'Timeline' | 'Capture';\r\n    tweet_hashtag_position: 'Prepend' | 'Append' | 'PrependWithLineBreak' | 'AppendWithLineBreak';\r\n    tweet_capture_watermark_position: 'None' | 'TopLeft' | 'TopRight' | 'BottomLeft' | 'BottomRight';\r\n}\r\n\r\n/**\r\n * ミュート対象のコメントのキーワードのインターフェイス\r\n */\r\nexport interface IMutedCommentKeywords {\r\n    match: 'partial' | 'forward' | 'backward' | 'exact' | 'regex';\r\n    pattern: string;\r\n}\r\n\r\n\r\nclass Settings {\r\n\r\n    /**\r\n     * クライアント設定を取得する\r\n     * @return クライアント設定 (取得に失敗した場合は null)\r\n     */\r\n    static async fetchClientSettings(): Promise<IClientSettings | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.get<IClientSettings>('/settings/client');\r\n\r\n        // エラー処理 (基本起こらないはず & 実行できなくても後続の処理に影響しないため何もしない)\r\n        if (response.type === 'error') {\r\n            return null;\r\n        }\r\n\r\n        return response.data;\r\n    }\r\n\r\n\r\n    /**\r\n     * クライアント設定を更新する\r\n     * @param settings クライアント設定\r\n     */\r\n    static async updateClientSettings(settings: IClientSettings): Promise<void> {\r\n\r\n        // API リクエストを実行\r\n        // 正常時は 204 No Content が返るし、エラーは基本起こらないはずなので何もしない\r\n        await APIClient.put<IClientSettings>('/settings/client', settings);\r\n    }\r\n}\r\n\r\nexport default Settings;\r\n","\r\nimport { defineStore } from 'pinia';\r\n\r\nimport Settings, { IClientSettings, IMutedCommentKeywords } from '@/services/Settings';\r\nimport Utils from '@/utils';\r\n\r\n\r\n// 選択可能な画質の種類\r\nexport type LiveStreamingQuality = '1080p-60fps' | '1080p' | '810p' | '720p' | '540p' | '480p' | '360p' | '240p';\r\nexport const LIVE_STREAMING_QUALITIES: LiveStreamingQuality[] = ['1080p-60fps', '1080p', '810p', '720p', '540p', '480p', '360p', '240p'];\r\nexport type VideoStreamingQuality = '1080p-60fps' | '1080p' | '810p' | '720p' | '540p' | '480p' | '360p' | '240p';\r\nexport const VIDEO_STREAMING_QUALITIES: VideoStreamingQuality[] = ['1080p-60fps', '1080p', '810p', '720p', '540p', '480p', '360p', '240p'];\r\n\r\n// LocalStorage に保存される KonomiTV の設定データ\r\ninterface ILocalClientSettings {\r\n    pinned_channel_ids: string[];\r\n    showed_panel_last_time: boolean;\r\n    selected_twitter_account_id: number | null;\r\n    saved_twitter_hashtags: string[];\r\n    panel_display_state: 'RestorePreviousState' | 'AlwaysDisplay' | 'AlwaysFold';\r\n    tv_panel_active_tab: 'Program' | 'Channel' | 'Comment' | 'Twitter';\r\n    video_panel_active_tab: 'RecordedProgram' | 'Series' | 'Comment' | 'Twitter';\r\n    tv_channel_selection_requires_alt_key: boolean;\r\n    tv_streaming_quality: LiveStreamingQuality;\r\n    tv_streaming_quality_cellular: LiveStreamingQuality;\r\n    tv_data_saver_mode: boolean;\r\n    tv_data_saver_mode_cellular: boolean;\r\n    tv_low_latency_mode: boolean;\r\n    tv_low_latency_mode_cellular: boolean;\r\n    video_streaming_quality: VideoStreamingQuality;\r\n    video_streaming_quality_cellular: VideoStreamingQuality;\r\n    video_data_saver_mode: boolean;\r\n    video_data_saver_mode_cellular: boolean;\r\n    caption_font: string;\r\n    always_border_caption_text: boolean;\r\n    specify_caption_opacity: boolean;\r\n    caption_opacity: number;\r\n    tv_show_superimpose: boolean;\r\n    video_show_superimpose: boolean;\r\n    tv_show_data_broadcasting: boolean;\r\n    capture_copy_to_clipboard: boolean;\r\n    capture_save_mode: 'Browser' | 'UploadServer' | 'Both';\r\n    capture_caption_mode: 'VideoOnly' | 'CompositingCaption' | 'Both';\r\n    sync_settings: boolean;\r\n    comment_speed_rate: number;\r\n    comment_font_size: number;\r\n    close_comment_form_after_sending: boolean;\r\n    muted_comment_keywords: IMutedCommentKeywords[];\r\n    muted_niconico_user_ids: string[];\r\n    mute_vulgar_comments: boolean;\r\n    mute_abusive_discriminatory_prejudiced_comments: boolean;\r\n    mute_big_size_comments: boolean;\r\n    mute_fixed_comments: boolean;\r\n    mute_colored_comments: boolean;\r\n    mute_consecutive_same_characters_comments: boolean;\r\n    fold_panel_after_sending_tweet: boolean;\r\n    reset_hashtag_when_program_switches: boolean;\r\n    auto_add_watching_channel_hashtag: boolean;\r\n    twitter_active_tab: 'Search' | 'Timeline' | 'Capture';\r\n    tweet_hashtag_position: 'Prepend' | 'Append' | 'PrependWithLineBreak' | 'AppendWithLineBreak';\r\n    tweet_capture_watermark_position: 'None' | 'TopLeft' | 'TopRight' | 'BottomLeft' | 'BottomRight';\r\n}\r\n\r\n// 設定データのうち、同期対象の設定キー\r\n// サーバー側の app.schemas.ClientSettings と\r\n// client/src/services/Settings.ts 内の IClientSettings で定義されているものと同じ\r\nconst sync_settings_keys = [\r\n    'pinned_channel_ids',\r\n    // showed_panel_last_time: 同期無効\r\n    // selected_twitter_account_id: 同期無効\r\n    'saved_twitter_hashtags',\r\n    'panel_display_state',\r\n    'tv_panel_active_tab',\r\n    'video_panel_active_tab',\r\n    'tv_channel_selection_requires_alt_key',\r\n    // tv_streaming_quality: 同期無効\r\n    // tv_streaming_quality_cellular: 同期無効\r\n    // tv_data_saver_mode: 同期無効\r\n    // tv_data_saver_mode_cellular: 同期無効\r\n    // tv_low_latency_mode: 同期無効\r\n    // tv_low_latency_mode_cellular: 同期無効\r\n    // video_streaming_quality: 同期無効\r\n    // video_streaming_quality_cellular: 同期無効\r\n    // video_data_saver_mode: 同期無効\r\n    // video_data_saver_mode_cellular: 同期無効\r\n    'caption_font',\r\n    'always_border_caption_text',\r\n    'specify_caption_opacity',\r\n    'caption_opacity',\r\n    'tv_show_superimpose',\r\n    'video_show_superimpose',\r\n    // tv_show_data_broadcasting: 同期無効\r\n    // capture_copy_to_clipboard: 同期無効\r\n    'capture_save_mode',\r\n    'capture_caption_mode',\r\n    // sync_settings: 同期無効\r\n    'comment_speed_rate',\r\n    'comment_font_size',\r\n    'close_comment_form_after_sending',\r\n    'muted_comment_keywords',\r\n    'muted_niconico_user_ids',\r\n    'mute_vulgar_comments',\r\n    'mute_abusive_discriminatory_prejudiced_comments',\r\n    'mute_big_size_comments',\r\n    'mute_fixed_comments',\r\n    'mute_colored_comments',\r\n    'mute_consecutive_same_characters_comments',\r\n    'fold_panel_after_sending_tweet',\r\n    'reset_hashtag_when_program_switches',\r\n    'auto_add_watching_channel_hashtag',\r\n    'twitter_active_tab',\r\n    'tweet_hashtag_position',\r\n    'tweet_capture_watermark_position',\r\n];\r\n\r\n// LocalStorage に保存される KonomiTV の設定データのデフォルト値\r\nconst default_settings: ILocalClientSettings = {\r\n\r\n    // ***** 設定画面から直接変更できない設定値 *****\r\n\r\n    // ピン留めしているチャンネルの ID (ex: gr011) が入るリスト\r\n    pinned_channel_ids: [],\r\n    // 前回視聴画面を開いた際にパネルが表示されていたかどうか (同期無効)\r\n    showed_panel_last_time: true,\r\n    // 現在ツイート対象として選択されている Twitter アカウントの ID (同期無効)\r\n    selected_twitter_account_id: null,\r\n    // 保存している Twitter のハッシュタグが入るリスト\r\n    saved_twitter_hashtags: [],\r\n\r\n    // ***** 設定 → 全般 *****\r\n\r\n    // デフォルトのパネルの表示状態 (Default: 前回の状態を復元する)\r\n    panel_display_state: 'RestorePreviousState',\r\n    // テレビをみるときにデフォルトで表示されるパネルのタブ (Default: 番組情報タブ)\r\n    tv_panel_active_tab: 'Program',\r\n    // ビデオをみるときにデフォルトで表示されるパネルのタブ (Default: 番組情報タブ)\r\n    video_panel_active_tab: 'RecordedProgram',\r\n    // チャンネル選局のキーボードショートカットを Alt or Option + 数字キー/テンキーに変更する (Default: オフ)\r\n    tv_channel_selection_requires_alt_key: false,\r\n\r\n    // ***** 設定 → 画質 *****\r\n\r\n    // テレビのデフォルトのストリーミング画質 (Wi-Fi 回線時) (Default: 1080p) (同期無効)\r\n    tv_streaming_quality: '1080p',\r\n    // テレビのデフォルトのストリーミング画質 (モバイル回線時) (Default: 480p) (同期無効)\r\n    tv_streaming_quality_cellular: '480p',\r\n    // テレビを通信節約モードで視聴する (Wi-Fi 回線時)  (Default: オフ) (同期無効)\r\n    tv_data_saver_mode: false,\r\n    // テレビを通信節約モードで視聴する (モバイル回線時)  (Default: オン) (同期無効)\r\n    tv_data_saver_mode_cellular: true,\r\n    // テレビを低遅延で視聴する (Wi-Fi 回線時)  (Default: 低遅延で視聴する) (同期無効)\r\n    tv_low_latency_mode: true,\r\n    // テレビを低遅延で視聴する (モバイル回線時)  (Default: 低遅延で視聴しない) (同期無効)\r\n    tv_low_latency_mode_cellular: false,\r\n\r\n    // ビデオのデフォルトのストリーミング画質 (Wi-Fi 回線時) (Default: 1080p) (同期無効)\r\n    video_streaming_quality: '1080p',\r\n    // ビデオのデフォルトのストリーミング画質 (モバイル回線時) (Default: 480p) (同期無効)\r\n    video_streaming_quality_cellular: '480p',\r\n    // ビデオを通信節約モードで視聴する (Wi-Fi 回線時)  (Default: オフ) (同期無効)\r\n    video_data_saver_mode: false,\r\n    // ビデオを通信節約モードで視聴する (モバイル回線時)  (Default: オン) (同期無効)\r\n    video_data_saver_mode_cellular: true,\r\n\r\n    // ***** 設定 → 字幕 *****\r\n\r\n    // 字幕のフォント (Default: Windows TV 丸ゴシック)\r\n    caption_font: 'Windows TV MaruGothic',\r\n    // 字幕の文字を常に縁取って描画する (Default: 常に縁取る)\r\n    always_border_caption_text: true,\r\n    // 字幕の不透明度を指定する (Default: 指定しない)\r\n    specify_caption_opacity: false,\r\n    // 字幕の不透明度 (Default: 50%)\r\n    caption_opacity: 0.5,\r\n    // テレビをみるときに文字スーパーを表示する (Default: 表示する)\r\n    tv_show_superimpose: true,\r\n    // ビデオをみるときに文字スーパーを表示する (Default: 表示しない)\r\n    video_show_superimpose: false,\r\n\r\n    // ***** 設定 → データ放送 *****\r\n\r\n    // テレビをみるときにデータ放送を表示する (Default: 表示する) (同期無効)\r\n    tv_show_data_broadcasting: true,\r\n\r\n    // ***** 設定 → キャプチャ *****\r\n\r\n    // キャプチャをクリップボードにコピーする (Default: 無効) (同期無効)\r\n    capture_copy_to_clipboard: false,\r\n    // キャプチャの保存先 (Default: KonomiTV サーバーにアップロード)\r\n    capture_save_mode: 'UploadServer',\r\n    // 字幕が表示されているときのキャプチャの保存モード (Default: 映像のみのキャプチャと、字幕を合成したキャプチャを両方保存する)\r\n    capture_caption_mode: 'Both',\r\n\r\n    // ***** 設定 → アカウント *****\r\n\r\n    // 設定を同期する (Default: 同期しない) (同期無効)\r\n    sync_settings: false,\r\n\r\n    // ***** 設定 → ニコニコ実況 *****\r\n\r\n    // コメントの速さ (Default: 1倍)\r\n    comment_speed_rate: 1,\r\n    // コメントのフォントサイズ (Default: 34px)\r\n    comment_font_size: 34,\r\n    // コメント送信後にコメント入力フォームを閉じる (Default: オン)\r\n    close_comment_form_after_sending: true,\r\n\r\n    // ***** 設定 → ニコニコ実況 (ミュート設定) *****\r\n\r\n    // ミュート済みのコメントのキーワードが入るリスト\r\n    muted_comment_keywords: [],\r\n    // ミュート済みのニコニコユーザー ID が入るリスト\r\n    muted_niconico_user_ids: [],\r\n    // 露骨な表現を含むコメントをミュートする (Default: ミュートする)\r\n    mute_vulgar_comments: true,\r\n    // 罵倒や誹謗中傷、差別的な表現、政治的に偏った表現を含むコメントをミュートする (Default: ミュートする)\r\n    mute_abusive_discriminatory_prejudiced_comments: true,\r\n    // 文字サイズが大きいコメントをミュートする (Default: ミュートする)\r\n    mute_big_size_comments: true,\r\n    // 映像の上下に固定表示されるコメントをミュートする (Default: ミュートしない)\r\n    mute_fixed_comments: false,\r\n    // 色付きのコメントをミュートする (Default: ミュートしない)\r\n    mute_colored_comments: false,\r\n    // 8文字以上同じ文字が連続しているコメントをミュートする (Default: ミュートしない)\r\n    mute_consecutive_same_characters_comments: false,\r\n\r\n    // ***** 設定 → Twitter *****\r\n\r\n    // ツイート送信後にパネルを折りたたむ (Default: オフ)\r\n    fold_panel_after_sending_tweet: false,\r\n    // 番組が切り替わったときにハッシュタグフォームをリセットする (Default: オン)\r\n    reset_hashtag_when_program_switches: true,\r\n    // 視聴中のチャンネルに対応する局タグを自動で追加する (Default: オン)\r\n    auto_add_watching_channel_hashtag: true,\r\n    // デフォルトで表示される Twitter タブ内のタブ (Default: キャプチャタブ)\r\n    twitter_active_tab: 'Capture',\r\n    // ツイートにつけるハッシュタグの位置 (Default: ツイート本文の後に追加する)\r\n    tweet_hashtag_position: 'Append',\r\n    // ツイートするキャプチャに番組名の透かしを描画する (Default: 透かしを描画しない)\r\n    tweet_capture_watermark_position: 'None',\r\n};\r\n\r\n/**\r\n * LocalStorage の KonomiTV-Settings キーから設定データを取得する\r\n * @returns 設定データ\r\n */\r\nexport function getLocalStorageSettings(): {[key: string]: any} {\r\n    const settings = localStorage.getItem('KonomiTV-Settings');\r\n    if (settings !== null) {\r\n        return JSON.parse(settings);\r\n    } else {\r\n        // もし LocalStorage に KonomiTV-Settings キーがまだない場合、あらかじめデフォルトの設定値を保存しておく\r\n        setLocalStorageSettings(default_settings);\r\n        return default_settings;\r\n    }\r\n}\r\n\r\n/**\r\n * LocalStorage の KonomiTV-Settings キーに設定データを保存する\r\n * @param settings 設定データ\r\n */\r\nexport function setLocalStorageSettings(settings: {[key: string]: any}): void {\r\n    localStorage.setItem('KonomiTV-Settings', JSON.stringify(settings));\r\n}\r\n\r\n/**\r\n * 与えられた設定データを並び替えたり足りない設定キーを補完したり不要な設定キーを削除したりと整形して返す\r\n * @param settings 設定データ\r\n */\r\nfunction getNormalizedSettings(settings: {[key: string]: any}): ILocalClientSettings {\r\n\r\n    // (名前が変わった、廃止されたなどの理由で) 現在の default_settings に存在しない設定キーを排除した上で並び替え\r\n    // 並び替えられていないと設定データの比較がうまくいかない\r\n    const new_settings: {[key: string]: any} = {};\r\n    for (const default_settings_key of Object.keys(default_settings)) {\r\n        if (default_settings_key in settings) {\r\n            new_settings[default_settings_key] = settings[default_settings_key];\r\n        } else {\r\n            // 後のバージョンで追加されたなどの理由で現状の KonomiTV-Settings に存在しない設定キーの場合\r\n            // その設定キーのデフォルト値を取得する\r\n            new_settings[default_settings_key] = default_settings[default_settings_key];\r\n        }\r\n    }\r\n\r\n    // この状態の新しい設定データを返す\r\n    return new_settings as ILocalClientSettings;\r\n}\r\n\r\n/**\r\n * 設定データを共有するストア\r\n */\r\nconst useSettingsStore = defineStore('settings', {\r\n    state: () => {\r\n\r\n        // ref: https://www.vuemastery.com/blog/refresh-proof-your-pinia-stores/\r\n\r\n        // LocalStorage から設定データを取得する\r\n        const settings = getLocalStorageSettings();\r\n\r\n        // (名前が変わった、廃止されたなどの理由で) 現在の default_settings に存在しない設定キーを排除した上で並び替え\r\n        const new_settings = getNormalizedSettings(settings);\r\n\r\n        // この状態の新しい設定データを LocalStorage に保存する\r\n        setLocalStorageSettings(new_settings);\r\n\r\n        // 設定データを Store の state のデフォルト値として返す\r\n        return {\r\n            settings: new_settings as ILocalClientSettings,\r\n        };\r\n    },\r\n    actions: {\r\n\r\n        /**\r\n         * エクスポートした JSON ファイルから設定データをインポートする (既存の設定はすべて上書きされる)\r\n         * @param file エクスポートした JSON ファイル\r\n         * @returns インポートに成功したかどうか\r\n         */\r\n        async importClientSettings(file: File): Promise<boolean> {\r\n\r\n            // JSON ファイルを読み込む\r\n            const settings_json = await file.text();\r\n\r\n            // JSON ファイルをパースする\r\n            let settings = {};\r\n            try {\r\n                settings = JSON.parse(settings_json);\r\n            } catch (error) {\r\n                return false;\r\n            }\r\n\r\n            // (名前が変わった、廃止されたなどの理由で) 現在の default_settings に存在しない設定キーを排除した上で並び替え\r\n            const new_settings = getNormalizedSettings(settings);\r\n\r\n            // この状態の新しい設定データを LocalStorage に保存し、Store の state に反映する\r\n            // このとき、既存の設定データはすべて上書きされる\r\n            setLocalStorageSettings(new_settings);\r\n            this.settings = new_settings;\r\n\r\n            // 設定データをサーバーに同期する\r\n            await this.syncClientSettingsToServer();\r\n\r\n            return true;\r\n        },\r\n\r\n        /**\r\n         * 設定データを初期状態にリセットする\r\n         */\r\n        async resetClientSettings(): Promise<void> {\r\n\r\n            // デフォルトの設定に現在設定の同期がオンになっているかだけ反映した設定データ\r\n            const default_settings_modified: ILocalClientSettings = {\r\n                ...default_settings,\r\n                sync_settings: this.settings.sync_settings,\r\n            };\r\n\r\n            // デフォルト値の設定データを LocalStorage に保存し、Store の state に反映する\r\n            setLocalStorageSettings(default_settings_modified);\r\n            this.settings = default_settings_modified;\r\n\r\n            // 設定データをサーバーに同期する\r\n            await this.syncClientSettingsToServer();\r\n        },\r\n\r\n        /**\r\n         * 設定データのうち、サーバーへの同期対象の設定キーのみで構成されたオブジェクト (IClientSettings と一致する) を返す\r\n         * @returns サーバーへの同期対象の設定キーのみで構成されたオブジェクト\r\n         */\r\n        getSyncableClientSettings(): IClientSettings {\r\n\r\n            // 同期対象の設定キーのみで設定データをまとめ直す\r\n            // sync_settings には同期対象外の設定は含まれない\r\n            const sync_settings: {[key: string]: any} = {};\r\n            for (const sync_settings_key of sync_settings_keys) {\r\n                if (sync_settings_key in this.settings) {\r\n                    sync_settings[sync_settings_key] = this.settings[sync_settings_key];\r\n                } else {\r\n                    // 後から追加された設定キーなどの理由で設定キーが現状の KonomiTV-Settings に存在しない場合\r\n                    // その設定キーのデフォルト値を取得する\r\n                    sync_settings[sync_settings_key] = default_settings[sync_settings_key];\r\n                }\r\n            }\r\n\r\n            return sync_settings as IClientSettings;\r\n        },\r\n\r\n        /**\r\n         * ログイン時かつ同期が有効な場合、サーバーに保存されている設定データをこのクライアントに同期する\r\n         * @param force ログイン中なら同期が有効かに関わらず実行する (デフォルト: false)\r\n         */\r\n        async syncClientSettingsFromServer(force: boolean = false): Promise<void> {\r\n\r\n            // ログインしていない時、同期が無効なときは実行しない\r\n            if (Utils.getAccessToken() === null || (this.settings.sync_settings === false && force === false)) {\r\n                return;\r\n            }\r\n\r\n            // サーバーから設定データをダウンロード\r\n            const settings_server = await Settings.fetchClientSettings();\r\n            if (settings_server === null) {\r\n                return;  // 取得できなくても後続の処理には影響しないので、サイレントに失敗する\r\n            }\r\n\r\n            // クライアントの設定データをサーバーからの設定データで上書き\r\n            // 両者の値に変更がある場合のみ上書きする\r\n            // さもなければ、実際にはサーバー側で値が変更されていない場合でも定義されているストアに紐づく全てのコンポーネントの再描画が発生してしまう (?)\r\n            for (const [settings_server_key, settings_server_value] of Object.entries(settings_server)) {\r\n                if (JSON.stringify(this.settings[settings_server_key]) !== JSON.stringify(settings_server_value)) {\r\n                    this.settings[settings_server_key] = settings_server_value;\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * ログイン時かつ同期が有効な場合、このクライアントの設定をサーバーに同期する\r\n         * @param force ログイン中なら同期が有効かに関わらず実行する (デフォルト: false)\r\n         */\r\n        async syncClientSettingsToServer(force: boolean = false): Promise<void> {\r\n\r\n            // ログインしていない時、同期が無効なときは実行しない\r\n            if (Utils.getAccessToken() === null || (this.settings.sync_settings === false && force === false)) {\r\n                return;\r\n            }\r\n\r\n            // 同期対象の設定キーのみで設定データをまとめ直す\r\n            const sync_settings = this.getSyncableClientSettings();\r\n\r\n            // サーバーに設定データをアップロード\r\n            await Settings.updateClientSettings(sync_settings);\r\n        }\r\n    }\r\n});\r\n\r\nexport default useSettingsStore;\r\n","\r\nimport { Buffer } from 'buffer';\r\n\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\n\r\n\r\n/**\r\n * コメント周りのユーティリティ\r\n */\r\nexport class CommentUtils {\r\n\r\n    // 「露骨な表現を含むコメントをミュートする」のフィルタ正規表現\r\n    private static readonly mute_vulgar_comments_pattern = new RegExp(Buffer.from('XChpXCl8XChVXCl8cHJwcnzvvZDvvZLvvZDvvZJ8U0VYfFPjgIdYfFPil69YfFPil4tYfFPil49YfO+8s++8pe+8uHzvvLPjgIfvvLh877yz4pev77y4fO+8s+KXi++8uHzvvLPil4/vvLh844Ki44OA44Or44OIfOOCouOCveOCs3zjgqLjg4rjgqV844Ki44OK44OrfOOCpOOCq+iHrXzjgqTjgY9844Kk44Oz44OdfOOBhuOCk+OBk3zjgqbjg7PjgrN844GG44KT44GhfOOCpuODs+ODgXzjgqjjgq3jg5t844GI44Gh44GI44GhfOOBiOOBo+OBoXzjgqjjg4Pjg4F844GI44Gj44KNfOOCqOODg+ODrXxe44GI44KNfOOCqOODrXzlt6Xlj6N844Kq44Kr44K6fOOBiuOBleOCj+OCiuOBvuOCk3zjgYrjgZfjgaPjgZN844Kq44K344OD44KzfOOCquODg+OCteODs3zjgYrjgaPjgbHjgYR844Kq44OD44OR44KkfOOCquODiuODi+ODvHzjgYrjgarjgbt844Kq44OK44ObfOOBiuOBseOBhHzjgqrjg5HjgqR844GK44KB44GTfOOCquODoeOCs3zjgYpwfOOBiu+9kHzjgqrjg5Xjg5HjgrN844Ks44OB44Og44OBfOOCreODoeOCu+OCr3zjgq3jg7Pjgr/jg55844GP44Gx44GCfOOBj+OBseOBgXzjgq/jg6rjg4jjg6rjgrl844Kv44Oz44OLfOOBlOOBj+OBlOOBj+OBlOOBj+OBlOOBj3zjgrPjg7Pjg4njg7zjg6B844GR44Gk44GC44GqfOOCseODhOOCouODinzjgrHjg4TnqbR844K244O844Oh44OzfOOCt+OCs3zjgZfjgZPjgZfjgZN844K344Kz44K344KzfOOBmeOBkeOBmeOBkXzjgZvjgYTjgYjjgY1844Gb44GE44KKfOOBm+ODvOOCinzjgZnjgYXjgYXjgYV844GZ44GG44GG44GGfOOCu+OCr+ODreOCuXzjgrvjg4Pjgq/jgrl844K744OV44OsfOOBoeOBo+OBseOBhHzjgaHjgaPjg5HjgqR844OB44OD44OR44KkfOOBoeOCk+OBk3zjgaHjgIfjgZN844Gh4pev44GTfOOBoeKXi+OBk3zjgaHil4/jgZN844OB44Oz44KzfOODgeOAh+OCs3zjg4Hil6/jgrN844OB4peL44KzfOODgeKXj+OCs3zjgaHjgpPjgb1844Gh44CH44G9fOOBoeKXr+OBvXzjgaHil4vjgb1844Gh4peP44G9fOODgeODs+ODnXzjg4HjgIfjg51844OB4pev44OdfOODgeKXi+ODnXzjg4Hil4/jg51844Gh44KT44Gh44KTfOODgeODs+ODgeODs3zjgabjgYPjgpPjgabjgYPjgpN844OG44Kj44Oz44OG44Kj44OzfOOBpuOBg+OCk+OBvXzjg4bjgqPjg7Pjg51844OH44Kr44GEfOODh+OCq+ODgeODs3zjg4fjg6rjg5jjg6t844Gq44GL44Gg44GXfOOBquOBi+OAh+OBl3zjgarjgYvil6/jgZd844Gq44GL4peL44GXfOOBquOBi+KXj+OBl3zohLHjgZJ844OM44GEfOODjOOBi3zjg4zjgqt844OM44GNfOODjOOCrXzjg4zjgY9844OM44KvfOODjOOBkXzjg4zjgrF844OM44GTfOODjOOCs3zjgbHjgYTjgoLjgb9844Gx44GE44Ga44KKfOODkeODs+ODhuOCo3zjg5HjgqTjgrrjg6p844OR44Kk44OR44OzfOODkOOCpOODlnzjg5Hjg5HmtLt844OP44OhfOODlOOCueODiOODs3zjg5Pjg4Pjg4F844G144GG44O7fOOBteOBhuKApnzjgbXjgYV8776M772pfOOBteOBj+OCieOBv3zjgbXjgY/jgonjgpPjgad844G644Gj44GffOOBuuOCjeOBuuOCjXzjg5rjg63jg5rjg618776N776f776b776N776f776bfOODleOCp+ODqXzjgbvjgYbjgZHjgYR844G844Gj44GNfOODneODq+ODjnzjgbzjgo3jgpN844Oc44Ot44OzfO++ju++nu++m+++nXzjgb3jgo3jgop844Od44Ot44OqfO++ju++n+++m+++mHzjg57jg7PjgY3jgaR844Oe44Oz44Kt44OEfOOBvuOCk+OBk3zjgb7jgIfjgZN844G+4pev44GTfOOBvuKXi+OBk3zjgb7il4/jgZN844Oe44Oz44KzfOODnuOAh+OCs3zjg57il6/jgrN844Oe4peL44KzfOODnuKXj+OCs3zjgb7jgpPjgZXjgpN844KC44Gj44GT44KKfOODouODg+OCs+ODqnzjgoLjgb/jgoLjgb9844Oi44Of44Oi44OffOODpOOBo+OBn3zjg6TjgaPjgaZ844Ok44KJfOOChOOCieOBm+OCjXzjg6Tjgop844Ok44OqfOODpOOCi3zjg6Tjgox844Ok44KNfOODqeODluODm3zjg6/jg6zjg6F85oSb5rayfOWSpXzllph86Zmw5qC4fOmZsOiMjnzpmbDllId85rerfOmaoOavm3zpmbDmr5t855Sj44KB44KLfOWls+OBruWtkOOBruaXpXzmsZrjgaPjgZXjgpN85aemfOmojuS5l+S9jXzlt6jkubN85beo5qC5fOW3qOWwu3zlt6jjg4Hjg7N85beo54+NfOmHkeeOiXzmnIjntYx85b6M6IOM5L2NfOWtkOeornzlrZDkvZzjgop85bCE57K+fOa9ruWQuXzkv6HogIV857K+5rayfOmAj+OBkXzmgKfkuqR857K+5a2QfOato+W4uOS9jXzmgKflvrR85oCn55qEfOeUn+eQhnzntbblgKt85a+45q2i44KBfOe0oOadkHzmirHjgYR85oqx44GLfOaKseOBjXzmirHjgY985oqx44GRfOaKseOBk3zkvZPmtrJ85Lmz6aaWfOaBpeWeonznj43mo5J85Lit44Gg44GXfOS4reWHuuOBl3zlsL985oqc44GEfOaKnOOBkeOBquOBhHzmipzjgZHjgot85oqc44GR44KMfOaOkuS+v3zniq/nj4186Iao44KJfOWMheiMjnzli4Potbd86IacfOaRqee+hXzprZTnvoV85o+J44G+fOaPieOBv3zmj4njgoB85o+J44KBfOa8q+a5lnzjgIfvvZ584pev772efOKXi++9nnzil4/vvZ5844CHfnzil69+fOKXi3584pePfnzjgIfjg4Pjgq/jgrl84pev44OD44Kv44K5fOKXi+ODg+OCr+OCuXzil4/jg4Pjgq/jgrk=', 'base64').toString());\r\n\r\n    // 「ネガティブな表現、差別的な表現、政治的に偏った表現を含むコメントをミュートする」のフィルタ正規表現\r\n    private static readonly mute_abusive_discriminatory_prejudiced_comments_pattern = new RegExp(Buffer.from('44CCfOOCouODi+ODl+ODrOOBj+OCk3zjgqLjg4vjg5fjg6zlkJt844Ki44K544OafOOBguOBu3zjgqLjg5t86Zi/5ZGGfOOCpOOCq+OCjHzjgYTjgb7jgYTjgaF844Kk44Oe44Kk44OBfOOCpOODqeOBpOOBj3zjgqbjgrh844Km44O844OofOOCpuODqHzjgqbjg6jjgq9844Km44OyfOOBjeOCguOBhHzjgq3jg6LjgqR844Kt44Oi44GEfOOCrS/jg6Av44OBfOOCrOOCpOOCuHzvvbbvvp7vvbLvvbzvvp5844Ks44Kk44K444OzfOOCrOOCrXzjgqvjgrl844Kt44OD44K6fOOBjeOBoeOBjOOBhHzjgq3jg4HjgqzjgqR844Kt44Og44OBfOOBjeOCieOBhHzjgq3jg6njgqR85auM44GEfOOCr+OCvXzns55844K344OKfOOCueODhuODnnzjgaTjgb7jgonjgap844Gk44G+44KJ44KTfOODgeODp+ODg+ODkeODqnzjg4Hjg6fjg7N85Y2D44On44OzfOOBpOOCk+OBvHzjg4Tjg7Pjg5x844ON44OI44Km44OofOOBq+OBoOOBguOBgnzjg4vjg4B85LqM44OAfO++hu++gO++nnzjg5Hjg7zjg6h844OR44OofOODkeODqOOCr3xe44G044O8JHxe44OU44O8JHzjgbbjgaPjgZV844OW44OD44K1fOOBtuOBleOBhHzjg5bjgrXjgqR844OY44Kk44OI44K544OU44O844OBfOODm+ODonzjgb7jgazjgZF844Oh44Kv44OpfOODkOOCq3zjg6DjgqvjgaTjgY986I2S44KJ44GXfOm6u+eUn+OCu+ODoeODs+ODiHzlj7Pnv7x85rGa54mpfOaFsOWuieWppnzlrrPlhZB85aSW5a2XfOWnpuWbvXzpn5Plm7186Z+T5LitfOmfk+aXpXzln7rlnLDlpJZ85rCX54uC44GEfOawl+mBleOBhHzliIfjgaPjgZ985YiH44Gj44GmfOawl+aMgeOBoeaCqnzoh6185bGRfOWbveS6pOaWree1tnzlm73nsY185Zu944Gr5biw44KMfOWbveOBuOW4sOOCjHzlt6bnv7x85q66fOmgg3zpoIPjgZd86aCD44GZfOmgg+OBm3xe5ZyofOWcqOaXpXzlnKjml6XnibnmqKl85Zyo54m55LyafOWPguaUv+aoqXznsr7npZ7nlbDluLjogIV85q2744GtfOawj+OBrXzvvoDvvot85q255YyVfOatueODknzmrbvliJF844K344Kx44KkfOOBl+OBkeOBhHzlpLHpgJ986Zqc5a6zfOWkp+adseS6nHzmlq3kuqR86YCa5ZCNfOS4remfk3zmnJ3prq585b6055So5belfOWjunzlo7d85aO8fOaXpemfk3zml6XluJ1857KY552AfOWNiuWztnzlj43ml6V85Y+N5rCR5pePfOmmrOm5v3znmbrni4J855m66YGUfOactHzlo7Llm7185LiN5b+rfOS9teWQiHzplpPmipzjgZF854Sh6IO9fOaWh+WPpXzpnZblm7186YeO6YOO', 'base64').toString());\r\n\r\n    // 「8文字以上同じ文字が連続しているコメントをミュートする」のフィルタ正規表現\r\n    private static readonly mute_consecutive_same_characters_comments_pattern = /(.)\\1{7,}/;\r\n\r\n    // ニコ生の特殊コマンド付きコメントのフィルタ正規表現\r\n    private static readonly special_command_comments_pattern = /\\/[a-z]+ /;\r\n\r\n    // 迷惑な統計コメントのフィルタ正規表現\r\n    private static readonly annoying_statistical_comments_pattern = /最高\\d+米\\/|計\\d+ＩＤ|総\\d+米/;\r\n\r\n    // ニコニコの色指定を 16 進数カラーコードに置換するテーブル\r\n    private static readonly color_table: {[key: string]: string} = {\r\n        'white': '#FFEAEA',\r\n        'red': '#F02840',\r\n        'pink': '#FD7E80',\r\n        'orange': '#FDA708',\r\n        'yellow': '#FFE133',\r\n        'green': '#64DD17',\r\n        'cyan': '#00D4F5',\r\n        'blue': '#4763FF',\r\n        'purple': '#D500F9',\r\n        'black': '#1E1310',\r\n        'white2': '#CCCC99',\r\n        'niconicowhite': '#CCCC99',\r\n        'red2': '#CC0033',\r\n        'truered': '#CC0033',\r\n        'pink2': '#FF33CC',\r\n        'orange2': '#FF6600',\r\n        'passionorange': '#FF6600',\r\n        'yellow2': '#999900',\r\n        'madyellow': '#999900',\r\n        'green2': '#00CC66',\r\n        'elementalgreen': '#00CC66',\r\n        'cyan2': '#00CCCC',\r\n        'blue2': '#3399FF',\r\n        'marineblue': '#3399FF',\r\n        'purple2': '#6633CC',\r\n        'nobleviolet': '#6633CC',\r\n        'black2': '#666666',\r\n    };\r\n\r\n\r\n    /**\r\n     * ニコニコの色指定を 16 進数カラーコードに置換する\r\n     * @param color ニコニコの色指定\r\n     * @return 16 進数カラーコード\r\n     */\r\n    static getCommentColor(color: string): string | null {\r\n        return this.color_table[color] || null;\r\n    }\r\n\r\n\r\n    /**\r\n     * ニコニコの位置指定を DPlayer の位置指定に置換する\r\n     * @param position ニコニコの位置指定\r\n     * @return DPlayer の位置指定\r\n     */\r\n    static getCommentPosition(position: string): 'top' | 'right' | 'bottom' | null {\r\n        switch (position) {\r\n            case 'ue':\r\n                return 'top';\r\n            case 'naka':\r\n                return 'right';\r\n            case 'shita':\r\n                return 'bottom';\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * ニコニコのサイズ指定を DPlayer のサイズ指定に置換する\r\n     * @param size ニコニコのサイズ指定\r\n     * @returns DPlayer のサイズ指定\r\n     */\r\n    static getCommentSize(size: string): 'big' | 'medium' | 'small' | null {\r\n        switch (size) {\r\n            case 'big':\r\n            case 'medium':\r\n            case 'small':\r\n                return size;\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * ニコニコのコメントコマンドを解析する\r\n     * @param comment_mail ニコニコのコメントコマンド\r\n     * @returns コメントの色、位置、サイズ\r\n     */\r\n    static parseCommentCommand(comment_mail: string | null | undefined): {\r\n        color: string;\r\n        position: 'top' | 'right' | 'bottom';\r\n        size: 'big' | 'medium' | 'small';\r\n    } {\r\n        let color = '#FFEAEA';\r\n        let position: 'top' | 'right' | 'bottom' = 'right';\r\n        let size: 'big' | 'medium' | 'small' = 'medium';\r\n\r\n        if (comment_mail !== undefined && comment_mail !== null) {\r\n            const commands = comment_mail.replace('184', '').split(' ');\r\n\r\n            for (const command of commands) {\r\n                const parsed_color = CommentUtils.getCommentColor(command);\r\n                const parsed_position = CommentUtils.getCommentPosition(command);\r\n                const parsed_size = CommentUtils.getCommentSize(command);\r\n                if (parsed_color !== null) {\r\n                    color = parsed_color;\r\n                }\r\n                if (parsed_position !== null) {\r\n                    position = parsed_position;\r\n                }\r\n                if (parsed_size !== null) {\r\n                    size = parsed_size;\r\n                }\r\n            }\r\n        }\r\n\r\n        return {color, position, size};\r\n    }\r\n\r\n\r\n    /**\r\n     * ミュート対象のコメントかどうかを判断する\r\n     * @param comment コメント\r\n     * @param user_id コメントを投稿したユーザーの ID\r\n     * @param color コメントの色\r\n     * @param position コメントの位置\r\n     * @param size コメントのサイズ\r\n     * @return ミュート対象のコメントなら true を返す\r\n     */\r\n    static isMutedComment(\r\n        comment: string,\r\n        user_id: string,\r\n        color?: string,\r\n        position?: 'top' | 'right' | 'bottom',\r\n        size?: 'big' | 'medium' | 'small',\r\n    ): boolean {\r\n\r\n        const settings_store = useSettingsStore();\r\n\r\n        // ユーザー ID ミュート処理\r\n        if (settings_store.settings.muted_niconico_user_ids.includes(user_id)) {\r\n            return true;\r\n        }\r\n\r\n        // ニコ生の特殊コマンド付きコメント (/nicoad, /emotion など) を一括で弾く\r\n        if (CommentUtils.special_command_comments_pattern.test(comment)) {\r\n            return true;\r\n        }\r\n\r\n        // 「映像の上下に固定表示されるコメントをミュートする」がオンの場合\r\n        // コメントの位置が top (上固定) もしくは bottom (下固定) のときは弾く\r\n        if (settings_store.settings.mute_fixed_comments === true && (position === 'top' || position === 'bottom')) {\r\n            console.log('[CommentUtils] Muted comment (fixed_comments): ' + comment);\r\n            return true;\r\n        }\r\n\r\n        // 「色付きのコメントをミュートする」がオンの場合\r\n        // コメントの色が #FFEAEA (デフォルト) 以外のときは弾く\r\n        if (settings_store.settings.mute_colored_comments === true && color !== '#FFEAEA') {\r\n            console.log('[CommentUtils] Muted comment (colored_comments): ' + comment);\r\n            return true;\r\n        }\r\n\r\n        // 「文字サイズが大きいコメントをミュートする」がオンの場合\r\n        // コメントのサイズが big のときは弾く\r\n        if (settings_store.settings.mute_big_size_comments === true && size === 'big') {\r\n            console.log('[CommentUtils] Muted comment (big_size_comments): ' + comment);\r\n            return true;\r\n        }\r\n\r\n        // 「露骨な表現を含むコメントをミュートする」がオンの場合\r\n        if ((settings_store.settings.mute_vulgar_comments === true) &&\r\n            (CommentUtils.mute_vulgar_comments_pattern.test(comment))) {\r\n            console.log('[CommentUtils] Muted comment (vulgar_comments): ' + comment);\r\n            return true;\r\n        }\r\n\r\n        // 「ネガティブな表現、差別的な表現、政治的に偏った表現を含むコメントをミュートする」がオンの場合\r\n        if ((settings_store.settings.mute_abusive_discriminatory_prejudiced_comments === true) &&\r\n            (CommentUtils.mute_abusive_discriminatory_prejudiced_comments_pattern.test(comment))) {\r\n            console.log('[CommentUtils] Muted comment (abusive_discriminatory_prejudiced_comments): ' + comment);\r\n            return true;\r\n        }\r\n\r\n        // 「8文字以上同じ文字が連続しているコメントをミュートする」がオンの場合\r\n        if ((settings_store.settings.mute_consecutive_same_characters_comments === true &&\r\n            (CommentUtils.mute_consecutive_same_characters_comments_pattern.test(comment)))) {\r\n            console.log('[CommentUtils] Muted comment (consecutive_same_characters_comments): ' + comment);\r\n            return true;\r\n        }\r\n\r\n        // キーワードミュート処理\r\n        for (const muted_comment_keyword of settings_store.settings.muted_comment_keywords) {\r\n            if (muted_comment_keyword.pattern === '') continue;  // キーワードが空文字のときは無視\r\n            switch (muted_comment_keyword.match) {\r\n                // 部分一致\r\n                case 'partial':\r\n                    if (comment.includes(muted_comment_keyword.pattern)) {\r\n                        console.log('[CommentUtils] Muted comment (partial): ' + comment);\r\n                        return true;\r\n                    }\r\n                    break;\r\n                // 前方一致\r\n                case 'forward':\r\n                    if (comment.startsWith(muted_comment_keyword.pattern)) {\r\n                        console.log('[CommentUtils] Muted comment (forward): ' + comment);\r\n                        return true;\r\n                    }\r\n                    break;\r\n                // 後方一致\r\n                case 'backward':\r\n                    if (comment.endsWith(muted_comment_keyword.pattern)) {\r\n                        console.log('[CommentUtils] Muted comment (backward): ' + comment);\r\n                        return true;\r\n                    }\r\n                    break;\r\n                // 完全一致\r\n                case 'exact':\r\n                    if (comment === muted_comment_keyword.pattern) {\r\n                        console.log('[CommentUtils] Muted comment (exact): ' + comment);\r\n                        return true;\r\n                    }\r\n                    break;\r\n                // 正規表現\r\n                case 'regex':\r\n                    if (new RegExp(muted_comment_keyword.pattern).test(comment)) {\r\n                        console.log('[CommentUtils] Muted comment (regex): ' + comment);\r\n                        return true;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n\r\n        // 「ＮHK→計1447ＩＤ／内プレ425ＩＤ／総33372米 ◆ Ｅﾃﾚ → 計73ＩＤ／内プレ19ＩＤ／総941米」のような\r\n        // 迷惑コメントを一括で弾く (あえてミュートしたくないユースケースが思い浮かばないのでデフォルトで弾く)\r\n        // 一番最後なのは、この迷惑コメント自体の頻度が低いため\r\n        if (CommentUtils.annoying_statistical_comments_pattern.test(comment)) {\r\n            return true;\r\n        }\r\n\r\n        // いずれのミュート処理にも引っかからなかった (ミュート対象ではない)\r\n        return false;\r\n    }\r\n\r\n\r\n    /**\r\n     * ミュート済みキーワードリストに追加する (完全一致)\r\n     * @param comment コメント文字列\r\n     */\r\n    static addMutedKeywords(comment: string): void {\r\n\r\n        // すでにまったく同じミュート済みキーワードが追加済みの場合は何もしない\r\n        const settings_store = useSettingsStore();\r\n        for (const muted_comment_keyword of settings_store.settings.muted_comment_keywords) {\r\n            if (muted_comment_keyword.match === 'exact' && muted_comment_keyword.pattern === comment) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // ミュート済みキーワードリストに追加\r\n        settings_store.settings.muted_comment_keywords.push({\r\n            match: 'exact',\r\n            pattern: comment,\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * ミュート済みニコニコユーザー ID リストに追加する\r\n     * @param user_id ニコニコユーザー ID\r\n     */\r\n    static addMutedNiconicoUserIDs(user_id: string): void {\r\n\r\n        // すでに追加済みの場合は何もしない\r\n        const settings_store = useSettingsStore();\r\n        if (settings_store.settings.muted_niconico_user_ids.includes(user_id)) {\r\n            return;\r\n        }\r\n\r\n        // ミュート済みニコニコユーザー ID リストに追加\r\n        settings_store.settings.muted_niconico_user_ids.push(user_id);\r\n    }\r\n}\r\n","\r\nimport DPlayer from 'dplayer';\r\n\r\n/**\r\n * ライブストリーミング API で設定できる動画の画質\r\n */\r\ntype LiveAPIVideoQuality = (\r\n    '1080p-60fps' |\r\n    '1080p-60fps-hevc' |\r\n    '1080p' |\r\n    '1080p-hevc' |\r\n    '810p' |\r\n    '810p-hevc' |\r\n    '720p' |\r\n    '720p-hevc' |\r\n    '540p' |\r\n    '540p-hevc' |\r\n    '480p' |\r\n    '480p-hevc' |\r\n    '360p' |\r\n    '360p-hevc' |\r\n    '240p' |\r\n    '240p-hevc'\r\n);\r\n\r\n/**\r\n * 録画番組ストリーミング API で設定できる動画の画質\r\n */\r\ntype VideoAPIVideoQuality = (\r\n    '1080p-60fps' |\r\n    '1080p-60fps-hevc' |\r\n    '1080p' |\r\n    '1080p-hevc' |\r\n    '810p' |\r\n    '810p-hevc' |\r\n    '720p' |\r\n    '720p-hevc' |\r\n    '540p' |\r\n    '540p-hevc' |\r\n    '480p' |\r\n    '480p-hevc' |\r\n    '360p' |\r\n    '360p-hevc' |\r\n    '240p' |\r\n    '240p-hevc'\r\n);\r\n\r\n\r\n/**\r\n * プレイヤー周りのユーティリティ\r\n */\r\nexport class PlayerUtils {\r\n\r\n    /**\r\n     * DPlayer のインスタンスからライブストリーミング API で設定できる画質を取得する\r\n     * @param player DPlayer のインスタンス\r\n     * @returns API で設定できる画質 (取得できなかった場合は基本復旧不能だが、一応 \"1080p\" を返す)\r\n     */\r\n    static extractLiveAPIQualityFromDPlayer(player: DPlayer): LiveAPIVideoQuality {\r\n        if (player.quality === null) {\r\n            return '1080p';\r\n        }\r\n        const regex = /streams\\/live\\/[a-z0-9-]*\\/(.*)\\/mpegts/;\r\n        const match = player.quality.url.match(regex);\r\n        return match ? (match[1] as LiveAPIVideoQuality) : '1080p';\r\n    }\r\n\r\n\r\n    /**\r\n     * DPlayer のインスタンスから録画番組ストリーミング API で設定できる画質を取得する\r\n     * @param player DPlayer のインスタンス\r\n     * @returns API で設定できる画質 (取得できなかった場合は基本復旧不能だが、一応 \"1080p\" を返す)\r\n     */\r\n    static extractVideoAPIQualityFromDPlayer(player: DPlayer): VideoAPIVideoQuality {\r\n        if (player.quality === null) {\r\n            return '1080p';\r\n        }\r\n        const regex = /streams\\/video\\/[0-9]*\\/(.*)\\/playlist/;\r\n        const match = player.quality.url.match(regex);\r\n        return match ? (match[1] as VideoAPIVideoQuality) : '1080p';\r\n    }\r\n\r\n\r\n    /**\r\n     * プレイヤーの背景画像をランダムで取得し、その URL を返す\r\n     * @returns ランダムで設定されたプレイヤーの背景画像の URL\r\n     */\r\n    static generatePlayerBackgroundURL(): string {\r\n        const background_count = 50;  // 50種類から選択\r\n        const random = (Math.floor(Math.random() * background_count) + 1);\r\n        return `/assets/images/player-backgrounds/${random.toString().padStart(2, '0')}.jpg`;\r\n    }\r\n\r\n\r\n    /**\r\n     * Network Information API から現在接続されているネットワーク回線の種類を取得する\r\n     * navigator.connection.type が利用できない場合は null を返す\r\n     * \"Wi-Fi\" には Cellular 以外のすべてのネットワークが含まれる\r\n     * @returns ネットワークの種類 (Wi-Fi / Cellular)、取得できなかった場合は null\r\n     */\r\n    static getNetworkCircuitType(): 'Wi-Fi' | 'Cellular' | null {\r\n        if (navigator.connection && navigator.connection.type) {\r\n            switch (navigator.connection.type) {\r\n                case 'cellular':\r\n                    return 'Cellular';\r\n                default:\r\n                    return 'Wi-Fi';\r\n            }\r\n        } else {\r\n            console.warn('[PlayerUtils] navigator.connection.type is not available.');\r\n            return null;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 現在のブラウザで H.265 / HEVC 映像が再生できるかどうかを取得する\r\n     * ref: https://github.com/StaZhu/enable-chromium-hevc-hardware-decoding#mediacapabilities\r\n     * @returns 再生できるなら true、できないなら false\r\n     */\r\n    static isHEVCVideoSupported(): boolean {\r\n        // hvc1.1.6.L123.B0 の部分は呪文 (HEVC であることと、そのプロファイルを示す値らしい)\r\n        return document.createElement('video').canPlayType('video/mp4; codecs=\"hvc1.1.6.L123.B0\"') === 'probably';\r\n    }\r\n}\r\n","\r\nimport { IProgram } from '@/services/Programs';\r\nimport { IRecordedProgram } from '@/services/Videos';\r\nimport Utils, { dayjs } from '@/utils';\r\n\r\n\r\n/**\r\n * 番組情報周りのユーティリティ\r\n */\r\nexport class ProgramUtils {\r\n\r\n    // 映像のコーデック\r\n    // ref: https://github.com/Chinachu/Mirakurun/blob/master/src/Mirakurun/EPG.ts#L23-L27\r\n    static readonly STREAM_CONTENT = {\r\n        0x01: 'MPEG-2',\r\n        0x05: 'H.264',\r\n        0x09: 'H.265',\r\n    };\r\n\r\n    // 映像の解像度\r\n    // ref: https://github.com/Chinachu/Mirakurun/blob/master/src/Mirakurun/EPG.ts#L29-L63\r\n    static readonly VIDEO_COMPONENT_TYPE = {\r\n        0x01: '480i',\r\n        0x02: '480i',\r\n        0x03: '480i',\r\n        0x04: '480i',\r\n        0x83: '4320p',\r\n        0x91: '2160p',\r\n        0x92: '2160p',\r\n        0x93: '2160p',\r\n        0x94: '2160p',\r\n        0xA1: '480p',\r\n        0xA2: '480p',\r\n        0xA3: '480p',\r\n        0xA4: '480p',\r\n        0xB1: '1080i',\r\n        0xB2: '1080i',\r\n        0xB3: '1080i',\r\n        0xB4: '1080i',\r\n        0xC1: '720p',\r\n        0xC2: '720p',\r\n        0xC3: '720p',\r\n        0xC4: '720p',\r\n        0xD1: '240p',\r\n        0xD2: '240p',\r\n        0xD3: '240p',\r\n        0xD4: '240p',\r\n        0xE1: '1080p',\r\n        0xE2: '1080p',\r\n        0xE3: '1080p',\r\n        0xE4: '1080p',\r\n        0xF1: '180p',\r\n        0xF2: '180p',\r\n        0xF3: '180p',\r\n        0xF4: '180p',\r\n    };\r\n\r\n    // 以下は ariblib から LivePSIArchivedDataDecoder で必要なもののみ移植\r\n    // node-aribts にも同等の定義があるが微妙に文字列の表記揺れがあるため、互換性を鑑みて敢えて移植している\r\n    // ref: https://github.com/tsukumijima/ariblib/blob/master/ariblib/constants.py\r\n\r\n    // ARIB-STD-B10-2-H コンテント記述子におけるジャンル指定\r\n    // KonomiTV では見栄え的な都合で中分類の \"／\" を \"・\" に置き換えている (サーバー側も同様)\r\n    static readonly CONTENT_TYPE = {\r\n        0x0: ['ニュース・報道', {\r\n            0x0: '定時・総合',\r\n            0x1: '天気',\r\n            0x2: '特集・ドキュメント',\r\n            0x3: '政治・国会',\r\n            0x4: '経済・市況',\r\n            0x5: '海外・国際',\r\n            0x6: '解説',\r\n            0x7: '討論・会談',\r\n            0x8: '報道特番',\r\n            0x9: 'ローカル・地域',\r\n            0xA: '交通',\r\n            0xF: 'その他',\r\n        }],\r\n        0x1: ['スポーツ', {\r\n            0x0: 'スポーツニュース',\r\n            0x1: '野球',\r\n            0x2: 'サッカー',\r\n            0x3: 'ゴルフ',\r\n            0x4: 'その他の球技',\r\n            0x5: '相撲・格闘技',\r\n            0x6: 'オリンピック・国際大会',\r\n            0x7: 'マラソン・陸上・水泳',\r\n            0x8: 'モータースポーツ',\r\n            0x9: 'マリン・ウィンタースポーツ',\r\n            0xA: '競馬・公営競技',\r\n            0xF: 'その他',\r\n        }],\r\n        0x2: ['情報・ワイドショー', {\r\n            0x0: '芸能・ワイドショー',\r\n            0x1: 'ファッション',\r\n            0x2: '暮らし・住まい',\r\n            0x3: '健康・医療',\r\n            0x4: 'ショッピング・通販',\r\n            0x5: 'グルメ・料理',\r\n            0x6: 'イベント',\r\n            0x7: '番組紹介・お知らせ',\r\n            0xF: 'その他',\r\n        }],\r\n        0x3: ['ドラマ', {\r\n            0x0: '国内ドラマ',\r\n            0x1: '海外ドラマ',\r\n            0x2: '時代劇',\r\n            0xF: 'その他',\r\n        }],\r\n        0x4: ['音楽', {\r\n            0x0: '国内ロック・ポップス',\r\n            0x1: '海外ロック・ポップス',\r\n            0x2: 'クラシック・オペラ',\r\n            0x3: 'ジャズ・フュージョン',\r\n            0x4: '歌謡曲・演歌',\r\n            0x5: 'ライブ・コンサート',\r\n            0x6: 'ランキング・リクエスト',\r\n            0x7: 'カラオケ・のど自慢',\r\n            0x8: '民謡・邦楽',\r\n            0x9: '童謡・キッズ',\r\n            0xA: '民族音楽・ワールドミュージック',\r\n            0xF: 'その他',\r\n        }],\r\n        0x5: ['バラエティ', {\r\n            0x0: 'クイズ',\r\n            0x1: 'ゲーム',\r\n            0x2: 'トークバラエティ',\r\n            0x3: 'お笑い・コメディ',\r\n            0x4: '音楽バラエティ',\r\n            0x5: '旅バラエティ',\r\n            0x6: '料理バラエティ',\r\n            0xF: 'その他',\r\n        }],\r\n        0x6: ['映画', {\r\n            0x0: '洋画',\r\n            0x1: '邦画',\r\n            0x2: 'アニメ',\r\n            0xF: 'その他',\r\n        }],\r\n        0x7: ['アニメ・特撮', {\r\n            0x0: '国内アニメ',\r\n            0x1: '海外アニメ',\r\n            0x2: '特撮',\r\n            0xF: 'その他',\r\n        }],\r\n        0x8: ['ドキュメンタリー・教養', {\r\n            0x0: '社会・時事',\r\n            0x1: '歴史・紀行',\r\n            0x2: '自然・動物・環境',\r\n            0x3: '宇宙・科学・医学',\r\n            0x4: 'カルチャー・伝統文化',\r\n            0x5: '文学・文芸',\r\n            0x6: 'スポーツ',\r\n            0x7: 'ドキュメンタリー全般',\r\n            0x8: 'インタビュー・討論',\r\n            0xF: 'その他',\r\n        }],\r\n        0x9: ['劇場・公演', {\r\n            0x0: '現代劇・新劇',\r\n            0x1: 'ミュージカル',\r\n            0x2: 'ダンス・バレエ',\r\n            0x3: '落語・演芸',\r\n            0x4: '歌舞伎・古典',\r\n            0xF: 'その他',\r\n        }],\r\n        0xA: ['趣味・教育', {\r\n            0x0: '旅・釣り・アウトドア',\r\n            0x1: '園芸・ペット・手芸',\r\n            0x2: '音楽・美術・工芸',\r\n            0x3: '囲碁・将棋',\r\n            0x4: '麻雀・パチンコ',\r\n            0x5: '車・オートバイ',\r\n            0x6: 'コンピュータ・ＴＶゲーム',\r\n            0x7: '会話・語学',\r\n            0x8: '幼児・小学生',\r\n            0x9: '中学生・高校生',\r\n            0xA: '大学生・受験',\r\n            0xB: '生涯教育・資格',\r\n            0xC: '教育問題',\r\n            0xF: 'その他',\r\n        }],\r\n        0xB: ['福祉', {\r\n            0x0: '高齢者',\r\n            0x1: '障害者',\r\n            0x2: '社会福祉',\r\n            0x3: 'ボランティア',\r\n            0x4: '手話',\r\n            0x5: '文字（字幕）',\r\n            0x6: '音声解説',\r\n            0xF: 'その他',\r\n        }],\r\n        0xE: ['拡張', {\r\n            0x0: 'BS/地上デジタル放送用番組付属情報',\r\n            0x1: '広帯域CSデジタル放送用拡張',\r\n            0x2: '衛星デジタル音声放送用拡張',\r\n            0x3: 'サーバー型番組付属情報',\r\n            0x4: 'IP放送用番組付属情報',\r\n        }],\r\n        0xF: ['その他', {\r\n            0xF: 'その他',\r\n        }],\r\n    };\r\n\r\n    // ARIB-TR-B24-4.B 表B-1 地上デジタルテレビジョン放送用番組付属情報\r\n    // ARIB-TR-B25-4.B 表B-1 BSデジタル放送用番組付属情報\r\n    static readonly USER_TYPE = {\r\n        0x00: '中止の可能性あり',\r\n        0x01: '延長の可能性あり',\r\n        0x02: '中断の可能性あり',\r\n        0x03: '同一シリーズの別話数放送の可能性あり',\r\n        0x04: '編成未定枠',\r\n        0x05: '繰り上げの可能性あり',\r\n        0x10: '中断ニュースあり',\r\n        0x11: '当該イベントに関連する臨時サービスあり',\r\n        0x20: '当該イベント中に3D映像あり',\r\n    };\r\n\r\n    // ARIB-STD-B10-2-6.2.3 表6-5 コンポーネント内容とコンポーネント種別\r\n    static readonly COMPONENT_TYPE = {\r\n        0x01: {\r\n            0x00: '将来使用のためリザーブ',\r\n            0x01: '映像480i(525i)、アスペクト比4:3',\r\n            0x02: '映像480i(525i)、アスペクト比16:9 パンベクトルあり',\r\n            0x03: '映像480i(525i)、アスペクト比16:9 パンベクトルなし',\r\n            0x04: '映像480i(525i)、アスペクト比16:9',\r\n            0x91: '映像2160p、アスペクト比4:3',\r\n            0x92: '映像2160p、アスペクト比16:9 パンベクトルあり',\r\n            0x93: '映像2160p、アスペクト比16:9 パンベクトルなし',\r\n            0x94: '映像2160p、アスペクト比16:9',\r\n            0xA1: '映像480p(525p)、アスペクト比4:3',\r\n            0xA2: '映像480p(525p)、アスペクト比16:9 パンベクトルあり',\r\n            0xA3: '映像480p(525p)、アスペクト比16:9 パンベクトルなし',\r\n            0xA4: '映像480p(525p)、アスペクト比16:9',\r\n            0xB1: '映像1080i(1125i)、アスペクト比4:3',\r\n            0xB2: '映像1080i(1125i)、アスペクト比16:9 パンベクトルあり',\r\n            0xB3: '映像1080i(1125i)、アスペクト比16:9 パンベクトルなし',\r\n            0xB4: '映像1080i(1125i)、アスペクト比16:9',\r\n            0xC1: '映像720p(750p)、アスペクト比4:3',\r\n            0xC2: '映像720p(750p)、アスペクト比16:9 パンベクトルあり',\r\n            0xC3: '映像720p(750p)、アスペクト比16:9 パンベクトルなし',\r\n            0xC4: '映像720p(750p)、アスペクト比16:9',\r\n            0xD1: '映像240p アスペクト比4:3',\r\n            0xD2: '映像240p アスペクト比16:9 パンベクトルあり',\r\n            0xD3: '映像240p アスペクト比16:9 パンベクトルなし',\r\n            0xD4: '映像240p アスペクト比16:9',\r\n            0xE1: '映像1080p(1125p)、アスペクト比4:3',\r\n            0xE2: '映像1080p(1125p)、アスペクト比16:9 パンベクトルあり',\r\n            0xE3: '映像1080p(1125p)、アスペクト比16:9 パンベクトルなし',\r\n            0xE4: '映像1080p(1125p)、アスペクト比16:9',\r\n            0xF1: '映像180p アスペクト比4:3',\r\n            0xF2: '映像180p アスペクト比16:9 パンベクトルあり',\r\n            0xF3: '映像180p アスペクト比16:9 パンベクトルなし',\r\n            0xF4: '映像180p アスペクト比16:9',\r\n        },\r\n        0x02: {\r\n            0x00: '将来使用のためリザーブ',\r\n            0x01: '1/0モード(シングルモノ)',\r\n            0x02: '1/0+1/0モード(デュアルモノ)',\r\n            0x03: '2/0モード(ステレオ)',\r\n            0x04: '2/1モード',\r\n            0x05: '3/0モード',\r\n            0x06: '2/2モード',\r\n            0x07: '3/1モード',\r\n            0x08: '3/2モード',\r\n            0x09: '3/2+LFEモード(3/2.1モード)',\r\n            0x0A: '3/3.1モード',\r\n            0x0B: '2/0/0-2/0/2-0.1モード',\r\n            0x0C: '5/2.1モード',\r\n            0x0D: '3/2/2.1モード',\r\n            0x0E: '2/0/0-3/0/2-0.1モード',\r\n            0x0F: '0/2/0-3/0/2-0.2モード',\r\n            0x10: '2/0/0-3/2/3-0.2モード',\r\n            0x11: '3/3/3-5/2/3-3/0/0.2モード',\r\n            0x40: '視覚障害者用音声解説',\r\n            0x41: '聴覚障害者用音声',\r\n        },\r\n        0x05: {\r\n            0x01: 'H.264|MPEG-4 AVC、映像480i(525i)、アスペクト比4:3',\r\n            0x02: 'H.264|MPEG-4 AVC、映像480i(525i)、アスペクト比16:9 パンベクトルあり',\r\n            0x03: 'H.264|MPEG-4 AVC、映像480i(525i)、アスペクト比16:9 パンベクトルなし ',\r\n            0x04: 'H.264|MPEG-4 AVC、映像480i(525i)、アスペクト比 > 16:9',\r\n            0x91: 'H.264|MPEG-4 AVC、映像2160p、アスペクト比4:3',\r\n            0x92: 'H.264|MPEG-4 AVC、映像2160p、アスペクト比16:9 パンベクトルあり',\r\n            0x93: 'H.264|MPEG-4 AVC、映像2160p、アスペクト比16:9 パンベクトルなし',\r\n            0x94: 'H.264|MPEG-4 AVC、映像2160p、アスペクト比 > 16:9',\r\n            0xA1: 'H.264|MPEG-4 AVC、映像480p(525p)、アスペクト比4:3',\r\n            0xA2: 'H.264|MPEG-4 AVC、映像480p(525p)、アスペクト比16:9 パンベクトルあり',\r\n            0xA3: 'H.264|MPEG-4 AVC、映像480p(525p)、アスペクト比16:9 パンベクトルなし',\r\n            0xA4: 'H.264|MPEG-4 AVC、映像480p(525p)、アスペクト比 > 16:9',\r\n            0xB1: 'H.264|MPEG-4 AVC、映像1080i(1125i)、アスペクト比4:3',\r\n            0xB2: 'H.264|MPEG-4 AVC、映像1080i(1125i)、アスペクト比16:9 パンベクトルあり',\r\n            0xB3: 'H.264|MPEG-4 AVC、映像1080i(1125i)、アスペクト比16:9 パンベクトルなし',\r\n            0xB4: 'H.264|MPEG-4 AVC、映像1080i(1125i)、アスペクト比 > 16:9',\r\n            0xC1: 'H.264|MPEG-4 AVC、映像720p(750p)、アスペクト比4:3',\r\n            0xC2: 'H.264|MPEG-4 AVC、映像720p(750p)、アスペクト比16:9 パンベクトルあり',\r\n            0xC3: 'H.264|MPEG-4 AVC、映像720p(750p)、アスペクト比16:9 パンベクトルなし',\r\n            0xC4: 'H.264|MPEG-4 AVC、映像720p(750p)、アスペクト比 > 16:9',\r\n            0xD1: 'H.264|MPEG-4 AVC、映像240p アスペクト比4:3',\r\n            0xD2: 'H.264|MPEG-4 AVC、映像240p アスペクト比16:9 パンベクトルあり',\r\n            0xD3: 'H.264|MPEG-4 AVC、映像240p アスペクト比16:9 パンベクトルなし',\r\n            0xD4: 'H.264|MPEG-4 AVC、映像240p アスペクト比 > 16:9',\r\n            0xE1: 'H.264|MPEG-4 AVC、映像1080p(1125p)、アスペクト比4:3',\r\n            0xE2: 'H.264|MPEG-4 AVC、映像1080p(1125p)、アスペクト比16:9 パンベクトルあり',\r\n            0xE3: 'H.264|MPEG-4 AVC、映像1080p(1125p)、アスペクト比16:9 パンベクトルなし',\r\n            0xE4: 'H.264|MPEG-4 AVC、映像1080p(1125p)、アスペクト比 > 16:9',\r\n            0xF1: 'H.264|MPEG-4 AVC、映像180p アスペクト比4:3',\r\n            0xF2: 'H.264|MPEG-4 AVC、映像180p アスペクト比16:9 パンベクトルあり',\r\n            0xF3: 'H.264|MPEG-4 AVC、映像180p アスペクト比16:9 パンベクトルなし',\r\n            0xF4: 'H.264|MPEG-4 AVC、映像180p アスペクト比 > 16:9',\r\n        },\r\n    };\r\n\r\n    // ARIB-STD-B10-2-6.2.26 表6-45 サンプリング周波数\r\n    static readonly SAMPLING_RATE = {\r\n        0b000: '将来使用のためリザーブ',\r\n        0b001: '16kHz',\r\n        0b010: '22.05kHz',\r\n        0b011: '24kHz',\r\n        0b100: 'リザーブ',\r\n        0b101: '32kHz',\r\n        0b110: '44.1kHz',\r\n        0b111: '48kHz',\r\n    };\r\n\r\n    // 事前に文字列の変換テーブルを構築しておく\r\n    private static readonly format_string_translation_map = ProgramUtils.buildFormatStringTranslationMap();\r\n\r\n\r\n    /**\r\n     * 番組情報中の[字]や[解]などの記号をいい感じに装飾する\r\n     * @param program 番組情報のオブジェクト\r\n     * @param key 番組情報のオブジェクトから取り出すプロパティのキー\r\n     * @returns 装飾した文字列\r\n     */\r\n    static decorateProgramInfo(program: IProgram | IRecordedProgram | null, key: string): string {\r\n\r\n        // program が空でないかつ、program[key] が存在する\r\n        if (program !== null && program[key] !== null) {\r\n\r\n            // 番組情報に含まれる HTML の特殊文字で表示がバグらないように、事前に HTML エスケープしておく\r\n            const text = Utils.escapeHTML(program[key]);\r\n\r\n            // 本来 ARIB 外字である記号の一覧\r\n            // ref: https://ja.wikipedia.org/wiki/%E7%95%AA%E7%B5%84%E8%A1%A8\r\n            // ref: https://github.com/xtne6f/EDCB/blob/work-plus-s/EpgDataCap3/EpgDataCap3/ARIB8CharDecode.cpp#L1319\r\n            const mark = '新|終|再|交|映|手|声|多|副|字|文|CC|OP|二|S|B|SS|無|無料' +\r\n                'C|S1|S2|S3|MV|双|デ|D|N|W|P|H|HV|SD|天|解|料|前|後初|生|販|吹|PPV|' +\r\n                '演|移|他|収|・|英|韓|中|字/日|字/日英|3D|2K|4K|8K|5.1|7.1|22.2|60P|120P|d|HC|HDR|SHV|UHD|VOD|配|初';\r\n\r\n            // 正規表現を作成\r\n            const pattern1 = new RegExp('\\\\((二|字|再)\\\\)', 'g');  // 通常の括弧で囲まれている記号\r\n            const pattern2 = new RegExp(`\\\\[(${mark})\\\\]`, 'g');\r\n\r\n            // 正規表現で置換した結果を返す\r\n            return text.replace(pattern1, '<span class=\"decorate-symbol\">$1</span>')\r\n                .replace(pattern2, '<span class=\"decorate-symbol\">$1</span>');\r\n\r\n        // 番組情報がない時間帯\r\n        } else {\r\n\r\n            // 23時～翌7時 (0:00 ~ 06:59 or 23:00 ~ 23:59) の間なら放送を休止している可能性が高いので、放送休止と表示する\r\n            const now = dayjs();\r\n            const pause_time_start = dayjs().hour(0).minute(0).second(0);\r\n            const pause_time_end = dayjs().hour(6).minute(59).second(59);\r\n            const pause_time_start_23 = dayjs().hour(23).minute(0).second(0);\r\n            const pause_time_end_23 = dayjs().hour(23).minute(59).second(59);\r\n            if ((now.isSameOrAfter(pause_time_start) && now.isSameOrBefore(pause_time_end)) ||\r\n                (now.isSameOrAfter(pause_time_start_23) && now.isSameOrBefore(pause_time_end_23))) {\r\n                if (key === 'title') {\r\n                    return '放送休止';  // タイトル\r\n                } else {\r\n                    return 'この時間は放送を休止しています。';  // 番組概要\r\n                }\r\n\r\n            // それ以外の時間帯では、「番組情報がありません」と表示する\r\n            // 急な番組変更の影響で、一時的にその時間帯に対応する番組情報が消えることがある\r\n            // 特に Mirakurun バックエンドでは高頻度で収集した EIT[p/f] が比較的すぐ反映されるため、この現象が起こりやすい\r\n            // 日中に放送休止（停波）になることはまずあり得ないので、番組情報が取得できてないだけで視聴できるかも？というニュアンスを与える\r\n            } else {\r\n                if (key === 'title') {\r\n                    return '番組情報がありません';  // タイトル\r\n                } else {\r\n                    return 'この時間の番組情報を取得できませんでした。';  // 番組概要\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 番組の進捗状況を取得する\r\n     * @param program 番組情報\r\n     * @returns 番組の進捗状況（%単位）\r\n     */\r\n    static getProgramProgress(program: IProgram | IRecordedProgram | null): number {\r\n\r\n        // program が空でない\r\n        if (program !== null) {\r\n\r\n            // 番組開始時刻から何秒進んだか\r\n            const progress = dayjs(dayjs()).diff(program.start_time, 'second');\r\n\r\n            // %単位の割合を算出して返す\r\n            // duration が Infinity の場合は、放送時間未定として扱う\r\n            if (program.duration !== Infinity) {\r\n                return progress / program.duration * 100;\r\n            } else {\r\n                return 100;  // 放送時間未定\r\n            }\r\n\r\n        // 放送休止中\r\n        } else {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 番組放送時刻の文字列表現を取得する\r\n     * @param program 番組情報\r\n     * @param is_short 時刻のみ返すかどうか\r\n     * @returns 番組の放送時刻\r\n     */\r\n    static getProgramTime(program: IProgram | IRecordedProgram | null, is_short: boolean = false): string {\r\n\r\n        // program が空でなく、かつ番組時刻が初期値でない\r\n        if (program !== null && program.start_time !== '2000-01-01T00:00:00+09:00') {\r\n\r\n            const start_time = dayjs(program.start_time);\r\n            const end_time = dayjs(program.end_time);\r\n\r\n            // duration が Infinity の場合は、end_time を無視して放送時間未定として扱う\r\n            // この時 end_time には便宜上 start_time と同一の時刻が設定されるため、参照してはいけない\r\n            // IRecordedProgram (録画番組) では発生しない\r\n            if (program.duration === Infinity) {\r\n                if (is_short === true) {  // 時刻のみ\r\n                    return `${start_time.format('HH:mm')} ～ --:--`;\r\n                } else {\r\n                    return `${start_time.format('YYYY/MM/DD (dd) HH:mm')} ～ --:-- (放送時間未定)`;\r\n                }\r\n            }\r\n\r\n            // 分単位の番組長 (割り切れない場合は小数第2位で四捨五入)\r\n            const duration = Math.round(program.duration / 60 * 100) / 100;\r\n\r\n            if (is_short === true) {  // 時刻のみ\r\n                if ('recorded_video' in program) {\r\n                    return `${start_time.format('YYYY/MM/DD HH:mm')} ～ ${end_time.format('HH:mm')}`;  // 録画番組\r\n                } else {\r\n                    return `${start_time.format('HH:mm')} ～ ${end_time.format('HH:mm')}`;  // 放送中/次の番組\r\n                }\r\n            } else {\r\n                return `${start_time.format('YYYY/MM/DD (dd) HH:mm')} ～ ${end_time.format('HH:mm')} (${duration}分)`;\r\n            }\r\n\r\n        // 放送休止中\r\n        } else {\r\n            if (is_short === true) {  // 時刻のみ\r\n                if (program !== null && 'recorded_video' in program) {\r\n                    return '----/--/-- --:-- ～ --:--';  // 録画番組\r\n                } else {\r\n                    return '--:-- ～ --:--';  // 放送中/次の番組\r\n                }\r\n            } else {\r\n                return '----/--/-- (-) --:-- ～ --:-- (--分)';\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 文字列に含まれる英数や記号を半角に置換し、一律な表現に整える\r\n     * server/app/utils/TSInformation.py の TSInformation.formatString() と同等の処理を行う\r\n     * @param string 変換する文字列\r\n     * @returns 置換した文字列\r\n     */\r\n    static formatString(string: string): string {\r\n\r\n        // 変換\r\n        for (const key in ProgramUtils.format_string_translation_map) {\r\n            string = string.replaceAll(key, ProgramUtils.format_string_translation_map[key]);\r\n        }\r\n\r\n        // 置換した文字列を返す\r\n        return string;\r\n    }\r\n\r\n\r\n    /**\r\n     * formatString() で使用する変換マップを取得する\r\n     * server/app/utils/TSInformation.py の TSInfoAnalyzer.__buildFormatStringTranslationMap() と同等の処理を行う\r\n     * @returns 変換マップ\r\n     */\r\n    private static buildFormatStringTranslationMap(): {[key: string]: string} {\r\n\r\n        // 全角英数を半角英数に置換\r\n        const zenkaku_table = '０１２３４５６７８９ＡＢＣＤＥＦＧＨＩＪＫＬＭＮＯＰＱＲＳＴＵＶＷＸＹＺａｂｃｄｅｆｇｈｉｊｋｌｍｎｏｐｑｒｓｔｕｖｗｘｙｚ';\r\n        const hankaku_table = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\r\n        const merged_table: { [key: string]: string } = {};\r\n        for (let i = 0; i < zenkaku_table.length; i++) {\r\n            merged_table[zenkaku_table[i]] = hankaku_table[i];\r\n        }\r\n\r\n        // 全角記号を半角記号に置換\r\n        const symbol_zenkaku_table = '＂＃＄％＆＇（）＋，－．／：；＜＝＞［＼］＾＿｀｛｜｝　';\r\n        const symbol_hankaku_table = '\"#$%&\\'()+,-./:;<=>[\\\\]^_`{|} ';\r\n        for (let i = 0; i < symbol_zenkaku_table.length; i++) {\r\n            merged_table[symbol_zenkaku_table[i]] = symbol_hankaku_table[i];\r\n        }\r\n        // 一部の半角記号を全角に置換\r\n        // 主に見栄え的な問題（全角の方が字面が良い）\r\n        merged_table['!'] = '！';\r\n        merged_table['?'] = '？';\r\n        merged_table['*'] = '＊';\r\n        merged_table['~'] = '～';\r\n        // シャープ → ハッシュ\r\n        merged_table['♯'] = '#';\r\n        // 波ダッシュ → 全角チルダ\r\n        // EDCB は ～ を全角チルダとして扱っているため、KonomiTV でもそのように統一する\r\n        merged_table['〜'] = '～';\r\n\r\n        // 番組表で使用される囲み文字の置換テーブル\r\n        // ref: https://note.nkmk.me/python-chr-ord-unicode-code-point/\r\n        // ref: https://github.com/l3tnun/EPGStation/blob/v2.6.17/src/util/StrUtil.ts#L7-L46\r\n        const enclosed_characters_table: {[key: string]: string} = {\r\n            '\\u{1F14A}': '[HV]',\r\n            '\\u{1F13F}': '[P]',\r\n            '\\u{1F14C}': '[SD]',\r\n            '\\u{1F146}': '[W]',\r\n            '\\u{1F14B}': '[MV]',\r\n            '\\u{1F210}': '[手]',\r\n            '\\u{1F211}': '[字]',\r\n            '\\u{1F212}': '[双]',\r\n            '\\u{1F213}': '[デ]',\r\n            '\\u{1F142}': '[S]',\r\n            '\\u{1F214}': '[二]',\r\n            '\\u{1F215}': '[多]',\r\n            '\\u{1F216}': '[解]',\r\n            '\\u{1F14D}': '[SS]',\r\n            '\\u{1F131}': '[B]',\r\n            '\\u{1F13D}': '[N]',\r\n            '\\u{1F217}': '[天]',\r\n            '\\u{1F218}': '[交]',\r\n            '\\u{1F219}': '[映]',\r\n            '\\u{1F21A}': '[無]',\r\n            '\\u{1F21B}': '[料]',\r\n            '\\u{1F21C}': '[前]',\r\n            '\\u{1F21D}': '[後]',\r\n            '\\u{1F21E}': '[再]',\r\n            '\\u{1F21F}': '[新]',\r\n            '\\u{1F220}': '[初]',\r\n            '\\u{1F221}': '[終]',\r\n            '\\u{1F222}': '[生]',\r\n            '\\u{1F223}': '[販]',\r\n            '\\u{1F224}': '[声]',\r\n            '\\u{1F225}': '[吹]',\r\n            '\\u{1F14E}': '[PPV]',\r\n            '\\u{1F200}': '[ほか]',\r\n        };\r\n\r\n        // Unicode の囲み文字を大かっこで囲った文字に置換する\r\n        // EDCB で EpgDataCap3_Unicode.dll を利用している場合や、Mirakurun 3.9.0-beta.24 以降など、\r\n        // 番組情報取得元から Unicode の囲み文字が送られてくる場合に対応するためのもの\r\n        // Unicode の囲み文字はサロゲートペアなどで扱いが難しい上に KonomiTV では囲み文字を CSS でハイライトしているため、Unicode にするメリットがない\r\n        // ref: https://note.nkmk.me/python-str-replace-translate-re-sub/\r\n        for (const key in enclosed_characters_table) {\r\n            merged_table[key] = enclosed_characters_table[key];\r\n        }\r\n\r\n        return merged_table;\r\n    }\r\n\r\n    /**\r\n     * ISO639 形式の言語コードが示す言語の名称を取得する\r\n     * server/app/utils/TSInformation.py の TSInformation.getISO639LanguageCodeName() と同等の処理を行う\r\n     * @param iso639_language_code ISO639 形式の言語コード\r\n     * @returns ISO639 形式の言語コードが示す言語の名称\r\n     */\r\n    static getISO639LanguageCodeName(iso639_language_code: string): string {\r\n        if (iso639_language_code === 'jpn') {\r\n            return '日本語';\r\n        } else if (iso639_language_code === 'eng') {\r\n            return '英語';\r\n        } else if (iso639_language_code === 'deu') {\r\n            return 'ドイツ語';\r\n        } else if (iso639_language_code === 'fra') {\r\n            return 'フランス語';\r\n        } else if (iso639_language_code === 'ita') {\r\n            return 'イタリア語';\r\n        } else if (iso639_language_code === 'rus') {\r\n            return 'ロシア語';\r\n        } else if (iso639_language_code === 'zho') {\r\n            return '中国語';\r\n        } else if (iso639_language_code === 'kor') {\r\n            return '韓国語';\r\n        } else if (iso639_language_code === 'spa') {\r\n            return 'スペイン語';\r\n        } else {\r\n            return 'その他の言語';\r\n        }\r\n    }\r\n}\r\n","\r\n// day.js に毎回プラグインやタイムゾーンを設定するのが面倒かつ嵌まりポイントが多いので、ここでエクスポートする day.js を使う\r\n// ややこしすぎるので KonomiTV 内ではブラウザのタイムゾーンに関わらず、常に Asia/Tokyo として扱う\r\n// ref: https://github.com/iamkun/dayjs/issues/1227#issuecomment-917720826\r\n// ref: https://zenn.dev/taigakiyokawa/articles/20221122-dayjs-timezone\r\n\r\nimport dayjsOriginal from 'dayjs';\r\nimport ja from 'dayjs/locale/ja';\r\nimport isBetween from 'dayjs/plugin/isBetween';\r\nimport isSameOrAfter from 'dayjs/plugin/isSameOrAfter';\r\nimport isSameOrBefore from 'dayjs/plugin/isSameOrBefore';\r\nimport timezone from 'dayjs/plugin/timezone';\r\nimport utc from 'dayjs/plugin/utc';\r\n\r\nimport type { ConfigType, Dayjs } from 'dayjs';\r\n\r\ndayjsOriginal.extend(isBetween);\r\ndayjsOriginal.extend(isSameOrAfter);\r\ndayjsOriginal.extend(isSameOrBefore);\r\ndayjsOriginal.extend(utc);\r\ndayjsOriginal.extend(timezone);\r\ndayjsOriginal.locale(ja);\r\ndayjsOriginal.tz.setDefault('Asia/Tokyo');\r\n\r\nexport const dayjs = (date?: ConfigType): Dayjs => {\r\n    // return dayjsOriginal(date).tz();  // .tz() では setDefault で設定したタイムゾーンが適用される\r\n    // dayjs.tz() があまりにもクッソ遅いことが判明したので当面使わないことにする\r\n    // dayjs.tz() を使わないようにするだけで低スペ端末でのパフォーマンスが大幅に向上した…\r\n    return dayjsOriginal(date);\r\n};\r\n\r\n// 共通ユーティリティをデフォルトとしてインポート\r\nimport Utils from '@/utils/Utils';\r\nexport default Utils;\r\n\r\n// Utils フォルダ配下のユーティリティを一括でインポートできるように\r\nexport * from '@/utils/ChannelUtils';\r\nexport * from '@/utils/CommentUtils';\r\nexport * from '@/utils/PlayerUtils';\r\nexport * from '@/utils/ProgramUtils';\r\n","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"route-container\"},[_c('Header'),_c('main',[_c('Navigation'),_c('div',{staticClass:\"login-container-wrapper d-flex align-center w-100 mb-13\"},[_c('v-card',{staticClass:\"login-container px-10 pt-8 pb-11 mx-auto background lighten-1\",attrs:{\"elevation\":\"10\",\"width\":\"100%\",\"max-width\":\"450\"}},[_c('v-card-title',{staticClass:\"login__logo flex-column justify-center\"},[_c('v-img',{attrs:{\"max-width\":\"250\",\"src\":\"/assets/images/logo.svg\"}}),_c('h4',{staticClass:\"mt-10\"},[_vm._v(\"ログイン\")])],1),_c('v-divider'),_c('v-form',{ref:\"login\",on:{\"submit\":function($event){$event.preventDefault();}}},[_c('v-text-field',{staticClass:\"mt-12\",attrs:{\"outlined\":\"\",\"placeholder\":\"ユーザー名\",\"hide-details\":\"\",\"autofocus\":\"\",\"dense\":_vm.is_form_dense},model:{value:(_vm.username),callback:function ($$v) {_vm.username=$$v},expression:\"username\"}}),_c('v-text-field',{staticClass:\"mt-8\",attrs:{\"outlined\":\"\",\"placeholder\":\"パスワード\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"type\":_vm.password_showing ? 'text' : 'password',\"append-icon\":_vm.password_showing ? 'mdi-eye' : 'mdi-eye-off'},on:{\"click:append\":function($event){_vm.password_showing = !_vm.password_showing}},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}}),_c('v-btn',{staticClass:\"login-button mt-5\",attrs:{\"color\":\"secondary\",\"depressed\":\"\",\"width\":\"100%\",\"height\":\"56\"},on:{\"click\":function($event){return _vm.login()}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fa:sign-in\"}}),_vm._v(\"ログイン \")],1)],1)],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('header',{staticClass:\"header\"},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"konomitv-logo ml-3 ml-md-6\",attrs:{\"to\":\"/tv/\"}},[_c('img',{staticClass:\"konomitv-logo__image\",attrs:{\"src\":\"/assets/images/logo.svg\",\"height\":\"21\"}})]),_c('v-spacer')],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./Header.vue?vue&type=template&id=0f235e58&scoped=true\"\nvar script = {}\nimport style0 from \"./Header.vue?vue&type=style&index=0&id=0f235e58&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0f235e58\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',[_c('div',{staticClass:\"navigation-container elevation-8\"},[_c('nav',{staticClass:\"navigation\"},[_c('div',{staticClass:\"navigation-scroll\"},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"navigation__link\",attrs:{\"active-class\":\"navigation__link--active\",\"to\":\"/tv/\"}},[_c('Icon',{staticClass:\"navigation__link-icon\",attrs:{\"icon\":\"fluent:tv-20-regular\",\"width\":\"26px\"}}),_c('span',{staticClass:\"navigation__link-text\"},[_vm._v(\"テレビをみる\")])],1),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"navigation__link\",attrs:{\"active-class\":\"navigation__link--active\",\"to\":\"/videos/\"}},[_c('Icon',{staticClass:\"navigation__link-icon\",attrs:{\"icon\":\"fluent:movies-and-tv-20-regular\",\"width\":\"26px\"}}),_c('span',{staticClass:\"navigation__link-text\"},[_vm._v(\"ビデオをみる\")])],1),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"navigation__link\",attrs:{\"active-class\":\"navigation__link--active\",\"to\":\"/timetable/\"}},[_c('Icon',{staticClass:\"navigation__link-icon\",attrs:{\"icon\":\"fluent:calendar-ltr-20-regular\",\"width\":\"26px\"}}),_c('span',{staticClass:\"navigation__link-text\"},[_vm._v(\"番組表\")])],1),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"navigation__link\",attrs:{\"active-class\":\"navigation__link--active\",\"to\":\"/reserves/\"}},[_c('Icon',{staticClass:\"navigation__link-icon\",staticStyle:{\"padding\":\"0.5px\"},attrs:{\"icon\":\"fluent:timer-16-regular\",\"width\":\"26px\"}}),_c('span',{staticClass:\"navigation__link-text\"},[_vm._v(\"録画予約\")])],1),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"navigation__link\",attrs:{\"active-class\":\"navigation__link--active\",\"to\":\"/mylist/\"}},[_c('Icon',{staticClass:\"navigation__link-icon\",attrs:{\"icon\":\"ic:round-playlist-play\",\"width\":\"26px\"}}),_c('span',{staticClass:\"navigation__link-text\"},[_vm._v(\"マイリスト\")])],1),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"navigation__link\",attrs:{\"active-class\":\"navigation__link--active\",\"to\":\"/captures/\"}},[_c('Icon',{staticClass:\"navigation__link-icon\",attrs:{\"icon\":\"fluent:image-multiple-24-regular\",\"width\":\"26px\"}}),_c('span',{staticClass:\"navigation__link-text\"},[_vm._v(\"キャプチャ\")])],1),_c('v-spacer'),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"navigation__link\",attrs:{\"active-class\":\"navigation__link--active\",\"to\":\"/settings/\"}},[_c('Icon',{staticClass:\"navigation__link-icon\",attrs:{\"icon\":\"fluent:settings-20-regular\",\"width\":\"26px\"}}),_c('span',{staticClass:\"navigation__link-text\"},[_vm._v(\"設定\")])],1),_c('a',{directives:[{name:\"ripple\",rawName:\"v-ripple\"},{name:\"tooltip\",rawName:\"v-tooltip.top\",value:(_vm.versionStore.is_update_available ?\n                        `アップデートがあります (version ${_vm.versionStore.latest_version})` : ''),expression:\"versionStore.is_update_available ?\\n                        `アップデートがあります (version ${versionStore.latest_version})` : ''\",modifiers:{\"top\":true}}],staticClass:\"navigation__link\",class:{\n                        'navigation__link--version': _vm.versionStore.is_client_develop_version,\n                        'navigation__link--highlight': _vm.versionStore.is_update_available,\n                    },attrs:{\"active-class\":\"navigation__link--active\",\"href\":\"https://github.com/tsukumijima/KonomiTV\"}},[_c('Icon',{staticClass:\"navigation__link-icon\",attrs:{\"icon\":\"fluent:info-16-regular\",\"width\":\"26px\"}}),_c('span',{staticClass:\"navigation__link-text\"},[_vm._v(\"version \"+_vm._s(_vm.versionStore.client_version))])],1)],1)])]),_c('BottomNavigation')],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-bottom-navigation',{staticClass:\"bottom-navigation-container elevation-12\",attrs:{\"color\":\"primary\",\"grow\":\"\"}},[_c('v-btn',{staticClass:\"bottom-navigation-button\",attrs:{\"to\":\"/tv/\"}},[_c('span',{staticClass:\"mt-1\"},[_vm._v(\"テレビをみる\")]),_c('Icon',{attrs:{\"icon\":\"fluent:tv-20-regular\",\"width\":\"30px\"}})],1),_c('v-btn',{staticClass:\"bottom-navigation-button\",attrs:{\"to\":\"/videos/\"}},[_c('span',{staticClass:\"mt-1\"},[_vm._v(\"ビデオをみる\")]),_c('Icon',{attrs:{\"icon\":\"fluent:movies-and-tv-20-regular\",\"width\":\"30px\"}})],1),_c('v-btn',{staticClass:\"bottom-navigation-button\",attrs:{\"to\":\"/settings/\"}},[_c('span',{staticClass:\"mt-1\"},[_vm._v(\"設定\")]),_c('Icon',{attrs:{\"icon\":\"fluent:settings-20-regular\",\"width\":\"30px\"}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./BottomNavigation.vue?vue&type=template&id=3df53df3&scoped=true\"\nvar script = {}\nimport style0 from \"./BottomNavigation.vue?vue&type=style&index=0&id=3df53df3&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3df53df3\",\n  null\n  \n)\n\nexport default component.exports","\r\nimport APIClient from '@/services/APIClient';\r\n\r\n\r\n/** バージョン情報を表すインターフェイス */\r\nexport interface IVersionInformation {\r\n    version: string;\r\n    latest_version: string;\r\n    environment: 'Windows' | 'Linux' | 'Linux-Docker' | 'Linux-ARM';\r\n    backend: 'EDCB' | 'Mirakurun';\r\n    encoder: 'FFmpeg' | 'QSVEncC' | 'NVEncC' | 'VCEEncC' | 'rkmppenc';\r\n}\r\n\r\n\r\nclass Version {\r\n\r\n    /**\r\n     * バージョン情報を取得する\r\n     * @returns バージョン情報 or バージョン情報の取得に失敗した場合は null\r\n     */\r\n    static async fetchServerVersion(): Promise<IVersionInformation | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.get<IVersionInformation>('/version');\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, 'バージョン情報を取得できませんでした。');\r\n            return null;\r\n        }\r\n\r\n        return response.data;\r\n    }\r\n}\r\n\r\nexport default Version;\r\n","\r\nimport { defineStore } from 'pinia';\r\n\r\nimport Version, { IVersionInformation } from '@/services/Version';\r\nimport Utils from '@/utils';\r\n\r\n\r\n/**\r\n * 現在ログイン中のユーザーアカウントの情報を共有するストア\r\n */\r\nconst useVersionStore = defineStore('version', {\r\n    state: () => ({\r\n\r\n        // サーバーのバージョン情報\r\n        server_version_info: null as IVersionInformation | null,\r\n\r\n        // 最終更新日時 (UNIX タイムスタンプ、秒単位)\r\n        last_updated_at: 0,\r\n    }),\r\n    getters: {\r\n        client_version(): string {\r\n            return Utils.version;\r\n        },\r\n        server_version(): string | null {\r\n            return this.server_version_info?.version ?? null;\r\n        },\r\n        latest_version(): string | null {\r\n            return this.server_version_info?.latest_version ?? null;\r\n        },\r\n        is_client_develop_version(): boolean {\r\n            return this.client_version.includes('-dev');\r\n        },\r\n        is_server_develop_version(): boolean {\r\n            return this.server_version?.includes('-dev') ?? false;\r\n        },\r\n        is_update_available(): boolean {\r\n            // もし現在のサーバーバージョンと最新のバージョンが異なるなら、アップデートが利用できると判断する\r\n            // 現在のサーバーバージョンが開発版 (-dev あり) で、かつ最新のバージョンがリリース版 (-dev なし) の場合も同様に表示する\r\n            // つまり開発版だと同じバージョンのリリース版がリリースされたときにしかアップデート通知が表示されない事になるが、ひとまずこれで…\r\n            if (this.server_version === null || this.latest_version === null) return false;\r\n            if ((this.is_server_develop_version === false && this.server_version !== this.latest_version) ||\r\n                (this.is_server_develop_version === true && this.server_version.replace('-dev', '') === this.latest_version)) {\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n        is_version_mismatch(): boolean {\r\n            if (this.server_version === null) return false;\r\n            return this.client_version !== this.server_version;\r\n        }\r\n    },\r\n    actions: {\r\n\r\n        /**\r\n         * バージョン情報を取得する\r\n         * すでに取得済みの情報がある場合は API リクエストを行わずにそれを返す\r\n         * @param force 強制的に API リクエストを行う場合は true\r\n         * @returns バージョン情報 or バージョン情報の取得に失敗した場合は null\r\n         */\r\n        async fetchServerVersion(force: boolean = false): Promise<IVersionInformation | null> {\r\n\r\n            // バージョン情報がある場合はそれを返す\r\n            // force が true の場合は無視される\r\n            if (this.server_version_info !== null && force === false) {\r\n                // ただし、最終更新日時が1分以上前の場合は非同期で更新する\r\n                if (Utils.time() - this.last_updated_at > 60) {\r\n                    this.fetchServerVersion(true);\r\n                }\r\n                return this.server_version_info;\r\n            }\r\n\r\n            // サーバーのバージョン情報を取得する\r\n            const version_info = await Version.fetchServerVersion();\r\n            if (version_info === null) {\r\n                return null;\r\n            }\r\n            this.server_version_info = version_info;\r\n            this.last_updated_at = Utils.time();\r\n\r\n            return this.server_version_info;\r\n        },\r\n    }\r\n});\r\n\r\nexport default useVersionStore;\r\n","<template>\r\n    <div>\r\n        <div class=\"navigation-container elevation-8\">\r\n            <nav class=\"navigation\">\r\n                <div class=\"navigation-scroll\">\r\n                    <router-link v-ripple class=\"navigation__link\" active-class=\"navigation__link--active\" to=\"/tv/\">\r\n                        <Icon class=\"navigation__link-icon\" icon=\"fluent:tv-20-regular\" width=\"26px\" />\r\n                        <span class=\"navigation__link-text\">テレビをみる</span>\r\n                    </router-link>\r\n                    <router-link v-ripple class=\"navigation__link\" active-class=\"navigation__link--active\" to=\"/videos/\">\r\n                        <Icon class=\"navigation__link-icon\" icon=\"fluent:movies-and-tv-20-regular\" width=\"26px\" />\r\n                        <span class=\"navigation__link-text\">ビデオをみる</span>\r\n                    </router-link>\r\n                    <router-link v-ripple class=\"navigation__link\" active-class=\"navigation__link--active\" to=\"/timetable/\">\r\n                        <Icon class=\"navigation__link-icon\" icon=\"fluent:calendar-ltr-20-regular\" width=\"26px\" />\r\n                        <span class=\"navigation__link-text\">番組表</span>\r\n                    </router-link>\r\n                    <router-link v-ripple class=\"navigation__link\" active-class=\"navigation__link--active\" to=\"/reserves/\">\r\n                        <Icon class=\"navigation__link-icon\" icon=\"fluent:timer-16-regular\" width=\"26px\" style=\"padding: 0.5px;\" />\r\n                        <span class=\"navigation__link-text\">録画予約</span>\r\n                    </router-link>\r\n                    <router-link v-ripple class=\"navigation__link\" active-class=\"navigation__link--active\" to=\"/mylist/\">\r\n                        <Icon class=\"navigation__link-icon\" icon=\"ic:round-playlist-play\" width=\"26px\" />\r\n                        <span class=\"navigation__link-text\">マイリスト</span>\r\n                    </router-link>\r\n                    <router-link v-ripple class=\"navigation__link\" active-class=\"navigation__link--active\" to=\"/captures/\">\r\n                        <Icon class=\"navigation__link-icon\" icon=\"fluent:image-multiple-24-regular\" width=\"26px\" />\r\n                        <span class=\"navigation__link-text\">キャプチャ</span>\r\n                    </router-link>\r\n                    <v-spacer></v-spacer>\r\n                    <router-link v-ripple class=\"navigation__link\" active-class=\"navigation__link--active\" to=\"/settings/\">\r\n                        <Icon class=\"navigation__link-icon\" icon=\"fluent:settings-20-regular\" width=\"26px\" />\r\n                        <span class=\"navigation__link-text\">設定</span>\r\n                    </router-link>\r\n                    <a v-ripple class=\"navigation__link\" active-class=\"navigation__link--active\" href=\"https://github.com/tsukumijima/KonomiTV\"\r\n                        :class=\"{\r\n                            'navigation__link--version': versionStore.is_client_develop_version,\r\n                            'navigation__link--highlight': versionStore.is_update_available,\r\n                        }\"\r\n                        v-tooltip.top=\"versionStore.is_update_available ?\r\n                            `アップデートがあります (version ${versionStore.latest_version})` : ''\">\r\n                        <Icon class=\"navigation__link-icon\" icon=\"fluent:info-16-regular\" width=\"26px\" />\r\n                        <span class=\"navigation__link-text\">version {{versionStore.client_version}}</span>\r\n                    </a>\r\n                </div>\r\n            </nav>\r\n        </div>\r\n        <BottomNavigation />\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport BottomNavigation from '@/components/BottomNavigation.vue';\r\nimport useVersionStore from '@/stores/VersionStore';\r\n\r\nexport default defineComponent({\r\n    name: 'Navigation',\r\n    components: {\r\n        BottomNavigation,\r\n    },\r\n    computed: {\r\n        ...mapStores(useVersionStore),\r\n    },\r\n    async created() {\r\n        await this.versionStore.fetchServerVersion();\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.navigation-container {\r\n    flex-shrink: 0;\r\n    width: 220px;  // .navigation を fixed にするため、浮いた分の幅を確保する\r\n    background: var(--v-background-lighten1);\r\n    @include smartphone-horizontal {\r\n        width: calc(210px + env(safe-area-inset-left));\r\n    }\r\n    @include smartphone-horizontal-short {\r\n        width: calc(190px + env(safe-area-inset-left));\r\n    }\r\n    @include smartphone-vertical {\r\n        display: none;\r\n    }\r\n\r\n    .navigation {\r\n        position: fixed;\r\n        width: 220px;\r\n        top: 65px;  // ヘッダーの高さ分\r\n        left: 0px;\r\n        // スマホ・タブレットのブラウザでアドレスバーが完全に引っ込むまでビューポートの高さが更新されず、\r\n        // その間下に何も背景がない部分ができてしまうのを防ぐ\r\n        bottom: -100px;\r\n        padding-bottom: 100px;\r\n        background: var(--v-background-lighten1);\r\n        z-index: 1;\r\n        @include smartphone-horizontal {\r\n            top: 48px;\r\n            width: 210px;\r\n            margin-left:env(safe-area-inset-left);\r\n        }\r\n        @include smartphone-horizontal-short {\r\n            width: 190px;\r\n            margin-left:env(safe-area-inset-left);\r\n        }\r\n\r\n        .navigation-scroll {\r\n            display: flex;\r\n            flex-direction: column;\r\n            height: 100%;\r\n            padding: 22px 12px;\r\n            overflow-y: auto;\r\n            @include smartphone-horizontal {\r\n                padding: 10px 12px;\r\n            }\r\n            @include smartphone-horizontal-short {\r\n                padding: 10px 8px;\r\n            }\r\n            &::-webkit-scrollbar-track {\r\n                background: var(--v-background-lighten1);\r\n            }\r\n\r\n            .navigation__link {\r\n                display: flex;\r\n                align-items: center;\r\n                flex-shrink: 0;\r\n                height: 52px;\r\n                padding-left: 16px;\r\n                margin-top: 4px;\r\n                border-radius: 11px;\r\n                font-size: 16px;\r\n                color: var(--v-text-base);\r\n                transition: background-color 0.15s;\r\n                text-decoration: none;\r\n                user-select: none;\r\n                @include smartphone-horizontal {\r\n                    height: 40px;\r\n                    padding-left: 12px;\r\n                    border-radius: 9px;\r\n                    font-size: 15px;\r\n                }\r\n\r\n                &:hover {\r\n                    background: var(--v-background-lighten2);\r\n                }\r\n                &:first-of-type {\r\n                    margin-top: 0;\r\n                }\r\n                &--active {\r\n                    color: var(--v-primary-base);\r\n                    background: #5b2d3c;\r\n                    &:hover {\r\n                        background: #5b2d3c;\r\n                    }\r\n                }\r\n                &--highlight {\r\n                    color: var(--v-secondary-lighten1);\r\n                }\r\n                &--version {\r\n                    font-size: 15px;\r\n                    @include smartphone-horizontal {\r\n                        font-size: 14.5px;\r\n                    }\r\n                }\r\n\r\n                .navigation__link-icon {\r\n                    margin-right: 14px;\r\n                    @include smartphone-horizontal {\r\n                        margin-right: 10px;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Navigation.vue?vue&type=template&id=a7a4a2cc&scoped=true\"\nimport script from \"./Navigation.vue?vue&type=script&lang=ts\"\nexport * from \"./Navigation.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Navigation.vue?vue&type=style&index=0&id=a7a4a2cc&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a7a4a2cc\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <div class=\"route-container\">\r\n        <Header/>\r\n        <main>\r\n            <Navigation/>\r\n            <div class=\"login-container-wrapper d-flex align-center w-100 mb-13\">\r\n                <v-card class=\"login-container px-10 pt-8 pb-11 mx-auto background lighten-1\" elevation=\"10\"\r\n                    width=\"100%\" max-width=\"450\">\r\n                    <v-card-title class=\"login__logo flex-column justify-center\">\r\n                        <v-img max-width=\"250\" src=\"/assets/images/logo.svg\"></v-img>\r\n                        <h4 class=\"mt-10\">ログイン</h4>\r\n                    </v-card-title>\r\n                    <v-divider></v-divider>\r\n                    <v-form ref=\"login\" @submit.prevent>\r\n                        <v-text-field class=\"mt-12\" outlined placeholder=\"ユーザー名\" hide-details autofocus\r\n                            :dense=\"is_form_dense\"\r\n                            v-model=\"username\">\r\n                        </v-text-field>\r\n                        <v-text-field class=\"mt-8\" outlined placeholder=\"パスワード\" hide-details\r\n                            :dense=\"is_form_dense\"\r\n                            v-model=\"password\"\r\n                            :type=\"password_showing ? 'text' : 'password'\"\r\n                            :append-icon=\"password_showing ? 'mdi-eye' : 'mdi-eye-off'\"\r\n                            @click:append=\"password_showing = !password_showing\">\r\n                        </v-text-field>\r\n                        <v-btn class=\"login-button mt-5\" color=\"secondary\" depressed width=\"100%\" height=\"56\"\r\n                            @click=\"login()\">\r\n                            <Icon icon=\"fa:sign-in\" class=\"mr-2\" />ログイン\r\n                        </v-btn>\r\n                    </v-form>\r\n                </v-card>\r\n            </div>\r\n        </main>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport Header from '@/components/Header.vue';\r\nimport Navigation from '@/components/Navigation.vue';\r\nimport Message from '@/message';\r\nimport useUserStore from '@/stores/UserStore';\r\nimport Utils from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'Login',\r\n    components: {\r\n        Header,\r\n        Navigation,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // フォームを小さくするかどうか\r\n            is_form_dense: Utils.isSmartphoneHorizontal(),\r\n\r\n            username: '' as string,\r\n            password: '' as string,\r\n            password_showing: false,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useUserStore),\r\n    },\r\n    async created() {\r\n\r\n        // アカウント情報を更新\r\n        await this.userStore.fetchUser();\r\n\r\n        // 現在ログイン中の場合はアカウントページに遷移\r\n        if (this.userStore.is_logged_in) {\r\n            await this.$router.replace({path: '/settings/account'});\r\n        }\r\n    },\r\n    methods: {\r\n        async login() {\r\n\r\n            // ユーザー名またはパスワードが空\r\n            if (this.username === '' || this.password === '') {\r\n                Message.error('ユーザー名またはパスワードが空です。');\r\n                return;\r\n            }\r\n\r\n            // ログイン処理 (エラーハンドリング含む) を実行\r\n            const result = await this.userStore.login(this.username, this.password);\r\n            if (result === false) {\r\n                return;  // ログイン失敗\r\n            }\r\n\r\n            // アカウントページに遷移\r\n            // ブラウザバックでログインページに戻れないようにする\r\n            await this.$router.replace({path: '/settings/account'});\r\n        }\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.login-container-wrapper {\r\n    @include smartphone-horizontal {\r\n        padding: 20px !important;\r\n        margin-bottom: 0px !important;\r\n    }\r\n    @include smartphone-vertical {\r\n        margin-bottom: 0px !important;\r\n    }\r\n\r\n    .login-container {\r\n        border-radius: 11px;\r\n        @include smartphone-horizontal {\r\n            padding: 24px !important;\r\n        }\r\n        @include smartphone-vertical {\r\n            padding: 32px 20px !important;\r\n            margin-left: 12px !important;\r\n            margin-right: 12px !important;\r\n        }\r\n\r\n        .login__logo {\r\n            @include smartphone-horizontal {\r\n                padding-top: 4px !important;\r\n                padding-bottom: 8px !important;\r\n                .v-image {\r\n                    max-width: 200px !important;\r\n                }\r\n                h4 {\r\n                    margin-top: 16px !important;\r\n                    font-size: 19px !important;\r\n                }\r\n            }\r\n            @include smartphone-vertical {\r\n                padding-top: 4px !important;\r\n                padding-bottom: 12px !important;\r\n                .v-image {\r\n                    max-width: 200px !important;\r\n                }\r\n                h4 {\r\n                    margin-top: 24px !important;\r\n                    font-size: 19px !important;\r\n                }\r\n            }\r\n        }\r\n\r\n        .v-input {\r\n            @include smartphone-horizontal {\r\n                margin-top: 24px !important;\r\n                font-size: 14px !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                margin-top: 32px !important;\r\n                font-size: 16px !important;\r\n            }\r\n        }\r\n\r\n        .login-button {\r\n            border-radius: 7px;\r\n            margin-top: 48px !important;\r\n            font-size: 18px;\r\n            letter-spacing: 0px;\r\n            @include smartphone-horizontal {\r\n                height: 44px !important;\r\n                margin-top: 24px !important;\r\n                font-size: 16px;\r\n            }\r\n            @include smartphone-vertical {\r\n                height: 50px !important;\r\n                margin-top: 32px !important;\r\n                font-size: 15.5px;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=018899ee&scoped=true\"\nimport script from \"./Login.vue?vue&type=script&lang=ts\"\nexport * from \"./Login.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=018899ee&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"018899ee\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"route-container\"},[_c('Header'),_c('main',[_c('Navigation'),_vm._m(0)],1)],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"d-flex justify-center align-center w-100\"},[_c('div',{staticClass:\"d-flex justify-center align-center flex-column\"},[_c('h1',[_vm._v(\"Not Found, or Under Development...\")]),_c('span',{staticClass:\"mt-4 text--text text--darken-1\"},[_vm._v(\"お探しのページは存在しないか、鋭意開発中です。\")])])])\n}]\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"route-container\">\r\n        <Header/>\r\n        <main>\r\n            <Navigation/>\r\n            <div class=\"d-flex justify-center align-center w-100\">\r\n                <div class=\"d-flex justify-center align-center flex-column\">\r\n                    <h1>Not Found, or Under Development...</h1>\r\n                    <span class=\"mt-4 text--text text--darken-1\">お探しのページは存在しないか、鋭意開発中です。</span>\r\n                </div>\r\n            </div>\r\n        </main>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { defineComponent } from 'vue';\r\n\r\nimport Header from '@/components/Header.vue';\r\nimport Navigation from '@/components/Navigation.vue';\r\n\r\nexport default defineComponent({\r\n    name: 'NotFound',\r\n    components: {\r\n        Header,\r\n        Navigation,\r\n    },\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\nh1 {\r\n    @include tablet-vertical {\r\n        font-size: 24px !important;\r\n    }\r\n    @include smartphone-horizontal {\r\n        font-size: 24px !important;\r\n    }\r\n    @include smartphone-vertical {\r\n        font-size: 24px !important;\r\n        text-align: center;\r\n    }\r\n}\r\nspan {\r\n    @include smartphone-horizontal {\r\n        font-size: 15px !important;\r\n    }\r\n    @include smartphone-vertical {\r\n        font-size: 14px !important;\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./NotFound.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./NotFound.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./NotFound.vue?vue&type=template&id=086c5be2&scoped=true\"\nimport script from \"./NotFound.vue?vue&type=script&lang=ts\"\nexport * from \"./NotFound.vue?vue&type=script&lang=ts\"\nimport style0 from \"./NotFound.vue?vue&type=style&index=0&id=086c5be2&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"086c5be2\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"route-container\"},[_c('Header'),_c('main',[_c('Navigation'),_c('div',{staticClass:\"register-container-wrapper d-flex align-center w-100 mb-13\"},[_c('v-card',{staticClass:\"register-container px-10 pt-8 pb-11 mx-auto background lighten-1\",attrs:{\"elevation\":\"10\",\"width\":\"100%\",\"max-width\":\"450\"}},[_c('v-card-title',{staticClass:\"register__logo flex-column justify-center\"},[_c('v-img',{attrs:{\"max-width\":\"250\",\"src\":\"/assets/images/logo.svg\"}}),_c('h4',{staticClass:\"mt-10\"},[_vm._v(\"アカウントを作成\")])],1),_c('v-divider'),_c('v-form',{ref:\"register\",on:{\"submit\":function($event){$event.preventDefault();}}},[_c('v-text-field',{staticClass:\"mt-12\",attrs:{\"outlined\":\"\",\"placeholder\":\"ユーザー名\",\"autofocus\":\"\",\"dense\":_vm.is_form_dense,\"rules\":[_vm.username_validation]},model:{value:(_vm.username),callback:function ($$v) {_vm.username=$$v},expression:\"username\"}}),_c('v-text-field',{staticStyle:{\"margin-top\":\"2px\"},attrs:{\"outlined\":\"\",\"placeholder\":\"パスワード\",\"dense\":_vm.is_form_dense,\"type\":_vm.password_showing ? 'text' : 'password',\"append-icon\":_vm.password_showing ? 'mdi-eye' : 'mdi-eye-off',\"rules\":[_vm.password_validation]},on:{\"click:append\":function($event){_vm.password_showing = !_vm.password_showing}},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}}),_c('v-btn',{staticClass:\"register-button mt-5\",attrs:{\"color\":\"secondary\",\"depressed\":\"\",\"width\":\"100%\",\"height\":\"56\"},on:{\"click\":function($event){return _vm.register()}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:person-add-20-filled\",\"height\":\"24\"}}),_vm._v(\"アカウントを作成 \")],1)],1)],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"route-container\">\r\n        <Header/>\r\n        <main>\r\n            <Navigation/>\r\n            <div class=\"register-container-wrapper d-flex align-center w-100 mb-13\">\r\n                <v-card class=\"register-container px-10 pt-8 pb-11 mx-auto background lighten-1\" elevation=\"10\"\r\n                    width=\"100%\" max-width=\"450\">\r\n                    <v-card-title class=\"register__logo flex-column justify-center\">\r\n                        <v-img max-width=\"250\" src=\"/assets/images/logo.svg\"></v-img>\r\n                        <h4 class=\"mt-10\">アカウントを作成</h4>\r\n                    </v-card-title>\r\n                    <v-divider></v-divider>\r\n                    <v-form ref=\"register\" @submit.prevent>\r\n                        <v-text-field class=\"mt-12\" outlined placeholder=\"ユーザー名\" autofocus\r\n                            :dense=\"is_form_dense\"\r\n                            v-model=\"username\"\r\n                            :rules=\"[username_validation]\">\r\n                        </v-text-field>\r\n                        <v-text-field style=\"margin-top: 2px;\" outlined placeholder=\"パスワード\"\r\n                            :dense=\"is_form_dense\"\r\n                            v-model=\"password\"\r\n                            :type=\"password_showing ? 'text' : 'password'\"\r\n                            :append-icon=\"password_showing ? 'mdi-eye' : 'mdi-eye-off'\"\r\n                            :rules=\"[password_validation]\"\r\n                            @click:append=\"password_showing = !password_showing\">\r\n                        </v-text-field>\r\n                        <v-btn class=\"register-button mt-5\" color=\"secondary\" depressed width=\"100%\" height=\"56\"\r\n                            @click=\"register()\">\r\n                            <Icon icon=\"fluent:person-add-20-filled\" class=\"mr-2\" height=\"24\" />アカウントを作成\r\n                        </v-btn>\r\n                    </v-form>\r\n            </v-card>\r\n            </div>\r\n        </main>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport Header from '@/components/Header.vue';\r\nimport Navigation from '@/components/Navigation.vue';\r\nimport useUserStore from '@/stores/UserStore';\r\nimport Utils from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'Register',\r\n    components: {\r\n        Header,\r\n        Navigation,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // フォームを小さくするかどうか\r\n            is_form_dense: Utils.isSmartphoneHorizontal(),\r\n\r\n            username: null as string | null,\r\n            username_validation: (value: string | null) => {\r\n                if (value === '' || value === null) return 'ユーザー名を入力してください。';\r\n                if (/^.{2,}$/.test(value) === false) return 'ユーザー名は2文字以上で入力してください。';\r\n                return true;\r\n            },\r\n            password: null as string | null,\r\n            password_showing: true,  // アカウント作成時はデフォルトでパスワードを表示する\r\n            password_validation: (value: string | null) => {\r\n                if (value === '' || value === null) return 'パスワードを入力してください。';\r\n                // ref: https://qiita.com/grrrr/items/0b35b5c1c98eebfa5128\r\n                if (/^[a-zA-Z0-9!-/:-@¥[-`{-~]{4,}$/.test(value) === false) return 'パスワードは4文字以上の半角英数記号を入力してください。';\r\n                return true;\r\n            },\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useUserStore),\r\n    },\r\n    async created() {\r\n\r\n        // アカウント情報を更新\r\n        await this.userStore.fetchUser();\r\n\r\n        // 現在ログイン中の場合はアカウントページに遷移\r\n        if (this.userStore.is_logged_in) {\r\n            await this.$router.replace({path: '/settings/account'});\r\n        }\r\n    },\r\n    methods: {\r\n        async register() {\r\n\r\n            // すべてのバリデーションが通過したときのみ\r\n            // ref: https://qiita.com/Hijiri_Ishi/items/56cac99c8f3806a6fa24\r\n            if ((this.$refs.register as any).validate() === false) return;\r\n            if (this.username === null || this.password === null) return;\r\n\r\n            // アカウント作成 & ログイン処理 (エラーハンドリング含む) を実行\r\n            const result = await this.userStore.register(this.username, this.password);\r\n            if (result === false) {\r\n                return;  // ログイン失敗\r\n            }\r\n\r\n            // アカウントページに遷移\r\n            // ブラウザバックでアカウント作成画面に戻れないようにする\r\n            await this.$router.replace({path: '/settings/account'});\r\n        }\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.register-container-wrapper {\r\n    @include smartphone-horizontal {\r\n        padding: 20px !important;\r\n        margin-bottom: 0px !important;\r\n    }\r\n    @include smartphone-vertical {\r\n        margin-bottom: 0px !important;\r\n    }\r\n\r\n    .register-container {\r\n        border-radius: 11px;\r\n        @include smartphone-horizontal {\r\n            padding: 24px !important;\r\n        }\r\n        @include smartphone-vertical {\r\n            padding: 32px 20px !important;\r\n            margin-left: 12px !important;\r\n            margin-right: 12px !important;\r\n        }\r\n\r\n        .register__logo {\r\n            @include smartphone-horizontal {\r\n                padding-top: 4px !important;\r\n                padding-bottom: 8px !important;\r\n                .v-image {\r\n                    max-width: 200px !important;\r\n                }\r\n                h4 {\r\n                    margin-top: 16px !important;\r\n                    font-size: 19px !important;\r\n                }\r\n            }\r\n            @include smartphone-vertical {\r\n                padding-top: 4px !important;\r\n                padding-bottom: 12px !important;\r\n                .v-image {\r\n                    max-width: 200px !important;\r\n                }\r\n                h4 {\r\n                    margin-top: 24px !important;\r\n                    font-size: 19px !important;\r\n                }\r\n            }\r\n        }\r\n\r\n        .v-input {\r\n            @include smartphone-horizontal {\r\n                margin-top: 0px !important;\r\n                font-size: 14px !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                margin-top: 2px !important;\r\n                font-size: 16px !important;\r\n            }\r\n        }\r\n        .v-input:nth-child(1) {\r\n            @include smartphone-horizontal {\r\n                margin-top: 24px !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                margin-top: 32px !important;\r\n            }\r\n        }\r\n\r\n        .register-button {\r\n            border-radius: 7px;\r\n            margin-top: 18px !important;\r\n            font-size: 18px;\r\n            letter-spacing: 0px;\r\n            @include smartphone-horizontal {\r\n                height: 44px !important;\r\n                margin-top: 0px !important;\r\n                font-size: 16px;\r\n            }\r\n            @include smartphone-vertical {\r\n                height: 50px !important;\r\n                margin-top: 2px !important;\r\n                font-size: 15.5px;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Register.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Register.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Register.vue?vue&type=template&id=b186d5f6&scoped=true\"\nimport script from \"./Register.vue?vue&type=script&lang=ts\"\nexport * from \"./Register.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Register.vue?vue&type=style&index=0&id=b186d5f6&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b186d5f6\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('SettingsBase',[_c('h2',{staticClass:\"settings__heading\"},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"settings__back-button\",attrs:{\"to\":\"/settings/\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-left-12-filled\",\"width\":\"25px\"}})],1),_c('Icon',{attrs:{\"icon\":\"fluent:person-20-filled\",\"width\":\"25px\"}}),_c('span',{staticClass:\"ml-2\"},[_vm._v(\"アカウント\")])],1),_c('div',{staticClass:\"settings__content\",class:{'settings__content--loading': _vm.is_loading}},[(_vm.userStore.user === null)?_c('div',{staticClass:\"account\"},[_c('div',{staticClass:\"account-wrapper\"},[_c('img',{staticClass:\"account__icon\",attrs:{\"src\":\"/assets/images/account-icon-default.png\"}}),_c('div',{staticClass:\"account__info\"},[_c('div',{staticClass:\"account__info-name\"},[_c('span',{staticClass:\"account__info-name-text\"},[_vm._v(\"ログインしていません\")])]),_c('span',{staticClass:\"account__info-id\"},[_vm._v(\"Not logged in\")])])]),_c('v-btn',{staticClass:\"account__login ml-auto\",attrs:{\"color\":\"secondary\",\"width\":\"140\",\"height\":\"56\",\"depressed\":\"\",\"to\":\"/login/\"}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fa:sign-in\"}}),_vm._v(\"ログイン \")],1)],1):_vm._e(),(_vm.userStore.user !== null)?_c('div',{staticClass:\"account\"},[_c('div',{staticClass:\"account-wrapper\"},[_c('img',{staticClass:\"account__icon\",attrs:{\"src\":_vm.userStore.user_icon_url ?? ''}}),_c('div',{staticClass:\"account__info\"},[_c('div',{staticClass:\"account__info-name\"},[_c('span',{staticClass:\"account__info-name-text\"},[_vm._v(_vm._s(_vm.userStore.user.name))]),(_vm.userStore.user.is_admin)?_c('span',{staticClass:\"account__info-admin\"},[_vm._v(\"管理者\")]):_vm._e()]),_c('span',{staticClass:\"account__info-id\"},[_vm._v(\"User ID: \"+_vm._s(_vm.userStore.user.id))])])]),_c('v-btn',{staticClass:\"account__login ml-auto\",attrs:{\"color\":\"secondary\",\"width\":\"140\",\"height\":\"56\",\"depressed\":\"\"},on:{\"click\":function($event){return _vm.userStore.logout()}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fa:sign-out\"}}),_vm._v(\"ログアウト \")],1)],1):_vm._e(),(_vm.userStore.is_logged_in === false)?_c('div',{staticClass:\"account-register\"},[_c('div',{staticClass:\"account-register__heading\"},[_vm._v(\" KonomiTV アカウントにログインすると、\"),_c('br'),_vm._v(\"より便利な機能が使えます！ \")]),_c('div',{staticClass:\"account-register__feature\"},[_c('div',{staticClass:\"account-feature\"},[_c('Icon',{staticClass:\"account-feature__icon\",attrs:{\"icon\":\"bi:chat-left-text-fill\"}}),_c('div',{staticClass:\"account-feature__info\"},[_c('span',{staticClass:\"account-feature__info-heading\"},[_vm._v(\"ニコニコ実況にコメントする\")]),_c('span',{staticClass:\"account-feature__info-text\"},[_vm._v(\"テレビを見ながらニコニコ実況にコメントできます。別途、ニコニコアカウントとの連携が必要です。\")])])],1),_c('div',{staticClass:\"account-feature\"},[_c('Icon',{staticClass:\"account-feature__icon\",attrs:{\"icon\":\"fa-brands:twitter\"}}),_c('div',{staticClass:\"account-feature__info\"},[_c('span',{staticClass:\"account-feature__info-heading\"},[_vm._v(\"Twitter 連携機能\")]),_c('span',{staticClass:\"account-feature__info-text\"},[_vm._v(\"テレビを見ながら Twitter にツイートしたり、検索したツイートをリアルタイムで表示できます。別途、Twitter アカウントとの連携が必要です。\")])])],1),_c('div',{staticClass:\"account-feature\"},[_c('Icon',{staticClass:\"account-feature__icon\",attrs:{\"icon\":\"fluent:arrow-sync-20-filled\"}}),_c('div',{staticClass:\"account-feature__info\"},[_c('span',{staticClass:\"account-feature__info-heading\"},[_vm._v(\"設定をデバイス間で同期\")]),_c('span',{staticClass:\"account-feature__info-text\"},[_vm._v(\"ピン留めしたチャンネルなど、ブラウザに保存されている各種設定をブラウザやデバイスをまたいで同期できます。\")])])],1),_c('div',{staticClass:\"account-feature\"},[_c('Icon',{staticClass:\"account-feature__icon\",attrs:{\"icon\":\"fa-solid:sliders-h\"}}),_c('div',{staticClass:\"account-feature__info\"},[_c('span',{staticClass:\"account-feature__info-heading\"},[_vm._v(\"サーバー設定をブラウザから変更\")]),_c('span',{staticClass:\"account-feature__info-text\"},[_vm._v(\"管理者権限があれば、サーバー設定をブラウザから変更できます。一番最初に作成されたアカウントには、自動で管理者権限が付与されます。\")])])],1)]),_c('div',{staticClass:\"account-register__description\"},[_vm._v(\" KonomiTV アカウントの作成に必要なものは\"),_c('br',{staticClass:\"smartphone-vertical-only\"}),_vm._v(\"ユーザー名とパスワードだけです。\"),_c('br'),_vm._v(\" アカウントはローカルに導入した\"),_c('br',{staticClass:\"smartphone-vertical-only\"}),_vm._v(\" KonomiTV サーバーにのみ保存されます。\"),_c('br'),_vm._v(\" 外部のサービスには保存されませんので、ご安心ください。\"),_c('br')]),_c('v-btn',{staticClass:\"account-register__button\",attrs:{\"color\":\"secondary\",\"width\":\"100%\",\"max-width\":\"250\",\"height\":\"50\",\"depressed\":\"\",\"to\":\"/register/\"}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:person-add-20-filled\",\"height\":\"24\"}}),_vm._v(\"アカウントを作成 \")],1)],1):_vm._e(),(_vm.userStore.is_logged_in === true)?_c('div',[_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"sync_settings\"}},[_vm._v(\"設定をデバイス間で同期する\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"sync_settings\"}},[_vm._v(\" KonomiTV では、設定を同じアカウントでログインしているデバイス間で同期できます！\"),_c('br'),_vm._v(\" 同期をオンにすると、同期をオンにしているすべてのデバイスで共通の設定が使えます。ピン留めチャンネルやハッシュタグリストなども同期されます。\"),_c('br'),_vm._v(\" なお、デバイス固有の設定（画質設定など）は、同期後も各デバイスで個別に反映されます。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"sync_settings\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.sync_settings),callback:function ($$v) {_vm.sync_settings=$$v},expression:\"sync_settings\"}})],1),_c('v-dialog',{attrs:{\"max-width\":\"530\"},model:{value:(_vm.sync_settings_dialog),callback:function ($$v) {_vm.sync_settings_dialog=$$v},expression:\"sync_settings_dialog\"}},[_c('v-card',[_c('v-card-title',{staticClass:\"justify-center\"},[_vm._v(\"設定データの競合\")]),_c('v-card-text',[_vm._v(\" このデバイスの設定と、サーバーに保存されている設定が競合しています。\"),_c('br'),_vm._v(\" 一度上書きすると、元に戻すことはできません。慎重に選択してください。\"),_c('br')]),_c('div',{staticClass:\"d-flex flex-column px-4 pb-4 settings__conflict-dialog\"},[_c('v-btn',{staticClass:\"settings__save-button error--text text--lighten-1\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){return _vm.overrideServerSettingsFromClient()}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:document-arrow-up-16-filled\",\"height\":\"22px\"}}),_vm._v(\" サーバーに保存されている設定を、\"),_c('br',{staticClass:\"smartphone-vertical-only\"}),_vm._v(\"このデバイスの設定で上書きする \")],1),_c('v-btn',{staticClass:\"settings__save-button error--text text--lighten-1 mt-3\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){return _vm.overrideClientSettingsFromServer()}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:document-arrow-down-16-filled\",\"height\":\"22px\"}}),_vm._v(\" このデバイスの設定を、\"),_c('br',{staticClass:\"smartphone-vertical-only\"}),_vm._v(\"サーバーに保存されている設定で上書きする \")],1),_c('v-btn',{staticClass:\"settings__save-button mt-3\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){_vm.sync_settings_dialog = false}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:dismiss-16-filled\",\"height\":\"22px\"}}),_vm._v(\" キャンセル \")],1)],1)],1)],1),_c('v-form',{ref:\"settings_username\",staticClass:\"settings__item\",on:{\"submit\":function($event){$event.preventDefault();}}},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"ユーザー名\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" KonomiTV アカウントのユーザー名を設定します。アルファベットだけでなく日本語や記号も使えます。\"),_c('br'),_vm._v(\" 同じ KonomiTV サーバー上の他のアカウントと同じユーザー名には変更できません。\"),_c('br')]),_c('v-text-field',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"placeholder\":\"ユーザー名\",\"dense\":_vm.is_form_dense,\"rules\":[_vm.settings_username_validation]},model:{value:(_vm.settings_username),callback:function ($$v) {_vm.settings_username=$$v},expression:\"settings_username\"}})],1),_c('v-btn',{staticClass:\"settings__save-button\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){return _vm.updateAccountInfo('username')}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:save-16-filled\",\"height\":\"24px\"}}),_vm._v(\"ユーザー名を更新 \")],1),_c('v-form',{staticClass:\"settings__item\",on:{\"submit\":function($event){$event.preventDefault();}}},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"アイコン画像\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" KonomiTV アカウントのアイコン画像を設定します。\"),_c('br'),_vm._v(\" アップロードされた画像は自動で 400×400 の正方形にリサイズされます。\"),_c('br')]),_c('v-file-input',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"placeholder\":\"アイコン画像を選択\",\"dense\":_vm.is_form_dense,\"accept\":\"image/jpeg, image/png\",\"prepend-icon\":\"\",\"prepend-inner-icon\":\"mdi-paperclip\"},model:{value:(_vm.settings_icon),callback:function ($$v) {_vm.settings_icon=$$v},expression:\"settings_icon\"}})],1),_c('v-btn',{staticClass:\"settings__save-button mt-5\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){return _vm.updateAccountIcon()}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:save-16-filled\",\"height\":\"24px\"}}),_vm._v(\"アイコン画像を更新 \")],1),_c('v-form',{ref:\"settings_password\",staticClass:\"settings__item\",on:{\"submit\":function($event){$event.preventDefault();}}},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"新しいパスワード\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" KonomiTV アカウントの新しいパスワードを設定します。\"),_c('br')]),_c('v-text-field',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"placeholder\":\"新しいパスワード\",\"dense\":_vm.is_form_dense,\"type\":_vm.settings_password_showing ? 'text' : 'password',\"append-icon\":_vm.settings_password_showing ? 'mdi-eye' : 'mdi-eye-off',\"rules\":[_vm.settings_password_validation]},on:{\"click:append\":function($event){_vm.settings_password_showing = !_vm.settings_password_showing}},model:{value:(_vm.settings_password),callback:function ($$v) {_vm.settings_password=$$v},expression:\"settings_password\"}})],1),_c('v-btn',{staticClass:\"settings__save-button\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){return _vm.updateAccountInfo('password')}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:save-16-filled\",\"height\":\"24px\"}}),_vm._v(\"パスワードを更新 \")],1),_c('v-divider',{staticClass:\"mt-6\"}),_c('div',{staticClass:\"settings__item mt-6\"},[_c('div',{staticClass:\"settings__item-heading error--text text--lighten-1\"},[_vm._v(\"アカウントを削除\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" 現在ログインしている KonomiTV アカウントを削除します。\"),_c('br'),_c('b',[_vm._v(\"アカウントに紐づくすべてのデータが削除されます。\")]),_vm._v(\"元に戻すことはできません。\"),_c('br')])]),_c('v-dialog',{attrs:{\"max-width\":\"385\"},scopedSlots:_vm._u([{key:\"activator\",fn:function({ on }){return [_c('v-btn',_vm._g({staticClass:\"settings__save-button error mt-5\",attrs:{\"depressed\":\"\"}},on),[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:delete-16-filled\",\"height\":\"24px\"}}),_vm._v(\"アカウントを削除 \")],1)]}}],null,false,1849668703),model:{value:(_vm.account_delete_confirm_dialog),callback:function ($$v) {_vm.account_delete_confirm_dialog=$$v},expression:\"account_delete_confirm_dialog\"}},[_c('v-card',[_c('v-card-title',{staticClass:\"justify-center pt-6 font-weight-bold\"},[_vm._v(\"本当にアカウントを削除しますか？\")]),_c('v-card-text',{staticClass:\"pt-2 pb-0\"},[_vm._v(\" アカウントに紐づくすべてのデータが削除されます。元に戻すことはできません。\"),_c('br'),_vm._v(\" 本当にアカウントを削除しますか？ \")]),_c('v-card-actions',{staticClass:\"pt-4 px-6 pb-5\"},[_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"text\",\"text\":\"\"},on:{\"click\":function($event){_vm.account_delete_confirm_dialog = false}}},[_vm._v(\"キャンセル\")]),_c('v-btn',{attrs:{\"color\":\"error\"},on:{\"click\":function($event){return _vm.deleteAccount()}}},[_vm._v(\"削除\")])],1)],1)],1)],1):_vm._e()])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"route-container\"},[_c('Header'),_c('main',[_c('Navigation'),_c('v-card',{staticClass:\"settings-container d-flex px-5 py-5 mx-auto background\",attrs:{\"elevation\":\"0\",\"width\":\"100%\",\"max-width\":\"1000\"}},[_c('div',[_c('v-navigation-drawer',{staticClass:\"settings-navigation flex-shrink-0 background\",attrs:{\"permanent\":\"\",\"width\":\"195\",\"height\":\"auto\"}},[_c('v-list-item',{staticClass:\"px-4\"},[_c('v-list-item-content',[_c('h1',[_vm._v(\"設定\")])])],1),_c('v-list',{staticClass:\"mt-3 px-0 py-0\",attrs:{\"nav\":\"\"}},[_c('v-list-item',{staticClass:\"px-4 mb-1\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/general\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{staticStyle:{\"padding\":\"0 3px\"},attrs:{\"icon\":\"fa-solid:sliders-h\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"全般\")])],1)],1),_c('v-list-item',{staticClass:\"px-4 mb-1\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/quality\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:video-clip-multiple-16-filled\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"画質\")])],1)],1),_c('v-list-item',{staticClass:\"px-4 mb-1\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/caption\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:subtitles-16-filled\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"字幕\")])],1)],1),_c('v-list-item',{staticClass:\"px-4 mb-1\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/data-broadcasting\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('svg',{attrs:{\"width\":\"26px\",\"height\":\"26px\",\"viewBox\":\"0 0 512 512\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M248.039 381.326L355.039 67.8258C367.539 28.3257 395.039 34.3258 406.539 34.3258C431.039 34.3258 453.376 61.3258 441.039 96.8258C362.639 322.426 343.539 375.326 340.539 384.826C338.486 391.326 342.039 391.326 345.539 391.326C377.039 391.326 386.539 418.326 386.539 435.326C386.539 458.826 371.539 477.326 350.039 477.326H214.539C179.039 477.326 85.8269 431.3 88.0387 335.826C91.0387 206.326 192.039 183.326 243.539 183.326H296.539L265.539 272.326H243.539C185.539 272.326 174.113 314.826 176.039 334.326C180.039 374.826 215.039 389.814 237.039 390.326C244.539 390.5 246.039 386.826 248.039 381.326Z\"}})])]),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"データ放送\")])],1)],1),_c('v-list-item',{staticClass:\"px-4 mb-1\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/capture\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:image-multiple-16-filled\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"キャプチャ\")])],1)],1),_c('v-list-item',{staticClass:\"px-4 mb-1\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/account\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:person-20-filled\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"アカウント\")])],1)],1),_c('v-list-item',{staticClass:\"px-4 mb-1\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/jikkyo\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{staticStyle:{\"padding\":\"0 2px\"},attrs:{\"icon\":\"bi:chat-left-text-fill\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"ニコニコ実況\")])],1)],1),_c('v-list-item',{staticClass:\"px-4 mb-1\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/twitter\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{staticStyle:{\"padding\":\"0 1px\"},attrs:{\"icon\":\"fa-brands:twitter\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"Twitter\")])],1)],1),_c('v-list-item',{staticClass:\"px-4 mb-1\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/server\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:server-surface-16-filled\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"サーバー設定\")])],1)],1)],1)],1)],1),_c('v-card',{staticClass:\"settings ml-5 px-7 py-7 lighten-1\",attrs:{\"width\":\"100%\"}},[_vm._t(\"default\")],2)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"route-container\">\r\n        <Header/>\r\n        <main>\r\n            <Navigation/>\r\n            <v-card class=\"settings-container d-flex px-5 py-5 mx-auto background\" elevation=\"0\" width=\"100%\" max-width=\"1000\">\r\n                <div><!-- ← position: sticky; を効かせるためのボックス -->\r\n                    <v-navigation-drawer permanent class=\"settings-navigation flex-shrink-0 background\" width=\"195\" height=\"auto\">\r\n                        <v-list-item class=\"px-4\">\r\n                            <v-list-item-content>\r\n                                <h1>設定</h1>\r\n                            </v-list-item-content>\r\n                        </v-list-item>\r\n                        <v-list nav class=\"mt-3 px-0 py-0\">\r\n                            <v-list-item link color=\"primary\" class=\"px-4 mb-1\" to=\"/settings/general\">\r\n                                <v-list-item-icon class=\"mr-4\">\r\n                                    <Icon icon=\"fa-solid:sliders-h\" width=\"26px\" style=\"padding: 0 3px;\" />\r\n                                </v-list-item-icon>\r\n                                <v-list-item-content>\r\n                                    <v-list-item-title>全般</v-list-item-title>\r\n                                </v-list-item-content>\r\n                            </v-list-item>\r\n                            <v-list-item link color=\"primary\" class=\"px-4 mb-1\" to=\"/settings/quality\">\r\n                                <v-list-item-icon class=\"mr-4\">\r\n                                    <Icon icon=\"fluent:video-clip-multiple-16-filled\" width=\"26px\" />\r\n                                </v-list-item-icon>\r\n                                <v-list-item-content>\r\n                                    <v-list-item-title>画質</v-list-item-title>\r\n                                </v-list-item-content>\r\n                            </v-list-item>\r\n                            <v-list-item link color=\"primary\" class=\"px-4 mb-1\" to=\"/settings/caption\">\r\n                                <v-list-item-icon class=\"mr-4\">\r\n                                    <Icon icon=\"fluent:subtitles-16-filled\" width=\"26px\" />\r\n                                </v-list-item-icon>\r\n                                <v-list-item-content>\r\n                                    <v-list-item-title>字幕</v-list-item-title>\r\n                                </v-list-item-content>\r\n                            </v-list-item>\r\n                            <v-list-item link color=\"primary\" class=\"px-4 mb-1\" to=\"/settings/data-broadcasting\">\r\n                                <v-list-item-icon class=\"mr-4\">\r\n                                    <svg width=\"26px\" height=\"26px\" viewBox=\"0 0 512 512\">\r\n                                        <path fill=\"currentColor\" d=\"M248.039 381.326L355.039 67.8258C367.539 28.3257 395.039 34.3258 406.539 34.3258C431.039 34.3258 453.376 61.3258 441.039 96.8258C362.639 322.426 343.539 375.326 340.539 384.826C338.486 391.326 342.039 391.326 345.539 391.326C377.039 391.326 386.539 418.326 386.539 435.326C386.539 458.826 371.539 477.326 350.039 477.326H214.539C179.039 477.326 85.8269 431.3 88.0387 335.826C91.0387 206.326 192.039 183.326 243.539 183.326H296.539L265.539 272.326H243.539C185.539 272.326 174.113 314.826 176.039 334.326C180.039 374.826 215.039 389.814 237.039 390.326C244.539 390.5 246.039 386.826 248.039 381.326Z\" />\r\n                                    </svg>\r\n                                </v-list-item-icon>\r\n                                <v-list-item-content>\r\n                                    <v-list-item-title>データ放送</v-list-item-title>\r\n                                </v-list-item-content>\r\n                            </v-list-item>\r\n                            <v-list-item link color=\"primary\" class=\"px-4 mb-1\" to=\"/settings/capture\">\r\n                                <v-list-item-icon class=\"mr-4\">\r\n                                    <Icon icon=\"fluent:image-multiple-16-filled\" width=\"26px\" />\r\n                                </v-list-item-icon>\r\n                                <v-list-item-content>\r\n                                    <v-list-item-title>キャプチャ</v-list-item-title>\r\n                                </v-list-item-content>\r\n                            </v-list-item>\r\n                            <v-list-item link color=\"primary\" class=\"px-4 mb-1\" to=\"/settings/account\">\r\n                                <v-list-item-icon class=\"mr-4\">\r\n                                    <Icon icon=\"fluent:person-20-filled\" width=\"26px\" />\r\n                                </v-list-item-icon>\r\n                                <v-list-item-content>\r\n                                    <v-list-item-title>アカウント</v-list-item-title>\r\n                                </v-list-item-content>\r\n                            </v-list-item>\r\n                            <v-list-item link color=\"primary\" class=\"px-4 mb-1\" to=\"/settings/jikkyo\">\r\n                                <v-list-item-icon class=\"mr-4\">\r\n                                    <Icon icon=\"bi:chat-left-text-fill\" width=\"26px\" style=\"padding: 0 2px;\" />\r\n                                </v-list-item-icon>\r\n                                <v-list-item-content>\r\n                                    <v-list-item-title>ニコニコ実況</v-list-item-title>\r\n                                </v-list-item-content>\r\n                            </v-list-item>\r\n                            <v-list-item link color=\"primary\" class=\"px-4 mb-1\" to=\"/settings/twitter\">\r\n                                <v-list-item-icon class=\"mr-4\">\r\n                                    <Icon icon=\"fa-brands:twitter\" width=\"26px\" style=\"padding: 0 1px;\" />\r\n                                </v-list-item-icon>\r\n                                <v-list-item-content>\r\n                                    <v-list-item-title>Twitter</v-list-item-title>\r\n                                </v-list-item-content>\r\n                            </v-list-item>\r\n                            <v-list-item link color=\"primary\" class=\"px-4 mb-1\" to=\"/settings/server\">\r\n                                <v-list-item-icon class=\"mr-4\">\r\n                                    <Icon icon=\"fluent:server-surface-16-filled\" width=\"26px\" />\r\n                                </v-list-item-icon>\r\n                                <v-list-item-content>\r\n                                    <v-list-item-title>サーバー設定</v-list-item-title>\r\n                                </v-list-item-content>\r\n                            </v-list-item>\r\n                        </v-list>\r\n                    </v-navigation-drawer>\r\n                </div>\r\n                <v-card class=\"settings ml-5 px-7 py-7 lighten-1\" width=\"100%\">\r\n                    <!-- この slot にそれぞれの設定画面の内容が入る -->\r\n                    <slot></slot>\r\n                </v-card>\r\n            </v-card>\r\n        </main>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { defineComponent } from 'vue';\r\n\r\nimport Header from '@/components/Header.vue';\r\nimport Navigation from '@/components/Navigation.vue';\r\n\r\n// 設定のベース画面なので、ロジックは基本置かない\r\nexport default defineComponent({\r\n    name: 'Settings-Base',\r\n    components: {\r\n        Header,\r\n        Navigation,\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.settings-container {\r\n    width: 100%;\r\n    min-width: 0;\r\n    @include smartphone-horizontal {\r\n        padding: 16px 20px !important;\r\n    }\r\n    @include smartphone-horizontal-short {\r\n        padding: 16px 16px !important;\r\n    }\r\n    @include smartphone-vertical {\r\n        padding: 0px 0px !important;\r\n    }\r\n\r\n    .settings-navigation {\r\n        position: sticky;\r\n        top: calc(65px + 20px) !important;  // ヘッダー+余白の高さ\r\n\r\n        // タブレット縦画面・スマホ横画面・スマホ縦画面では表示しない\r\n        @include tablet-vertical {\r\n            display: none;\r\n        }\r\n        @include smartphone-horizontal {\r\n            display: none;\r\n        }\r\n        @include smartphone-vertical {\r\n            display: none;\r\n        }\r\n\r\n        .v-list-item--link, .v-list-item--link:before {\r\n            border-radius: 11px !important;\r\n        }\r\n    }\r\n\r\n    // :deep() で子コンポーネント（それぞれの設定画面）にも CSS が効くようにする\r\n    // ref: https://qiita.com/buntafujikawa/items/b1703a2a4344fd326fe0\r\n    .settings :deep() {\r\n        width: 100%;\r\n        min-width: 0;\r\n        border-radius: 11px !important;\r\n        background-color: var(--v-background-lighten1);\r\n        @include tablet-vertical {\r\n            margin-left: 0 !important;\r\n            padding-top: 20px !important;\r\n            padding-left: 20px !important;\r\n            padding-right: 20px !important;\r\n        }\r\n        @include smartphone-horizontal {\r\n            padding: 20px !important;\r\n            margin-left: 0 !important;\r\n        }\r\n        @include smartphone-vertical {\r\n            margin-left: 0 !important;\r\n        }\r\n        @include smartphone-vertical {\r\n            padding-top: 60px !important;\r\n            padding-left: 16px !important;\r\n            padding-right: 16px !important;\r\n            border-radius: 0 !important;\r\n            background-color: var(--v-background-base);\r\n        }\r\n\r\n        .settings__heading {\r\n            display: flex;\r\n            align-items: center;\r\n            font-size: 22px;\r\n            @include smartphone-horizontal {\r\n                font-size: 20px;\r\n            }\r\n            @include smartphone-vertical {\r\n                position: fixed;\r\n                top: 0;\r\n                left: 0;\r\n                right: 0;\r\n                height: 60px;\r\n                padding: 16px;\r\n                border-radius: 0;\r\n                background: var(--v-background-lighten1);\r\n                box-shadow: 0px 3px 14px 2px rgb(0 0 0 / 12%);\r\n                z-index: 5;\r\n            }\r\n\r\n            .settings__back-button {\r\n                display: none;\r\n                position: relative;\r\n                left: -6px;\r\n                padding: 6px;\r\n                border-radius: 50%;\r\n                color: var(--v-text-base);\r\n                @include tablet-vertical {\r\n                    display: flex;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    display: flex;\r\n                }\r\n                @include smartphone-vertical {\r\n                    display: flex;\r\n                }\r\n            }\r\n\r\n            .settings__back-button + svg {\r\n                @include tablet-vertical {\r\n                    display: none;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    display: none;\r\n                }\r\n                @include smartphone-vertical {\r\n                    display: none;\r\n                }\r\n            }\r\n\r\n            .settings__back-button + svg + span {\r\n                @include tablet-vertical {\r\n                    margin-left: 0px !important;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    margin-left: 0px !important;\r\n                }\r\n                @include smartphone-vertical {\r\n                    margin-left: 0px !important;\r\n                }\r\n            }\r\n        }\r\n\r\n        .settings__content {\r\n            margin-top: 24px;\r\n            @include smartphone-horizontal {\r\n                margin-top: 16px;\r\n            }\r\n\r\n            .settings__item {\r\n                display: flex;\r\n                position: relative;\r\n                flex-direction: column;\r\n                margin-top: 24px;\r\n                @include smartphone-horizontal {\r\n                    margin-top: 16px;\r\n                }\r\n\r\n                &--sync-disabled {\r\n                    .settings__item-heading {\r\n                        padding-right: 8px;\r\n                        &:after {\r\n                            content: 'デバイス間同期無効';\r\n                            display: flex;\r\n                            align-items: center;\r\n                            flex-shrink: 0;\r\n                            position: relative;\r\n                            right: -8px;\r\n                            padding: 2px 4px;\r\n                            margin-left: auto;\r\n                            border-radius: 4px;\r\n                            background: var(--v-background-lighten2);\r\n                            font-size: 11px;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                &--switch {\r\n                    margin-right: 62px;\r\n\r\n                    .settings__item-heading {\r\n                        width: calc(100% + 62px);\r\n                    }\r\n\r\n                    .settings__item-heading, .settings__item-label {\r\n                        cursor: pointer;\r\n                    }\r\n                }\r\n\r\n                &--disabled {\r\n                    opacity: 0.5;\r\n                }\r\n\r\n                &-heading {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    color: var(--v-text-base);\r\n                    font-size: 16.5px;\r\n                    @include smartphone-horizontal {\r\n                        font-size: 15px;\r\n                    }\r\n                }\r\n                &-label {\r\n                    margin-top: 8px;\r\n                    color: var(--v-text-darken1);\r\n                    font-size: 13.5px;\r\n                    line-height: 1.6;\r\n                    @include smartphone-horizontal {\r\n                        font-size: 11px;\r\n                        line-height: 1.7;\r\n                    }\r\n                }\r\n                &-form {\r\n                    margin-top: 14px;\r\n                    @include smartphone-horizontal {\r\n                        font-size: 13.5px;\r\n                    }\r\n                }\r\n                &-switch {\r\n                    align-items: center;\r\n                    position: absolute;\r\n                    top: 0;\r\n                    right: -74px;\r\n                    bottom: 0;\r\n                    margin-top: 0;\r\n                }\r\n\r\n                p {\r\n                    margin-bottom: 8px;\r\n                    &:last-of-type {\r\n                        margin-bottom: 0px;\r\n                    }\r\n                }\r\n            }\r\n\r\n            .settings__save-button {\r\n                max-width: 100%;\r\n                height: 45px;\r\n                background: var(--v-background-lighten2);\r\n                font-size: 15.5px;\r\n                letter-spacing: 0;\r\n                @include smartphone-horizontal {\r\n                    height: 40px;\r\n                    padding: 0 12px;\r\n                    font-size: 14px;\r\n                }\r\n                @include smartphone-vertical-short {\r\n                    font-size: 14px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Base.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Base.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Base.vue?vue&type=template&id=a3aa94f6&scoped=true\"\nimport script from \"./Base.vue?vue&type=script&lang=ts\"\nexport * from \"./Base.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Base.vue?vue&type=style&index=0&id=a3aa94f6&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a3aa94f6\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <!-- ベース画面の中にそれぞれの設定画面で異なる部分を記述する -->\r\n    <SettingsBase>\r\n        <h2 class=\"settings__heading\">\r\n            <router-link v-ripple class=\"settings__back-button\" to=\"/settings/\">\r\n                <Icon icon=\"fluent:arrow-left-12-filled\" width=\"25px\" />\r\n            </router-link>\r\n            <Icon icon=\"fluent:person-20-filled\" width=\"25px\" />\r\n            <span class=\"ml-2\">アカウント</span>\r\n        </h2>\r\n        <div class=\"settings__content\" :class=\"{'settings__content--loading': is_loading}\">\r\n            <div class=\"account\" v-if=\"userStore.user === null\">\r\n                <div class=\"account-wrapper\">\r\n                    <img class=\"account__icon\" src=\"/assets/images/account-icon-default.png\">\r\n                    <div class=\"account__info\">\r\n                        <div class=\"account__info-name\">\r\n                            <span class=\"account__info-name-text\">ログインしていません</span>\r\n                        </div>\r\n                        <span class=\"account__info-id\">Not logged in</span>\r\n                    </div>\r\n                </div>\r\n                <v-btn class=\"account__login ml-auto\" color=\"secondary\" width=\"140\" height=\"56\" depressed to=\"/login/\">\r\n                    <Icon icon=\"fa:sign-in\" class=\"mr-2\" />ログイン\r\n                </v-btn>\r\n            </div>\r\n            <div class=\"account\" v-if=\"userStore.user !== null\">\r\n                <div class=\"account-wrapper\">\r\n                    <img class=\"account__icon\" :src=\"userStore.user_icon_url ?? ''\">\r\n                    <div class=\"account__info\">\r\n                        <div class=\"account__info-name\">\r\n                            <span class=\"account__info-name-text\">{{userStore.user.name}}</span>\r\n                            <span class=\"account__info-admin\" v-if=\"userStore.user.is_admin\">管理者</span>\r\n                        </div>\r\n                        <span class=\"account__info-id\">User ID: {{userStore.user.id}}</span>\r\n                    </div>\r\n                </div>\r\n                <v-btn class=\"account__login ml-auto\" color=\"secondary\" width=\"140\" height=\"56\" depressed @click=\"userStore.logout()\">\r\n                    <Icon icon=\"fa:sign-out\" class=\"mr-2\" />ログアウト\r\n                </v-btn>\r\n            </div>\r\n            <div class=\"account-register\" v-if=\"userStore.is_logged_in === false\">\r\n                <div class=\"account-register__heading\">\r\n                    KonomiTV アカウントにログインすると、<br>より便利な機能が使えます！\r\n                </div>\r\n                <div class=\"account-register__feature\">\r\n                    <div class=\"account-feature\">\r\n                        <Icon class=\"account-feature__icon\" icon=\"bi:chat-left-text-fill\" />\r\n                        <div class=\"account-feature__info\">\r\n                            <span class=\"account-feature__info-heading\">ニコニコ実況にコメントする</span>\r\n                            <span class=\"account-feature__info-text\">テレビを見ながらニコニコ実況にコメントできます。別途、ニコニコアカウントとの連携が必要です。</span>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"account-feature\">\r\n                        <Icon class=\"account-feature__icon\" icon=\"fa-brands:twitter\" />\r\n                        <div class=\"account-feature__info\">\r\n                            <span class=\"account-feature__info-heading\">Twitter 連携機能</span>\r\n                            <span class=\"account-feature__info-text\">テレビを見ながら Twitter にツイートしたり、検索したツイートをリアルタイムで表示できます。別途、Twitter アカウントとの連携が必要です。</span>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"account-feature\">\r\n                        <Icon class=\"account-feature__icon\" icon=\"fluent:arrow-sync-20-filled\" />\r\n                        <div class=\"account-feature__info\">\r\n                            <span class=\"account-feature__info-heading\">設定をデバイス間で同期</span>\r\n                            <span class=\"account-feature__info-text\">ピン留めしたチャンネルなど、ブラウザに保存されている各種設定をブラウザやデバイスをまたいで同期できます。</span>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"account-feature\">\r\n                        <Icon class=\"account-feature__icon\" icon=\"fa-solid:sliders-h\" />\r\n                        <div class=\"account-feature__info\">\r\n                            <span class=\"account-feature__info-heading\">サーバー設定をブラウザから変更</span>\r\n                            <span class=\"account-feature__info-text\">管理者権限があれば、サーバー設定をブラウザから変更できます。一番最初に作成されたアカウントには、自動で管理者権限が付与されます。</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"account-register__description\">\r\n                    KonomiTV アカウントの作成に必要なものは<br class=\"smartphone-vertical-only\">ユーザー名とパスワードだけです。<br>\r\n                    アカウントはローカルに導入した<br class=\"smartphone-vertical-only\"> KonomiTV サーバーにのみ保存されます。<br>\r\n                    外部のサービスには保存されませんので、ご安心ください。<br>\r\n                </div>\r\n                <v-btn class=\"account-register__button\" color=\"secondary\" width=\"100%\" max-width=\"250\" height=\"50\" depressed to=\"/register/\">\r\n                    <Icon icon=\"fluent:person-add-20-filled\" class=\"mr-2\" height=\"24\" />アカウントを作成\r\n                </v-btn>\r\n            </div>\r\n            <div v-if=\"userStore.is_logged_in === true\">\r\n                <div class=\"settings__item settings__item--switch\">\r\n                    <label class=\"settings__item-heading\" for=\"sync_settings\">設定をデバイス間で同期する</label>\r\n                    <label class=\"settings__item-label\" for=\"sync_settings\">\r\n                        KonomiTV では、設定を同じアカウントでログインしているデバイス間で同期できます！<br>\r\n                        同期をオンにすると、同期をオンにしているすべてのデバイスで共通の設定が使えます。ピン留めチャンネルやハッシュタグリストなども同期されます。<br>\r\n                        なお、デバイス固有の設定（画質設定など）は、同期後も各デバイスで個別に反映されます。<br>\r\n                    </label>\r\n                    <v-switch class=\"settings__item-switch\" id=\"sync_settings\" inset hide-details\r\n                        v-model=\"sync_settings\">\r\n                    </v-switch>\r\n                </div>\r\n                <v-dialog max-width=\"530\" v-model=\"sync_settings_dialog\">\r\n                    <v-card>\r\n                        <v-card-title class=\"justify-center\">設定データの競合</v-card-title>\r\n                        <v-card-text>\r\n                            このデバイスの設定と、サーバーに保存されている設定が競合しています。<br>\r\n                            一度上書きすると、元に戻すことはできません。慎重に選択してください。<br>\r\n                        </v-card-text>\r\n                        <div class=\"d-flex flex-column px-4 pb-4 settings__conflict-dialog\">\r\n                            <v-btn class=\"settings__save-button error--text text--lighten-1\" depressed\r\n                                @click=\"overrideServerSettingsFromClient()\">\r\n                                <Icon icon=\"fluent:document-arrow-up-16-filled\" class=\"mr-2\" height=\"22px\" />\r\n                                サーバーに保存されている設定を、<br class=\"smartphone-vertical-only\">このデバイスの設定で上書きする\r\n                            </v-btn>\r\n                            <v-btn class=\"settings__save-button error--text text--lighten-1 mt-3\" depressed\r\n                                @click=\"overrideClientSettingsFromServer()\">\r\n                                <Icon icon=\"fluent:document-arrow-down-16-filled\" class=\"mr-2\" height=\"22px\" />\r\n                                このデバイスの設定を、<br class=\"smartphone-vertical-only\">サーバーに保存されている設定で上書きする\r\n                            </v-btn>\r\n                            <v-btn class=\"settings__save-button mt-3\" depressed @click=\"sync_settings_dialog = false\">\r\n                                <Icon icon=\"fluent:dismiss-16-filled\" class=\"mr-2\" height=\"22px\" />\r\n                                キャンセル\r\n                            </v-btn>\r\n                        </div>\r\n                    </v-card>\r\n                </v-dialog>\r\n                <v-form class=\"settings__item\" ref=\"settings_username\" @submit.prevent>\r\n                    <div class=\"settings__item-heading\">ユーザー名</div>\r\n                    <div class=\"settings__item-label\">\r\n                        KonomiTV アカウントのユーザー名を設定します。アルファベットだけでなく日本語や記号も使えます。<br>\r\n                        同じ KonomiTV サーバー上の他のアカウントと同じユーザー名には変更できません。<br>\r\n                    </div>\r\n                    <v-text-field class=\"settings__item-form\" outlined placeholder=\"ユーザー名\"\r\n                        :dense=\"is_form_dense\"\r\n                        v-model=\"settings_username\"\r\n                        :rules=\"[settings_username_validation]\">\r\n                    </v-text-field>\r\n                </v-form>\r\n                <v-btn class=\"settings__save-button\" depressed @click=\"updateAccountInfo('username')\">\r\n                    <Icon icon=\"fluent:save-16-filled\" class=\"mr-2\" height=\"24px\" />ユーザー名を更新\r\n                </v-btn>\r\n                <v-form class=\"settings__item\" @submit.prevent>\r\n                    <div class=\"settings__item-heading\">アイコン画像</div>\r\n                    <div class=\"settings__item-label\">\r\n                        KonomiTV アカウントのアイコン画像を設定します。<br>\r\n                        アップロードされた画像は自動で 400×400 の正方形にリサイズされます。<br>\r\n                    </div>\r\n                    <v-file-input class=\"settings__item-form\" outlined hide-details placeholder=\"アイコン画像を選択\"\r\n                        :dense=\"is_form_dense\"\r\n                        accept=\"image/jpeg, image/png\"\r\n                        prepend-icon=\"\"\r\n                        prepend-inner-icon=\"mdi-paperclip\"\r\n                        v-model=\"settings_icon\">\r\n                    </v-file-input>\r\n                </v-form>\r\n                <v-btn class=\"settings__save-button mt-5\" depressed @click=\"updateAccountIcon()\">\r\n                    <Icon icon=\"fluent:save-16-filled\" class=\"mr-2\" height=\"24px\" />アイコン画像を更新\r\n                </v-btn>\r\n                <v-form class=\"settings__item\" ref=\"settings_password\" @submit.prevent>\r\n                    <div class=\"settings__item-heading\">新しいパスワード</div>\r\n                    <div class=\"settings__item-label\">\r\n                        KonomiTV アカウントの新しいパスワードを設定します。<br>\r\n                    </div>\r\n                    <v-text-field class=\"settings__item-form\" outlined placeholder=\"新しいパスワード\"\r\n                        :dense=\"is_form_dense\"\r\n                        v-model=\"settings_password\"\r\n                        :type=\"settings_password_showing ? 'text' : 'password'\"\r\n                        :append-icon=\"settings_password_showing ? 'mdi-eye' : 'mdi-eye-off'\"\r\n                        :rules=\"[settings_password_validation]\"\r\n                        @click:append=\"settings_password_showing = !settings_password_showing\">\r\n                    </v-text-field>\r\n                </v-form>\r\n                <v-btn class=\"settings__save-button\" depressed @click=\"updateAccountInfo('password')\">\r\n                    <Icon icon=\"fluent:save-16-filled\" class=\"mr-2\" height=\"24px\" />パスワードを更新\r\n                </v-btn>\r\n                <v-divider class=\"mt-6\"></v-divider>\r\n                <div class=\"settings__item mt-6\">\r\n                    <div class=\"settings__item-heading error--text text--lighten-1\">アカウントを削除</div>\r\n                    <div class=\"settings__item-label\">\r\n                        現在ログインしている KonomiTV アカウントを削除します。<br>\r\n                        <b>アカウントに紐づくすべてのデータが削除されます。</b>元に戻すことはできません。<br>\r\n                    </div>\r\n                </div>\r\n                <v-dialog max-width=\"385\" v-model=\"account_delete_confirm_dialog\">\r\n                    <template v-slot:activator=\"{ on }\">\r\n                        <v-btn class=\"settings__save-button error mt-5\" depressed v-on=\"on\">\r\n                            <Icon icon=\"fluent:delete-16-filled\" class=\"mr-2\" height=\"24px\" />アカウントを削除\r\n                        </v-btn>\r\n                    </template>\r\n                    <v-card>\r\n                        <v-card-title class=\"justify-center pt-6 font-weight-bold\">本当にアカウントを削除しますか？</v-card-title>\r\n                        <v-card-text class=\"pt-2 pb-0\">\r\n                            アカウントに紐づくすべてのデータが削除されます。元に戻すことはできません。<br>\r\n                            本当にアカウントを削除しますか？\r\n                        </v-card-text>\r\n                        <v-card-actions class=\"pt-4 px-6 pb-5\">\r\n                            <v-spacer></v-spacer>\r\n                            <v-btn color=\"text\" text @click=\"account_delete_confirm_dialog = false\">キャンセル</v-btn>\r\n                            <v-btn color=\"error\" @click=\"deleteAccount()\">削除</v-btn>\r\n                        </v-card-actions>\r\n                    </v-card>\r\n                </v-dialog>\r\n            </div>\r\n        </div>\r\n    </SettingsBase>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport Message from '@/message';\r\nimport Settings from '@/services/Settings';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport useUserStore from '@/stores/UserStore';\r\nimport Utils from '@/utils';\r\nimport SettingsBase from '@/views/Settings/Base.vue';\r\n\r\nexport default defineComponent({\r\n    name: 'Settings-Account',\r\n    components: {\r\n        SettingsBase,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // フォームを小さくするかどうか\r\n            is_form_dense: Utils.isSmartphoneHorizontal(),\r\n\r\n            // ローディング中かどうか\r\n            is_loading: true,\r\n\r\n            // ユーザー名とパスワード\r\n            // ログイン画面やアカウント作成画面の data と同一のもの\r\n            settings_username: null as string | null,\r\n            settings_username_validation: (value: string | null) => {\r\n                if (value === '' || value === null) return 'ユーザー名を入力してください。';\r\n                if (/^.{2,}$/.test(value) === false) return 'ユーザー名は2文字以上で入力してください。';\r\n                return true;\r\n            },\r\n            settings_password: null as string | null,\r\n            settings_password_showing: false,\r\n            settings_password_validation: (value: string | null) => {\r\n                if (value === '' || value === null) return 'パスワードを入力してください。';\r\n                // 正規表現の参考: https://qiita.com/grrrr/items/0b35b5c1c98eebfa5128\r\n                if (/^[a-zA-Z0-9!-/:-@¥[-`{-~]{4,}$/.test(value) === false) return 'パスワードは4文字以上の半角英数記号を入力してください。';\r\n                return true;\r\n            },\r\n\r\n            // アップロードするアイコン画像\r\n            settings_icon: null as File | null,\r\n\r\n            // アカウント削除確認ダイヤログ\r\n            account_delete_confirm_dialog: false,\r\n\r\n            // 設定を同期するかの設定値\r\n            sync_settings: useSettingsStore().settings.sync_settings as boolean,\r\n\r\n            // 設定を同期するときのダイヤログ\r\n            sync_settings_dialog: false,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useSettingsStore, useUserStore),\r\n    },\r\n    watch: {\r\n        // sync_settings の値の変更を監視する\r\n        async sync_settings() {\r\n\r\n            // 同期がオンになった & ダイヤログが表示されていない\r\n            if (this.sync_settings === true && this.sync_settings_dialog === false) {\r\n\r\n                // 同期対象の設定キーのみで設定データをまとめ直す\r\n                const sync_settings = this.settingsStore.getSyncableClientSettings();\r\n\r\n                // 同期対象のこのクライアントの設定を再度 JSON にする（文字列比較のため）\r\n                const sync_settings_json = JSON.stringify(sync_settings);\r\n\r\n                // サーバーから設定データをダウンロード\r\n                // 一度オブジェクトに戻したものをを再度 JSON にする（文字列比較のため）\r\n                const server_sync_settings = await Settings.fetchClientSettings();\r\n                if (server_sync_settings === null) {\r\n                    Message.error('サーバーから設定データを取得できませんでした。');\r\n                    return;\r\n                }\r\n                const server_sync_settings_json = JSON.stringify(server_sync_settings);\r\n\r\n                // このクライアントの設定とサーバーに保存されている設定が一致しない（=競合している）\r\n                if (sync_settings_json !== server_sync_settings_json) {\r\n\r\n                    // 一度同期のスイッチをオフにして、クライアントとサーバーどちらの設定を使うのかを選択させるダイヤログを表示\r\n                    this.sync_settings_dialog = true;\r\n                    this.sync_settings = false;\r\n\r\n                // このクライアントの設定とサーバーに保存されている設定が一致する\r\n                } else {\r\n\r\n                    // 特に設定の同期をオンにしても問題ないので、そのまま有効にする\r\n                    this.settingsStore.settings.sync_settings = true;\r\n                }\r\n\r\n            // 同期がオフになった & ダイヤログが表示されていない\r\n            } else if (this.sync_settings === false && this.sync_settings_dialog === false) {\r\n                this.settingsStore.settings.sync_settings = false;\r\n            }\r\n        }\r\n    },\r\n    async created() {\r\n\r\n        // アカウント情報を更新\r\n        await this.userStore.fetchUser();\r\n\r\n        // ローディング状態を解除\r\n        this.is_loading = false;\r\n    },\r\n    methods: {\r\n\r\n        // このクライアントの設定でサーバー上の設定を上書きする\r\n        async overrideServerSettingsFromClient() {\r\n\r\n            // 強制的にこのクライアントの設定をサーバーに同期\r\n            await this.settingsStore.syncClientSettingsToServer(true);\r\n\r\n            // 設定の同期を有効化\r\n            this.settingsStore.settings.sync_settings = true;\r\n            this.sync_settings = true;\r\n\r\n            // ダイヤログを閉じる\r\n            this.sync_settings_dialog = false;\r\n        },\r\n\r\n        // サーバー上の設定でこのクライアントの設定を上書きする\r\n        async overrideClientSettingsFromServer() {\r\n\r\n            // 強制的にサーバーに保存されている設定データをこのクライアントに同期する\r\n            // 設定の同期を有効化する前に実行しておくのが重要\r\n            await this.settingsStore.syncClientSettingsFromServer(true);\r\n\r\n            // 設定の同期を有効化\r\n            // 値を変更した時点で設定データがサーバーにアップロードされてしまうので、\r\n            // それよりも前に syncClientSettingsFromServer(true) でサーバー上の設定データを同期させておく必要がある\r\n            // さもなければ、サーバー上の設定データがこのクライアントの設定で上書きされてしまい、overrideServerSettingsFromClient() と同じ挙動になってしまう\r\n            this.settingsStore.settings.sync_settings = true;\r\n            this.sync_settings = true;\r\n\r\n            // ダイヤログを閉じる\r\n            this.sync_settings_dialog = false;\r\n        },\r\n\r\n        async updateAccountInfo(update_type: 'username' | 'password') {\r\n\r\n            // すべてのバリデーションが通過したときのみ\r\n            // ref: https://qiita.com/Hijiri_Ishi/items/56cac99c8f3806a6fa24\r\n            if (update_type === 'username') {\r\n                if ((this.$refs.settings_username as any).validate() === false) return;\r\n            } else {\r\n                if ((this.$refs.settings_password as any).validate() === false) return;\r\n            }\r\n\r\n            // アカウント情報の更新処理 (エラーハンドリングを含む) を実行\r\n            if (update_type === 'username') {\r\n                if (this.settings_username === null) return;\r\n                await this.userStore.updateUser({username: this.settings_username});\r\n            } else {\r\n                if (this.settings_password === null) return;\r\n                await this.userStore.updateUser({password: this.settings_password});\r\n            }\r\n        },\r\n\r\n        async updateAccountIcon() {\r\n\r\n            // アイコン画像が選択されていないなら更新しない\r\n            if (this.settings_icon === null) {\r\n                Message.error('アップロードする画像を選択してください！');\r\n                return;\r\n            }\r\n\r\n            // アイコン画像の更新処理 (エラーハンドリングを含む) を実行\r\n            await this.userStore.updateUserIcon(this.settings_icon);\r\n        },\r\n\r\n        async deleteAccount() {\r\n\r\n            // ダイヤログを閉じる\r\n            this.account_delete_confirm_dialog = false;\r\n\r\n            // アカウント削除処理 (エラーハンドリングを含む) を実行\r\n            await this.userStore.deleteUser();\r\n        }\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.settings__content {\r\n    opacity: 1;\r\n    transition: opacity 0.4s;\r\n\r\n    &--loading {\r\n        opacity: 0;\r\n    }\r\n}\r\n\r\n.settings__conflict-dialog {\r\n    .v-btn {\r\n        @include smartphone-vertical {\r\n            height: 50px !important;\r\n            text-align: left;\r\n        }\r\n        br.smartphone-vertical-only {\r\n            display: none;\r\n            @include smartphone-vertical {\r\n                display: inline;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n.account {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 130px;\r\n    padding: 18px 20px;\r\n    border-radius: 15px;\r\n    background: var(--v-background-lighten2);\r\n    @include tablet-horizontal {\r\n        align-items: normal;\r\n        flex-direction: column;\r\n        height: auto;\r\n        padding: 16px;\r\n    }\r\n    @include tablet-vertical {\r\n        align-items: normal;\r\n        flex-direction: column;\r\n        height: auto;\r\n        padding: 16px;\r\n    }\r\n    @include smartphone-horizontal {\r\n        align-items: normal;\r\n        flex-direction: column;\r\n        height: auto;\r\n        padding: 16px;\r\n        border-radius: 10px;\r\n    }\r\n    @include smartphone-vertical {\r\n        align-items: normal;\r\n        flex-direction: column;\r\n        height: auto;\r\n        padding: 16px 12px;\r\n        border-radius: 10px;\r\n    }\r\n\r\n    &-wrapper {\r\n        display: flex;\r\n        align-items: center;\r\n        min-width: 0;\r\n        height: 94px;\r\n        @include smartphone-horizontal {\r\n            height: 80px;\r\n        }\r\n        @include smartphone-vertical {\r\n            height: 70px;\r\n        }\r\n    }\r\n\r\n    &__icon {\r\n        flex-shrink: 0;\r\n        min-width: 94px;\r\n        height: 100%;\r\n        border-radius: 50%;\r\n        object-fit: cover;\r\n        // 読み込まれるまでのアイコンの背景\r\n        background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n        // 低解像度で表示する画像がぼやけないようにする\r\n        // ref: https://sho-log.com/chrome-image-blurred/\r\n        image-rendering: -webkit-optimize-contrast;\r\n        @include smartphone-horizontal {\r\n            min-width: 80px;\r\n        }\r\n        @include smartphone-vertical {\r\n            min-width: 70px;\r\n        }\r\n    }\r\n\r\n    &__info {\r\n        display: flex;\r\n        flex-direction: column;\r\n        min-width: 0;\r\n        margin-left: 20px;\r\n        margin-right: 12px;\r\n        @include smartphone-vertical {\r\n            margin-left: 12px !important;\r\n            margin-right: 0 !important;\r\n        }\r\n\r\n        &-name {\r\n            display: inline-flex;\r\n            align-items: center;\r\n            height: 33px;\r\n\r\n            &-text {\r\n                display: inline-block;\r\n                font-size: 23px;\r\n                color: var(--v-text-base);\r\n                font-weight: bold;\r\n                overflow: hidden;\r\n                white-space: nowrap;\r\n                text-overflow: ellipsis;  // はみ出た部分を … で省略\r\n                @include smartphone-horizontal {\r\n                    font-size: 21px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    font-size: 20px;\r\n                }\r\n            }\r\n        }\r\n\r\n        &-admin {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            flex-shrink: 0;\r\n            width: 52px;\r\n            height: 28px;\r\n            margin-left: 10px;\r\n            border-radius: 5px;\r\n            background: var(--v-secondary-base);\r\n            font-size: 14px;\r\n            font-weight: 500;\r\n            line-height: 2;\r\n            @include smartphone-horizontal {\r\n                width: 45px;\r\n                height: 24px;\r\n                border-radius: 4px;\r\n                font-size: 11.5px;\r\n            }\r\n            @include smartphone-vertical {\r\n                width: 45px;\r\n                height: 24px;\r\n                border-radius: 4px;\r\n                font-size: 11.5px;\r\n            }\r\n        }\r\n\r\n        &-id {\r\n            display: inline-block;\r\n            margin-top: 2px;\r\n            color: var(--v-text-darken1);\r\n            font-size: 16px;\r\n            @include smartphone-horizontal {\r\n                font-size: 14.5px;\r\n            }\r\n            @include smartphone-vertical {\r\n                font-size: 14.5px;\r\n            }\r\n        }\r\n    }\r\n\r\n    &__login {\r\n        border-radius: 7px;\r\n        font-size: 16px;\r\n        letter-spacing: 0;\r\n        @include tablet-horizontal {\r\n            height: 50px !important;\r\n            margin-top: 8px;\r\n            margin-right: auto;\r\n            font-size: 14.5px;\r\n        }\r\n        @include tablet-vertical {\r\n            height: 42px !important;\r\n            margin-top: 8px;\r\n            margin-right: auto;\r\n            font-size: 14.5px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            height: 42px !important;\r\n            margin-top: 8px;\r\n            margin-right: auto;\r\n            font-size: 14.5px;\r\n        }\r\n        @include smartphone-vertical {\r\n            height: 42px !important;\r\n            margin-top: 16px;\r\n            margin-right: auto;\r\n            font-size: 14.5px;\r\n        }\r\n    }\r\n}\r\n\r\n.account-register {\r\n    display: flex;\r\n    flex-direction: column;\r\n    margin-top: 28px;\r\n\r\n    &__heading {\r\n        font-size: 21px;\r\n        font-weight: bold;\r\n        text-align: center;\r\n        font-feature-settings: \"palt\" 1;  // 文字詰め\r\n        letter-spacing: 0.04em;  // 字間を少し空ける\r\n        @include smartphone-horizontal {\r\n            font-size: 19px;\r\n        }\r\n        @include smartphone-vertical {\r\n            font-size: 18px;\r\n        }\r\n    }\r\n\r\n    &__feature {\r\n        display: grid;\r\n        grid-template-columns: 1fr 1fr;\r\n        grid-row-gap: 18px;\r\n        grid-column-gap: 16px;\r\n        margin-top: 28px;\r\n        @include tablet-horizontal {\r\n            grid-template-columns: 1fr;\r\n        }\r\n        @include tablet-vertical {\r\n            grid-template-columns: 1fr;\r\n        }\r\n        @include smartphone-horizontal {\r\n            grid-template-columns: 1fr;\r\n        }\r\n        @include smartphone-vertical {\r\n            grid-template-columns: 1fr;\r\n        }\r\n\r\n        .account-feature {\r\n            display: flex;\r\n            align-items: center;\r\n\r\n            &__icon {\r\n                width: 46px;\r\n                height: 46px;\r\n                flex-shrink: 0;\r\n                margin-right: 16px;\r\n                color: var(--v-secondary-lighten1);\r\n            }\r\n\r\n            &__info {\r\n                display: flex;\r\n                flex-direction: column;\r\n                &-heading {\r\n                    font-size: 15px;\r\n                }\r\n                &-text {\r\n                    margin-top: 3px;\r\n                    color: var(--v-text-darken1);\r\n                    font-size: 12.5px;\r\n                    line-height: 1.65;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    &__description {\r\n        margin-top: 32px;\r\n        font-size: 15px;\r\n        line-height: 1.7;\r\n        text-align: center;\r\n        br.smartphone-vertical-only {\r\n            display: none;\r\n        }\r\n        @include tablet-horizontal {\r\n            font-size: 12.5px;\r\n        }\r\n        @include tablet-vertical {\r\n            font-size: 10.5px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            font-size: 12.5px;\r\n        }\r\n        @include smartphone-horizontal-short {\r\n            font-size: 10.5px;\r\n        }\r\n        @include smartphone-vertical {\r\n            font-size: 12.5px;\r\n            br.smartphone-vertical-only {\r\n                display: inline;\r\n            }\r\n        }\r\n    }\r\n\r\n    &__button {\r\n        margin-top: 24px;\r\n        margin-left: auto;\r\n        margin-right: auto;\r\n        border-radius: 7px;\r\n        font-size: 16px;\r\n        letter-spacing: 0;\r\n        @include tablet-vertical {\r\n            height: 42px !important;\r\n            font-size: 14.5px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            height: 42px !important;\r\n            font-size: 14.5px;\r\n        }\r\n        @include smartphone-vertical {\r\n            max-width: 210px !important;\r\n            height: 42px !important;\r\n            font-size: 15px;\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Account.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Account.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Account.vue?vue&type=template&id=70a71649&scoped=true\"\nimport script from \"./Account.vue?vue&type=script&lang=ts\"\nexport * from \"./Account.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Account.vue?vue&type=style&index=0&id=70a71649&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"70a71649\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('SettingsBase',[_c('h2',{staticClass:\"settings__heading\"},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"settings__back-button\",attrs:{\"to\":\"/settings/\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-left-12-filled\",\"width\":\"25px\"}})],1),_c('Icon',{attrs:{\"icon\":\"fluent:subtitles-16-filled\",\"width\":\"25px\"}}),_c('span',{staticClass:\"ml-3\"},[_vm._v(\"字幕\")])],1),_c('div',{staticClass:\"settings__content\"},[_c('div',{staticClass:\"settings__item\"},[_c('label',{staticClass:\"settings__item-heading\"},[_vm._v(\"字幕のフォント\")]),_c('label',{staticClass:\"settings__item-label\"},[_vm._v(\" プレイヤーで字幕表示をオンにしているときの、字幕のフォントを設定します。\"),_c('br')]),_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.caption_font},model:{value:(_vm.settingsStore.settings.caption_font),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"caption_font\", $$v)},expression:\"settingsStore.settings.caption_font\"}})],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"always_border_caption_text\"}},[_vm._v(\"字幕の文字を常に縁取りする\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"always_border_caption_text\"}},[_vm._v(\" 字幕表示時、縁取りをオンにすると、字幕が見やすくきれいになります。とくに理由がなければ、オンにしておくのがおすすめです。\"),_c('br'),_vm._v(\" この設定がオフのときも、字幕データ側で縁取りが指定されていれば、オンのときと同様に縁取り付きで描画されます。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"always_border_caption_text\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.always_border_caption_text),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"always_border_caption_text\", $$v)},expression:\"settingsStore.settings.always_border_caption_text\"}})],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"specify_caption_opacity\"}},[_vm._v(\"字幕の不透明度を指定する\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"specify_caption_opacity\"}},[_vm._v(\" 字幕表示時、不透明度を自分で指定するか設定できます。\"),_c('br'),_vm._v(\" この設定がオフのときは、字幕データ側で指定されている不透明度で描画します。とくに理由がなければ、オフにしておくのがおすすめです。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"specify_caption_opacity\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.specify_caption_opacity),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"specify_caption_opacity\", $$v)},expression:\"settingsStore.settings.specify_caption_opacity\"}})],1),_c('div',{staticClass:\"settings__item\",class:{'settings__item--disabled': _vm.settingsStore.settings.specify_caption_opacity === false}},[_c('label',{staticClass:\"settings__item-heading\"},[_vm._v(\"字幕の不透明度\")]),_c('label',{staticClass:\"settings__item-label\"},[_vm._v(\" 上の [字幕の不透明度を指定する] をオンに設定したときのみ有効です。不透明度を 0 に設定すれば、字幕の背景を非表示にできます。\"),_c('br')]),_c('div',{ref:\"caption_opacity\",staticClass:\"settings__item-label\"},[_c('v-slider',{staticClass:\"settings__item-form\",attrs:{\"ticks\":\"always\",\"thumb-label\":\"\",\"hide-details\":\"\",\"min\":0,\"max\":1,\"step\":0.05,\"disabled\":_vm.settingsStore.settings.specify_caption_opacity === false},model:{value:(_vm.settingsStore.settings.caption_opacity),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"caption_opacity\", $$v)},expression:\"settingsStore.settings.caption_opacity\"}})],1)]),_c('v-divider',{staticClass:\"mt-6\"}),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"tv_show_superimpose\"}},[_vm._v(\"テレビをみるときに文字スーパーを表示する\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"tv_show_superimpose\"}},[_vm._v(\" 文字スーパーは、緊急地震速報の赤テロップや、NHK BS のニュース速報のテロップなどで利用されています。とくに理由がなければ、オンにしておくのがおすすめです。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"tv_show_superimpose\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.tv_show_superimpose),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tv_show_superimpose\", $$v)},expression:\"settingsStore.settings.tv_show_superimpose\"}})],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"video_show_superimpose\"}},[_vm._v(\"ビデオをみるときに文字スーパーを表示する\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"video_show_superimpose\"}},[_vm._v(\" 文字スーパーは、緊急地震速報の赤テロップや、NHK BS のニュース速報のテロップなどで利用されています。録画当時の文字スーパーによるニュース速報を確認したい方以外は、オフにしておくのがおすすめです。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"video_show_superimpose\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.video_show_superimpose),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"video_show_superimpose\", $$v)},expression:\"settingsStore.settings.video_show_superimpose\"}})],1)],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <!-- ベース画面の中にそれぞれの設定画面で異なる部分を記述する -->\r\n    <SettingsBase>\r\n        <h2 class=\"settings__heading\">\r\n            <router-link v-ripple class=\"settings__back-button\" to=\"/settings/\">\r\n                <Icon icon=\"fluent:arrow-left-12-filled\" width=\"25px\" />\r\n            </router-link>\r\n            <Icon icon=\"fluent:subtitles-16-filled\" width=\"25px\" />\r\n            <span class=\"ml-3\">字幕</span>\r\n        </h2>\r\n        <div class=\"settings__content\">\r\n            <div class=\"settings__item\">\r\n                <label class=\"settings__item-heading\">字幕のフォント</label>\r\n                <label class=\"settings__item-label\">\r\n                    プレイヤーで字幕表示をオンにしているときの、字幕のフォントを設定します。<br>\r\n                </label>\r\n                <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\"\r\n                    :items=\"caption_font\" v-model=\"settingsStore.settings.caption_font\">\r\n                </v-select>\r\n            </div>\r\n            <div class=\"settings__item settings__item--switch\">\r\n                <label class=\"settings__item-heading\" for=\"always_border_caption_text\">字幕の文字を常に縁取りする</label>\r\n                <label class=\"settings__item-label\" for=\"always_border_caption_text\">\r\n                    字幕表示時、縁取りをオンにすると、字幕が見やすくきれいになります。とくに理由がなければ、オンにしておくのがおすすめです。<br>\r\n                    この設定がオフのときも、字幕データ側で縁取りが指定されていれば、オンのときと同様に縁取り付きで描画されます。<br>\r\n                </label>\r\n                <v-switch class=\"settings__item-switch\" id=\"always_border_caption_text\" inset hide-details\r\n                    v-model=\"settingsStore.settings.always_border_caption_text\">\r\n                </v-switch>\r\n            </div>\r\n            <div class=\"settings__item settings__item--switch\">\r\n                <label class=\"settings__item-heading\" for=\"specify_caption_opacity\">字幕の不透明度を指定する</label>\r\n                <label class=\"settings__item-label\" for=\"specify_caption_opacity\">\r\n                    字幕表示時、不透明度を自分で指定するか設定できます。<br>\r\n                    この設定がオフのときは、字幕データ側で指定されている不透明度で描画します。とくに理由がなければ、オフにしておくのがおすすめです。<br>\r\n                </label>\r\n                <v-switch class=\"settings__item-switch\" id=\"specify_caption_opacity\" inset hide-details\r\n                    v-model=\"settingsStore.settings.specify_caption_opacity\">\r\n                </v-switch>\r\n            </div>\r\n            <div class=\"settings__item\" :class=\"{'settings__item--disabled': settingsStore.settings.specify_caption_opacity === false}\">\r\n                <label class=\"settings__item-heading\">字幕の不透明度</label>\r\n                <label class=\"settings__item-label\">\r\n                    上の [字幕の不透明度を指定する] をオンに設定したときのみ有効です。不透明度を 0 に設定すれば、字幕の背景を非表示にできます。<br>\r\n                </label>\r\n                <div class=\"settings__item-label\" ref=\"caption_opacity\">\r\n                    <v-slider class=\"settings__item-form\" ticks=\"always\" thumb-label hide-details\r\n                        :min=\"0\" :max=\"1\" :step=\"0.05\" v-model=\"settingsStore.settings.caption_opacity\"\r\n                        :disabled=\"settingsStore.settings.specify_caption_opacity === false\">\r\n                    </v-slider>\r\n                </div>\r\n            </div>\r\n            <v-divider class=\"mt-6\"></v-divider>\r\n            <div class=\"settings__item settings__item--switch\">\r\n                <label class=\"settings__item-heading\" for=\"tv_show_superimpose\">テレビをみるときに文字スーパーを表示する</label>\r\n                <label class=\"settings__item-label\" for=\"tv_show_superimpose\">\r\n                    文字スーパーは、緊急地震速報の赤テロップや、NHK BS のニュース速報のテロップなどで利用されています。とくに理由がなければ、オンにしておくのがおすすめです。<br>\r\n                </label>\r\n                <v-switch class=\"settings__item-switch\" id=\"tv_show_superimpose\" inset hide-details\r\n                    v-model=\"settingsStore.settings.tv_show_superimpose\">\r\n                </v-switch>\r\n            </div>\r\n            <div class=\"settings__item settings__item--switch\">\r\n                <label class=\"settings__item-heading\" for=\"video_show_superimpose\">ビデオをみるときに文字スーパーを表示する</label>\r\n                <label class=\"settings__item-label\" for=\"video_show_superimpose\">\r\n                    文字スーパーは、緊急地震速報の赤テロップや、NHK BS のニュース速報のテロップなどで利用されています。録画当時の文字スーパーによるニュース速報を確認したい方以外は、オフにしておくのがおすすめです。<br>\r\n                </label>\r\n                <v-switch class=\"settings__item-switch\" id=\"video_show_superimpose\" inset hide-details\r\n                    v-model=\"settingsStore.settings.video_show_superimpose\">\r\n                </v-switch>\r\n            </div>\r\n        </div>\r\n    </SettingsBase>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils from '@/utils';\r\nimport SettingsBase from '@/views/Settings/Base.vue';\r\n\r\nexport default defineComponent({\r\n    name: 'Settings-Caption',\r\n    components: {\r\n        SettingsBase,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // フォームを小さくするかどうか\r\n            is_form_dense: Utils.isSmartphoneHorizontal(),\r\n\r\n            // 字幕のフォントの選択肢\r\n            caption_font: [\r\n                {text: 'Windows TV ゴシック', value: 'Windows TV Gothic'},\r\n                {text: 'Windows TV 丸ゴシック', value: 'Windows TV MaruGothic'},\r\n                {text: 'Windows TV 太丸ゴシック', value: 'Windows TV FutoMaruGothic'},\r\n                {text: 'ヒラギノTV丸ゴ', value: 'Hiragino TV Sans Rd S'},\r\n                {text: '新丸ゴ ARIB', value: 'TT-ShinMGo-regular'},\r\n                {text: 'Rounded M+ 1m for ARIB', value: 'Rounded M+ 1m for ARIB'},\r\n                {text: 'Noto Sans JP', value: 'Noto Sans JP'},\r\n                {text: 'デフォルトのフォント', value: 'sans-serif'},\r\n            ],\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useSettingsStore),\r\n    }\r\n});\r\n\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Caption.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Caption.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Caption.vue?vue&type=template&id=3b3cdbd6\"\nimport script from \"./Caption.vue?vue&type=script&lang=ts\"\nexport * from \"./Caption.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('SettingsBase',[_c('h2',{staticClass:\"settings__heading\"},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"settings__back-button\",attrs:{\"to\":\"/settings/\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-left-12-filled\",\"width\":\"25px\"}})],1),_c('Icon',{attrs:{\"icon\":\"fluent:image-multiple-16-filled\",\"width\":\"26px\"}}),_c('span',{staticClass:\"ml-2\"},[_vm._v(\"キャプチャ\")])],1),_c('div',{staticClass:\"settings__content\"},[_c('div',{staticClass:\"settings__item settings__item--switch settings__item--sync-disabled\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"capture_copy_to_clipboard\"}},[_vm._v(\"キャプチャをクリップボードにコピーする\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"capture_copy_to_clipboard\"}},[_vm._v(\" この設定をオンにすると、撮ったキャプチャ画像がクリップボードにもコピーされます。\"),_c('br'),_vm._v(\" クリップボードの履歴をサポートしていない OS では、この設定をオンにしてキャプチャを撮ると、以前のクリップボードが上書きされます。注意してください。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"capture_copy_to_clipboard\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.capture_copy_to_clipboard),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"capture_copy_to_clipboard\", $$v)},expression:\"settingsStore.settings.capture_copy_to_clipboard\"}})],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"キャプチャの保存先\")]),_c('div',{staticClass:\"settings__item-label\"},[_c('p',[_vm._v(\" キャプチャした画像をブラウザでダウンロードするか、KonomiTV サーバーにアップロードするかを設定します。\"),_c('br'),_vm._v(\" ブラウザでのダウンロードと、KonomiTV サーバーへのアップロードを両方同時に行うこともできます。\"),_c('br')]),_c('p',[_vm._v(\" ブラウザでダウンロードすると、視聴中のデバイスのダウンロードフォルダに保存されます。\"),_c('br'),_vm._v(\" 視聴中のデバイスにそのまま保存されるためシンプルですが、保存先のフォルダを変更できないこと、iOS Safari (PWA モード) ではダウンロードするとファイル概要画面が表示されて視聴に支障することがデメリットです (将来的には、iOS / Android アプリ版や拡張機能などで解消される予定) 。\"),_c('br')]),_c('p',[_vm._v(\" KonomiTV サーバーにアップロードすると、サーバー設定で指定されたキャプチャ保存フォルダに保存されます。視聴したデバイスにかかわらず、今までに撮ったキャプチャをひとつのフォルダにまとめて保存できます。\"),_c('br'),_vm._v(\" 他のデバイスでキャプチャを見るにはキャプチャ保存フォルダをネットワークに共有する必要があること、スマホ・タブレットではネットワーク上のフォルダへのアクセスがやや面倒なことがデメリットです。(将来的には、保存フォルダ内のキャプチャを Google フォトのように表示する機能を追加予定)\"),_c('br')])]),_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.capture_save_mode},model:{value:(_vm.settingsStore.settings.capture_save_mode),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"capture_save_mode\", $$v)},expression:\"settingsStore.settings.capture_save_mode\"}})],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"字幕表示時のキャプチャの保存モード\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" 字幕表示時、キャプチャした画像に字幕を合成するかを設定します。\"),_c('br'),_vm._v(\" 映像のみのキャプチャと、字幕を合成したキャプチャを両方同時に保存することもできます。\"),_c('br'),_vm._v(\" なお、字幕非表示時は、常に映像のみ (+コメント付きキャプチャではコメントを合成して) 保存されます。\"),_c('br')]),_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.capture_caption_mode},model:{value:(_vm.settingsStore.settings.capture_caption_mode),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"capture_caption_mode\", $$v)},expression:\"settingsStore.settings.capture_caption_mode\"}})],1)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <!-- ベース画面の中にそれぞれの設定画面で異なる部分を記述する -->\r\n    <SettingsBase>\r\n        <h2 class=\"settings__heading\">\r\n            <router-link v-ripple class=\"settings__back-button\" to=\"/settings/\">\r\n                <Icon icon=\"fluent:arrow-left-12-filled\" width=\"25px\" />\r\n            </router-link>\r\n            <Icon icon=\"fluent:image-multiple-16-filled\" width=\"26px\" />\r\n            <span class=\"ml-2\">キャプチャ</span>\r\n        </h2>\r\n        <div class=\"settings__content\">\r\n            <div class=\"settings__item settings__item--switch settings__item--sync-disabled\">\r\n                <label class=\"settings__item-heading\" for=\"capture_copy_to_clipboard\">キャプチャをクリップボードにコピーする</label>\r\n                <label class=\"settings__item-label\" for=\"capture_copy_to_clipboard\">\r\n                    この設定をオンにすると、撮ったキャプチャ画像がクリップボードにもコピーされます。<br>\r\n                    クリップボードの履歴をサポートしていない OS では、この設定をオンにしてキャプチャを撮ると、以前のクリップボードが上書きされます。注意してください。<br>\r\n                </label>\r\n                <v-switch class=\"settings__item-switch\" id=\"capture_copy_to_clipboard\" inset hide-details\r\n                    v-model=\"settingsStore.settings.capture_copy_to_clipboard\">\r\n                </v-switch>\r\n            </div>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">キャプチャの保存先</div>\r\n                <div class=\"settings__item-label\">\r\n                    <p>\r\n                        キャプチャした画像をブラウザでダウンロードするか、KonomiTV サーバーにアップロードするかを設定します。<br>\r\n                        ブラウザでのダウンロードと、KonomiTV サーバーへのアップロードを両方同時に行うこともできます。<br>\r\n                    </p>\r\n                    <p>\r\n                        ブラウザでダウンロードすると、視聴中のデバイスのダウンロードフォルダに保存されます。<br>\r\n                        視聴中のデバイスにそのまま保存されるためシンプルですが、保存先のフォルダを変更できないこと、iOS Safari (PWA モード) ではダウンロードするとファイル概要画面が表示されて視聴に支障することがデメリットです (将来的には、iOS / Android アプリ版や拡張機能などで解消される予定) 。<br>\r\n                    </p>\r\n                    <p>\r\n                        KonomiTV サーバーにアップロードすると、サーバー設定で指定されたキャプチャ保存フォルダに保存されます。視聴したデバイスにかかわらず、今までに撮ったキャプチャをひとつのフォルダにまとめて保存できます。<br>\r\n                        他のデバイスでキャプチャを見るにはキャプチャ保存フォルダをネットワークに共有する必要があること、スマホ・タブレットではネットワーク上のフォルダへのアクセスがやや面倒なことがデメリットです。(将来的には、保存フォルダ内のキャプチャを Google フォトのように表示する機能を追加予定)<br>\r\n                    </p>\r\n                </div>\r\n                <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\"\r\n                    :items=\"capture_save_mode\" v-model=\"settingsStore.settings.capture_save_mode\">\r\n                </v-select>\r\n            </div>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">字幕表示時のキャプチャの保存モード</div>\r\n                <div class=\"settings__item-label\">\r\n                    字幕表示時、キャプチャした画像に字幕を合成するかを設定します。<br>\r\n                    映像のみのキャプチャと、字幕を合成したキャプチャを両方同時に保存することもできます。<br>\r\n                    なお、字幕非表示時は、常に映像のみ (+コメント付きキャプチャではコメントを合成して) 保存されます。<br>\r\n                </div>\r\n                <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\"\r\n                    :items=\"capture_caption_mode\" v-model=\"settingsStore.settings.capture_caption_mode\">\r\n                </v-select>\r\n            </div>\r\n        </div>\r\n    </SettingsBase>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils from '@/utils';\r\nimport SettingsBase from '@/views/Settings/Base.vue';\r\n\r\nexport default defineComponent({\r\n    name: 'Settings-Capture',\r\n    components: {\r\n        SettingsBase,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // フォームを小さくするかどうか\r\n            is_form_dense: Utils.isSmartphoneHorizontal(),\r\n\r\n            // キャプチャの保存先の選択肢\r\n            capture_save_mode: [\r\n                {text: 'ブラウザでダウンロード', value: 'Browser'},\r\n                {text: 'KonomiTV サーバーにアップロード', value: 'UploadServer'},\r\n                {text: 'ブラウザでのダウンロードと、KonomiTV サーバーへのアップロードを両方行う', value: 'Both'},\r\n            ],\r\n\r\n            // 字幕が表示されているときのキャプチャの保存モードの選択肢\r\n            capture_caption_mode: [\r\n                {text: '映像のみのキャプチャを保存する', value: 'VideoOnly'},\r\n                {text: '字幕を合成したキャプチャを保存する', value: 'CompositingCaption'},\r\n                {text: '映像のみのキャプチャと、字幕を合成したキャプチャを両方保存する', value: 'Both'},\r\n            ],\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useSettingsStore),\r\n    }\r\n});\r\n\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Capture.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Capture.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Capture.vue?vue&type=template&id=392eeff2\"\nimport script from \"./Capture.vue?vue&type=script&lang=ts\"\nexport * from \"./Capture.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('SettingsBase',[_c('h2',{staticClass:\"settings__heading\"},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"settings__back-button\",attrs:{\"to\":\"/settings/\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-left-12-filled\",\"width\":\"25px\"}})],1),_c('svg',{attrs:{\"width\":\"27px\",\"height\":\"27px\",\"viewBox\":\"0 0 512 512\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M248.039 381.326L355.039 67.8258C367.539 28.3257 395.039 34.3258 406.539 34.3258C431.039 34.3258 453.376 61.3258 441.039 96.8258C362.639 322.426 343.539 375.326 340.539 384.826C338.486 391.326 342.039 391.326 345.539 391.326C377.039 391.326 386.539 418.326 386.539 435.326C386.539 458.826 371.539 477.326 350.039 477.326H214.539C179.039 477.326 85.8269 431.3 88.0387 335.826C91.0387 206.326 192.039 183.326 243.539 183.326H296.539L265.539 272.326H243.539C185.539 272.326 174.113 314.826 176.039 334.326C180.039 374.826 215.039 389.814 237.039 390.326C244.539 390.5 246.039 386.826 248.039 381.326Z\"}})]),_c('span',{staticClass:\"ml-2\"},[_vm._v(\"データ放送\")])],1),_c('div',{staticClass:\"settings__content\"},[_c('div',{staticClass:\"settings__item settings__item--switch settings__item--sync-disabled\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"tv_show_data_broadcasting\"}},[_vm._v(\"テレビをみるときにデータ放送を表示する\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"tv_show_data_broadcasting\"}},[_vm._v(\" この設定をオンにすると、テレビをみるときにデータ放送機能を利用できます。\"),_c('br'),_vm._v(\" データ放送画面自体のオン/オフは、視聴画面右側のパネルからリモコンを表示した上で、リモコンの d ボタンから切り替えられます。\"),_c('br')]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"tv_show_data_broadcasting\"}},[_vm._v(\" データ放送機能をオンにすると、視聴時の負荷が若干高くなります。データ放送を利用しない場合や、スペックの低い Android デバイスで動作が重い場合は、オフに設定してみてください。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"tv_show_data_broadcasting\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.tv_show_data_broadcasting),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tv_show_data_broadcasting\", $$v)},expression:\"settingsStore.settings.tv_show_data_broadcasting\"}})],1),_c('v-divider',{staticClass:\"mt-6\"}),_c('v-form',{ref:\"data_broadcasting_zip_code\",staticClass:\"settings__item settings__item--sync-disabled\",on:{\"submit\":function($event){$event.preventDefault();}}},[_c('label',{staticClass:\"settings__item-heading\"},[_vm._v(\"お住まいの郵便番号\")]),_c('label',{staticClass:\"settings__item-label\"},[_vm._v(\" ここで設定した郵便番号をもとに、データ放送の地域情報（ニュース・天気予報など）が表示されます。\"),_c('br'),_vm._v(\" 設定しない場合、データ放送の一部のコンテンツが利用できないことがあります。\"),_c('br')]),_c('v-text-field',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"placeholder\":\"郵便番号\",\"dense\":_vm.is_form_dense,\"rules\":[_vm.data_broadcasting_zip_code_validation]},model:{value:(_vm.data_broadcasting_zip_code),callback:function ($$v) {_vm.data_broadcasting_zip_code=$$v},expression:\"data_broadcasting_zip_code\"}})],1),_c('div',{staticClass:\"settings__item settings__item--sync-disabled mt-0\"},[_c('label',{staticClass:\"settings__item-heading\"},[_vm._v(\"お住まいの都道府県\")]),_c('label',{staticClass:\"settings__item-label\"},[_vm._v(\" ここで設定した都道府県をもとに、データ放送の地域情報（ニュース・天気予報など）が表示されます。\"),_c('br'),_vm._v(\" 設定しない場合、データ放送の一部のコンテンツが利用できないことがあります。\"),_c('br')]),_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.data_broadcasting_prefectures},model:{value:(_vm.data_broadcasting_prefecture),callback:function ($$v) {_vm.data_broadcasting_prefecture=$$v},expression:\"data_broadcasting_prefecture\"}})],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading error--text text--lighten-1\"},[_vm._v(\"データ放送の保存データをリセット\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" このデバイス（ブラウザ）に保存されているデータ放送の保存データを、初期状態にリセット (消去) できます。\"),_c('br'),_vm._v(\" 保存データには、データ放送内のミニゲームの得点データや、設定データなどが含まれます。\"),_c('br'),_vm._v(\" 保存データをリセットすると、元に戻すことはできません。十分ご注意ください。\"),_c('br')])]),_c('v-btn',{staticClass:\"settings__save-button error mt-5\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){return _vm.resetNVRAMSettings()}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"material-symbols:device-reset-rounded\",\"height\":\"23px\"}}),_vm._v(\"保存データをリセット \")],1)],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <!-- ベース画面の中にそれぞれの設定画面で異なる部分を記述する -->\r\n    <SettingsBase>\r\n        <h2 class=\"settings__heading\">\r\n            <router-link v-ripple class=\"settings__back-button\" to=\"/settings/\">\r\n                <Icon icon=\"fluent:arrow-left-12-filled\" width=\"25px\" />\r\n            </router-link>\r\n            <svg width=\"27px\" height=\"27px\" viewBox=\"0 0 512 512\">\r\n                <path fill=\"currentColor\" d=\"M248.039 381.326L355.039 67.8258C367.539 28.3257 395.039 34.3258 406.539 34.3258C431.039 34.3258 453.376 61.3258 441.039 96.8258C362.639 322.426 343.539 375.326 340.539 384.826C338.486 391.326 342.039 391.326 345.539 391.326C377.039 391.326 386.539 418.326 386.539 435.326C386.539 458.826 371.539 477.326 350.039 477.326H214.539C179.039 477.326 85.8269 431.3 88.0387 335.826C91.0387 206.326 192.039 183.326 243.539 183.326H296.539L265.539 272.326H243.539C185.539 272.326 174.113 314.826 176.039 334.326C180.039 374.826 215.039 389.814 237.039 390.326C244.539 390.5 246.039 386.826 248.039 381.326Z\" />\r\n            </svg>\r\n            <span class=\"ml-2\">データ放送</span>\r\n        </h2>\r\n        <div class=\"settings__content\">\r\n            <div class=\"settings__item settings__item--switch settings__item--sync-disabled\">\r\n                <label class=\"settings__item-heading\" for=\"tv_show_data_broadcasting\">テレビをみるときにデータ放送を表示する</label>\r\n                <label class=\"settings__item-label\" for=\"tv_show_data_broadcasting\">\r\n                    この設定をオンにすると、テレビをみるときにデータ放送機能を利用できます。<br>\r\n                    データ放送画面自体のオン/オフは、視聴画面右側のパネルからリモコンを表示した上で、リモコンの d ボタンから切り替えられます。<br>\r\n                </label>\r\n                <label class=\"settings__item-label\" for=\"tv_show_data_broadcasting\">\r\n                    データ放送機能をオンにすると、視聴時の負荷が若干高くなります。データ放送を利用しない場合や、スペックの低い Android デバイスで動作が重い場合は、オフに設定してみてください。<br>\r\n                </label>\r\n                <v-switch class=\"settings__item-switch\" id=\"tv_show_data_broadcasting\" inset hide-details\r\n                    v-model=\"settingsStore.settings.tv_show_data_broadcasting\">\r\n                </v-switch>\r\n            </div>\r\n            <v-divider class=\"mt-6\"></v-divider>\r\n            <v-form class=\"settings__item settings__item--sync-disabled\" ref=\"data_broadcasting_zip_code\" @submit.prevent>\r\n                <label class=\"settings__item-heading\">お住まいの郵便番号</label>\r\n                <label class=\"settings__item-label\">\r\n                    ここで設定した郵便番号をもとに、データ放送の地域情報（ニュース・天気予報など）が表示されます。<br>\r\n                    設定しない場合、データ放送の一部のコンテンツが利用できないことがあります。<br>\r\n                </label>\r\n                <v-text-field class=\"settings__item-form\" outlined placeholder=\"郵便番号\" :dense=\"is_form_dense\"\r\n                    :rules=\"[data_broadcasting_zip_code_validation]\" v-model=\"data_broadcasting_zip_code\">\r\n                </v-text-field>\r\n            </v-form>\r\n            <div class=\"settings__item settings__item--sync-disabled mt-0\">\r\n                <label class=\"settings__item-heading\">お住まいの都道府県</label>\r\n                <label class=\"settings__item-label\">\r\n                    ここで設定した都道府県をもとに、データ放送の地域情報（ニュース・天気予報など）が表示されます。<br>\r\n                    設定しない場合、データ放送の一部のコンテンツが利用できないことがあります。<br>\r\n                </label>\r\n                <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\"\r\n                    :items=\"data_broadcasting_prefectures\" v-model=\"data_broadcasting_prefecture\">\r\n                </v-select>\r\n            </div>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading error--text text--lighten-1\">データ放送の保存データをリセット</div>\r\n                <div class=\"settings__item-label\">\r\n                    このデバイス（ブラウザ）に保存されているデータ放送の保存データを、初期状態にリセット (消去) できます。<br>\r\n                    保存データには、データ放送内のミニゲームの得点データや、設定データなどが含まれます。<br>\r\n                    保存データをリセットすると、元に戻すことはできません。十分ご注意ください。<br>\r\n                </div>\r\n            </div>\r\n            <v-btn class=\"settings__save-button error mt-5\" depressed @click=\"resetNVRAMSettings()\">\r\n                <Icon icon=\"material-symbols:device-reset-rounded\" class=\"mr-2\" height=\"23px\" />保存データをリセット\r\n            </v-btn>\r\n        </div>\r\n    </SettingsBase>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport Message from '@/message';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils from '@/utils';\r\nimport SettingsBase from '@/views/Settings/Base.vue';\r\n\r\n// データ放送の NVRAM のうち、郵便番号/都道府県設定の保存に使う LocalStorage キーのプレフィックス\r\nconst NVRAM_LOCAL_STORAGE_PREFIX = 'KonomiTV-BMLBrowser_nvram_prefix=receiverinfo%2F';\r\n\r\nexport default defineComponent({\r\n    name: 'Settings-DataBroadcasting',\r\n    components: {\r\n        SettingsBase,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // フォームを小さくするかどうか\r\n            is_form_dense: Utils.isSmartphoneHorizontal(),\r\n\r\n            // データ放送向け郵便番号設定\r\n            data_broadcasting_zip_code: '' as string,\r\n\r\n            // データ放送向け郵便番号（日本）のバリデーション関数\r\n            data_broadcasting_zip_code_validation: (value: string) => {\r\n                if (value === '') {\r\n                    return true;\r\n                }\r\n                if (value.match(/^[0-9]{3}-[0-9]{4}$/) === null) {\r\n                    return '郵便番号は「000-0000」の形式で入力してください。';\r\n                }\r\n                return true;\r\n            },\r\n\r\n            // データ放送向け都道府県設定\r\n            data_broadcasting_prefecture: '255-0b0' as string,\r\n            data_broadcasting_prefectures: [\r\n                {text: '未設定', value: '255-0b0'},\r\n                {text: '西北海道', value: '2-0b000101101011'},\r\n                {text: '東北海道', value: '1-0b000101101011'},\r\n                {text: '青森県', value: '3-0b010001100111'},\r\n                {text: '岩手県', value: '4-0b010111010100'},\r\n                {text: '宮城県', value: '5-0b011101011000'},\r\n                {text: '秋田県', value: '6-0b101011000110'},\r\n                {text: '山形県', value: '7-0b111001001100'},\r\n                {text: '福島県', value: '8-0b000110101110'},\r\n                {text: '茨城県', value: '9-0b110001101001'},\r\n                {text: '栃木県', value: '10-0b111000111000'},\r\n                {text: '群馬県', value: '11-0b100110001011'},\r\n                {text: '埼玉県', value: '12-0b011001001011'},\r\n                {text: '千葉県', value: '13-0b000111000111'},\r\n                {text: '東京都 (島部を除く)', value: '14-0b101010101100'},\r\n                {text: '東京都島部 (伊豆・小笠原諸島)', value: '49-0b101010101100'},\r\n                {text: '神奈川県', value: '15-0b010101101100'},\r\n                {text: '新潟県', value: '16-0b010011001110'},\r\n                {text: '富山県', value: '17-0b010100111001'},\r\n                {text: '石川県', value: '18-0b011010100110'},\r\n                {text: '福井県', value: '19-0b100100101101'},\r\n                {text: '山梨県', value: '20-0b110101001010'},\r\n                {text: '長野県', value: '21-0b100111010010'},\r\n                {text: '岐阜県', value: '22-0b101001100101'},\r\n                {text: '静岡県', value: '23-0b101001011010'},\r\n                {text: '愛知県', value: '24-0b100101100110'},\r\n                {text: '三重県', value: '25-0b001011011100'},\r\n                {text: '滋賀県', value: '26-0b110011100100'},\r\n                {text: '京都府', value: '27-0b010110011010'},\r\n                {text: '大阪府', value: '28-0b110010110010'},\r\n                {text: '兵庫県', value: '29-0b011001110100'},\r\n                {text: '奈良県', value: '30-0b101010010011'},\r\n                {text: '和歌山県', value: '31-0b001110010110'},\r\n                {text: '鳥取県', value: '32-0b110100100011'},\r\n                {text: '島根県', value: '33-0b001100011011'},\r\n                {text: '岡山県', value: '34-0b001010110101'},\r\n                {text: '広島県', value: '35-0b101100110001'},\r\n                {text: '山口県', value: '36-0b101110011000'},\r\n                {text: '徳島県', value: '37-0b111001100010'},\r\n                {text: '香川県', value: '38-0b100110110100'},\r\n                {text: '愛媛県', value: '39-0b000110011101'},\r\n                {text: '高知県', value: '40-0b001011100011'},\r\n                {text: '福岡県', value: '41-0b011000101101'},\r\n                {text: '佐賀県', value: '42-0b100101011001'},\r\n                {text: '長崎県', value: '43-0b101000101011'},\r\n                {text: '熊本県', value: '44-0b100010100111'},\r\n                {text: '大分県', value: '45-0b110010001101'},\r\n                {text: '宮崎県', value: '46-0b110100011100'},\r\n                {text: '鹿児島県 (南西諸島を除く)', value: '47-0b110101000101'},\r\n                {text: '鹿児島県島部 (南西諸島の鹿児島県域)', value: '50-0b110101000101'},\r\n                {text: '沖縄県', value: '48-0b001101110010'},\r\n            ],\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useSettingsStore),\r\n    },\r\n    watch: {\r\n        data_broadcasting_zip_code(new_value: string) {\r\n            // バリデーションチェック\r\n            if ((this.$refs.data_broadcasting_zip_code as any).validate() === false) {\r\n                return;\r\n            }\r\n            // 郵便番号設定を LocalStorage に保存する\r\n            if (new_value !== '') {\r\n                // - を除去してから Base64 エンコードする\r\n                const zip_code_raw = window.btoa(new_value.replace('-', ''));\r\n                localStorage.setItem(`${NVRAM_LOCAL_STORAGE_PREFIX}zipcode`, zip_code_raw);\r\n            } else {\r\n                // 未設定の場合は LocalStorage から削除する\r\n                localStorage.removeItem(`${NVRAM_LOCAL_STORAGE_PREFIX}zipcode`);\r\n            }\r\n        },\r\n        data_broadcasting_prefecture(new_value: string) {\r\n            // 都道府県設定を LocalStorage に保存する\r\n            if (new_value !== '255-0b0') {\r\n                const value = new_value.split('-0b');\r\n                const prefecture_number = parseInt(value[0]);\r\n                const prefecture_raw = window.btoa(String.fromCharCode(prefecture_number));\r\n                localStorage.setItem(`${NVRAM_LOCAL_STORAGE_PREFIX}prefecture`, prefecture_raw);\r\n                const region_code_number = parseInt(value[1], 2);  // 2進数の文字列を10進数の数値に変換する\r\n                const region_code_raw = window.btoa(String.fromCharCode(region_code_number >> 8, region_code_number & 0xff));\r\n                localStorage.setItem(`${NVRAM_LOCAL_STORAGE_PREFIX}regioncode`, region_code_raw);\r\n            } else {\r\n                // 未設定の場合は LocalStorage から削除する\r\n                localStorage.removeItem(`${NVRAM_LOCAL_STORAGE_PREFIX}prefecture`);\r\n                localStorage.removeItem(`${NVRAM_LOCAL_STORAGE_PREFIX}regioncode`);\r\n            }\r\n        }\r\n    },\r\n    created() {\r\n        // 郵便番号設定を LocalStorage から読み込む\r\n        const zip_code_raw = localStorage.getItem(`${NVRAM_LOCAL_STORAGE_PREFIX}zipcode`);\r\n        if (zip_code_raw) {\r\n            try {\r\n                // 3文字目と4文字目の間に - を挿入する\r\n                this.data_broadcasting_zip_code = window.atob(zip_code_raw);\r\n                this.data_broadcasting_zip_code = this.data_broadcasting_zip_code.slice(0, 3) + '-' + this.data_broadcasting_zip_code.slice(3);\r\n            } catch (error) {\r\n                // 何もしない\r\n            }\r\n        }\r\n        // 都道府県設定を LocalStorage から読み込む\r\n        // 現在設定されている都道府県を特定するだけなら regioncode は不要なので、省略している\r\n        const prefecture_raw = localStorage.getItem(`${NVRAM_LOCAL_STORAGE_PREFIX}prefecture`);\r\n        if (prefecture_raw) {\r\n            try {\r\n                const prefecture = window.atob(prefecture_raw).charCodeAt(0);\r\n                for (const item of this.data_broadcasting_prefectures) {\r\n                    if (item.value.startsWith(`${prefecture}-`)) {\r\n                        this.data_broadcasting_prefecture = item.value;\r\n                        break;\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                // 何もしない\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        resetNVRAMSettings() {\r\n            // KonomiTV-BMLBrowser_nvram_ から始まる LocalStorage の項目をすべて削除する\r\n            for (const key in localStorage) {\r\n                if (key.startsWith('KonomiTV-BMLBrowser_nvram_')) {\r\n                    localStorage.removeItem(key);\r\n                }\r\n            }\r\n            this.data_broadcasting_zip_code = '';\r\n            this.data_broadcasting_prefecture = '255-0b0';\r\n            Message.success('データ放送の保存データをリセットしました。');\r\n        }\r\n    }\r\n});\r\n\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./DataBroadcasting.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./DataBroadcasting.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./DataBroadcasting.vue?vue&type=template&id=fe4416b4\"\nimport script from \"./DataBroadcasting.vue?vue&type=script&lang=ts\"\nexport * from \"./DataBroadcasting.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('SettingsBase',[_c('h2',{staticClass:\"settings__heading\"},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"settings__back-button\",attrs:{\"to\":\"/settings/\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-left-12-filled\",\"width\":\"25px\"}})],1),_c('Icon',{staticStyle:{\"margin\":\"0 4px\"},attrs:{\"icon\":\"fa-solid:sliders-h\",\"width\":\"19px\"}}),_c('span',{staticClass:\"ml-3\"},[_vm._v(\"全般\")])],1),_c('div',{staticClass:\"settings__content\"},[_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"ピン留め中チャンネルの並び替え\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" ピン留め中のチャンネルの表示順序を変更できます。よくみるチャンネルは先頭に配置しておくと便利です。\"),_c('br'),_vm._v(\" ピン留め中のチャンネルの追加・削除は、別途 TV ホーム画面のチャンネルリストから行えます。\"),_c('br')])]),_c('v-btn',{staticClass:\"settings__save-button mt-4\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){_vm.pinned_channel_settings_modal = !_vm.pinned_channel_settings_modal}}},[_c('Icon',{attrs:{\"icon\":\"iconamoon:sorting-left-bold\",\"height\":\"19px\"}}),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"ピン留め中チャンネルの並び替え設定を開く\")])],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"tv_channel_selection_requires_alt_key\"}},[_vm._v(\"チャンネル選局のキーボードショートカットを \"+_vm._s(_vm.Utils.AltOrOption())+\" + 数字キー/テンキーに変更する\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"tv_channel_selection_requires_alt_key\"}},[_vm._v(\" この設定をオンにすると、数字キーまたはテンキーに対応するリモコン番号（1～12）のチャンネルに切り替える際、\"+_vm._s(_vm.Utils.AltOrOption())+\" キーを同時に押す必要があります。\"),_c('br'),_vm._v(\" コメントやツイートを入力しようとして誤って数字キーを押してしまい、チャンネルが変わってしまう事態を避けたい方におすすめです。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"tv_channel_selection_requires_alt_key\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.tv_channel_selection_requires_alt_key),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tv_channel_selection_requires_alt_key\", $$v)},expression:\"settingsStore.settings.tv_channel_selection_requires_alt_key\"}})],1),_c('v-divider',{staticClass:\"mt-6\"}),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"デフォルトのパネルの表示状態\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" 視聴画面を開いたときに、右側のパネルをどう表示するかを設定します。\"),_c('br')]),_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.panel_display_state},model:{value:(_vm.settingsStore.settings.panel_display_state),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"panel_display_state\", $$v)},expression:\"settingsStore.settings.panel_display_state\"}})],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"テレビをみるときにデフォルトで表示されるパネルのタブ\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" テレビの視聴画面を開いたときに、右側のパネルで最初に表示されるタブを設定します。\"),_c('br')]),_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.tv_panel_active_tab},model:{value:(_vm.settingsStore.settings.tv_panel_active_tab),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tv_panel_active_tab\", $$v)},expression:\"settingsStore.settings.tv_panel_active_tab\"}})],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"ビデオをみるときにデフォルトで表示されるパネルのタブ\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" ビデオの視聴画面を開いたときに、右側のパネルで最初に表示されるタブを設定します。\"),_c('br')]),_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.video_panel_active_tab},model:{value:(_vm.settingsStore.settings.video_panel_active_tab),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"video_panel_active_tab\", $$v)},expression:\"settingsStore.settings.video_panel_active_tab\"}})],1),_c('v-divider',{staticClass:\"mt-6\"}),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"設定をエクスポート\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" このデバイス（ブラウザ）に保存されている設定データを、エクスポート（ダウンロード）できます。\"),_c('br'),_vm._v(\" ダウンロードした設定データ (KonomiTV-Settings.json) は、[設定をインポート] からインポートできます。異なるサーバーの KonomiTV を同じ設定で使いたいときなどに使ってください。\"),_c('br')])]),_c('v-btn',{staticClass:\"settings__save-button mt-4\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){return _vm.exportSettings()}}},[_c('Icon',{staticClass:\"mr-3\",attrs:{\"icon\":\"fa6-solid:download\",\"height\":\"19px\"}}),_vm._v(\"設定をエクスポート \")],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading error--text text--lighten-1\"},[_vm._v(\"設定をインポート\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" [設定をエクスポート] でダウンロードした設定データを、このデバイス（ブラウザ）にインポートできます。\"),_c('br'),_vm._v(\" 設定をインポートすると、\"),_c('b',[_vm._v(\"現在のデバイス設定はすべて上書きされます。\")]),_vm._v(\"元に戻すことはできません。\"),_c('br'),_vm._v(\" 設定のデバイス間同期がオンのときは、\"),_c('b',[_vm._v(\"同期が有効なすべてのデバイスに反映されます。\")]),_vm._v(\"十分ご注意ください。\"),_c('br')]),_c('v-file-input',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"placeholder\":\"設定データ (KonomiTV-Settings.json) を選択\",\"dense\":_vm.is_form_dense,\"accept\":\"application/json\",\"prepend-icon\":\"\",\"prepend-inner-icon\":\"mdi-paperclip\"},model:{value:(_vm.import_settings_file),callback:function ($$v) {_vm.import_settings_file=$$v},expression:\"import_settings_file\"}})],1),_c('v-btn',{staticClass:\"settings__save-button error mt-5\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){return _vm.importSettings()}}},[_c('Icon',{staticClass:\"mr-3\",attrs:{\"icon\":\"fa6-solid:upload\",\"height\":\"19px\"}}),_vm._v(\"設定をインポート \")],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading error--text text--lighten-1\"},[_vm._v(\"設定を初期状態にリセット\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" このデバイス（ブラウザ）に保存されている設定データを、初期状態のデフォルト値にリセットできます。\"),_c('br'),_vm._v(\" 設定をリセットすると、元に戻すことはできません。\"),_c('br'),_vm._v(\" 設定のデバイス間同期がオンのときは、\"),_c('b',[_vm._v(\"同期が有効なすべてのデバイスに反映されます。\")]),_vm._v(\"十分ご注意ください。\"),_c('br')])]),_c('v-btn',{staticClass:\"settings__save-button error mt-5\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){return _vm.resetSettings()}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"material-symbols:device-reset-rounded\",\"height\":\"23px\"}}),_vm._v(\"設定をリセット \")],1)],1),_c('PinnedChannelSettings',{attrs:{\"modelValue\":_vm.pinned_channel_settings_modal},on:{\"update:modelValue\":function($event){_vm.pinned_channel_settings_modal = $event}}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('v-dialog',{attrs:{\"max-width\":\"550\",\"transition\":\"slide-y-transition\"},model:{value:(_vm.pinned_channel_settings_modal),callback:function ($$v) {_vm.pinned_channel_settings_modal=$$v},expression:\"pinned_channel_settings_modal\"}},[_c('v-card',{staticClass:\"pinned-channels-settings\"},[_c('v-card-title',{staticClass:\"px-5 pt-5 pb-3 d-flex align-center font-weight-bold\",staticStyle:{\"height\":\"60px\"}},[_c('Icon',{attrs:{\"icon\":\"iconamoon:sorting-left-bold\",\"height\":\"26px\"}}),_c('span',{staticClass:\"ml-3\"},[_vm._v(\"ピン留め中チャンネルの並び替え\")]),_c('v-spacer'),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"d-flex align-center rounded-circle cursor-pointer px-2 py-2\",on:{\"click\":function($event){_vm.pinned_channel_settings_modal = false}}},[_c('Icon',{attrs:{\"icon\":\"fluent:dismiss-12-filled\",\"width\":\"23px\",\"height\":\"23px\"}})],1)],1),_c('div',{staticClass:\"px-5 pb-5\"},[((_vm.channelsStore.channels_list_with_pinned.get('ピン留め') ?? []).length > 0)?_c('div',{staticClass:\"pinned-channels-settings__label\"},[_c('div',[_vm._v(\"各チャンネルのつまみをドラッグして並べ替えできます。\")])]):_vm._e(),((_vm.channelsStore.channels_list_with_pinned.get('ピン留め') ?? []).length === 0)?_c('div',{staticClass:\"pinned-channels-settings__label\"},[_c('div',[_c('b',[_vm._v(\"ピン留めされているチャンネルがありません。\")])]),_c('div',{staticClass:\"mt-1\"},[_vm._v(\"TV ホーム画面のチャンネルリストの \"),_c('Icon',{staticStyle:{\"position\":\"relative\",\"bottom\":\"-5px\"},attrs:{\"icon\":\"fluent:pin-20-filled\",\"width\":\"18.5px\"}}),_vm._v(\" アイコンから、よくみるチャンネルをピン留めできます。\")],1)]):_vm._e(),((_vm.channelsStore.channels_list_with_pinned.get('ピン留め') ?? []).length > 0)?_c('draggable',{staticClass:\"pinned-channels\",attrs:{\"handle\":\".pinned-channel__sort-handle\"},model:{value:(_vm.settingsStore.settings.pinned_channel_ids),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"pinned_channel_ids\", $$v)},expression:\"settingsStore.settings.pinned_channel_ids\"}},_vm._l((_vm.channelsStore.channels_list_with_pinned.get('ピン留め') ?? []),function(channel){return _c('div',{key:channel.id,staticClass:\"pinned-channel\"},[_c('img',{staticClass:\"pinned-channel__icon\",attrs:{\"src\":`${_vm.Utils.api_base_url}/channels/${channel.id}/logo`}}),_c('span',{staticClass:\"pinned-channel__name\"},[_vm._v(\"Ch: \"+_vm._s(channel.channel_number)+\" \"+_vm._s(channel.name))]),_c('button',{staticClass:\"pinned-channel__sort-handle\"},[_c('svg',{staticClass:\"iconify iconify--material-symbols\",attrs:{\"width\":\"20px\",\"height\":\"20px\",\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M5 15q-.425 0-.713-.288T4 14q0-.425.288-.713T5 13h14q.425 0 .713.288T20 14q0 .425-.288.713T19 15H5Zm0-4q-.425 0-.713-.288T4 10q0-.425.288-.713T5 9h14q.425 0 .713.288T20 10q0 .425-.288.713T19 11H5Z\"}})])]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"pinned-channel__delete-button\",on:{\"click\":function($event){_vm.settingsStore.settings.pinned_channel_ids.splice(_vm.settingsStore.settings.pinned_channel_ids.indexOf(channel.id), 1)}}},[_c('svg',{staticClass:\"iconify iconify--fluent\",attrs:{\"width\":\"20px\",\"height\":\"20px\",\"viewBox\":\"0 0 16 16\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M7 3h2a1 1 0 0 0-2 0ZM6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1h4Zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5ZM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5Z\"}})])])])}),0):_vm._e()],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\r\n/** 番組情報を表すインターフェイス */\r\nexport interface IProgram {\r\n    id: string;\r\n    channel_id: string;\r\n    network_id: number;\r\n    service_id: number;\r\n    event_id: number;\r\n    title: string;\r\n    description: string;\r\n    detail: { [key: string]: string };\r\n    start_time: string;\r\n    end_time: string;\r\n    duration: number;\r\n    is_free: boolean;\r\n    genres: { major: string; middle: string; }[];\r\n    video_type: string | null;\r\n    video_codec: string | null;\r\n    video_resolution: string | null;\r\n    primary_audio_type: string;\r\n    primary_audio_language: string;\r\n    primary_audio_sampling_rate: string;\r\n    secondary_audio_type: string | null;\r\n    secondary_audio_language: string | null;\r\n    secondary_audio_sampling_rate: string | null;\r\n}\r\n\r\n/** 番組情報を表すインターフェイスのデフォルト値 */\r\nexport const IProgramDefault: IProgram = {\r\n    id: 'NID0-SID0-EID0',\r\n    channel_id: 'NID0-SID0',\r\n    network_id: 0,\r\n    service_id: 0,\r\n    event_id: 0,\r\n    title: '取得中…',\r\n    description: '取得中…',\r\n    detail: {},\r\n    start_time: '2000-01-01T00:00:00+09:00',\r\n    end_time: '2000-01-01T00:00:00+09:00',\r\n    duration: 0,\r\n    is_free: true,\r\n    genres: [],\r\n    video_type: '映像1080i(1125i)、アスペクト比16:9 パンベクトルなし',\r\n    video_codec: 'MPEG-2',\r\n    video_resolution: '1080i',\r\n    primary_audio_type: '2/0モード(ステレオ)',\r\n    primary_audio_language: '日本語',\r\n    primary_audio_sampling_rate: '48kHz',\r\n    secondary_audio_type: null,\r\n    secondary_audio_language: null,\r\n    secondary_audio_sampling_rate: null,\r\n};\r\n\r\n/** 番組情報を表すインターフェイス (present_or_following: Present なら現在放送中、Following なら次の番組であることを示す) */\r\nexport interface IProgramPF {\r\n    type: 'IProgramPF';\r\n    present_or_following: 'Present' | 'Following';\r\n    program: IProgram;\r\n}\r\n\r\n// TODO: 番組情報 API が開発されたらここに API 定義を書く\r\n","\r\nimport APIClient from '@/services/APIClient';\r\nimport { IProgram, IProgramDefault } from '@/services/Programs';\r\n\r\n\r\n/** チャンネルタイプの型 */\r\nexport type ChannelType = 'GR' | 'BS' | 'CS' | 'CATV' | 'SKY' | 'STARDIGIO';\r\n\r\n// チャンネルタイプの型 (実際のチャンネルリストに表示される表現)\r\nexport type ChannelTypePretty = 'ピン留め' | '地デジ' | 'BS' | 'CS' | 'CATV' | 'SKY' | 'StarDigio';\r\n\r\n/** チャンネル情報を表すインターフェイス */\r\nexport interface IChannel {\r\n    id: string;\r\n    display_channel_id: string;\r\n    network_id: number;\r\n    service_id: number;\r\n    transport_stream_id: number | null;\r\n    remocon_id: number;\r\n    channel_number: string;\r\n    type: ChannelType;\r\n    name: string;\r\n    jikkyo_force: number | null;\r\n    is_subchannel: boolean;\r\n    is_radiochannel: boolean;\r\n    is_watchable: boolean,\r\n}\r\n\r\n/** 現在放送中のチャンネル情報を表すインターフェイス */\r\nexport interface ILiveChannel extends IChannel {\r\n    // 以下はすべて動的に生成される TV ライブストリーミング用の追加カラム\r\n    is_display: boolean;\r\n    viewer_count: number;\r\n    program_present: IProgram | null;\r\n    program_following: IProgram | null;\r\n}\r\n\r\n/** 現在放送中のチャンネル情報を表すインターフェイスのデフォルト値 */\r\nexport const ILiveChannelDefault: ILiveChannel = {\r\n    id: 'NID0-SID0',\r\n    display_channel_id: 'gr000',\r\n    network_id: 0,\r\n    service_id: 0,\r\n    transport_stream_id: null,\r\n    remocon_id: 0,\r\n    channel_number: '---',\r\n    type: 'GR',\r\n    name: '取得中…',\r\n    jikkyo_force: null,\r\n    is_subchannel: false,\r\n    is_radiochannel: false,\r\n    is_watchable: true,\r\n    is_display: true,\r\n    viewer_count: 0,\r\n    program_present: IProgramDefault,\r\n    program_following: IProgramDefault,\r\n};\r\n\r\n/** すべてのチャンネルタイプの現在放送中のチャンネルの情報を表すインターフェイス */\r\nexport interface ILiveChannelsList {\r\n    GR: ILiveChannel[];\r\n    BS: ILiveChannel[];\r\n    CS: ILiveChannel[];\r\n    CATV: ILiveChannel[];\r\n    SKY: ILiveChannel[];\r\n    STARDIGIO: ILiveChannel[];\r\n}\r\n\r\n/** ニコニコ実況のセッション情報を表すインターフェイス */\r\nexport interface IJikkyoSession {\r\n    is_success: boolean;\r\n    audience_token: string | null;\r\n    detail: string;\r\n}\r\n\r\n\r\nclass Channels {\r\n\r\n    /**\r\n     * すべてのチャンネルの情報を取得する\r\n     * @return すべてのチャンネルの情報\r\n     */\r\n    static async fetchAll(): Promise<ILiveChannelsList | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.get<ILiveChannelsList>('/channels');\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, 'チャンネル情報を取得できませんでした。');\r\n            return null;\r\n        }\r\n\r\n        return response.data;\r\n    }\r\n\r\n\r\n    /**\r\n     * 指定したチャンネルの情報を取得する\r\n     * 現状、処理の見直しにより使用されていない\r\n     * @param channel_id チャンネル ID (id or display_channel_id)\r\n     * @return 指定したチャンネルの情報\r\n     */\r\n    static async fetch(channel_id: string): Promise<ILiveChannel | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.get<ILiveChannel>(`/channels/${channel_id}`);\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, 'チャンネル情報を取得できませんでした。');\r\n            return null;\r\n        }\r\n\r\n        return response.data;\r\n    }\r\n\r\n\r\n    /**\r\n     * 指定したチャンネルに紐づくニコニコ実況のセッション情報を取得する\r\n     * @param channel_id チャンネル ID (id or display_channel_id)\r\n     * @return 指定したチャンネルに紐づくニコニコ実況のセッション情報\r\n     */\r\n    static async fetchJikkyoSession(channel_id: string): Promise<IJikkyoSession | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.get<IJikkyoSession>(`/channels/${channel_id}/jikkyo`);\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, 'ニコニコ実況のセッション情報を取得できませんでした。');\r\n            return null;\r\n        }\r\n\r\n        return response.data;\r\n    }\r\n}\r\n\r\nexport default Channels;\r\n","\r\nimport { defineStore } from 'pinia';\r\n\r\nimport Channels, { ChannelType, ChannelTypePretty, ILiveChannelsList, ILiveChannel, ILiveChannelDefault } from '@/services/Channels';\r\nimport { IProgram, IProgramDefault } from '@/services/Programs';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils, { ChannelUtils } from '@/utils';\r\n\r\n\r\n/**\r\n * TV ホーム画面と TV 視聴画面の両方のページでチャンネル情報を共有するためのストア\r\n * チャンネル情報の API からの取得はかなり重めなので、ページ遷移時に毎回 API リクエストを行うのはパフォーマンスが悪い\r\n * チャンネル情報をストアに格納しておくことで、TV ホーム画面から TV 視聴画面に遷移したときのパフォーマンスが向上する\r\n */\r\nconst useChannelsStore = defineStore('channels', {\r\n    state: () => ({\r\n\r\n        // すべてのチャンネルタイプのチャンネルリスト\r\n        channels_list: {\r\n            GR: [],\r\n            BS: [],\r\n            CS: [],\r\n            CATV: [],\r\n            SKY: [],\r\n            STARDIGIO: [],\r\n        } as ILiveChannelsList,\r\n\r\n        // 初回のチャンネル情報更新が実行された後かどうか\r\n        is_channels_list_initial_updated: false,\r\n\r\n        // 最終更新日時 (UNIX タイムスタンプ、秒単位)\r\n        last_updated_at: 0,\r\n\r\n        // 現在視聴中のチャンネルの ID (ex: gr011)\r\n        // 視聴画面のみ有効で、ホーム画面では利用されない\r\n        // 視聴画面から離れる際は、必ず gr000 (現在視聴画面ではないことを示す特別な値) に戻さなければならない\r\n        // 本来は null あたりにすべきだが、null を入れると UI 側でのエラー処理が大変なので、やむを得ず形式上有効だが絶対にあり得ない値を入れている\r\n        display_channel_id: 'gr000' as string,\r\n\r\n        // 現在視聴中のチャンネルの視聴者数 (LiveEventManager でリアルタイムに更新される)\r\n        // チャンネル切り替え後、LiveEventManager で Server-Sent Events から取得されるまでは null になる\r\n        // 視聴画面のみ有効で、ホーム画面では利用されない\r\n        viewer_count: null as number | null,\r\n\r\n        // 現在視聴中のチャンネルの現在放送中の番組情報 (EPG (EIT[p/f]) からリアルタイムに更新される)\r\n        // チャンネル切り替え後、LiveDataBroadcastingManager で EIT[p/f] から取得されるまでは null になる\r\n        // 視聴画面のみ有効で、ホーム画面では利用されない\r\n        current_program_present: null as IProgram | null,\r\n\r\n        // 現在視聴中のチャンネルの次に放送される番組情報 (EPG (EIT[p/f]) からリアルタイムに更新される)\r\n        // チャンネル切り替え後、LiveDataBroadcastingManager で EIT[p/f] から取得されるまでは null になる\r\n        // 視聴画面のみ有効で、ホーム画面では利用されない\r\n        current_program_following: null as IProgram | null,\r\n    }),\r\n    getters: {\r\n\r\n        /**\r\n         * 前・現在・次のチャンネルの情報 (視聴画面用)\r\n         * チャンネル情報はデータ量がかなり多いので、個別に取得するより一気に取得したほうがループ回数が少なくなりパフォーマンスが良い\r\n         */\r\n        channel(): { previous: ILiveChannel; current: ILiveChannel; next: ILiveChannel; } {\r\n\r\n            // 初回のチャンネル情報更新がまだ実行されていない or 実行中のときは、情報取得中であることを示すダミーのチャンネル情報を返す\r\n            if (this.is_channels_list_initial_updated === false) {\r\n                return {\r\n                    previous: ILiveChannelDefault,\r\n                    current: ILiveChannelDefault,\r\n                    next: ILiveChannelDefault,\r\n                };\r\n            }\r\n\r\n            // エラー発生時用のダミーのチャンネル情報\r\n            const IProgramError: IProgram = {\r\n                ...IProgramDefault,\r\n                title: 'チャンネル情報取得エラー',\r\n                description: 'このチャンネル ID のチャンネル情報は存在しません。',\r\n            };\r\n            const ILiveChannelError: ILiveChannel = {\r\n                ...ILiveChannelDefault,\r\n                name: 'チャンネル情報取得エラー',\r\n                program_present: IProgramError,\r\n                program_following: IProgramError,\r\n            };\r\n\r\n            // display_channel_id に一致するチャンネルタイプを取得する\r\n            // 取得できなかった場合、display_channel_id 自体が不正なため、エラー発生時用のダミーのチャンネル情報を返す\r\n            // このチャンネル情報が返されたとき、視聴画面側では 404 ページへのリダイレクトが行われる\r\n            const channel_type = ChannelUtils.getChannelType(this.display_channel_id);\r\n            if (channel_type === null) {\r\n                return {\r\n                    previous: ILiveChannelError,\r\n                    current: ILiveChannelError,\r\n                    next: ILiveChannelError,\r\n                };\r\n            }\r\n\r\n            // チャンネルタイプごとのチャンネル情報リストを取得する (すべてのチャンネルリストから探索するより効率的)\r\n            const channels: ILiveChannel[] = this.channels_list[channel_type];\r\n\r\n            // 起点にするチャンネル情報があるインデックスを取得\r\n            // 取得できなかった場合、display_channel_id に一致するチャンネル情報は存在しないため、エラー発生時用のダミーのチャンネル情報を返す\r\n            // このチャンネル情報が返されたとき、視聴画面側では 404 ページへのリダイレクトが行われる\r\n            const current_channel_index = channels.findIndex((channel) => channel.display_channel_id === this.display_channel_id);\r\n            if (current_channel_index === -1) {\r\n                return {\r\n                    previous: ILiveChannelError,\r\n                    current: ILiveChannelError,\r\n                    next: ILiveChannelError,\r\n                };\r\n            }\r\n\r\n            // 前のインデックスを取得する\r\n            // インデックスがマイナスになった時は、最後のインデックスに巻き戻す\r\n            // channel.is_display が true のチャンネルに到達するまで続ける\r\n            const previous_channel_index = ((): number => {\r\n                let index = current_channel_index - 1;\r\n                while (channels.length) {\r\n                    if (index <= -1) {\r\n                        index = channels.length - 1;  // 最後のインデックス\r\n                    }\r\n                    if (channels[index].is_display) {\r\n                        return index;\r\n                    }\r\n                    index--;\r\n                }\r\n                return 0;\r\n            })();\r\n\r\n            // 次のインデックスを取得する\r\n            // インデックスが配列の長さを超えた時は、最初のインデックスに巻き戻す\r\n            // channel.is_display が true のチャンネルに到達するまで続ける\r\n            const next_channel_index = ((): number => {\r\n                let index = current_channel_index + 1;\r\n                while (channels.length) {\r\n                    if (index >= channels.length) {\r\n                        index = 0;  // 最初のインデックス\r\n                    }\r\n                    if (channels[index].is_display) {\r\n                        return index;\r\n                    }\r\n                    index++;\r\n                }\r\n                return 0;\r\n            })();\r\n\r\n            // structuredClone() でディープコピーを行い、プロパティの変更が channels_list 内のオブジェクトに反映されないようにする\r\n            // チャンネルリストに反映するとその時点で全チャンネルの再レンダリングが走ってしまい (?) 負荷が高まる\r\n            const current_channel = structuredClone(channels[current_channel_index]);\r\n\r\n            // 現在のチャンネル情報のみ、EPG から取得した現在/次の番組情報があればそちらを優先して上書き表示する\r\n            if (this.current_program_present !== null) {\r\n                current_channel.program_present = this.current_program_present;\r\n            }\r\n            if (this.current_program_following !== null) {\r\n                current_channel.program_following = this.current_program_following;\r\n            }\r\n\r\n            // 現在のチャンネル情報のみ、LiveEventManager から取得したリアルタイム視聴者数があればそちらを優先して上書き表示する\r\n            if (this.viewer_count !== null) {\r\n                current_channel.viewer_count = this.viewer_count;\r\n            }\r\n\r\n            // 前・現在・次のチャンネル情報を返す\r\n            return {\r\n                previous: channels[previous_channel_index],\r\n                current: current_channel,\r\n                next: channels[next_channel_index],\r\n            };\r\n        },\r\n\r\n        /**\r\n         * 実際に表示されるチャンネルリストを表すデータ\r\n         * ピン留めチャンネルのタブを追加するほか、放送していないサブチャンネルはピン留めタブを含めて表示から除外される\r\n         * また、チャンネルが1つもないチャンネルタイプのタブも表示から除外される\r\n         * (たとえば SKY (スカパー！プレミアムサービス) のタブは、SKY に属すチャンネルが1つもない（=受信できない）なら表示されない)\r\n         */\r\n        channels_list_with_pinned(): Map<ChannelTypePretty, ILiveChannel[]> {\r\n            const settings_store = useSettingsStore();\r\n\r\n            // 事前に Map を定義しておく\r\n            // Map にしていたのは、確か連想配列の順序を保証してくれるからだったはず\r\n            const channels_list_with_pinned = new Map<ChannelTypePretty, ILiveChannel[]>();\r\n            channels_list_with_pinned.set('ピン留め', []);\r\n            channels_list_with_pinned.set('地デジ', []);\r\n\r\n            // 初回のチャンネル情報更新がまだ実行されていない or 実行中のときは最低限の上記2つだけで返す\r\n            if (this.is_channels_list_initial_updated === false) {\r\n                return channels_list_with_pinned;\r\n            }\r\n\r\n            channels_list_with_pinned.set('BS', []);\r\n            channels_list_with_pinned.set('CS', []);\r\n            channels_list_with_pinned.set('CATV', []);\r\n            channels_list_with_pinned.set('SKY', []);\r\n            channels_list_with_pinned.set('StarDigio', []);\r\n\r\n            // pinned_channel_ids がもし NIDxxx-SIDxxx の形式の ID でなければ、NIDxxx-SIDxxx の形式に変換する\r\n            // pinned_channel_ids に display_channel_id が格納されている古い環境への互換性のため\r\n            settings_store.settings.pinned_channel_ids = settings_store.settings.pinned_channel_ids.map((channel_id) => {\r\n                if (channel_id.includes('NID') && channel_id.includes('SID')) {\r\n                    // すでに NIDxxx-SIDxxx の形式の ID になっているので、そのまま返す\r\n                    return channel_id;\r\n                } else {\r\n                    // display_channel_id (ex: gr011) の形式の ID なので、NIDxxx-SIDxxx の形式に変換する\r\n                    // チャンネルタイプごとのチャンネル情報リストを取得する (すべてのチャンネルリストから探索するより効率的)\r\n                    const channel_type = ChannelUtils.getChannelType(channel_id);\r\n                    if (channel_type === null) return 'NID0-SID0';  // 不正なチャンネル ID なことを示す特別な値\r\n                    const channels: ILiveChannel[] = this.channels_list[channel_type];\r\n                    const channel = channels.find((channel) => channel.display_channel_id === channel_id) ?? null;\r\n                    if (channel === null) return 'NID0-SID0';  // 不正なチャンネル ID なことを示す特別な値\r\n                    return channel.id;\r\n                }\r\n            }).filter((channel_id) => channel_id !== 'NID0-SID0');  // NID0-SID0 は不正なチャンネル ID なので除外する\r\n\r\n            // channels_list に格納されているすべてのチャンネルに対しループを回し、\r\n            // 順次 channels_list_with_pinned に追加していく\r\n            // 1つのチャンネルに対するループ回数が少なくなる分、毎回 filter() や find() するよりも高速になるはず\r\n            const pinned_channels: ILiveChannel[] = [];\r\n            for (const [channel_type, channels] of Object.entries(this.channels_list)) {\r\n                for (const channel of channels) {\r\n\r\n                    // ピン留め中チャンネルの ID (ex: NID32736-SID1024) が入るリストに含まれているチャンネルなら、ピン留めタブに追加\r\n                    // 一旦 pinned_channels に追加した後、pinned_channel_ids の順に並び替える\r\n                    // ピン留めされているなら放送していないサブチャンネルも含める\r\n                    if (settings_store.settings.pinned_channel_ids.includes(channel.id)) {\r\n                        pinned_channels.push(channel);\r\n                    }\r\n\r\n                    // 放送していないサブチャンネルは除外\r\n                    if (channel.is_display === false) {\r\n                        continue;\r\n                    }\r\n\r\n                    // チャンネルタイプごとに分類\r\n                    switch (channel.type) {\r\n                        case 'GR': {\r\n                            channels_list_with_pinned.get('地デジ')?.push(channel);\r\n                            break;\r\n                        }\r\n                        case 'BS': {\r\n                            channels_list_with_pinned.get('BS')?.push(channel);\r\n                            break;\r\n                        }\r\n                        case 'CS': {\r\n                            channels_list_with_pinned.get('CS')?.push(channel);\r\n                            break;\r\n                        }\r\n                        case 'CATV': {\r\n                            channels_list_with_pinned.get('CATV')?.push(channel);\r\n                            break;\r\n                        }\r\n                        case 'SKY': {\r\n                            channels_list_with_pinned.get('SKY')?.push(channel);\r\n                            break;\r\n                        }\r\n                        case 'STARDIGIO': {\r\n                            channels_list_with_pinned.get('StarDigio')?.push(channel);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // この時点で pinned_channels に存在していないピン留め中チャンネルの ID を pinned_channel_ids から削除する\r\n            // 受信環境の変化などでピン留め中チャンネルのチャンネル情報が取得できなくなった場合に備える\r\n            settings_store.settings.pinned_channel_ids = settings_store.settings.pinned_channel_ids.filter((channel_id) => {\r\n                return pinned_channels.some((channel) => channel.id === channel_id);\r\n            });\r\n\r\n            // ピン留め中チャンネルを pinned_channel_ids の順に並び替える\r\n            channels_list_with_pinned.get('ピン留め')?.push(...pinned_channels.sort((a, b) => {\r\n                const index_a = settings_store.settings.pinned_channel_ids.indexOf(a.id);\r\n                const index_b = settings_store.settings.pinned_channel_ids.indexOf(b.id);\r\n                return index_a - index_b;\r\n            }));\r\n\r\n            // 最後に、チャンネルが1つもないチャンネルタイプのタブを除外する (ピン留めタブを除く)\r\n            for (const [channel_type, channels] of channels_list_with_pinned) {\r\n                if (channel_type === 'ピン留め') {\r\n                    continue;\r\n                }\r\n                if (channels.length === 0) {\r\n                    channels_list_with_pinned.delete(channel_type);\r\n                }\r\n            }\r\n\r\n            // ただし、this.channels_list_with_pinned 全体が空でもうピン留めタブしか残っていない場合は、ピン留めタブも削除する\r\n            if (channels_list_with_pinned.size === 1 && channels_list_with_pinned.has('ピン留め')) {\r\n                channels_list_with_pinned.delete('ピン留め');\r\n            }\r\n\r\n            return channels_list_with_pinned;\r\n        },\r\n\r\n        /**\r\n         * 視聴画面向けの channels_list_with_pinned\r\n         * 視聴画面ではピン留め中チャンネルが1つもないときは、ピン留めタブを表示する必要性がないため削除される\r\n         */\r\n        channels_list_with_pinned_for_watch(): Map<ChannelTypePretty, ILiveChannel[]> {\r\n\r\n            // 意図せぬ副作用が発生しないように、channels_list_with_pinned が返す Map をコピーする\r\n            const channels_list_with_pinned = new Map([...this.channels_list_with_pinned]);\r\n\r\n            // 初回のチャンネル情報更新がまだ実行されていない or 実行中のときのみ、表示タイミングの問題で例外的に常にピン留めタブを削除せずに返す\r\n            // こうしないと視聴画面に直接アクセスした際に、ピン留めタブではなく地デジタブがデフォルトで表示されてしまう\r\n            if (this.is_channels_list_initial_updated === false) {\r\n                return channels_list_with_pinned;\r\n            }\r\n\r\n            // ピン留め中チャンネルが1つもない場合は、ピン留めタブを削除する\r\n            if (channels_list_with_pinned.get('ピン留め')?.length === 0) {\r\n                channels_list_with_pinned.delete('ピン留め');\r\n            }\r\n\r\n            return channels_list_with_pinned;\r\n        }\r\n    },\r\n    actions: {\r\n\r\n        /**\r\n         * チャンネルタイプとリモコン番号からチャンネル情報を取得する\r\n         * @param channel_type チャンネルタイプ\r\n         * @param remocon_id リモコン番号\r\n         * @returns チャンネル情報 (見つからなかった場合は null)\r\n         */\r\n        getChannelByRemoconID(channel_type: ChannelType, remocon_id: number): ILiveChannel | null {\r\n\r\n            // 指定されたチャンネルタイプのチャンネルを取得\r\n            const channels = this.channels_list[channel_type];\r\n\r\n            // リモコン番号が一致するチャンネルを取得\r\n            const channel = channels.find((channel) => channel.remocon_id === remocon_id);\r\n\r\n            // リモコン番号が一致するチャンネルを見つけられなかった場合は null を返す\r\n            return channel ?? null;\r\n        },\r\n\r\n        /**\r\n         * チャンネルリストを更新する\r\n         * @param force 強制的に更新するかどうか\r\n         */\r\n        async update(force: boolean = false): Promise<void> {\r\n\r\n            const update = async () => {\r\n\r\n                // 最新のすべてのチャンネルの情報を取得\r\n                const channels_list = await Channels.fetchAll();\r\n                if (channels_list === null) {\r\n                    return;\r\n                }\r\n\r\n                // 再帰的に Object.freeze() を適用し、Vue 側で再帰的にリアクティブ化されないようにする\r\n                // channels_list 内の大量のチャンネル/番組情報オブジェクトはここ以外から更新されることはない\r\n                // さらに更新周期自体も基本 30 秒以上な上、毎回一括更新で一部だけが更新されることもないため、リアクティブである必要がない\r\n                // 大きなオブジェクトを扱う際は、細部のリアクティブを捨てることでパフォーマンスが向上する (下記記事が大変参考になりました)\r\n                // ref: https://speakerdeck.com/tbashiyy/shi-shu-mo-rekodoninai-euruvue-dot-jspuroziekutowoshi-xian-surutamenopahuomansutiyuningu\r\n                // ref: https://unyacat.net/2021/01/20/vue-freeze-faster/\r\n                this.channels_list = Utils.deepObjectFreeze(channels_list);\r\n\r\n                // チャンネルリストの更新日時を更新\r\n                if (this.is_channels_list_initial_updated === false) {\r\n                    this.is_channels_list_initial_updated = true;\r\n                }\r\n                this.last_updated_at = Utils.time();\r\n            };\r\n\r\n            // すでに取得されている場合は更新しない\r\n            if (this.is_channels_list_initial_updated === true && force === false) {\r\n\r\n                // ただし、最終更新日時が1分以上前の場合は非同期で更新する\r\n                if (Utils.time() - this.last_updated_at > 60) {\r\n                    update();\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            // チャンネルリストの更新を行う\r\n            await update();\r\n        }\r\n    }\r\n});\r\n\r\nexport default useChannelsStore;\r\n","<template>\r\n    <v-dialog max-width=\"550\" transition=\"slide-y-transition\" v-model=\"pinned_channel_settings_modal\">\r\n        <v-card class=\"pinned-channels-settings\">\r\n            <v-card-title class=\"px-5 pt-5 pb-3 d-flex align-center font-weight-bold\" style=\"height: 60px;\">\r\n                <Icon icon=\"iconamoon:sorting-left-bold\" height=\"26px\" />\r\n                <span class=\"ml-3\">ピン留め中チャンネルの並び替え</span>\r\n                <v-spacer></v-spacer>\r\n                <div v-ripple class=\"d-flex align-center rounded-circle cursor-pointer px-2 py-2\" @click=\"pinned_channel_settings_modal = false\">\r\n                    <Icon icon=\"fluent:dismiss-12-filled\" width=\"23px\" height=\"23px\" />\r\n                </div>\r\n            </v-card-title>\r\n            <div class=\"px-5 pb-5\">\r\n                <div class=\"pinned-channels-settings__label\"\r\n                    v-if=\"(channelsStore.channels_list_with_pinned.get('ピン留め') ?? []).length > 0\">\r\n                    <div>各チャンネルのつまみをドラッグして並べ替えできます。</div>\r\n                </div>\r\n                <div class=\"pinned-channels-settings__label\"\r\n                    v-if=\"(channelsStore.channels_list_with_pinned.get('ピン留め') ?? []).length === 0\">\r\n                    <div><b>ピン留めされているチャンネルがありません。</b></div>\r\n                    <div class=\"mt-1\">TV ホーム画面のチャンネルリストの <Icon style=\"position: relative; bottom: -5px;\" icon=\"fluent:pin-20-filled\" width=\"18.5px\" /> アイコンから、よくみるチャンネルをピン留めできます。</div>\r\n                </div>\r\n                <draggable class=\"pinned-channels\" v-model=\"settingsStore.settings.pinned_channel_ids\" handle=\".pinned-channel__sort-handle\"\r\n                    v-if=\"(channelsStore.channels_list_with_pinned.get('ピン留め') ?? []).length > 0\">\r\n                    <!-- 以下では Icon コンポーネントを使うと個数が多いときに高負荷になるため、意図的に SVG を直書きしている -->\r\n                    <div class=\"pinned-channel\"\r\n                        v-for=\"channel in channelsStore.channels_list_with_pinned.get('ピン留め') ?? []\" :key=\"channel.id\">\r\n                        <img class=\"pinned-channel__icon\" :src=\"`${Utils.api_base_url}/channels/${channel.id}/logo`\">\r\n                        <span class=\"pinned-channel__name\">Ch: {{channel.channel_number}} {{channel.name}}</span>\r\n                        <button class=\"pinned-channel__sort-handle\">\r\n                            <svg class=\"iconify iconify--material-symbols\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\">\r\n                                <path fill=\"currentColor\" d=\"M5 15q-.425 0-.713-.288T4 14q0-.425.288-.713T5 13h14q.425 0 .713.288T20 14q0 .425-.288.713T19 15H5Zm0-4q-.425 0-.713-.288T4 10q0-.425.288-.713T5 9h14q.425 0 .713.288T20 10q0 .425-.288.713T19 11H5Z\"></path>\r\n                            </svg>\r\n                        </button>\r\n                        <button v-ripple class=\"pinned-channel__delete-button\"\r\n                            @click=\"settingsStore.settings.pinned_channel_ids.splice(settingsStore.settings.pinned_channel_ids.indexOf(channel.id), 1)\">\r\n                            <svg class=\"iconify iconify--fluent\" width=\"20px\" height=\"20px\" viewBox=\"0 0 16 16\">\r\n                                <path fill=\"currentColor\" d=\"M7 3h2a1 1 0 0 0-2 0ZM6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1h4Zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5ZM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5Z\"></path>\r\n                            </svg>\r\n                        </button>\r\n                    </div>\r\n                </draggable>\r\n            </div>\r\n        </v-card>\r\n    </v-dialog>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent, PropType } from 'vue';\r\nimport draggable from 'vuedraggable';\r\n\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'PinnedChannelSettings',\r\n    components: {\r\n        draggable,\r\n    },\r\n    props: {\r\n        modelValue: {\r\n            type: Boolean as PropType<boolean>,\r\n            required: true,\r\n        }\r\n    },\r\n    emits: {\r\n        'update:modelValue': (value: boolean) => true,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n\r\n            // ピン留め中チャンネルの並び替え設定のモーダルを表示するか\r\n            pinned_channel_settings_modal: false,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useChannelsStore, useSettingsStore),\r\n    },\r\n    watch: {\r\n\r\n        // modelValue (親コンポーネント側: Props) の変更を監視し、変更されたら pinned_channel_settings_modal に反映する\r\n        modelValue() {\r\n            this.pinned_channel_settings_modal = this.modelValue;\r\n        },\r\n\r\n        // pinned_channel_settings_modal (子コンポーネント側) の変更を監視し、変更されたら this.$emit() で親コンポーネントに伝える\r\n        pinned_channel_settings_modal() {\r\n            this.$emit('update:modelValue', this.pinned_channel_settings_modal);\r\n        }\r\n    },\r\n    async created() {\r\n\r\n        // チャンネル情報を更新\r\n        await this.channelsStore.update();\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.pinned-channels-settings {\r\n    .v-card__title, & > div {\r\n        @include smartphone-vertical {\r\n            padding-left: 12px !important;\r\n            padding-right: 12px !important;\r\n        }\r\n    }\r\n    .v-card__title span {\r\n        font-size: 20px;\r\n        @include smartphone-vertical {\r\n            font-size: 15.5px;\r\n        }\r\n    }\r\n}\r\n\r\n.pinned-channels-settings__label {\r\n    margin-top: 8px;\r\n    color: var(--v-text-darken1);\r\n    font-size: 13.5px;\r\n    line-height: 1.6;\r\n    @include smartphone-horizontal {\r\n        font-size: 11px;\r\n        line-height: 1.7;\r\n    }\r\n}\r\n\r\n.pinned-channels {\r\n    display: flex;\r\n    flex-direction: column;\r\n    margin-top: 12px;\r\n\r\n    .pinned-channel {\r\n        display: flex;\r\n        align-items: center;\r\n        padding: 6px 0px;\r\n        border-bottom: 1px solid var(--v-background-lighten2);\r\n        transition: background-color 0.15s ease;\r\n\r\n        &:last-of-type {\r\n            border-bottom: none;\r\n        }\r\n\r\n        &__icon {\r\n            display: inline-block;\r\n            flex-shrink: 0;\r\n            width: 64px;\r\n            height: 36px;\r\n            border-radius: 4px;\r\n            // 読み込まれるまでのアイコンの背景\r\n            background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n            object-fit: cover;\r\n        }\r\n\r\n        &__name {\r\n            margin-left: 16px;\r\n            font-size: 16.5px;\r\n            overflow: hidden;\r\n            white-space: nowrap;\r\n            text-overflow: ellipsis;\r\n            @include smartphone-vertical {\r\n                margin-left: 12px;\r\n                font-size: 15.5px;\r\n            }\r\n        }\r\n\r\n        &__sort-handle {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            width: 35px;\r\n            height: 40px;\r\n            margin-left: auto;\r\n            border-radius: 5px;\r\n            outline: none;\r\n            cursor: grab;\r\n        }\r\n\r\n        &__delete-button {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            width: 35px;\r\n            height: 40px;\r\n            margin-left: 4px;\r\n            border-radius: 5px;\r\n            outline: none;\r\n            cursor: pointer;\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PinnedChannelSettings.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PinnedChannelSettings.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./PinnedChannelSettings.vue?vue&type=template&id=8993ac36&scoped=true\"\nimport script from \"./PinnedChannelSettings.vue?vue&type=script&lang=ts\"\nexport * from \"./PinnedChannelSettings.vue?vue&type=script&lang=ts\"\nimport style0 from \"./PinnedChannelSettings.vue?vue&type=style&index=0&id=8993ac36&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8993ac36\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <!-- ベース画面の中にそれぞれの設定画面で異なる部分を記述する -->\r\n    <SettingsBase>\r\n        <h2 class=\"settings__heading\">\r\n            <router-link v-ripple class=\"settings__back-button\" to=\"/settings/\">\r\n                <Icon icon=\"fluent:arrow-left-12-filled\" width=\"25px\" />\r\n            </router-link>\r\n            <Icon icon=\"fa-solid:sliders-h\" width=\"19px\" style=\"margin: 0 4px;\" />\r\n            <span class=\"ml-3\">全般</span>\r\n        </h2>\r\n        <div class=\"settings__content\">\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">ピン留め中チャンネルの並び替え</div>\r\n                <div class=\"settings__item-label\">\r\n                    ピン留め中のチャンネルの表示順序を変更できます。よくみるチャンネルは先頭に配置しておくと便利です。<br>\r\n                    ピン留め中のチャンネルの追加・削除は、別途 TV ホーム画面のチャンネルリストから行えます。<br>\r\n                </div>\r\n            </div>\r\n            <v-btn class=\"settings__save-button mt-4\" depressed @click=\"pinned_channel_settings_modal = !pinned_channel_settings_modal\">\r\n                <Icon icon=\"iconamoon:sorting-left-bold\" height=\"19px\" />\r\n                <span class=\"ml-1\">ピン留め中チャンネルの並び替え設定を開く</span>\r\n            </v-btn>\r\n            <div class=\"settings__item settings__item--switch\">\r\n                <label class=\"settings__item-heading\" for=\"tv_channel_selection_requires_alt_key\">チャンネル選局のキーボードショートカットを {{Utils.AltOrOption()}} + 数字キー/テンキーに変更する</label>\r\n                <label class=\"settings__item-label\" for=\"tv_channel_selection_requires_alt_key\">\r\n                    この設定をオンにすると、数字キーまたはテンキーに対応するリモコン番号（1～12）のチャンネルに切り替える際、{{Utils.AltOrOption()}} キーを同時に押す必要があります。<br>\r\n                    コメントやツイートを入力しようとして誤って数字キーを押してしまい、チャンネルが変わってしまう事態を避けたい方におすすめです。<br>\r\n                </label>\r\n                <v-switch class=\"settings__item-switch\" id=\"tv_channel_selection_requires_alt_key\" inset hide-details\r\n                    v-model=\"settingsStore.settings.tv_channel_selection_requires_alt_key\">\r\n                </v-switch>\r\n            </div>\r\n            <v-divider class=\"mt-6\"></v-divider>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">デフォルトのパネルの表示状態</div>\r\n                <div class=\"settings__item-label\">\r\n                    視聴画面を開いたときに、右側のパネルをどう表示するかを設定します。<br>\r\n                </div>\r\n                <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\"\r\n                    :items=\"panel_display_state\" v-model=\"settingsStore.settings.panel_display_state\">\r\n                </v-select>\r\n            </div>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">テレビをみるときにデフォルトで表示されるパネルのタブ</div>\r\n                <div class=\"settings__item-label\">\r\n                    テレビの視聴画面を開いたときに、右側のパネルで最初に表示されるタブを設定します。<br>\r\n                </div>\r\n                <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\"\r\n                    :items=\"tv_panel_active_tab\" v-model=\"settingsStore.settings.tv_panel_active_tab\">\r\n                </v-select>\r\n            </div>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">ビデオをみるときにデフォルトで表示されるパネルのタブ</div>\r\n                <div class=\"settings__item-label\">\r\n                    ビデオの視聴画面を開いたときに、右側のパネルで最初に表示されるタブを設定します。<br>\r\n                </div>\r\n                <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\"\r\n                    :items=\"video_panel_active_tab\" v-model=\"settingsStore.settings.video_panel_active_tab\">\r\n                </v-select>\r\n            </div>\r\n            <v-divider class=\"mt-6\"></v-divider>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">設定をエクスポート</div>\r\n                <div class=\"settings__item-label\">\r\n                    このデバイス（ブラウザ）に保存されている設定データを、エクスポート（ダウンロード）できます。<br>\r\n                    ダウンロードした設定データ (KonomiTV-Settings.json) は、[設定をインポート] からインポートできます。異なるサーバーの KonomiTV を同じ設定で使いたいときなどに使ってください。<br>\r\n                </div>\r\n            </div>\r\n            <v-btn class=\"settings__save-button mt-4\" depressed @click=\"exportSettings()\">\r\n                <Icon icon=\"fa6-solid:download\" class=\"mr-3\" height=\"19px\" />設定をエクスポート\r\n            </v-btn>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading error--text text--lighten-1\">設定をインポート</div>\r\n                <div class=\"settings__item-label\">\r\n                    [設定をエクスポート] でダウンロードした設定データを、このデバイス（ブラウザ）にインポートできます。<br>\r\n                    設定をインポートすると、<b>現在のデバイス設定はすべて上書きされます。</b>元に戻すことはできません。<br>\r\n                    設定のデバイス間同期がオンのときは、<b>同期が有効なすべてのデバイスに反映されます。</b>十分ご注意ください。<br>\r\n                </div>\r\n                <v-file-input class=\"settings__item-form\" outlined hide-details placeholder=\"設定データ (KonomiTV-Settings.json) を選択\"\r\n                    :dense=\"is_form_dense\"\r\n                    accept=\"application/json\"\r\n                    prepend-icon=\"\"\r\n                    prepend-inner-icon=\"mdi-paperclip\"\r\n                    v-model=\"import_settings_file\">\r\n                </v-file-input>\r\n            </div>\r\n            <v-btn class=\"settings__save-button error mt-5\" depressed @click=\"importSettings()\">\r\n                <Icon icon=\"fa6-solid:upload\" class=\"mr-3\" height=\"19px\" />設定をインポート\r\n            </v-btn>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading error--text text--lighten-1\">設定を初期状態にリセット</div>\r\n                <div class=\"settings__item-label\">\r\n                    このデバイス（ブラウザ）に保存されている設定データを、初期状態のデフォルト値にリセットできます。<br>\r\n                    設定をリセットすると、元に戻すことはできません。<br>\r\n                    設定のデバイス間同期がオンのときは、<b>同期が有効なすべてのデバイスに反映されます。</b>十分ご注意ください。<br>\r\n                </div>\r\n            </div>\r\n            <v-btn class=\"settings__save-button error mt-5\" depressed @click=\"resetSettings()\">\r\n                <Icon icon=\"material-symbols:device-reset-rounded\" class=\"mr-2\" height=\"23px\" />設定をリセット\r\n            </v-btn>\r\n        </div>\r\n        <PinnedChannelSettings :modelValue=\"pinned_channel_settings_modal\" @update:modelValue=\"pinned_channel_settings_modal = $event\" />\r\n    </SettingsBase>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport PinnedChannelSettings from '@/components/Settings/PinnedChannelSettings.vue';\r\nimport Message from '@/message';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils from '@/utils';\r\nimport SettingsBase from '@/views/Settings/Base.vue';\r\n\r\nexport default defineComponent({\r\n    name: 'Settings-General',\r\n    components: {\r\n        PinnedChannelSettings,\r\n        SettingsBase,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n\r\n            // フォームを小さくするかどうか\r\n            is_form_dense: Utils.isSmartphoneHorizontal(),\r\n\r\n            // ピン留め中チャンネルの並び替え設定のモーダルを表示するか\r\n            pinned_channel_settings_modal: false,\r\n\r\n            // デフォルトのパネルの表示状態の選択肢\r\n            panel_display_state: [\r\n                {text: '前回の状態を復元する', value: 'RestorePreviousState'},\r\n                {text: '常に表示する', value: 'AlwaysDisplay'},\r\n                {text: '常に折りたたむ', value: 'AlwaysFold'},\r\n            ],\r\n\r\n            // テレビをみるときにデフォルトで表示されるパネルのタブの選択肢\r\n            tv_panel_active_tab: [\r\n                {text: '番組情報タブ', value: 'Program'},\r\n                {text: 'チャンネルタブ', value: 'Channel'},\r\n                {text: 'コメントタブ', value: 'Comment'},\r\n                {text: 'Twitter タブ', value: 'Twitter'},\r\n            ],\r\n\r\n            // ビデオをみるときにデフォルトで表示されるパネルのタブの選択肢\r\n            video_panel_active_tab: [\r\n                {text: '番組情報タブ', value: 'RecordedProgram'},\r\n                {text: 'シリーズタブ', value: 'Series'},\r\n                {text: 'コメントタブ', value: 'Comment'},\r\n                {text: 'Twitter タブ', value: 'Twitter'},\r\n            ],\r\n\r\n            // 選択された設定データ (KonomiTV-Settings.json) が入る\r\n            import_settings_file: null as File | null,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useSettingsStore),\r\n    },\r\n    methods: {\r\n\r\n        // 設定データをエクスポートする\r\n        exportSettings() {\r\n\r\n            // 設定データを JSON 化して取得\r\n            const settings_json = JSON.stringify(this.settingsStore.settings, null, 4);\r\n\r\n            // ダウンロードさせるために一旦 Blob にしてから、KonomiTV-Settings.json としてダウンロード\r\n            const settings_json_blob = new Blob([settings_json], {type: 'application/json'});\r\n            Utils.downloadBlobData(settings_json_blob, 'KonomiTV-Settings.json');\r\n            Message.success('設定をエクスポートしました。');\r\n        },\r\n\r\n        // 設定データをインポートする\r\n        async importSettings() {\r\n\r\n            // 設定データが選択されていないときは実行しない\r\n            if (this.import_settings_file === null) {\r\n                Message.error('インポートする設定データを選択してください！');\r\n                return;\r\n            }\r\n\r\n            // 設定データのインポートを実行\r\n            const result = await this.settingsStore.importClientSettings(this.import_settings_file);\r\n            if (result === true) {\r\n                Message.success('設定をインポートしました。');\r\n                window.setTimeout(() => this.$router.go(0), 300);\r\n            } else {\r\n                Message.error('設定データが不正なため、インポートできませんでした。');\r\n            }\r\n        },\r\n\r\n        // 設定データをリセットする\r\n        async resetSettings() {\r\n            await this.settingsStore.resetClientSettings();\r\n            Message.success('設定をリセットしました。');\r\n            window.setTimeout(() => this.$router.go(0), 300);\r\n        },\r\n    }\r\n});\r\n\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./General.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./General.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./General.vue?vue&type=template&id=c9c37dda\"\nimport script from \"./General.vue?vue&type=script&lang=ts\"\nexport * from \"./General.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"route-container\"},[_c('Header'),_c('main',[_c('Navigation'),_c('v-card',{staticClass:\"settings-container d-flex px-5 py-5 mx-auto background\",attrs:{\"elevation\":\"0\",\"width\":\"100%\",\"max-width\":\"1000\"}},[_c('v-navigation-drawer',{staticClass:\"settings-navigation flex-shrink-0 background\",attrs:{\"permanent\":\"\",\"width\":\"100%\",\"height\":\"auto\"}},[_c('v-list-item',{staticClass:\"px-1\"},[_c('v-list-item-content',[_c('h1',[_vm._v(\"設定\")])])],1),_c('v-list',{staticClass:\"mt-2 px-0\",attrs:{\"nav\":\"\"}},[_c('v-list-item',{staticClass:\"px-4\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/general\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{staticStyle:{\"padding\":\"0 3px\"},attrs:{\"icon\":\"fa-solid:sliders-h\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"全般\")])],1)],1),_c('v-list-item',{staticClass:\"px-4\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/quality\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:video-clip-multiple-16-filled\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"画質\")])],1)],1),_c('v-list-item',{staticClass:\"px-4\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/caption\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:subtitles-16-filled\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"字幕\")])],1)],1),_c('v-list-item',{staticClass:\"px-4\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/data-broadcasting\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('svg',{attrs:{\"width\":\"26px\",\"height\":\"26px\",\"viewBox\":\"0 0 512 512\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M248.039 381.326L355.039 67.8258C367.539 28.3257 395.039 34.3258 406.539 34.3258C431.039 34.3258 453.376 61.3258 441.039 96.8258C362.639 322.426 343.539 375.326 340.539 384.826C338.486 391.326 342.039 391.326 345.539 391.326C377.039 391.326 386.539 418.326 386.539 435.326C386.539 458.826 371.539 477.326 350.039 477.326H214.539C179.039 477.326 85.8269 431.3 88.0387 335.826C91.0387 206.326 192.039 183.326 243.539 183.326H296.539L265.539 272.326H243.539C185.539 272.326 174.113 314.826 176.039 334.326C180.039 374.826 215.039 389.814 237.039 390.326C244.539 390.5 246.039 386.826 248.039 381.326Z\"}})])]),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"データ放送\")])],1)],1),_c('v-list-item',{staticClass:\"px-4\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/capture\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:image-multiple-16-filled\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"キャプチャ\")])],1)],1),_c('v-list-item',{staticClass:\"px-4\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/account\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:person-20-filled\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"アカウント\")])],1)],1),_c('v-list-item',{staticClass:\"px-4\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/jikkyo\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{staticStyle:{\"padding\":\"0 2px\"},attrs:{\"icon\":\"bi:chat-left-text-fill\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"ニコニコ実況\")])],1)],1),_c('v-list-item',{staticClass:\"px-4\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/twitter\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{staticStyle:{\"padding\":\"0 1px\"},attrs:{\"icon\":\"fa-brands:twitter\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"Twitter\")])],1)],1),_c('v-list-item',{staticClass:\"px-4\",attrs:{\"link\":\"\",\"color\":\"primary\",\"to\":\"/settings/server\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:server-surface-16-filled\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"サーバー設定\")])],1)],1),_c('v-list-item',{staticClass:\"px-4 settings-navigation-version\",class:{'settings-navigation-version--highlight': _vm.versionStore.is_update_available},attrs:{\"link\":\"\",\"color\":\"primary\",\"href\":\"https://github.com/tsukumijima/KonomiTV\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:info-16-regular\",\"width\":\"26px\"}})],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\" version \"+_vm._s(_vm.versionStore.client_version)+_vm._s(_vm.versionStore.is_update_available ? ' (Update Available)' : '')+\" \")])],1)],1)],1)],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"route-container\">\r\n        <Header/>\r\n        <main>\r\n            <Navigation/>\r\n            <v-card class=\"settings-container d-flex px-5 py-5 mx-auto background\" elevation=\"0\" width=\"100%\" max-width=\"1000\">\r\n                <v-navigation-drawer permanent class=\"settings-navigation flex-shrink-0 background\" width=\"100%\" height=\"auto\">\r\n                    <v-list-item class=\"px-1\">\r\n                        <v-list-item-content>\r\n                            <h1>設定</h1>\r\n                        </v-list-item-content>\r\n                    </v-list-item>\r\n                    <v-list nav class=\"mt-2 px-0\">\r\n                        <v-list-item link color=\"primary\" class=\"px-4\" to=\"/settings/general\">\r\n                            <v-list-item-icon class=\"mr-4\">\r\n                                <Icon icon=\"fa-solid:sliders-h\" width=\"26px\" style=\"padding: 0 3px;\" />\r\n                            </v-list-item-icon>\r\n                            <v-list-item-content>\r\n                                <v-list-item-title>全般</v-list-item-title>\r\n                            </v-list-item-content>\r\n                        </v-list-item>\r\n                        <v-list-item link color=\"primary\" class=\"px-4\" to=\"/settings/quality\">\r\n                            <v-list-item-icon class=\"mr-4\">\r\n                                <Icon icon=\"fluent:video-clip-multiple-16-filled\" width=\"26px\" />\r\n                            </v-list-item-icon>\r\n                            <v-list-item-content>\r\n                                <v-list-item-title>画質</v-list-item-title>\r\n                            </v-list-item-content>\r\n                        </v-list-item>\r\n                        <v-list-item link color=\"primary\" class=\"px-4\" to=\"/settings/caption\">\r\n                            <v-list-item-icon class=\"mr-4\">\r\n                                <Icon icon=\"fluent:subtitles-16-filled\" width=\"26px\" />\r\n                            </v-list-item-icon>\r\n                            <v-list-item-content>\r\n                                <v-list-item-title>字幕</v-list-item-title>\r\n                            </v-list-item-content>\r\n                        </v-list-item>\r\n                        <v-list-item link color=\"primary\" class=\"px-4\" to=\"/settings/data-broadcasting\">\r\n                            <v-list-item-icon class=\"mr-4\">\r\n                                <svg width=\"26px\" height=\"26px\" viewBox=\"0 0 512 512\">\r\n                                    <path fill=\"currentColor\" d=\"M248.039 381.326L355.039 67.8258C367.539 28.3257 395.039 34.3258 406.539 34.3258C431.039 34.3258 453.376 61.3258 441.039 96.8258C362.639 322.426 343.539 375.326 340.539 384.826C338.486 391.326 342.039 391.326 345.539 391.326C377.039 391.326 386.539 418.326 386.539 435.326C386.539 458.826 371.539 477.326 350.039 477.326H214.539C179.039 477.326 85.8269 431.3 88.0387 335.826C91.0387 206.326 192.039 183.326 243.539 183.326H296.539L265.539 272.326H243.539C185.539 272.326 174.113 314.826 176.039 334.326C180.039 374.826 215.039 389.814 237.039 390.326C244.539 390.5 246.039 386.826 248.039 381.326Z\" />\r\n                                </svg>\r\n                            </v-list-item-icon>\r\n                            <v-list-item-content>\r\n                                <v-list-item-title>データ放送</v-list-item-title>\r\n                            </v-list-item-content>\r\n                        </v-list-item>\r\n                        <v-list-item link color=\"primary\" class=\"px-4\" to=\"/settings/capture\">\r\n                            <v-list-item-icon class=\"mr-4\">\r\n                                <Icon icon=\"fluent:image-multiple-16-filled\" width=\"26px\" />\r\n                            </v-list-item-icon>\r\n                            <v-list-item-content>\r\n                                <v-list-item-title>キャプチャ</v-list-item-title>\r\n                            </v-list-item-content>\r\n                        </v-list-item>\r\n                        <v-list-item link color=\"primary\" class=\"px-4\" to=\"/settings/account\">\r\n                            <v-list-item-icon class=\"mr-4\">\r\n                                <Icon icon=\"fluent:person-20-filled\" width=\"26px\" />\r\n                            </v-list-item-icon>\r\n                            <v-list-item-content>\r\n                                <v-list-item-title>アカウント</v-list-item-title>\r\n                            </v-list-item-content>\r\n                        </v-list-item>\r\n                        <v-list-item link color=\"primary\" class=\"px-4\" to=\"/settings/jikkyo\">\r\n                            <v-list-item-icon class=\"mr-4\">\r\n                                <Icon icon=\"bi:chat-left-text-fill\" width=\"26px\" style=\"padding: 0 2px;\" />\r\n                            </v-list-item-icon>\r\n                            <v-list-item-content>\r\n                                <v-list-item-title>ニコニコ実況</v-list-item-title>\r\n                            </v-list-item-content>\r\n                        </v-list-item>\r\n                        <v-list-item link color=\"primary\" class=\"px-4\" to=\"/settings/twitter\">\r\n                            <v-list-item-icon class=\"mr-4\">\r\n                                <Icon icon=\"fa-brands:twitter\" width=\"26px\" style=\"padding: 0 1px;\" />\r\n                            </v-list-item-icon>\r\n                            <v-list-item-content>\r\n                                <v-list-item-title>Twitter</v-list-item-title>\r\n                            </v-list-item-content>\r\n                        </v-list-item>\r\n                        <v-list-item link color=\"primary\" class=\"px-4\" to=\"/settings/server\">\r\n                            <v-list-item-icon class=\"mr-4\">\r\n                                <Icon icon=\"fluent:server-surface-16-filled\" width=\"26px\" />\r\n                            </v-list-item-icon>\r\n                            <v-list-item-content>\r\n                                <v-list-item-title>サーバー設定</v-list-item-title>\r\n                            </v-list-item-content>\r\n                        </v-list-item>\r\n                        <v-list-item link color=\"primary\" class=\"px-4 settings-navigation-version\" href=\"https://github.com/tsukumijima/KonomiTV\"\r\n                            :class=\"{'settings-navigation-version--highlight': versionStore.is_update_available}\">\r\n                            <v-list-item-icon class=\"mr-4\">\r\n                                <Icon icon=\"fluent:info-16-regular\" width=\"26px\" />\r\n                            </v-list-item-icon>\r\n                            <v-list-item-content>\r\n                                <v-list-item-title>\r\n                                    version {{versionStore.client_version}}{{versionStore.is_update_available ? ' (Update Available)' : ''}}\r\n                                </v-list-item-title>\r\n                            </v-list-item-content>\r\n                        </v-list-item>\r\n                    </v-list>\r\n                </v-navigation-drawer>\r\n            </v-card>\r\n        </main>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport Header from '@/components/Header.vue';\r\nimport Navigation from '@/components/Navigation.vue';\r\nimport useVersionStore from '@/stores/VersionStore';\r\n\r\nexport default defineComponent({\r\n    name: 'Settings-Index',\r\n    components: {\r\n        Header,\r\n        Navigation,\r\n    },\r\n    computed: {\r\n        ...mapStores(useVersionStore),\r\n    },\r\n    async created() {\r\n        await this.versionStore.fetchServerVersion();\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.settings-container {\r\n    width: 100%;\r\n    min-width: 0;\r\n    @include smartphone-horizontal {\r\n        padding: 16px 20px !important;\r\n    }\r\n    @include smartphone-horizontal-short {\r\n        padding: 16px 16px !important;\r\n    }\r\n    @include smartphone-vertical {\r\n        padding: 16px 16px !important;\r\n    }\r\n\r\n    .settings-navigation {\r\n        transform: none !important;\r\n        visibility: visible !important;\r\n\r\n        .settings-navigation-version {\r\n            display: none;\r\n            @include smartphone-vertical {\r\n                display: flex;\r\n            }\r\n            &--highlight {\r\n                color: var(--v-secondary-lighten1);\r\n            }\r\n        }\r\n\r\n        h1 {\r\n            @include smartphone-horizontal {\r\n                font-size: 22px !important;\r\n            }\r\n        }\r\n\r\n        .v-navigation-drawer__content .v-list {\r\n            @include smartphone-horizontal {\r\n                margin-top: 12px !important;\r\n                padding: 0 !important;\r\n            }\r\n        }\r\n\r\n        .v-list-item--link, .v-list-item--link:before {\r\n            background: var(--v-background-lighten1);\r\n            border-radius: 6px !important;\r\n            margin-top: 6px !important;\r\n            margin-bottom: 0px !important;\r\n        }\r\n        .v-list-item--link {\r\n            &:first-of-type {\r\n                margin-top: 0 !important;\r\n            }\r\n        }\r\n        .v-list-item__icon {\r\n            margin: 14px 0 !important;\r\n            margin-right: 16px !important;\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=5a81b5be&scoped=true\"\nimport script from \"./Index.vue?vue&type=script&lang=ts\"\nexport * from \"./Index.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Index.vue?vue&type=style&index=0&id=5a81b5be&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5a81b5be\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('SettingsBase',[_c('h2',{staticClass:\"settings__heading\"},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"settings__back-button\",attrs:{\"to\":\"/settings/\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-left-12-filled\",\"width\":\"25px\"}})],1),_c('Icon',{attrs:{\"icon\":\"bi:chat-left-text-fill\",\"width\":\"19px\"}}),_c('span',{staticClass:\"ml-3\"},[_vm._v(\"ニコニコ実況\")])],1),_c('div',{staticClass:\"settings__content\",class:{'settings__content--loading': _vm.is_loading}},[(_vm.userStore.user === null || _vm.userStore.user.niconico_user_id === null)?_c('div',{staticClass:\"niconico-account niconico-account--anonymous\"},[_c('div',{staticClass:\"niconico-account-wrapper\"},[_c('Icon',{staticClass:\"flex-shrink-0\",attrs:{\"icon\":\"bi:chat-left-text-fill\",\"width\":\"45px\"}}),_c('div',{staticClass:\"niconico-account__info ml-4\"},[_c('div',{staticClass:\"niconico-account__info-name\"},[_c('span',{staticClass:\"niconico-account__info-name-text\"},[_vm._v(\"ニコニコアカウントと連携していません\")])]),_c('span',{staticClass:\"niconico-account__info-description\"},[_vm._v(\" ニコニコアカウントと連携すると、テレビを見ながらニコニコ実況にコメントできるようになります。 \")])])],1),_c('v-btn',{staticClass:\"niconico-account__login ml-auto\",attrs:{\"color\":\"secondary\",\"width\":\"130\",\"height\":\"56\",\"depressed\":\"\"},on:{\"click\":function($event){return _vm.loginNiconicoAccount()}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:plug-connected-20-filled\",\"height\":\"26\"}}),_vm._v(\"連携する \")],1)],1):_vm._e(),(_vm.userStore.user !== null && _vm.userStore.user.niconico_user_id !== null)?_c('div',{staticClass:\"niconico-account\"},[_c('div',{staticClass:\"niconico-account-wrapper\"},[_c('img',{staticClass:\"niconico-account__icon\",attrs:{\"src\":_vm.userStore.user_niconico_icon_url ?? ''}}),_c('div',{staticClass:\"niconico-account__info\"},[_c('div',{staticClass:\"niconico-account__info-name\"},[_c('span',{staticClass:\"niconico-account__info-name-text\"},[_vm._v(_vm._s(_vm.userStore.user.niconico_user_name)+\" と連携しています\")])]),_c('span',{staticClass:\"niconico-account__info-description\"},[_c('span',{staticClass:\"mr-2\",staticStyle:{\"white-space\":\"nowrap\"}},[_vm._v(\"Niconico User ID:\")]),_c('a',{staticClass:\"mr-2\",attrs:{\"href\":`https://www.nicovideo.jp/user/${_vm.userStore.user.niconico_user_id}`,\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.userStore.user.niconico_user_id))]),(_vm.userStore.user.niconico_user_premium === true)?_c('span',{staticClass:\"secondary--text\"},[_vm._v(\"(Premium)\")]):_vm._e()])])]),_c('v-btn',{staticClass:\"niconico-account__login ml-auto\",attrs:{\"color\":\"secondary\",\"width\":\"130\",\"height\":\"56\",\"depressed\":\"\"},on:{\"click\":function($event){return _vm.logoutNiconicoAccount()}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:plug-disconnected-20-filled\",\"height\":\"26\"}}),_vm._v(\"連携解除 \")],1)],1):_vm._e(),_c('div',{staticClass:\"settings__item mt-7\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"コメントのミュート設定\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" 表示したくないコメントを、映像上やコメントリストに表示しないようにミュートできます。\"),_c('br')])]),_c('v-btn',{staticClass:\"settings__save-button mt-4\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){_vm.comment_mute_settings_modal = !_vm.comment_mute_settings_modal}}},[_c('Icon',{attrs:{\"icon\":\"heroicons-solid:filter\",\"height\":\"19px\"}}),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"コメントのミュート設定を開く\")])],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"コメントの速さ\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" プレイヤーに流れるコメントの速さを設定します。\"),_c('br'),_vm._v(\" たとえば 1.2 に設定すると、コメントが 1.2 倍速く流れます。\"),_c('br')]),_c('v-slider',{staticClass:\"settings__item-form\",attrs:{\"ticks\":\"always\",\"thumb-label\":\"\",\"hide-details\":\"\",\"step\":0.1,\"min\":0.5,\"max\":2},model:{value:(_vm.settingsStore.settings.comment_speed_rate),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"comment_speed_rate\", $$v)},expression:\"settingsStore.settings.comment_speed_rate\"}})],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"コメントの文字サイズ\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" プレイヤーに流れるコメントの文字サイズの基準値を設定します。\"),_c('br'),_vm._v(\" 実際の文字サイズは画面サイズに合わせて調整されます。デフォルトの文字サイズは 34px です。\"),_c('br')]),_c('v-slider',{staticClass:\"settings__item-form\",attrs:{\"ticks\":\"always\",\"thumb-label\":\"\",\"hide-details\":\"\",\"min\":20,\"max\":60},model:{value:(_vm.settingsStore.settings.comment_font_size),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"comment_font_size\", $$v)},expression:\"settingsStore.settings.comment_font_size\"}})],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"close_comment_form_after_sending\"}},[_vm._v(\"コメント送信後にコメント入力フォームを閉じる\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"close_comment_form_after_sending\"}},[_vm._v(\" この設定をオンにすると、コメントを送信した後に、コメント入力フォームが自動で閉じるようになります。\"),_c('br'),_vm._v(\" コメント入力フォームが表示されたままだと、大半のショートカットキーが文字入力と競合して使えなくなります。とくに理由がなければ、オンにしておくのがおすすめです。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"close_comment_form_after_sending\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.close_comment_form_after_sending),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"close_comment_form_after_sending\", $$v)},expression:\"settingsStore.settings.close_comment_form_after_sending\"}})],1)],1),_c('CommentMuteSettings',{attrs:{\"modelValue\":_vm.comment_mute_settings_modal},on:{\"update:modelValue\":function($event){_vm.comment_mute_settings_modal = $event}}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('v-dialog',{attrs:{\"max-width\":\"770\",\"transition\":\"slide-y-transition\"},model:{value:(_vm.comment_mute_settings_modal),callback:function ($$v) {_vm.comment_mute_settings_modal=$$v},expression:\"comment_mute_settings_modal\"}},[_c('v-card',{staticClass:\"comment-mute-settings\"},[_c('v-card-title',{staticClass:\"px-5 pt-5 pb-3 d-flex align-center font-weight-bold\",staticStyle:{\"height\":\"60px\"}},[_c('Icon',{attrs:{\"icon\":\"heroicons-solid:filter\",\"height\":\"26px\"}}),_c('span',{staticClass:\"ml-3\"},[_vm._v(\"コメントのミュート設定\")]),_c('v-spacer'),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"d-flex align-center rounded-circle cursor-pointer px-2 py-2\",on:{\"click\":function($event){_vm.comment_mute_settings_modal = false}}},[_c('Icon',{attrs:{\"icon\":\"fluent:dismiss-12-filled\",\"width\":\"23px\",\"height\":\"23px\"}})],1)],1),_c('div',{staticClass:\"px-5 pb-5\"},[_c('div',{staticClass:\"text-subtitle-1 d-flex align-center font-weight-bold mt-4\"},[_c('Icon',{attrs:{\"icon\":\"fa-solid:sliders-h\",\"width\":\"24px\",\"height\":\"20px\"}}),_c('span',{staticClass:\"ml-2\"},[_vm._v(\"クイック設定\")])],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"mute_vulgar_comments\"}},[_vm._v(\" 露骨な表現を含むコメントをミュートする \")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"mute_vulgar_comments\"}},[_vm._v(\" 性的な単語などの露骨・下品な表現を含むコメントを、一括でミュートするかを設定します。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"mute_vulgar_comments\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.mute_vulgar_comments),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"mute_vulgar_comments\", $$v)},expression:\"settingsStore.settings.mute_vulgar_comments\"}})],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"mute_abusive_discriminatory_prejudiced_comments\"}},[_vm._v(\" ネガティブな表現、差別的な表現、政治的に偏った表現を含むコメントをミュートする \")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"mute_abusive_discriminatory_prejudiced_comments\"}},[_vm._v(\" 『死ね』『殺す』などのネガティブな表現、特定の国や人々への差別的な表現、政治的に偏った表現を含むコメントを、一括でミュートするかを設定します。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"mute_abusive_discriminatory_prejudiced_comments\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.mute_abusive_discriminatory_prejudiced_comments),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"mute_abusive_discriminatory_prejudiced_comments\", $$v)},expression:\"settingsStore.settings.mute_abusive_discriminatory_prejudiced_comments\"}})],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"mute_big_size_comments\"}},[_vm._v(\" 文字サイズが大きいコメントをミュートする \")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"mute_big_size_comments\"}},[_vm._v(\" 通常より大きい文字サイズで表示されるコメントを、一括でミュートするかを設定します。\"),_c('br'),_vm._v(\" 文字サイズが大きいコメントには迷惑なコメントが多いです。基本的にはオンにしておくのがおすすめです。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"mute_big_size_comments\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.mute_big_size_comments),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"mute_big_size_comments\", $$v)},expression:\"settingsStore.settings.mute_big_size_comments\"}})],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"mute_fixed_comments\"}},[_vm._v(\" 映像の上下に固定表示されるコメントをミュートする \")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"mute_fixed_comments\"}},[_vm._v(\" 映像の上下に固定された状態で表示されるコメントを、一括でミュートするかを設定します。\"),_c('br'),_vm._v(\" 固定表示されるコメントが煩わしい方におすすめです。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"mute_fixed_comments\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.mute_fixed_comments),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"mute_fixed_comments\", $$v)},expression:\"settingsStore.settings.mute_fixed_comments\"}})],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"mute_colored_comments\"}},[_vm._v(\" 色付きのコメントをミュートする \")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"mute_colored_comments\"}},[_vm._v(\" 白以外の色で表示される色付きのコメントを、一括でミュートするかを設定します。\"),_c('br'),_vm._v(\" この設定をオンにしておくと、目立つ色のコメントを一掃できます。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"mute_colored_comments\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.mute_colored_comments),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"mute_colored_comments\", $$v)},expression:\"settingsStore.settings.mute_colored_comments\"}})],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"mute_consecutive_same_characters_comments\"}},[_vm._v(\" 8文字以上同じ文字が連続しているコメントをミュートする \")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"mute_consecutive_same_characters_comments\"}},[_vm._v(\" 『wwwwwwwwwww』『あばばばばばばばばば』など、8文字以上同じ文字が連続しているコメントを、一括でミュートするかを設定します。\"),_c('br'),_vm._v(\" しばしばあるテンプレコメントが煩わしい方におすすめです。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"mute_consecutive_same_characters_comments\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.mute_consecutive_same_characters_comments),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"mute_consecutive_same_characters_comments\", $$v)},expression:\"settingsStore.settings.mute_consecutive_same_characters_comments\"}})],1),_c('div',{staticClass:\"text-subtitle-1 d-flex align-center font-weight-bold mt-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:comment-dismiss-20-filled\",\"width\":\"24px\"}}),_c('span',{staticClass:\"ml-2 mr-2\"},[_vm._v(\"ミュート済みのキーワード\")]),_c('v-btn',{staticClass:\"ml-auto\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){return _vm.settingsStore.settings.muted_comment_keywords.push({match: 'partial', pattern: ''})}}},[_c('Icon',{attrs:{\"icon\":\"fluent:add-12-filled\",\"height\":\"17px\"}}),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"追加\")])],1)],1),_c('div',{staticClass:\"muted-comment-items\"},_vm._l((_vm.settingsStore.settings.muted_comment_keywords),function(muted_comment_keyword,index){return _c('div',{key:index,staticClass:\"muted-comment-item\"},[_c('v-text-field',{staticClass:\"muted-comment-item__input\",attrs:{\"type\":\"search\",\"dense\":\"\",\"outlined\":\"\",\"hide-details\":\"\",\"placeholder\":\"ミュートするキーワードを入力\"},model:{value:(_vm.settingsStore.settings.muted_comment_keywords[index].pattern),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings.muted_comment_keywords[index], \"pattern\", $$v)},expression:\"settingsStore.settings.muted_comment_keywords[index].pattern\"}}),_c('v-select',{staticClass:\"muted-comment-item__match-type\",attrs:{\"dense\":\"\",\"outlined\":\"\",\"hide-details\":\"\",\"items\":_vm.muted_comment_keyword_match_type},model:{value:(_vm.settingsStore.settings.muted_comment_keywords[index].match),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings.muted_comment_keywords[index], \"match\", $$v)},expression:\"settingsStore.settings.muted_comment_keywords[index].match\"}}),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"muted-comment-item__delete-button\",on:{\"click\":function($event){_vm.settingsStore.settings.muted_comment_keywords\n                            .splice(_vm.settingsStore.settings.muted_comment_keywords.indexOf(muted_comment_keyword), 1)}}},[_c('svg',{staticClass:\"iconify iconify--fluent\",attrs:{\"width\":\"20px\",\"height\":\"20px\",\"viewBox\":\"0 0 16 16\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M7 3h2a1 1 0 0 0-2 0ZM6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1h4Zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5ZM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5Z\"}})])])],1)}),0),_c('div',{staticClass:\"text-subtitle-1 d-flex align-center font-weight-bold mt-4\"},[_c('Icon',{attrs:{\"icon\":\"fluent:person-prohibited-20-filled\",\"width\":\"24px\"}}),_c('span',{staticClass:\"ml-2 mr-2\"},[_vm._v(\"ミュート済みのニコニコユーザー ID\")]),_c('v-btn',{staticClass:\"ml-auto\",attrs:{\"depressed\":\"\"},on:{\"click\":function($event){return _vm.settingsStore.settings.muted_niconico_user_ids.push('')}}},[_c('Icon',{attrs:{\"icon\":\"fluent:add-12-filled\",\"height\":\"17px\"}}),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"追加\")])],1)],1),_c('div',{staticClass:\"muted-comment-items\"},_vm._l((_vm.settingsStore.settings.muted_niconico_user_ids),function(muted_niconico_user_id,index){return _c('div',{key:index,staticClass:\"muted-comment-item\"},[_c('v-text-field',{staticClass:\"muted-comment-item__input\",attrs:{\"type\":\"search\",\"dense\":\"\",\"outlined\":\"\",\"hide-details\":\"\",\"placeholder\":\"ミュートするニコニコユーザー ID を入力\"},model:{value:(_vm.settingsStore.settings.muted_niconico_user_ids[index]),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings.muted_niconico_user_ids, index, $$v)},expression:\"settingsStore.settings.muted_niconico_user_ids[index]\"}}),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"muted-comment-item__delete-button\",on:{\"click\":function($event){_vm.settingsStore.settings.muted_niconico_user_ids\n                            .splice(_vm.settingsStore.settings.muted_niconico_user_ids.indexOf(muted_niconico_user_id), 1)}}},[_c('svg',{staticClass:\"iconify iconify--fluent\",attrs:{\"width\":\"20px\",\"height\":\"20px\",\"viewBox\":\"0 0 16 16\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M7 3h2a1 1 0 0 0-2 0ZM6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1h4Zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5ZM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5Z\"}})])])],1)}),0)])],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <v-dialog max-width=\"770\" transition=\"slide-y-transition\" v-model=\"comment_mute_settings_modal\">\r\n        <v-card class=\"comment-mute-settings\">\r\n            <v-card-title class=\"px-5 pt-5 pb-3 d-flex align-center font-weight-bold\" style=\"height: 60px;\">\r\n                <Icon icon=\"heroicons-solid:filter\" height=\"26px\" />\r\n                <span class=\"ml-3\">コメントのミュート設定</span>\r\n                <v-spacer></v-spacer>\r\n                <div v-ripple class=\"d-flex align-center rounded-circle cursor-pointer px-2 py-2\" @click=\"comment_mute_settings_modal = false\">\r\n                    <Icon icon=\"fluent:dismiss-12-filled\" width=\"23px\" height=\"23px\" />\r\n                </div>\r\n            </v-card-title>\r\n            <div class=\"px-5 pb-5\">\r\n                <div class=\"text-subtitle-1 d-flex align-center font-weight-bold mt-4\">\r\n                    <Icon icon=\"fa-solid:sliders-h\" width=\"24px\" height=\"20px\" />\r\n                    <span class=\"ml-2\">クイック設定</span>\r\n                </div>\r\n                <div class=\"settings__item settings__item--switch\">\r\n                    <label class=\"settings__item-heading\" for=\"mute_vulgar_comments\">\r\n                        露骨な表現を含むコメントをミュートする\r\n                    </label>\r\n                    <label class=\"settings__item-label\" for=\"mute_vulgar_comments\">\r\n                        性的な単語などの露骨・下品な表現を含むコメントを、一括でミュートするかを設定します。<br>\r\n                    </label>\r\n                    <v-switch class=\"settings__item-switch\" id=\"mute_vulgar_comments\" inset hide-details\r\n                        v-model=\"settingsStore.settings.mute_vulgar_comments\">\r\n                    </v-switch>\r\n                </div>\r\n                <div class=\"settings__item settings__item--switch\">\r\n                    <label class=\"settings__item-heading\" for=\"mute_abusive_discriminatory_prejudiced_comments\">\r\n                        ネガティブな表現、差別的な表現、政治的に偏った表現を含むコメントをミュートする\r\n                    </label>\r\n                    <label class=\"settings__item-label\" for=\"mute_abusive_discriminatory_prejudiced_comments\">\r\n                        『死ね』『殺す』などのネガティブな表現、特定の国や人々への差別的な表現、政治的に偏った表現を含むコメントを、一括でミュートするかを設定します。<br>\r\n                    </label>\r\n                    <v-switch class=\"settings__item-switch\" id=\"mute_abusive_discriminatory_prejudiced_comments\" inset hide-details\r\n                        v-model=\"settingsStore.settings.mute_abusive_discriminatory_prejudiced_comments\">\r\n                    </v-switch>\r\n                </div>\r\n                <div class=\"settings__item settings__item--switch\">\r\n                    <label class=\"settings__item-heading\" for=\"mute_big_size_comments\">\r\n                        文字サイズが大きいコメントをミュートする\r\n                    </label>\r\n                    <label class=\"settings__item-label\" for=\"mute_big_size_comments\">\r\n                        通常より大きい文字サイズで表示されるコメントを、一括でミュートするかを設定します。<br>\r\n                        文字サイズが大きいコメントには迷惑なコメントが多いです。基本的にはオンにしておくのがおすすめです。<br>\r\n                    </label>\r\n                    <v-switch class=\"settings__item-switch\" id=\"mute_big_size_comments\" inset hide-details\r\n                        v-model=\"settingsStore.settings.mute_big_size_comments\">\r\n                    </v-switch>\r\n                </div>\r\n                <div class=\"settings__item settings__item--switch\">\r\n                    <label class=\"settings__item-heading\" for=\"mute_fixed_comments\">\r\n                        映像の上下に固定表示されるコメントをミュートする\r\n                    </label>\r\n                    <label class=\"settings__item-label\" for=\"mute_fixed_comments\">\r\n                        映像の上下に固定された状態で表示されるコメントを、一括でミュートするかを設定します。<br>\r\n                        固定表示されるコメントが煩わしい方におすすめです。<br>\r\n                    </label>\r\n                    <v-switch class=\"settings__item-switch\" id=\"mute_fixed_comments\" inset hide-details\r\n                        v-model=\"settingsStore.settings.mute_fixed_comments\">\r\n                    </v-switch>\r\n                </div>\r\n                <div class=\"settings__item settings__item--switch\">\r\n                    <label class=\"settings__item-heading\" for=\"mute_colored_comments\">\r\n                       色付きのコメントをミュートする\r\n                    </label>\r\n                    <label class=\"settings__item-label\" for=\"mute_colored_comments\">\r\n                        白以外の色で表示される色付きのコメントを、一括でミュートするかを設定します。<br>\r\n                        この設定をオンにしておくと、目立つ色のコメントを一掃できます。<br>\r\n                    </label>\r\n                    <v-switch class=\"settings__item-switch\" id=\"mute_colored_comments\" inset hide-details\r\n                        v-model=\"settingsStore.settings.mute_colored_comments\">\r\n                    </v-switch>\r\n                </div>\r\n                <div class=\"settings__item settings__item--switch\">\r\n                    <label class=\"settings__item-heading\" for=\"mute_consecutive_same_characters_comments\">\r\n                        8文字以上同じ文字が連続しているコメントをミュートする\r\n                    </label>\r\n                    <label class=\"settings__item-label\" for=\"mute_consecutive_same_characters_comments\">\r\n                        『wwwwwwwwwww』『あばばばばばばばばば』など、8文字以上同じ文字が連続しているコメントを、一括でミュートするかを設定します。<br>\r\n                        しばしばあるテンプレコメントが煩わしい方におすすめです。<br>\r\n                    </label>\r\n                    <v-switch class=\"settings__item-switch\" id=\"mute_consecutive_same_characters_comments\" inset hide-details\r\n                        v-model=\"settingsStore.settings.mute_consecutive_same_characters_comments\">\r\n                    </v-switch>\r\n                </div>\r\n                <div class=\"text-subtitle-1 d-flex align-center font-weight-bold mt-4\">\r\n                    <Icon icon=\"fluent:comment-dismiss-20-filled\" width=\"24px\" />\r\n                    <span class=\"ml-2 mr-2\">ミュート済みのキーワード</span>\r\n                    <v-btn class=\"ml-auto\" depressed\r\n                        @click=\"settingsStore.settings.muted_comment_keywords.push({match: 'partial', pattern: ''})\">\r\n                        <Icon icon=\"fluent:add-12-filled\" height=\"17px\" />\r\n                        <span class=\"ml-1\">追加</span>\r\n                    </v-btn>\r\n                </div>\r\n                <div class=\"muted-comment-items\">\r\n                    <div class=\"muted-comment-item\"\r\n                        v-for=\"(muted_comment_keyword, index) in settingsStore.settings.muted_comment_keywords\" :key=\"index\">\r\n                        <!-- 以下では Icon コンポーネントを使うと個数が多いときに高負荷になるため、意図的に SVG を直書きしている -->\r\n                        <v-text-field type=\"search\" class=\"muted-comment-item__input\" dense outlined hide-details\r\n                            placeholder=\"ミュートするキーワードを入力\"\r\n                            v-model=\"settingsStore.settings.muted_comment_keywords[index].pattern\">\r\n                        </v-text-field>\r\n                        <v-select class=\"muted-comment-item__match-type\" dense outlined hide-details\r\n                            :items=\"muted_comment_keyword_match_type\"\r\n                            v-model=\"settingsStore.settings.muted_comment_keywords[index].match\">\r\n                        </v-select>\r\n                        <button v-ripple class=\"muted-comment-item__delete-button\"\r\n                            @click=\"settingsStore.settings.muted_comment_keywords\r\n                                .splice(settingsStore.settings.muted_comment_keywords.indexOf(muted_comment_keyword), 1)\">\r\n                            <svg class=\"iconify iconify--fluent\" width=\"20px\" height=\"20px\" viewBox=\"0 0 16 16\">\r\n                                <path fill=\"currentColor\" d=\"M7 3h2a1 1 0 0 0-2 0ZM6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1h4Zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5ZM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5Z\"></path>\r\n                            </svg>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n                <div class=\"text-subtitle-1 d-flex align-center font-weight-bold mt-4\">\r\n                    <Icon icon=\"fluent:person-prohibited-20-filled\" width=\"24px\" />\r\n                    <span class=\"ml-2 mr-2\">ミュート済みのニコニコユーザー ID</span>\r\n                    <v-btn class=\"ml-auto\" depressed\r\n                        @click=\"settingsStore.settings.muted_niconico_user_ids.push('')\">\r\n                        <Icon icon=\"fluent:add-12-filled\" height=\"17px\" />\r\n                        <span class=\"ml-1\">追加</span>\r\n                    </v-btn>\r\n                </div>\r\n                <div class=\"muted-comment-items\">\r\n                    <div class=\"muted-comment-item\"\r\n                        v-for=\"(muted_niconico_user_id, index) in settingsStore.settings.muted_niconico_user_ids\" :key=\"index\">\r\n                        <!-- 以下では Icon コンポーネントを使うと個数が多いときに高負荷になるため、意図的に SVG を直書きしている -->\r\n                        <v-text-field type=\"search\" class=\"muted-comment-item__input\" dense outlined hide-details\r\n                            placeholder=\"ミュートするニコニコユーザー ID を入力\" v-model=\"settingsStore.settings.muted_niconico_user_ids[index]\">\r\n                        </v-text-field>\r\n                        <button v-ripple class=\"muted-comment-item__delete-button\"\r\n                            @click=\"settingsStore.settings.muted_niconico_user_ids\r\n                                .splice(settingsStore.settings.muted_niconico_user_ids.indexOf(muted_niconico_user_id), 1)\">\r\n                            <svg class=\"iconify iconify--fluent\" width=\"20px\" height=\"20px\" viewBox=\"0 0 16 16\">\r\n                                <path fill=\"currentColor\" d=\"M7 3h2a1 1 0 0 0-2 0ZM6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1h4Zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5ZM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5Z\"></path>\r\n                            </svg>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </v-card>\r\n    </v-dialog>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent, PropType } from 'vue';\r\n\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\n\r\nexport default defineComponent({\r\n    name: 'CommentMuteSettings',\r\n    props: {\r\n        modelValue: {\r\n            type: Boolean as PropType<boolean>,\r\n            required: true,\r\n        }\r\n    },\r\n    emits: {\r\n        'update:modelValue': (value: boolean) => true,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // コメントのミュート設定のモーダルを表示するか\r\n            comment_mute_settings_modal: false,\r\n\r\n            // ミュート済みのキーワードのマッチタイプ\r\n            muted_comment_keyword_match_type: [\r\n                {text: '部分一致', value: 'partial'},\r\n                {text: '前方一致', value: 'forward'},\r\n                {text: '後方一致', value: 'backward'},\r\n                {text: '完全一致', value: 'exact'},\r\n                {text: '正規表現', value: 'regex'},\r\n            ],\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useSettingsStore),\r\n    },\r\n    watch: {\r\n\r\n        // modelValue (親コンポーネント側: Props) の変更を監視し、変更されたら comment_mute_settings_modal に反映する\r\n        modelValue() {\r\n            this.comment_mute_settings_modal = this.modelValue;\r\n        },\r\n\r\n        // comment_mute_settings_modal (子コンポーネント側) の変更を監視し、変更されたら this.$emit() で親コンポーネントに伝える\r\n        comment_mute_settings_modal() {\r\n            this.$emit('update:modelValue', this.comment_mute_settings_modal);\r\n        }\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.comment-mute-settings {\r\n    .v-card__title, & > div {\r\n        @include smartphone-vertical {\r\n            padding-left: 12px !important;\r\n            padding-right: 12px !important;\r\n        }\r\n    }\r\n}\r\n\r\n// views/Settings/Base.vue から抜粋して一部編集\r\n.settings__item {\r\n    display: flex;\r\n    position: relative;\r\n    flex-direction: column;\r\n    margin-top: 24px;\r\n    @include smartphone-horizontal {\r\n        margin-top: 16px;\r\n    }\r\n\r\n    &--switch {\r\n        margin-right: 62px;\r\n    }\r\n\r\n    &-heading {\r\n        display: flex;\r\n        align-items: center;\r\n        color: var(--v-text-base);\r\n        font-size: 16.5px;\r\n        @include smartphone-horizontal {\r\n            font-size: 15px;\r\n        }\r\n    }\r\n    &-label {\r\n        margin-top: 8px;\r\n        color: var(--v-text-darken1);\r\n        font-size: 13.5px;\r\n        line-height: 1.6;\r\n        @include smartphone-horizontal {\r\n            font-size: 11px;\r\n            line-height: 1.7;\r\n        }\r\n    }\r\n    &-form {\r\n        margin-top: 14px;\r\n        @include smartphone-horizontal {\r\n            font-size: 13.5px;\r\n        }\r\n    }\r\n    &-switch {\r\n        align-items: center;\r\n        position: absolute;\r\n        top: 0;\r\n        right: -74px;\r\n        bottom: 0;\r\n        margin-top: 0;\r\n    }\r\n\r\n    p {\r\n        margin-bottom: 8px;\r\n        &:last-of-type {\r\n            margin-bottom: 0px;\r\n        }\r\n    }\r\n}\r\n.muted-comment-items {\r\n    display: flex;\r\n    flex-direction: column;\r\n    margin-top: 8px;\r\n\r\n    .muted-comment-item {\r\n        display: flex;\r\n        align-items: center;\r\n        padding: 6px 0px;\r\n        border-bottom: 1px solid var(--v-background-lighten2);\r\n        transition: background-color 0.15s ease;\r\n\r\n        &:last-of-type {\r\n            border-bottom: none;\r\n        }\r\n\r\n        &__input {\r\n            font-size: 14px;\r\n        }\r\n\r\n        &__match-type {\r\n            max-width: 150px;\r\n            margin-left: 12px;\r\n            font-size: 14px;\r\n            @include smartphone-vertical {\r\n                max-width: 115px;\r\n            }\r\n        }\r\n\r\n        &__delete-button {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            width: 40px;\r\n            height: 40px;\r\n            margin-left: 6px;\r\n            border-radius: 5px;\r\n            outline: none;\r\n            cursor: pointer;\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CommentMuteSettings.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CommentMuteSettings.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./CommentMuteSettings.vue?vue&type=template&id=413bd7b3&scoped=true\"\nimport script from \"./CommentMuteSettings.vue?vue&type=script&lang=ts\"\nexport * from \"./CommentMuteSettings.vue?vue&type=script&lang=ts\"\nimport style0 from \"./CommentMuteSettings.vue?vue&type=style&index=0&id=413bd7b3&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"413bd7b3\",\n  null\n  \n)\n\nexport default component.exports","\r\nimport APIClient from '@/services/APIClient';\r\n\r\n\r\n/** ニコニコアカウントと連携するための認証 URL を表すインターフェイス */\r\nexport interface INiconicoAuthURL {\r\n    authorization_url: string;\r\n}\r\n\r\n\r\nclass Niconico {\r\n\r\n    /**\r\n     * ニコニコアカウントと連携するための認証 URL を取得する\r\n     * @returns 認証 URL or 認証 URL の取得に失敗した場合は null\r\n     */\r\n    static async fetchAuthorizationURL(): Promise<string | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.get<INiconicoAuthURL>('/niconico/auth');\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, 'ニコニコアカウントとの連携用の認証 URL を取得できませんでした。');\r\n            return null;\r\n        }\r\n\r\n        return response.data.authorization_url;\r\n    }\r\n\r\n\r\n    /**\r\n     * 現在ログイン中のユーザーアカウントに紐づくニコニコアカウントとの連携を解除する\r\n     * @returns 連携解除に成功した場合は true, 失敗した場合は false\r\n     */\r\n    static async logoutAccount(): Promise<boolean> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.delete('/niconico/logout');\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, 'ニコニコアカウントとの連携を解除できませんでした。');\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\nexport default Niconico;\r\n","<template>\r\n    <!-- ベース画面の中にそれぞれの設定画面で異なる部分を記述する -->\r\n    <SettingsBase>\r\n        <h2 class=\"settings__heading\">\r\n            <router-link v-ripple class=\"settings__back-button\" to=\"/settings/\">\r\n                <Icon icon=\"fluent:arrow-left-12-filled\" width=\"25px\" />\r\n            </router-link>\r\n            <Icon icon=\"bi:chat-left-text-fill\" width=\"19px\" />\r\n            <span class=\"ml-3\">ニコニコ実況</span>\r\n        </h2>\r\n        <div class=\"settings__content\" :class=\"{'settings__content--loading': is_loading}\">\r\n            <div class=\"niconico-account niconico-account--anonymous\" v-if=\"userStore.user === null || userStore.user.niconico_user_id === null\">\r\n                <div class=\"niconico-account-wrapper\">\r\n                    <Icon class=\"flex-shrink-0\" icon=\"bi:chat-left-text-fill\" width=\"45px\" />\r\n                    <div class=\"niconico-account__info ml-4\">\r\n                        <div class=\"niconico-account__info-name\">\r\n                            <span class=\"niconico-account__info-name-text\">ニコニコアカウントと連携していません</span>\r\n                        </div>\r\n                        <span class=\"niconico-account__info-description\">\r\n                            ニコニコアカウントと連携すると、テレビを見ながらニコニコ実況にコメントできるようになります。\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n                <v-btn class=\"niconico-account__login ml-auto\" color=\"secondary\" width=\"130\" height=\"56\" depressed\r\n                    @click=\"loginNiconicoAccount()\">\r\n                    <Icon icon=\"fluent:plug-connected-20-filled\" class=\"mr-2\" height=\"26\" />連携する\r\n                </v-btn>\r\n            </div>\r\n            <div class=\"niconico-account\" v-if=\"userStore.user !== null && userStore.user.niconico_user_id !== null\">\r\n                <div class=\"niconico-account-wrapper\">\r\n                    <img class=\"niconico-account__icon\" :src=\"userStore.user_niconico_icon_url ?? ''\">\r\n                    <div class=\"niconico-account__info\">\r\n                        <div class=\"niconico-account__info-name\">\r\n                            <span class=\"niconico-account__info-name-text\">{{userStore.user.niconico_user_name}} と連携しています</span>\r\n                        </div>\r\n                        <span class=\"niconico-account__info-description\">\r\n                            <span class=\"mr-2\" style=\"white-space: nowrap;\">Niconico User ID:</span>\r\n                            <a class=\"mr-2\" :href=\"`https://www.nicovideo.jp/user/${userStore.user.niconico_user_id}`\"\r\n                                target=\"_blank\">{{userStore.user.niconico_user_id}}</a>\r\n                            <span class=\"secondary--text\" v-if=\"userStore.user.niconico_user_premium === true\">(Premium)</span>\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n                <v-btn class=\"niconico-account__login ml-auto\" color=\"secondary\" width=\"130\" height=\"56\" depressed\r\n                    @click=\"logoutNiconicoAccount()\">\r\n                    <Icon icon=\"fluent:plug-disconnected-20-filled\" class=\"mr-2\" height=\"26\" />連携解除\r\n                </v-btn>\r\n            </div>\r\n            <div class=\"settings__item mt-7\">\r\n                <div class=\"settings__item-heading\">コメントのミュート設定</div>\r\n                <div class=\"settings__item-label\">\r\n                    表示したくないコメントを、映像上やコメントリストに表示しないようにミュートできます。<br>\r\n                </div>\r\n            </div>\r\n            <v-btn class=\"settings__save-button mt-4\" depressed @click=\"comment_mute_settings_modal = !comment_mute_settings_modal\">\r\n                <Icon icon=\"heroicons-solid:filter\" height=\"19px\" />\r\n                <span class=\"ml-1\">コメントのミュート設定を開く</span>\r\n            </v-btn>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">コメントの速さ</div>\r\n                <div class=\"settings__item-label\">\r\n                    プレイヤーに流れるコメントの速さを設定します。<br>\r\n                    たとえば 1.2 に設定すると、コメントが 1.2 倍速く流れます。<br>\r\n                </div>\r\n                <v-slider class=\"settings__item-form\" ticks=\"always\" thumb-label hide-details\r\n                    :step=\"0.1\" :min=\"0.5\" :max=\"2\" v-model=\"settingsStore.settings.comment_speed_rate\">\r\n                </v-slider>\r\n            </div>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">コメントの文字サイズ</div>\r\n                <div class=\"settings__item-label\">\r\n                    プレイヤーに流れるコメントの文字サイズの基準値を設定します。<br>\r\n                    実際の文字サイズは画面サイズに合わせて調整されます。デフォルトの文字サイズは 34px です。<br>\r\n                </div>\r\n                <v-slider class=\"settings__item-form\" ticks=\"always\" thumb-label hide-details\r\n                    :min=\"20\" :max=\"60\" v-model=\"settingsStore.settings.comment_font_size\">\r\n                </v-slider>\r\n            </div>\r\n            <div class=\"settings__item settings__item--switch\">\r\n                <label class=\"settings__item-heading\" for=\"close_comment_form_after_sending\">コメント送信後にコメント入力フォームを閉じる</label>\r\n                <label class=\"settings__item-label\" for=\"close_comment_form_after_sending\">\r\n                    この設定をオンにすると、コメントを送信した後に、コメント入力フォームが自動で閉じるようになります。<br>\r\n                    コメント入力フォームが表示されたままだと、大半のショートカットキーが文字入力と競合して使えなくなります。とくに理由がなければ、オンにしておくのがおすすめです。<br>\r\n                </label>\r\n                <v-switch class=\"settings__item-switch\" id=\"close_comment_form_after_sending\" inset hide-details\r\n                    v-model=\"settingsStore.settings.close_comment_form_after_sending\">\r\n                </v-switch>\r\n            </div>\r\n        </div>\r\n        <CommentMuteSettings :modelValue=\"comment_mute_settings_modal\" @update:modelValue=\"comment_mute_settings_modal = $event\" />\r\n    </SettingsBase>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport CommentMuteSettings from '@/components/Settings/CommentMuteSettings.vue';\r\nimport Message from '@/message';\r\nimport Niconico from '@/services/Niconico';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport useUserStore from '@/stores/UserStore';\r\nimport Utils from '@/utils';\r\nimport SettingsBase from '@/views/Settings/Base.vue';\r\n\r\nexport default defineComponent({\r\n    name: 'Settings-Jikkyo',\r\n    components: {\r\n        SettingsBase,\r\n        CommentMuteSettings,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // コメントのミュート設定のモーダルを表示するか\r\n            comment_mute_settings_modal: false,\r\n\r\n            // ローディング中かどうか\r\n            is_loading: true,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useSettingsStore, useUserStore),\r\n    },\r\n    async created() {\r\n\r\n        // アカウント情報を更新\r\n        await this.userStore.fetchUser();\r\n\r\n        // ローディング状態を解除\r\n        this.is_loading = false;\r\n\r\n        // もしハッシュ (# から始まるフラグメント) に何か指定されていたら、\r\n        // OAuth 連携のコールバックの結果が入っている可能性が高いので、パースを試みる\r\n        // アカウント情報更新より後にしないと Snackbar がうまく表示されない\r\n        if (location.hash !== '') {\r\n            const params = new URLSearchParams(location.hash.replace('#', ''));\r\n            if (params.get('status') !== null && params.get('detail') !== null) {\r\n                // コールバックの結果を取得できたので、OAuth 連携の結果を画面に通知する\r\n                const authorization_status = parseInt(params.get('status')!);\r\n                const authorization_detail = params.get('detail')!;\r\n                this.onOAuthCallbackReceived(authorization_status, authorization_detail);\r\n                // URL からフラグメントを削除\r\n                // ref: https://stackoverflow.com/a/49373716/17124142\r\n                history.replaceState(null, '', ' ');\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        async loginNiconicoAccount() {\r\n\r\n            // ログインしていない場合はエラーにする\r\n            if (this.userStore.is_logged_in === false) {\r\n                Message.warning('連携をはじめるには、KonomiTV アカウントにログインしてください。');\r\n                return;\r\n            }\r\n\r\n            // ニコニコアカウントと連携するための認証 URL を取得\r\n            const authorization_url = await Niconico.fetchAuthorizationURL();\r\n            if (authorization_url === null) {\r\n                return;\r\n            }\r\n\r\n            // モバイルデバイスではポップアップが事実上使えない (特に Safari ではブロックされてしまう) ので、素直にリダイレクトで実装する\r\n            if (Utils.isMobileDevice() === true) {\r\n                location.href = authorization_url;\r\n                return;\r\n            }\r\n\r\n            // OAuth 連携のため、認証 URL をポップアップウインドウで開く\r\n            // window.open() の第2引数はユニークなものにしておくと良いらしい\r\n            // ref: https://qiita.com/catatsuy/items/babce8726ea78f5d25b1 (大変参考になりました)\r\n            const popup_window = window.open(authorization_url, 'KonomiTV-OAuthPopup', Utils.getWindowFeatures());\r\n            if (popup_window === null) {\r\n                Message.error('ポップアップウインドウを開けませんでした。');\r\n                return;\r\n            }\r\n\r\n            // 認証完了 or 失敗後、ポップアップウインドウから送信される文字列を受信\r\n            const onMessage = async (event) => {\r\n\r\n                // すでにウインドウが閉じている場合は実行しない\r\n                if (popup_window.closed) return;\r\n\r\n                // 受け取ったオブジェクトに KonomiTV-OAuthPopup キーがない or そもそもオブジェクトではない際は実行しない\r\n                // ブラウザの拡張機能から結構余計な message が飛んでくるっぽい…。\r\n                if (Utils.typeof(event.data) !== 'object') return;\r\n                if (('KonomiTV-OAuthPopup' in event.data) === false) return;\r\n\r\n                // 認証は完了したので、ポップアップウインドウを閉じ、リスナーを解除する\r\n                if (popup_window) popup_window.close();\r\n                window.removeEventListener('message', onMessage);\r\n\r\n                // ステータスコードと詳細メッセージを取得\r\n                const authorization_status = event.data['KonomiTV-OAuthPopup']['status'] as number;\r\n                const authorization_detail = event.data['KonomiTV-OAuthPopup']['detail'] as string;\r\n                this.onOAuthCallbackReceived(authorization_status, authorization_detail);\r\n            };\r\n\r\n            // postMessage() を受信するリスナーを登録\r\n            window.addEventListener('message', onMessage);\r\n        },\r\n\r\n        async onOAuthCallbackReceived(authorization_status: number, authorization_detail: string) {\r\n            console.log(`NiconicoAuthCallbackAPI: Status: ${authorization_status} / Detail: ${authorization_detail}`);\r\n\r\n            // OAuth 連携に失敗した\r\n            if (authorization_status !== 200) {\r\n                if (authorization_detail.startsWith('Authorization was denied (access_denied)')) {\r\n                    Message.error('ニコニコアカウントとの連携がキャンセルされました。');\r\n                } else if (authorization_detail.startsWith('Failed to get access token (HTTP Error ')) {\r\n                    const error = authorization_detail.replace('Failed to get access token ', '');\r\n                    Message.error(`アクセストークンの取得に失敗しました。${error}`);\r\n                } else if (authorization_detail.startsWith('Failed to get access token (Connection Timeout)')) {\r\n                    Message.error('アクセストークンの取得に失敗しました。ニコニコで障害が発生している可能性があります。');\r\n                } else if (authorization_detail.startsWith('Failed to get user information (HTTP Error ')) {\r\n                    const error = authorization_detail.replace('Failed to get user information ', '');\r\n                    Message.error(`ニコニコアカウントのユーザー情報の取得に失敗しました。${error}`);\r\n                } else if (authorization_detail.startsWith('Failed to get user information (Connection Timeout)')) {\r\n                    Message.error('ニコニコアカウントのユーザー情報の取得に失敗しました。ニコニコで障害が発生している可能性があります。');\r\n                } else {\r\n                    Message.error(`ニコニコアカウントとの連携に失敗しました。(${authorization_detail})`);\r\n                }\r\n                return;\r\n            }\r\n\r\n            // アカウント情報を強制的に更新\r\n            await this.userStore.fetchUser(true);\r\n\r\n            Message.success('ニコニコアカウントと連携しました。');\r\n        },\r\n\r\n        async logoutNiconicoAccount() {\r\n\r\n            // ニコニコアカウント連携解除 API にリクエスト\r\n            const result = await Niconico.logoutAccount();\r\n            if (result === false) {\r\n                return;\r\n            }\r\n\r\n            // アカウント情報を強制的に更新\r\n            await this.userStore.fetchUser(true);\r\n\r\n            Message.success('ニコニコアカウントとの連携を解除しました。');\r\n        },\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.settings__content {\r\n    opacity: 1;\r\n    transition: opacity 0.4s;\r\n\r\n    &--loading {\r\n        opacity: 0;\r\n    }\r\n}\r\n\r\n.niconico-account {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 120px;\r\n    padding: 20px;\r\n    border-radius: 15px;\r\n    background: var(--v-background-lighten2);\r\n    @include tablet-horizontal {\r\n        align-items: normal;\r\n        flex-direction: column;\r\n        height: auto;\r\n        padding: 16px;\r\n    }\r\n    @include tablet-vertical {\r\n        align-items: normal;\r\n        flex-direction: column;\r\n        height: auto;\r\n        padding: 16px;\r\n        .niconico-account-wrapper {\r\n            .niconico-account__info {\r\n                margin-left: 16px !important;\r\n                margin-right: 0 !important;\r\n                &-name-text {\r\n                    font-size: 18.5px;\r\n                }\r\n                &-description {\r\n                    font-size: 13.5px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    @include smartphone-horizontal {\r\n        align-items: normal;\r\n        flex-direction: column;\r\n        height: auto;\r\n        padding: 16px;\r\n        border-radius: 10px;\r\n        .niconico-account-wrapper {\r\n            .niconico-account__info {\r\n                margin-right: 0 !important;\r\n            }\r\n        }\r\n    }\r\n    @include smartphone-horizontal-short {\r\n        .niconico-account-wrapper {\r\n            .niconico-account__info {\r\n                margin-left: 16px !important;\r\n                &-name-text {\r\n                    font-size: 18px;\r\n                }\r\n                &-description {\r\n                    font-size: 13px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    @include smartphone-vertical {\r\n        align-items: normal;\r\n        flex-direction: column;\r\n        height: auto;\r\n        padding: 16px 12px;\r\n        border-radius: 10px;\r\n        .niconico-account-wrapper {\r\n            .niconico-account__info {\r\n                margin-left: 12px !important;\r\n                margin-right: 0px !important;\r\n                &-name-text {\r\n                    font-size: 17px;\r\n                }\r\n                &-description {\r\n                    font-size: 13px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    &--anonymous {\r\n        @include tablet-vertical {\r\n            .niconico-account__login {\r\n                margin-top: 12px;\r\n            }\r\n        }\r\n        @include smartphone-horizontal {\r\n            .niconico-account__login {\r\n                margin-top: 12px;\r\n            }\r\n        }\r\n        @include smartphone-horizontal-short {\r\n            .niconico-account-wrapper {\r\n                svg {\r\n                    display: none;\r\n                }\r\n                .niconico-account__info {\r\n                    margin-left: 0 !important;\r\n                }\r\n            }\r\n        }\r\n        @include smartphone-vertical {\r\n            padding-top: 20px;\r\n            .niconico-account__login {\r\n                margin-top: 16px;\r\n            }\r\n            .niconico-account-wrapper {\r\n                svg {\r\n                    display: none;\r\n                }\r\n                .niconico-account__info {\r\n                    margin-left: 0 !important;\r\n                    margin-right: 0 !important;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    &-wrapper {\r\n        display: flex;\r\n        align-items: center;\r\n        min-width: 0;\r\n        height: 80px;\r\n        @include smartphone-vertical {\r\n            height: 60px;\r\n        }\r\n    }\r\n\r\n    &__icon {\r\n        flex-shrink: 0;\r\n        min-width: 80px;\r\n        height: 100%;\r\n        border-radius: 50%;\r\n        object-fit: cover;\r\n        // 読み込まれるまでのアイコンの背景\r\n        background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n        // 低解像度で表示する画像がぼやけないようにする\r\n        // ref: https://sho-log.com/chrome-image-blurred/\r\n        image-rendering: -webkit-optimize-contrast;\r\n        @include smartphone-vertical {\r\n            width: 60px;\r\n            min-width: 60px;\r\n            height: 60px;\r\n        }\r\n    }\r\n\r\n    &__info {\r\n        display: flex;\r\n        flex-direction: column;\r\n        min-width: 0;\r\n        margin-left: 20px;\r\n        margin-right: 16px;\r\n\r\n        &-name {\r\n            display: inline-flex;\r\n            align-items: center;\r\n            height: 33px;\r\n            @include smartphone-vertical {\r\n                height: auto;\r\n            }\r\n\r\n            &-text {\r\n                display: inline-block;\r\n                font-size: 20px;\r\n                color: var(--v-text-base);\r\n                font-weight: bold;\r\n                overflow: hidden;\r\n                white-space: nowrap;\r\n                text-overflow: ellipsis;  // はみ出た部分を … で省略\r\n            }\r\n        }\r\n\r\n        &-description {\r\n            display: inline-block;\r\n            margin-top: 4px;\r\n            color: var(--v-text-darken1);\r\n            font-size: 14px;\r\n        }\r\n    }\r\n\r\n    &__login {\r\n        border-radius: 7px;\r\n        font-size: 16px;\r\n        letter-spacing: 0;\r\n        @include tablet-horizontal {\r\n            height: 50px !important;\r\n            margin-top: 12px;\r\n            margin-right: auto;\r\n        }\r\n        @include tablet-vertical {\r\n            height: 42px !important;\r\n            margin-top: 8px;\r\n            margin-right: auto;\r\n            font-size: 14.5px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            height: 42px !important;\r\n            margin-top: 8px;\r\n            margin-right: auto;\r\n            font-size: 14.5px;\r\n        }\r\n        @include smartphone-vertical {\r\n            height: 42px !important;\r\n            margin-top: 16px;\r\n            margin-right: auto;\r\n            font-size: 14.5px;\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Jikkyo.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Jikkyo.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Jikkyo.vue?vue&type=template&id=5b25c20c&scoped=true\"\nimport script from \"./Jikkyo.vue?vue&type=script&lang=ts\"\nexport * from \"./Jikkyo.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Jikkyo.vue?vue&type=style&index=0&id=5b25c20c&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5b25c20c\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('SettingsBase',[_c('h2',{staticClass:\"settings__heading\"},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"settings__back-button\",attrs:{\"to\":\"/settings/\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-left-12-filled\",\"width\":\"25px\"}})],1),_c('Icon',{attrs:{\"icon\":\"fluent:video-clip-multiple-16-filled\",\"width\":\"26px\"}}),_c('span',{staticClass:\"ml-3\"},[_vm._v(\"画質\")])],1),_c('v-tabs-fix',{staticClass:\"settings__tab\",attrs:{\"background-color\":\"transparent\",\"centered\":\"\"},model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},_vm._l((_vm.network_circuits),function(network_circuit){return _c('v-tab',{key:network_circuit,staticStyle:{\"text-transform\":\"none !important\"}},[_vm._v(\" \"+_vm._s(network_circuit)+\" \")])}),1),_c('v-tabs-items-fix',{model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},_vm._l((_vm.network_circuits),function(network_circuit){return _c('v-tab-item-fix',{key:network_circuit,staticClass:\"settings__content mt-0\"},[_c('div',{staticClass:\"settings__item settings__item--sync-disabled\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"テレビのデフォルトのストリーミング画質\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" テレビをライブストリーミングするときのデフォルトの画質を設定します。\"),_c('br'),_vm._v(\" ストリーミング画質はプレイヤーの設定からいつでも切り替えられます。\"),_c('br')]),_c('div',{staticClass:\"settings__item-label mt-1\"},[_vm._v(\" 画質を [1080p (60fps)] に設定すると、\"),_c('b',[_vm._v(\"通常 30fps (60i) の映像を補間し、より滑らか（ぬるぬる）な映像で視聴できます！\")]),_vm._v(\"ドラマやバラエティなどを視聴するときに特におすすめです。\"),_c('br')]),_c('div',{staticClass:\"settings__item-label mt-1\"},[_vm._v(\" Fire HD 10 (2021) などの一部のローエンド Android (特に MediaTek SoC 搭載) デバイスでは、1080p 以上の映像描画が不安定なことが確認されています。その場合は 720p 以下の画質を選択することをおすすめします。\"),_c('br')]),(network_circuit !== 'モバイル回線時')?_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.tv_streaming_quality},model:{value:(_vm.settingsStore.settings.tv_streaming_quality),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tv_streaming_quality\", $$v)},expression:\"settingsStore.settings.tv_streaming_quality\"}}):_vm._e(),(network_circuit === 'モバイル回線時')?_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.tv_streaming_quality_cellular},model:{value:(_vm.settingsStore.settings.tv_streaming_quality_cellular),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tv_streaming_quality_cellular\", $$v)},expression:\"settingsStore.settings.tv_streaming_quality_cellular\"}}):_vm._e()],1),_c('div',{staticClass:\"settings__item settings__item--switch settings__item--sync-disabled\",class:{'settings__item--disabled': _vm.PlayerUtils.isHEVCVideoSupported() === false}},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":`tv_data_saver_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`}},[_vm._v(\" テレビを通信節約モードで視聴する \")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":`tv_data_saver_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`}},[_vm._v(\" 通信節約モードでは、圧縮率の高い H.265 / HEVC を使い、\"),_c('b',[_vm._v(\"画質はほぼそのまま、通信量を通常より 50% 〜 70% 削減して視聴できます！\")]),_vm._v(\" サーバー PC によっては高負荷になることがあります。\"),_c('br')]),_c('div',{staticClass:\"settings__item-label mt-1\"},[_vm._v(\" 通信が不安定になりがちなモバイル回線 (4G/5G)・通信速度の遅いフリー Wi-Fi から視聴するときに特におすすめです。\"),_c('br'),(_vm.PlayerUtils.isHEVCVideoSupported() === false && _vm.Utils.isFirefox() === false)?_c('p',{staticClass:\"mt-1 mb-0 error--text lighten-1\"},[_vm._v(\" このデバイスでは通信節約モードがサポートされていません。 \")]):_vm._e(),(_vm.PlayerUtils.isHEVCVideoSupported() === false && _vm.Utils.isFirefox() === true)?_c('p',{staticClass:\"mt-1 mb-0 error--text lighten-1\"},[_vm._v(\" お使いの Firefox ブラウザでは通信節約モードがサポートされていません。 \")]):_vm._e()]),(network_circuit !== 'モバイル回線時')?_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"tv_data_saver_mode\",\"inset\":\"\",\"hide-details\":\"\",\"disabled\":_vm.PlayerUtils.isHEVCVideoSupported() === false},model:{value:(_vm.settingsStore.settings.tv_data_saver_mode),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tv_data_saver_mode\", $$v)},expression:\"settingsStore.settings.tv_data_saver_mode\"}}):_vm._e(),(network_circuit === 'モバイル回線時')?_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"tv_data_saver_mode_cellular\",\"inset\":\"\",\"hide-details\":\"\",\"disabled\":_vm.PlayerUtils.isHEVCVideoSupported() === false},model:{value:(_vm.settingsStore.settings.tv_data_saver_mode_cellular),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tv_data_saver_mode_cellular\", $$v)},expression:\"settingsStore.settings.tv_data_saver_mode_cellular\"}}):_vm._e()],1),_c('div',{staticClass:\"settings__item settings__item--switch settings__item--sync-disabled\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":`tv_low_latency_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`}},[_vm._v(\" テレビを低遅延で視聴する \")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":`tv_low_latency_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`}},[_vm._v(\" 低遅延ストリーミングをオンにすると、\"),_c('b',[_vm._v(\"放送波との遅延を最短 0.9 秒に抑えて視聴できます！\")]),_c('br'),_vm._v(\" また、約 3 秒以上遅延したときに少しだけ再生速度を早める (1.1x) ことで、滑らかにストリーミングの遅延を取り戻します。\"),_c('br')]),_c('div',{staticClass:\"settings__item-label mt-1\"},[_vm._v(\" 映像がカクつきやすくなるため、通信が不安定になりがちなモバイル回線やフリー Wi-Fi から視聴するときは、低遅延ストリーミングをオフにすることをおすすめします。\"),_c('br')]),(network_circuit !== 'モバイル回線時')?_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"tv_low_latency_mode\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.tv_low_latency_mode),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tv_low_latency_mode\", $$v)},expression:\"settingsStore.settings.tv_low_latency_mode\"}}):_vm._e(),(network_circuit === 'モバイル回線時')?_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"tv_low_latency_mode_cellular\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.tv_low_latency_mode_cellular),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tv_low_latency_mode_cellular\", $$v)},expression:\"settingsStore.settings.tv_low_latency_mode_cellular\"}}):_vm._e()],1),_c('v-divider',{staticClass:\"mt-6\"}),_c('div',{staticClass:\"settings__item settings__item--sync-disabled\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"ビデオのデフォルトのストリーミング画質\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" ビデオをストリーミング再生するときのデフォルトの画質を設定します。\"),_c('br'),_vm._v(\" ストリーミング画質はプレイヤーの設定からいつでも切り替えられます。\"),_c('br')]),_c('div',{staticClass:\"settings__item-label mt-1\"},[_vm._v(\" 画質を [1080p (60fps)] に設定すると、\"),_c('b',[_vm._v(\"通常 30fps (60i) の映像を補間し、より滑らか（ぬるぬる）な映像で視聴できます！\")]),_vm._v(\"ドラマやバラエティなどを視聴するときに特におすすめです。\"),_c('br')]),_c('div',{staticClass:\"settings__item-label mt-1\"},[_vm._v(\" Fire HD 10 (2021) などの一部のローエンド Android (特に MediaTek SoC 搭載) デバイスでは、1080p 以上の映像描画が不安定なことが確認されています。その場合は 720p 以下の画質を選択することをおすすめします。\"),_c('br')]),(network_circuit !== 'モバイル回線時')?_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.video_streaming_quality},model:{value:(_vm.settingsStore.settings.video_streaming_quality),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"video_streaming_quality\", $$v)},expression:\"settingsStore.settings.video_streaming_quality\"}}):_vm._e(),(network_circuit === 'モバイル回線時')?_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.video_streaming_quality_cellular},model:{value:(_vm.settingsStore.settings.video_streaming_quality_cellular),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"video_streaming_quality_cellular\", $$v)},expression:\"settingsStore.settings.video_streaming_quality_cellular\"}}):_vm._e()],1),_c('div',{staticClass:\"settings__item settings__item--switch settings__item--sync-disabled\",class:{'settings__item--disabled': _vm.PlayerUtils.isHEVCVideoSupported() === false}},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":`video_data_saver_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`}},[_vm._v(\" ビデオを通信節約モードで視聴する \")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":`video_data_saver_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`}},[_vm._v(\" 通信節約モードでは、圧縮率の高い H.265 / HEVC を使い、\"),_c('b',[_vm._v(\"画質はほぼそのまま、通信量を通常より 50% 〜 70% 削減して視聴できます！\")]),_vm._v(\" サーバー PC によっては高負荷になることがあります。\"),_c('br')]),_c('div',{staticClass:\"settings__item-label mt-1\"},[_vm._v(\" 通信が不安定になりがちなモバイル回線 (4G/5G)・通信速度の遅いフリー Wi-Fi から視聴するときに特におすすめです。\"),_c('br'),(_vm.PlayerUtils.isHEVCVideoSupported() === false && _vm.Utils.isFirefox() === false)?_c('p',{staticClass:\"mt-1 mb-0 error--text lighten-1\"},[_vm._v(\" このデバイスでは通信節約モードがサポートされていません。 \")]):_vm._e(),(_vm.PlayerUtils.isHEVCVideoSupported() === false && _vm.Utils.isFirefox() === true)?_c('p',{staticClass:\"mt-1 mb-0 error--text lighten-1\"},[_vm._v(\" お使いの Firefox ブラウザでは通信節約モードがサポートされていません。 \")]):_vm._e()]),(network_circuit !== 'モバイル回線時')?_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"video_data_saver_mode\",\"inset\":\"\",\"hide-details\":\"\",\"disabled\":_vm.PlayerUtils.isHEVCVideoSupported() === false},model:{value:(_vm.settingsStore.settings.video_data_saver_mode),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"video_data_saver_mode\", $$v)},expression:\"settingsStore.settings.video_data_saver_mode\"}}):_vm._e(),(network_circuit === 'モバイル回線時')?_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"video_data_saver_mode_cellular\",\"inset\":\"\",\"hide-details\":\"\",\"disabled\":_vm.PlayerUtils.isHEVCVideoSupported() === false},model:{value:(_vm.settingsStore.settings.video_data_saver_mode_cellular),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"video_data_saver_mode_cellular\", $$v)},expression:\"settingsStore.settings.video_data_saver_mode_cellular\"}}):_vm._e()],1)],1)}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <!-- ベース画面の中にそれぞれの設定画面で異なる部分を記述する -->\r\n    <SettingsBase>\r\n        <h2 class=\"settings__heading\">\r\n            <router-link v-ripple class=\"settings__back-button\" to=\"/settings/\">\r\n                <Icon icon=\"fluent:arrow-left-12-filled\" width=\"25px\" />\r\n            </router-link>\r\n            <Icon icon=\"fluent:video-clip-multiple-16-filled\" width=\"26px\" />\r\n            <span class=\"ml-3\">画質</span>\r\n        </h2>\r\n        <v-tabs-fix class=\"settings__tab\" background-color=\"transparent\" centered v-model=\"tab\">\r\n            <v-tab style=\"text-transform: none !important;\" v-for=\"network_circuit in network_circuits\" :key=\"network_circuit\">\r\n                {{network_circuit}}\r\n            </v-tab>\r\n        </v-tabs-fix>\r\n        <v-tabs-items-fix v-model=\"tab\">\r\n            <v-tab-item-fix class=\"settings__content mt-0\" v-for=\"network_circuit in network_circuits\" :key=\"network_circuit\">\r\n                <div class=\"settings__item settings__item--sync-disabled\">\r\n                    <div class=\"settings__item-heading\">テレビのデフォルトのストリーミング画質</div>\r\n                    <div class=\"settings__item-label\">\r\n                        テレビをライブストリーミングするときのデフォルトの画質を設定します。<br>\r\n                        ストリーミング画質はプレイヤーの設定からいつでも切り替えられます。<br>\r\n                    </div>\r\n                    <div class=\"settings__item-label mt-1\">\r\n                        画質を [1080p (60fps)] に設定すると、<b>通常 30fps (60i) の映像を補間し、より滑らか（ぬるぬる）な映像で視聴できます！</b>ドラマやバラエティなどを視聴するときに特におすすめです。<br>\r\n                    </div>\r\n                    <div class=\"settings__item-label mt-1\">\r\n                        Fire HD 10 (2021) などの一部のローエンド Android (特に MediaTek SoC 搭載) デバイスでは、1080p 以上の映像描画が不安定なことが確認されています。その場合は 720p 以下の画質を選択することをおすすめします。<br>\r\n                    </div>\r\n                    <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\" v-if=\"network_circuit !== 'モバイル回線時'\"\r\n                        :items=\"tv_streaming_quality\" v-model=\"settingsStore.settings.tv_streaming_quality\">\r\n                    </v-select>\r\n                    <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\" v-if=\"network_circuit === 'モバイル回線時'\"\r\n                        :items=\"tv_streaming_quality_cellular\" v-model=\"settingsStore.settings.tv_streaming_quality_cellular\">\r\n                    </v-select>\r\n                </div>\r\n                <div class=\"settings__item settings__item--switch settings__item--sync-disabled\"\r\n                    :class=\"{'settings__item--disabled': PlayerUtils.isHEVCVideoSupported() === false}\">\r\n                    <label class=\"settings__item-heading\" :for=\"`tv_data_saver_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`\">\r\n                        テレビを通信節約モードで視聴する\r\n                    </label>\r\n                    <label class=\"settings__item-label\" :for=\"`tv_data_saver_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`\">\r\n                        通信節約モードでは、圧縮率の高い H.265 / HEVC を使い、<b>画質はほぼそのまま、通信量を通常より 50% 〜 70% 削減して視聴できます！</b> サーバー PC によっては高負荷になることがあります。<br>\r\n                    </label>\r\n                    <div class=\"settings__item-label mt-1\">\r\n                        通信が不安定になりがちなモバイル回線 (4G/5G)・通信速度の遅いフリー Wi-Fi から視聴するときに特におすすめです。<br>\r\n                        <p class=\"mt-1 mb-0 error--text lighten-1\" v-if=\"PlayerUtils.isHEVCVideoSupported() === false && Utils.isFirefox() === false\">\r\n                            このデバイスでは通信節約モードがサポートされていません。\r\n                        </p>\r\n                        <p class=\"mt-1 mb-0 error--text lighten-1\" v-if=\"PlayerUtils.isHEVCVideoSupported() === false && Utils.isFirefox() === true\">\r\n                            お使いの Firefox ブラウザでは通信節約モードがサポートされていません。\r\n                        </p>\r\n                    </div>\r\n                    <v-switch class=\"settings__item-switch\" id=\"tv_data_saver_mode\" inset hide-details v-if=\"network_circuit !== 'モバイル回線時'\"\r\n                        v-model=\"settingsStore.settings.tv_data_saver_mode\" :disabled=\"PlayerUtils.isHEVCVideoSupported() === false\">\r\n                    </v-switch>\r\n                    <v-switch class=\"settings__item-switch\" id=\"tv_data_saver_mode_cellular\" inset hide-details v-if=\"network_circuit === 'モバイル回線時'\"\r\n                        v-model=\"settingsStore.settings.tv_data_saver_mode_cellular\" :disabled=\"PlayerUtils.isHEVCVideoSupported() === false\">\r\n                    </v-switch>\r\n                </div>\r\n                <div class=\"settings__item settings__item--switch settings__item--sync-disabled\">\r\n                    <label class=\"settings__item-heading\" :for=\"`tv_low_latency_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`\">\r\n                        テレビを低遅延で視聴する\r\n                    </label>\r\n                    <label class=\"settings__item-label\" :for=\"`tv_low_latency_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`\">\r\n                        低遅延ストリーミングをオンにすると、<b>放送波との遅延を最短 0.9 秒に抑えて視聴できます！</b><br>\r\n                        また、約 3 秒以上遅延したときに少しだけ再生速度を早める (1.1x) ことで、滑らかにストリーミングの遅延を取り戻します。<br>\r\n                    </label>\r\n                    <div class=\"settings__item-label mt-1\">\r\n                        映像がカクつきやすくなるため、通信が不安定になりがちなモバイル回線やフリー Wi-Fi から視聴するときは、低遅延ストリーミングをオフにすることをおすすめします。<br>\r\n                    </div>\r\n                    <v-switch class=\"settings__item-switch\" id=\"tv_low_latency_mode\" inset hide-details v-if=\"network_circuit !== 'モバイル回線時'\"\r\n                        v-model=\"settingsStore.settings.tv_low_latency_mode\">\r\n                    </v-switch>\r\n                    <v-switch class=\"settings__item-switch\" id=\"tv_low_latency_mode_cellular\" inset hide-details v-if=\"network_circuit === 'モバイル回線時'\"\r\n                        v-model=\"settingsStore.settings.tv_low_latency_mode_cellular\">\r\n                    </v-switch>\r\n                </div>\r\n                <v-divider class=\"mt-6\"></v-divider>\r\n                <div class=\"settings__item settings__item--sync-disabled\">\r\n                    <div class=\"settings__item-heading\">ビデオのデフォルトのストリーミング画質</div>\r\n                    <div class=\"settings__item-label\">\r\n                        ビデオをストリーミング再生するときのデフォルトの画質を設定します。<br>\r\n                        ストリーミング画質はプレイヤーの設定からいつでも切り替えられます。<br>\r\n                    </div>\r\n                    <div class=\"settings__item-label mt-1\">\r\n                        画質を [1080p (60fps)] に設定すると、<b>通常 30fps (60i) の映像を補間し、より滑らか（ぬるぬる）な映像で視聴できます！</b>ドラマやバラエティなどを視聴するときに特におすすめです。<br>\r\n                    </div>\r\n                    <div class=\"settings__item-label mt-1\">\r\n                        Fire HD 10 (2021) などの一部のローエンド Android (特に MediaTek SoC 搭載) デバイスでは、1080p 以上の映像描画が不安定なことが確認されています。その場合は 720p 以下の画質を選択することをおすすめします。<br>\r\n                    </div>\r\n                    <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\" v-if=\"network_circuit !== 'モバイル回線時'\"\r\n                        :items=\"video_streaming_quality\" v-model=\"settingsStore.settings.video_streaming_quality\">\r\n                    </v-select>\r\n                    <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\" v-if=\"network_circuit === 'モバイル回線時'\"\r\n                        :items=\"video_streaming_quality_cellular\" v-model=\"settingsStore.settings.video_streaming_quality_cellular\">\r\n                    </v-select>\r\n                </div>\r\n                <div class=\"settings__item settings__item--switch settings__item--sync-disabled\"\r\n                    :class=\"{'settings__item--disabled': PlayerUtils.isHEVCVideoSupported() === false}\">\r\n                    <label class=\"settings__item-heading\" :for=\"`video_data_saver_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`\">\r\n                        ビデオを通信節約モードで視聴する\r\n                    </label>\r\n                    <label class=\"settings__item-label\" :for=\"`video_data_saver_mode${network_circuit === 'モバイル回線時' ? '_cellular' : ''}`\">\r\n                        通信節約モードでは、圧縮率の高い H.265 / HEVC を使い、<b>画質はほぼそのまま、通信量を通常より 50% 〜 70% 削減して視聴できます！</b> サーバー PC によっては高負荷になることがあります。<br>\r\n                    </label>\r\n                    <div class=\"settings__item-label mt-1\">\r\n                        通信が不安定になりがちなモバイル回線 (4G/5G)・通信速度の遅いフリー Wi-Fi から視聴するときに特におすすめです。<br>\r\n                        <p class=\"mt-1 mb-0 error--text lighten-1\" v-if=\"PlayerUtils.isHEVCVideoSupported() === false && Utils.isFirefox() === false\">\r\n                            このデバイスでは通信節約モードがサポートされていません。\r\n                        </p>\r\n                        <p class=\"mt-1 mb-0 error--text lighten-1\" v-if=\"PlayerUtils.isHEVCVideoSupported() === false && Utils.isFirefox() === true\">\r\n                            お使いの Firefox ブラウザでは通信節約モードがサポートされていません。\r\n                        </p>\r\n                    </div>\r\n                    <v-switch class=\"settings__item-switch\" id=\"video_data_saver_mode\" inset hide-details v-if=\"network_circuit !== 'モバイル回線時'\"\r\n                        v-model=\"settingsStore.settings.video_data_saver_mode\" :disabled=\"PlayerUtils.isHEVCVideoSupported() === false\">\r\n                    </v-switch>\r\n                    <v-switch class=\"settings__item-switch\" id=\"video_data_saver_mode_cellular\" inset hide-details v-if=\"network_circuit === 'モバイル回線時'\"\r\n                        v-model=\"settingsStore.settings.video_data_saver_mode_cellular\" :disabled=\"PlayerUtils.isHEVCVideoSupported() === false\">\r\n                    </v-switch>\r\n                </div>\r\n            </v-tab-item-fix>\r\n        </v-tabs-items-fix>\r\n    </SettingsBase>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils, { PlayerUtils } from '@/utils';\r\nimport SettingsBase from '@/views/Settings/Base.vue';\r\n\r\nconst QUALITY_H264 = [\r\n    {text: '1080p (60fps) (約4.50GB/h / 平均10.0Mbps)', value: '1080p-60fps'},\r\n    {text: '1080p (約4.50GB/h / 平均10.0Mbps)', value: '1080p'},\r\n    {text: '810p (約2.62GB/h / 平均5.8Mbps)', value: '810p'},\r\n    {text: '720p (約2.18GB/h / 平均4.9Mbps)', value: '720p'},\r\n    {text: '540p (約1.52GB/h / 平均3.4Mbps)', value: '540p'},\r\n    {text: '480p (約1.06GB/h / 平均2.3Mbps)', value: '480p'},\r\n    {text: '360p (約0.60GB/h / 平均1.3Mbps)', value: '360p'},\r\n    {text: '240p (約0.35GB/h / 平均0.8Mbps)', value: '240p'},\r\n];\r\n\r\nconst QUALITY_H265 = [\r\n    {text: '1080p (60fps) (約1.80GB/h / 平均4.0Mbps)', value: '1080p-60fps'},\r\n    {text: '1080p (約1.37GB/h / 平均3.0Mbps)', value: '1080p'},\r\n    {text: '810p (約1.05GB/h / 平均2.3Mbps)', value: '810p'},\r\n    {text: '720p (約0.82GB/h / 平均1.8Mbps)', value: '720p'},\r\n    {text: '540p (約0.53GB/h / 平均1.2Mbps)', value: '540p'},\r\n    {text: '480p (約0.46GB/h / 平均1.0Mbps)', value: '480p'},\r\n    {text: '360p (約0.30GB/h / 平均0.7Mbps)', value: '360p'},\r\n    {text: '240p (約0.20GB/h / 平均0.4Mbps)', value: '240p'},\r\n];\r\n\r\nexport default defineComponent({\r\n    name: 'Settings-Quality',\r\n    components: {\r\n        SettingsBase,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n            PlayerUtils: Object.freeze(PlayerUtils),\r\n\r\n            // フォームを小さくするかどうか\r\n            is_form_dense: Utils.isSmartphoneHorizontal(),\r\n\r\n            // タブの状態管理\r\n            tab: null as number | null,\r\n\r\n            // ネットワーク回線の種類\r\n            network_circuits: PlayerUtils.getNetworkCircuitType() !== null ? ['Wi-Fi 回線時', 'モバイル回線時'] : ['Wi-Fi・モバイル回線時'],\r\n\r\n            // テレビのデフォルトのストリーミング画質の選択肢\r\n            tv_streaming_quality: QUALITY_H264,\r\n            tv_streaming_quality_cellular: QUALITY_H264,\r\n\r\n            // ビデオのデフォルトのストリーミング画質の選択肢\r\n            video_streaming_quality: QUALITY_H264,\r\n            video_streaming_quality_cellular: QUALITY_H264,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useSettingsStore),\r\n    },\r\n    watch: {\r\n        'settingsStore.settings.tv_data_saver_mode': {\r\n            immediate: true,\r\n            handler(value: boolean) {\r\n                if (value === true) {\r\n                    this.tv_streaming_quality = QUALITY_H265;\r\n                } else {\r\n                    this.tv_streaming_quality = QUALITY_H264;\r\n                }\r\n            },\r\n        },\r\n        'settingsStore.settings.tv_data_saver_mode_cellular': {\r\n            immediate: true,\r\n            handler(value: boolean) {\r\n                if (value === true) {\r\n                    this.tv_streaming_quality_cellular = QUALITY_H265;\r\n                } else {\r\n                    this.tv_streaming_quality_cellular = QUALITY_H264;\r\n                }\r\n            },\r\n        },\r\n        'settingsStore.settings.video_data_saver_mode': {\r\n            immediate: true,\r\n            handler(value: boolean) {\r\n                if (value === true) {\r\n                    this.video_streaming_quality = QUALITY_H265;\r\n                } else {\r\n                    this.video_streaming_quality = QUALITY_H264;\r\n                }\r\n            },\r\n        },\r\n        'settingsStore.settings.video_data_saver_mode_cellular': {\r\n            immediate: true,\r\n            handler(value: boolean) {\r\n                if (value === true) {\r\n                    this.video_streaming_quality_cellular = QUALITY_H265;\r\n                } else {\r\n                    this.video_streaming_quality_cellular = QUALITY_H264;\r\n                }\r\n            },\r\n        },\r\n    },\r\n    created() {\r\n        // 通信節約モードならストリーミング画質の選択肢を H.265 にする\r\n        if (this.settingsStore.settings.tv_data_saver_mode === true) {\r\n            this.tv_streaming_quality = QUALITY_H265;\r\n        }\r\n        if (this.settingsStore.settings.tv_data_saver_mode_cellular === true) {\r\n            this.tv_streaming_quality_cellular = QUALITY_H265;\r\n        }\r\n        if (this.settingsStore.settings.video_data_saver_mode === true) {\r\n            this.video_streaming_quality = QUALITY_H265;\r\n        }\r\n        if (this.settingsStore.settings.video_data_saver_mode_cellular === true) {\r\n            this.video_streaming_quality_cellular = QUALITY_H265;\r\n        }\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.settings__tab {\r\n    position: sticky;\r\n    top: 65px;\r\n    z-index: 4;\r\n    background: var(--v-background-lighten1);\r\n    @include smartphone-horizontal {\r\n        top: 0px;\r\n    }\r\n    @include smartphone-vertical {\r\n        top: 60px;\r\n        background: var(--v-background-base);\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Quality.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Quality.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Quality.vue?vue&type=template&id=e865f358&scoped=true\"\nimport script from \"./Quality.vue?vue&type=script&lang=ts\"\nexport * from \"./Quality.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Quality.vue?vue&type=style&index=0&id=e865f358&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e865f358\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('SettingsBase',[_c('h2',{staticClass:\"settings__heading\"},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"settings__back-button\",attrs:{\"to\":\"/settings/\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-left-12-filled\",\"width\":\"25px\"}})],1),_c('Icon',{attrs:{\"icon\":\"fluent:server-surface-16-filled\",\"width\":\"22px\"}}),_c('span',{staticClass:\"ml-2\"},[_vm._v(\"サーバー設定\")])],1),_c('div',{staticClass:\"settings__content\"},[_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"鋭意開発中…\")])])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <!-- ベース画面の中にそれぞれの設定画面で異なる部分を記述する -->\r\n    <SettingsBase>\r\n        <h2 class=\"settings__heading\">\r\n            <router-link v-ripple class=\"settings__back-button\" to=\"/settings/\">\r\n                <Icon icon=\"fluent:arrow-left-12-filled\" width=\"25px\" />\r\n            </router-link>\r\n            <Icon icon=\"fluent:server-surface-16-filled\" width=\"22px\" />\r\n            <span class=\"ml-2\">サーバー設定</span>\r\n        </h2>\r\n        <div class=\"settings__content\">\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">鋭意開発中…</div>\r\n            </div>\r\n        </div>\r\n    </SettingsBase>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { defineComponent } from 'vue';\r\n\r\nimport SettingsBase from '@/views/Settings/Base.vue';\r\n\r\nexport default defineComponent({\r\n    name: 'Settings-Server',\r\n    components: {\r\n        SettingsBase,\r\n    }\r\n});\r\n\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Server.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Server.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Server.vue?vue&type=template&id=3a5eacd7\"\nimport script from \"./Server.vue?vue&type=script&lang=ts\"\nexport * from \"./Server.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('SettingsBase',[_c('h2',{staticClass:\"settings__heading\"},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"settings__back-button\",attrs:{\"to\":\"/settings/\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-left-12-filled\",\"width\":\"25px\"}})],1),_c('Icon',{attrs:{\"icon\":\"fa-brands:twitter\",\"width\":\"22px\"}}),_c('span',{staticClass:\"ml-3\"},[_vm._v(\"Twitter\")])],1),_c('div',{staticClass:\"settings__content\",class:{'settings__content--loading': _vm.is_loading}},[_c('div',{staticClass:\"twitter-accounts\"},[(_vm.userStore.user !== null && _vm.userStore.user.twitter_accounts.length > 0)?_c('div',{staticClass:\"twitter-accounts__heading\"},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:person-board-20-filled\",\"height\":\"30\"}}),_vm._v(\"連携中のアカウント \")],1):_vm._e(),(_vm.userStore.user === null || _vm.userStore.user.twitter_accounts.length === 0)?_c('div',{staticClass:\"twitter-accounts__guide\"},[_c('Icon',{staticClass:\"flex-shrink-0\",attrs:{\"icon\":\"fa-brands:twitter\",\"width\":\"45px\"}}),_c('div',{staticClass:\"ml-4\"},[_c('div',{staticClass:\"font-weight-bold text-h6\"},[_vm._v(\"Twitter アカウントと連携していません\")]),_c('div',{staticClass:\"text--text text--darken-1 text-subtitle-2 mt-1\"},[_vm._v(\" Twitter アカウントと連携すると、テレビを見ながら Twitter にツイートしたり、ほかの実況ツイートをリアルタイムで表示できるようになります。 \")])])],1):_vm._e(),_vm._l(((_vm.userStore.user !== null ? _vm.userStore.user.twitter_accounts: [])),function(twitter_account){return _c('div',{key:twitter_account.id,staticClass:\"twitter-account\"},[_c('img',{staticClass:\"twitter-account__icon\",attrs:{\"src\":twitter_account.icon_url}}),_c('div',{staticClass:\"twitter-account__info\"},[_c('div',{staticClass:\"twitter-account__info-name\"},[_c('span',{staticClass:\"twitter-account__info-name-text\"},[_vm._v(_vm._s(twitter_account.name))])]),_c('span',{staticClass:\"twitter-account__info-screen-name\"},[_vm._v(\" @\"+_vm._s(twitter_account.screen_name)+\" \"),(twitter_account.is_oauth_session === true)?_c('span',[_vm._v(\"(Legacy Session)\")]):_vm._e()])]),_c('v-btn',{staticClass:\"twitter-account__logout ml-auto\",attrs:{\"width\":\"124\",\"height\":\"52\",\"depressed\":\"\"},on:{\"click\":function($event){return _vm.logoutTwitterAccount(twitter_account.screen_name)}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:plug-disconnected-20-filled\",\"height\":\"24\"}}),_vm._v(\"連携解除 \")],1)],1)}),_c('v-btn',{staticClass:\"twitter-account__login\",attrs:{\"color\":\"secondary\",\"max-width\":\"250\",\"height\":\"50\",\"depressed\":\"\"},on:{\"click\":function($event){return _vm.loginTwitterAccountWithPasswordForm()}}},[_c('Icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"fluent:plug-connected-20-filled\",\"height\":\"24\"}}),_vm._v(\"連携するアカウントを追加 \")],1),_c('v-dialog',{attrs:{\"max-width\":\"600\"},model:{value:(_vm.twitter_password_auth_dialog),callback:function ($$v) {_vm.twitter_password_auth_dialog=$$v},expression:\"twitter_password_auth_dialog\"}},[_c('v-card',[_c('v-card-title',{staticClass:\"justify-center pt-6 font-weight-bold\"},[_vm._v(\"Twitter にログイン\")]),_c('v-card-text',{staticClass:\"pt-2 pb-0\"},[_c('p',{staticClass:\"mb-1\"},[_vm._v(\"2023/07 以降、Twitter のサードパーティー API の事実上の廃止により、従来のアプリ連携では Twitter にアクセスできなくなりました。\")]),_c('p',{staticClass:\"mb-1\"},[_vm._v(\"そこで KonomiTV では、代わりに \"),_c('a',{attrs:{\"href\":\"https://github.com/tsukumijima/tweepy-authlib\",\"target\":\"_blank\"}},[_vm._v(\"ユーザー名とパスワードでログイン\")]),_vm._v(\" することで、これまで通り Twitter 連携ができるようにしています (2要素認証を設定しているアカウントには対応していません) 。\")]),_c('p',{staticClass:\"mb-1\"},[_vm._v(\"ここで入力したパスワードは一切保存されず、取得した Cookie セッションはローカルの KonomiTV サーバーにのみ保存されます。Cookie セッションが Twitter API 以外の外部サービスに送信されることはありません。\")]),_c('p',{staticClass:\"mb-1\"},[_vm._v(\"万全は期していますが、非公式な方法のため、使い方次第ではアカウントにペナルティが適用される可能性もあります。自己の責任のもとでご利用ください。\")]),_c('v-form',{ref:\"twitter_form\",staticClass:\"settings__item\",on:{\"submit\":function($event){$event.preventDefault();}}},[_c('v-text-field',{ref:\"twitter_screen_name\",staticClass:\"settings__item-form mt-6\",attrs:{\"outlined\":\"\",\"label\":\"ユーザー名 (@ から始まる ID)\",\"placeholder\":\"screen_name\",\"dense\":_vm.is_form_dense,\"rules\":[(value) => !!value || 'ユーザー名を入力してください。']},model:{value:(_vm.twitter_screen_name),callback:function ($$v) {_vm.twitter_screen_name=$$v},expression:\"twitter_screen_name\"}}),_c('v-text-field',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"label\":\"パスワード\",\"dense\":_vm.is_form_dense,\"type\":_vm.twitter_password_showing ? 'text' : 'password',\"append-icon\":_vm.twitter_password_showing ? 'mdi-eye' : 'mdi-eye-off',\"rules\":[(value) => !!value || 'パスワードを入力してください。']},on:{\"click:append\":function($event){_vm.twitter_password_showing = !_vm.twitter_password_showing}},model:{value:(_vm.twitter_password),callback:function ($$v) {_vm.twitter_password=$$v},expression:\"twitter_password\"}})],1)],1),_c('v-card-actions',{staticClass:\"pt-0 px-6 pb-5\"},[_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"text\",\"height\":\"40\",\"text\":\"\"},on:{\"click\":function($event){_vm.twitter_password_auth_dialog = false}}},[_vm._v(\"キャンセル\")]),_c('v-btn',{staticClass:\"px-4\",attrs:{\"color\":\"secondary\",\"height\":\"40\"},on:{\"click\":function($event){return _vm.loginTwitterAccountWithPassword()}}},[_vm._v(\"ログイン\")])],1)],1)],1)],2),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"fold_panel_after_sending_tweet\"}},[_vm._v(\"ツイート送信後にパネルを折りたたむ\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"fold_panel_after_sending_tweet\"}},[_vm._v(\" この設定をオンにすると、ツイートを送信した後に、パネルが自動で折りたたまれます。\"),_c('br'),_vm._v(\" ツイートするとき以外はできるだけ映像を大きくして見たい方におすすめです。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"fold_panel_after_sending_tweet\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.fold_panel_after_sending_tweet),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"fold_panel_after_sending_tweet\", $$v)},expression:\"settingsStore.settings.fold_panel_after_sending_tweet\"}})],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"reset_hashtag_when_program_switches\"}},[_vm._v(\"番組が切り替わったときにハッシュタグフォームをリセットする\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"reset_hashtag_when_program_switches\"}},[_vm._v(\" チャンネルを切り替えたときや、視聴中の番組が終了し次の番組の放送が開始されたときに、ハッシュタグフォームをリセットするかを設定します。\"),_c('br'),_vm._v(\" この設定をオンにしておけば、「誤って前番組のハッシュタグをつけたまま次番組の実況ツイートをしてしまう」といったミスを回避できます。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"reset_hashtag_when_program_switches\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.reset_hashtag_when_program_switches),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"reset_hashtag_when_program_switches\", $$v)},expression:\"settingsStore.settings.reset_hashtag_when_program_switches\"}})],1),_c('div',{staticClass:\"settings__item settings__item--switch\"},[_c('label',{staticClass:\"settings__item-heading\",attrs:{\"for\":\"auto_add_watching_channel_hashtag\"}},[_vm._v(\"視聴中のチャンネルに対応する局タグを自動で追加する\")]),_c('label',{staticClass:\"settings__item-label\",attrs:{\"for\":\"auto_add_watching_channel_hashtag\"}},[_vm._v(\" この設定をオンにすると、視聴中のチャンネルに対応する局タグ (#nhk, #tokyomx など) がハッシュタグフォームに自動で追加されます。\"),_c('br'),_vm._v(\" 現時点で、局タグは三大首都圏の地上波・BS の一部チャンネル・AT-X にのみ対応しています。\"),_c('br'),_vm._v(\" なお、ビデオをみるときは視聴中のチャンネルに対応する局タグは追加されません。\"),_c('br')]),_c('v-switch',{staticClass:\"settings__item-switch\",attrs:{\"id\":\"auto_add_watching_channel_hashtag\",\"inset\":\"\",\"hide-details\":\"\"},model:{value:(_vm.settingsStore.settings.auto_add_watching_channel_hashtag),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"auto_add_watching_channel_hashtag\", $$v)},expression:\"settingsStore.settings.auto_add_watching_channel_hashtag\"}})],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"デフォルトで表示される Twitter タブ内のタブ\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" 視聴画面を開いたときに、パネルの Twitter タブの中で最初に表示されるタブを設定します。\"),_c('br')]),_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.twitter_active_tab},model:{value:(_vm.settingsStore.settings.twitter_active_tab),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"twitter_active_tab\", $$v)},expression:\"settingsStore.settings.twitter_active_tab\"}})],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"ツイートにつけるハッシュタグの位置\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" ツイート本文から見て、ハッシュタグをどの位置につけてツイートするかを設定します。\"),_c('br')]),_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.tweet_hashtag_position},model:{value:(_vm.settingsStore.settings.tweet_hashtag_position),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tweet_hashtag_position\", $$v)},expression:\"settingsStore.settings.tweet_hashtag_position\"}})],1),_c('div',{staticClass:\"settings__item\"},[_c('div',{staticClass:\"settings__item-heading\"},[_vm._v(\"ツイートするキャプチャに番組タイトルの透かしを描画する\")]),_c('div',{staticClass:\"settings__item-label\"},[_vm._v(\" ツイートするキャプチャに、透かしとして視聴中の番組タイトルを描画するかを設定します。\"),_c('br'),_vm._v(\" 透かしの描画位置は 左上・右上・左下・右下 から選択できます。\"),_c('br')]),_c('v-select',{staticClass:\"settings__item-form\",attrs:{\"outlined\":\"\",\"hide-details\":\"\",\"dense\":_vm.is_form_dense,\"items\":_vm.tweet_capture_watermark_position},model:{value:(_vm.settingsStore.settings.tweet_capture_watermark_position),callback:function ($$v) {_vm.$set(_vm.settingsStore.settings, \"tweet_capture_watermark_position\", $$v)},expression:\"settingsStore.settings.tweet_capture_watermark_position\"}})],1)]),_c('v-overlay',{attrs:{\"value\":_vm.is_twitter_password_auth_sending,\"z-index\":\"300\"}},[_c('v-progress-circular',{attrs:{\"color\":\"secondary\",\"indeterminate\":\"\",\"size\":\"64\"}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\r\nimport Message from '@/message';\r\nimport APIClient from '@/services/APIClient';\r\n\r\n\r\n/** Twitter アカウントと連携するための認証 URL を表すインターフェイス */\r\nexport interface ITwitterAuthURL {\r\n    authorization_url: string;\r\n}\r\n\r\n/** ツイートの送信結果を表すインターフェイス */\r\nexport interface ITweetResult {\r\n    is_success: boolean;\r\n    tweet_url?: string;\r\n    detail: string;\r\n}\r\n\r\nexport interface ITwitterPasswordAuthRequest {\r\n    screen_name: string;\r\n    password: string;\r\n}\r\n\r\n\r\nclass Twitter {\r\n\r\n    /**\r\n     * Twitter アカウントと連携するための認証 URL を取得する\r\n     * @returns 認証 URL or 認証 URL の取得に失敗した場合は null\r\n     */\r\n    static async fetchAuthorizationURL(): Promise<string | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.get<ITwitterAuthURL>('/twitter/auth');\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, 'Twitter アカウントとの連携用の認証 URL を取得できませんでした。');\r\n            return null;\r\n        }\r\n\r\n        return response.data.authorization_url;\r\n    }\r\n\r\n\r\n    /**\r\n     * Twitter アカウントとパスワード認証で連携する\r\n     * @param twitter_password_auth_request スクリーンネームとパスワード\r\n     * @returns ログインできた場合は true, 失敗した場合は false\r\n     */\r\n    static async authWithPassword(twitter_password_auth_request: ITwitterPasswordAuthRequest): Promise<boolean> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.post('/twitter/password-auth', twitter_password_auth_request);\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            if (typeof response.data.detail === 'string') {\r\n                if (response.data.detail.startsWith('Failed to authenticate with password')) {\r\n                    const error = response.data.detail.match(/Message: (.+)\\)/)![1];\r\n                    Message.error(`ログインに失敗しました。${error}`);\r\n                    return false;\r\n                } else if (response.data.detail.startsWith('Unexpected error occurred while authenticate with password')) {\r\n                    const error = response.data.detail.match(/Message: (.+)\\)/)![1];\r\n                    Message.error(`ログインフローの途中で予期せぬエラーが発生しました。${error}`);\r\n                    return false;\r\n                } else if (response.data.detail.startsWith('Failed to get user information')) {\r\n                    Message.error('Twitter アカウントのユーザー情報の取得に失敗しました。');\r\n                    return false;\r\n                }\r\n            }\r\n            // 上記以外のエラー\r\n            APIClient.showGenericError(response, 'Twitter アカウントとの連携に失敗しました。');\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n\r\n    /**\r\n     * 現在ログイン中のユーザーアカウントに紐づく Twitter アカウントとの連携を解除する\r\n     * @param screen_name Twitter のスクリーンネーム\r\n     * @returns 連携解除に成功した場合は true, 失敗した場合は false\r\n     */\r\n    static async logoutAccount(screen_name: string): Promise<boolean> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.delete(`/twitter/accounts/${screen_name}`);\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, 'Twitter アカウントとの連携を解除できませんでした。');\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n\r\n    /**\r\n     * ツイートを送信する\r\n     * @param screen_name Twitter のスクリーンネーム\r\n     * @param text ツイート本文\r\n     * @param captures 添付するキャプチャ画像\r\n     */\r\n    static async sendTweet(screen_name: string, text: string, captures: Blob[]): Promise<{message: string; is_error: boolean;}> {\r\n\r\n        // multipart/form-data でツイート本文と画像（選択されている場合）を送る\r\n        const form_data = new FormData();\r\n        form_data.append('tweet', text);\r\n        for (const tweet_capture of captures) {\r\n            form_data.append('images', tweet_capture);\r\n        }\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.post<ITweetResult>(`/twitter/accounts/${screen_name}/tweets`, form_data, {\r\n            headers: {'Content-Type': 'multipart/form-data'},\r\n        });\r\n\r\n        // エラー処理 (API リクエスト自体に失敗した場合)\r\n        if (response.type === 'error') {\r\n            if (typeof response.data.detail === 'string') {\r\n                if (Number.isNaN(response.status)) {\r\n                    // HTTP リクエスト自体が失敗し、HTTP ステータスコードが取得できなかった場合\r\n                    return {message: `ツイートの送信に失敗しました。(${response.data.detail})`, is_error: true};\r\n                } else {\r\n                    // HTTP リクエスト自体は成功したが、API からエラーレスポンスが返ってきた場合\r\n                    return {message: `ツイートの送信に失敗しました。(HTTP Error ${response.status} / ${response.data.detail})`, is_error: true};\r\n                }\r\n            } else {\r\n                return {message: `ツイートの送信に失敗しました。(HTTP Error ${response.status})`, is_error: true};\r\n            }\r\n        }\r\n\r\n        // 成功 or 失敗に関わらず detail の内容をそのまま通知する\r\n        if (response.data.is_success === false) {\r\n            // ツイート失敗\r\n            return {message: response.data.detail, is_error: true};\r\n        } else {\r\n            // ツイート成功\r\n            return {message: response.data.detail, is_error: false};\r\n        }\r\n    }\r\n}\r\n\r\nexport default Twitter;\r\n","<template>\r\n    <!-- ベース画面の中にそれぞれの設定画面で異なる部分を記述する -->\r\n    <SettingsBase>\r\n        <h2 class=\"settings__heading\">\r\n            <router-link v-ripple class=\"settings__back-button\" to=\"/settings/\">\r\n                <Icon icon=\"fluent:arrow-left-12-filled\" width=\"25px\" />\r\n            </router-link>\r\n            <Icon icon=\"fa-brands:twitter\" width=\"22px\" />\r\n            <span class=\"ml-3\">Twitter</span>\r\n        </h2>\r\n        <div class=\"settings__content\" :class=\"{'settings__content--loading': is_loading}\">\r\n            <div class=\"twitter-accounts\">\r\n                <div class=\"twitter-accounts__heading\" v-if=\"userStore.user !== null && userStore.user.twitter_accounts.length > 0\">\r\n                    <Icon icon=\"fluent:person-board-20-filled\" class=\"mr-2\" height=\"30\" />連携中のアカウント\r\n                </div>\r\n                <div class=\"twitter-accounts__guide\" v-if=\"userStore.user === null || userStore.user.twitter_accounts.length === 0\">\r\n                    <Icon class=\"flex-shrink-0\" icon=\"fa-brands:twitter\" width=\"45px\" />\r\n                    <div class=\"ml-4\">\r\n                        <div class=\"font-weight-bold text-h6\">Twitter アカウントと連携していません</div>\r\n                        <div class=\"text--text text--darken-1 text-subtitle-2 mt-1\">\r\n                            Twitter アカウントと連携すると、テレビを見ながら Twitter にツイートしたり、ほかの実況ツイートをリアルタイムで表示できるようになります。\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"twitter-account\"\r\n                    v-for=\"twitter_account in (userStore.user !== null ? userStore.user.twitter_accounts: [])\"\r\n                    :key=\"twitter_account.id\">\r\n                    <img class=\"twitter-account__icon\" :src=\"twitter_account.icon_url\">\r\n                    <div class=\"twitter-account__info\">\r\n                        <div class=\"twitter-account__info-name\">\r\n                            <span class=\"twitter-account__info-name-text\">{{twitter_account.name}}</span>\r\n                        </div>\r\n                        <span class=\"twitter-account__info-screen-name\">\r\n                            @{{twitter_account.screen_name}}\r\n                            <span v-if=\"twitter_account.is_oauth_session === true\">(Legacy Session)</span>\r\n                        </span>\r\n                    </div>\r\n                    <v-btn class=\"twitter-account__logout ml-auto\" width=\"124\" height=\"52\" depressed\r\n                        @click=\"logoutTwitterAccount(twitter_account.screen_name)\">\r\n                        <Icon icon=\"fluent:plug-disconnected-20-filled\" class=\"mr-2\" height=\"24\" />連携解除\r\n                    </v-btn>\r\n                </div>\r\n                <v-btn class=\"twitter-account__login\" color=\"secondary\" max-width=\"250\" height=\"50\" depressed\r\n                    @click=\"loginTwitterAccountWithPasswordForm()\">\r\n                    <Icon icon=\"fluent:plug-connected-20-filled\" class=\"mr-2\" height=\"24\" />連携するアカウントを追加\r\n                </v-btn>\r\n                <v-dialog max-width=\"600\" v-model=\"twitter_password_auth_dialog\">\r\n                    <v-card>\r\n                        <v-card-title class=\"justify-center pt-6 font-weight-bold\">Twitter にログイン</v-card-title>\r\n                        <!-- スクリーンネームとパスワードフォーム -->\r\n                        <v-card-text class=\"pt-2 pb-0\">\r\n                            <p class=\"mb-1\">2023/07 以降、Twitter のサードパーティー API の事実上の廃止により、従来のアプリ連携では Twitter にアクセスできなくなりました。</p>\r\n                            <p class=\"mb-1\">そこで KonomiTV では、代わりに <a href=\"https://github.com/tsukumijima/tweepy-authlib\" target=\"_blank\">ユーザー名とパスワードでログイン</a> することで、これまで通り Twitter 連携ができるようにしています (2要素認証を設定しているアカウントには対応していません) 。</p>\r\n                            <p class=\"mb-1\">ここで入力したパスワードは一切保存されず、取得した Cookie セッションはローカルの KonomiTV サーバーにのみ保存されます。Cookie セッションが Twitter API 以外の外部サービスに送信されることはありません。</p>\r\n                            <p class=\"mb-1\">万全は期していますが、非公式な方法のため、使い方次第ではアカウントにペナルティが適用される可能性もあります。自己の責任のもとでご利用ください。</p>\r\n                            <v-form class=\"settings__item\" ref=\"twitter_form\" @submit.prevent>\r\n                                <v-text-field class=\"settings__item-form mt-6\" outlined label=\"ユーザー名 (@ から始まる ID)\" placeholder=\"screen_name\"\r\n                                    ref=\"twitter_screen_name\"\r\n                                    :dense=\"is_form_dense\"\r\n                                    v-model=\"twitter_screen_name\"\r\n                                    :rules=\"[(value) => !!value || 'ユーザー名を入力してください。']\">\r\n                                </v-text-field>\r\n                                <v-text-field class=\"settings__item-form\" outlined label=\"パスワード\"\r\n                                    :dense=\"is_form_dense\"\r\n                                    v-model=\"twitter_password\"\r\n                                    :type=\"twitter_password_showing ? 'text' : 'password'\"\r\n                                    :append-icon=\"twitter_password_showing ? 'mdi-eye' : 'mdi-eye-off'\"\r\n                                    :rules=\"[(value) => !!value || 'パスワードを入力してください。']\"\r\n                                    @click:append=\"twitter_password_showing = !twitter_password_showing\">\r\n                                </v-text-field>\r\n                            </v-form>\r\n                        </v-card-text>\r\n                        <v-card-actions class=\"pt-0 px-6 pb-5\">\r\n                            <v-spacer></v-spacer>\r\n                            <v-btn color=\"text\" height=\"40\" text @click=\"twitter_password_auth_dialog = false\">キャンセル</v-btn>\r\n                            <v-btn color=\"secondary\" height=\"40\" class=\"px-4\" @click=\"loginTwitterAccountWithPassword()\">ログイン</v-btn>\r\n                        </v-card-actions>\r\n                    </v-card>\r\n                </v-dialog>\r\n            </div>\r\n            <div class=\"settings__item settings__item--switch\">\r\n                <label class=\"settings__item-heading\" for=\"fold_panel_after_sending_tweet\">ツイート送信後にパネルを折りたたむ</label>\r\n                <label class=\"settings__item-label\" for=\"fold_panel_after_sending_tweet\">\r\n                    この設定をオンにすると、ツイートを送信した後に、パネルが自動で折りたたまれます。<br>\r\n                    ツイートするとき以外はできるだけ映像を大きくして見たい方におすすめです。<br>\r\n                </label>\r\n                <v-switch class=\"settings__item-switch\" id=\"fold_panel_after_sending_tweet\" inset hide-details\r\n                    v-model=\"settingsStore.settings.fold_panel_after_sending_tweet\">\r\n                </v-switch>\r\n            </div>\r\n            <div class=\"settings__item settings__item--switch\">\r\n                <label class=\"settings__item-heading\" for=\"reset_hashtag_when_program_switches\">番組が切り替わったときにハッシュタグフォームをリセットする</label>\r\n                <label class=\"settings__item-label\" for=\"reset_hashtag_when_program_switches\">\r\n                    チャンネルを切り替えたときや、視聴中の番組が終了し次の番組の放送が開始されたときに、ハッシュタグフォームをリセットするかを設定します。<br>\r\n                    この設定をオンにしておけば、「誤って前番組のハッシュタグをつけたまま次番組の実況ツイートをしてしまう」といったミスを回避できます。<br>\r\n                </label>\r\n                <v-switch class=\"settings__item-switch\" id=\"reset_hashtag_when_program_switches\" inset hide-details\r\n                    v-model=\"settingsStore.settings.reset_hashtag_when_program_switches\">\r\n                </v-switch>\r\n            </div>\r\n            <div class=\"settings__item settings__item--switch\">\r\n                <label class=\"settings__item-heading\" for=\"auto_add_watching_channel_hashtag\">視聴中のチャンネルに対応する局タグを自動で追加する</label>\r\n                <label class=\"settings__item-label\" for=\"auto_add_watching_channel_hashtag\">\r\n                    この設定をオンにすると、視聴中のチャンネルに対応する局タグ (#nhk, #tokyomx など) がハッシュタグフォームに自動で追加されます。<br>\r\n                    現時点で、局タグは三大首都圏の地上波・BS の一部チャンネル・AT-X にのみ対応しています。<br>\r\n                    なお、ビデオをみるときは視聴中のチャンネルに対応する局タグは追加されません。<br>\r\n                </label>\r\n                <v-switch class=\"settings__item-switch\" id=\"auto_add_watching_channel_hashtag\" inset hide-details\r\n                    v-model=\"settingsStore.settings.auto_add_watching_channel_hashtag\">\r\n                </v-switch>\r\n            </div>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">デフォルトで表示される Twitter タブ内のタブ</div>\r\n                <div class=\"settings__item-label\">\r\n                    視聴画面を開いたときに、パネルの Twitter タブの中で最初に表示されるタブを設定します。<br>\r\n                </div>\r\n                <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\"\r\n                    :items=\"twitter_active_tab\" v-model=\"settingsStore.settings.twitter_active_tab\">\r\n                </v-select>\r\n            </div>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">ツイートにつけるハッシュタグの位置</div>\r\n                <div class=\"settings__item-label\">\r\n                    ツイート本文から見て、ハッシュタグをどの位置につけてツイートするかを設定します。<br>\r\n                </div>\r\n                <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\"\r\n                    :items=\"tweet_hashtag_position\" v-model=\"settingsStore.settings.tweet_hashtag_position\">\r\n                </v-select>\r\n            </div>\r\n            <div class=\"settings__item\">\r\n                <div class=\"settings__item-heading\">ツイートするキャプチャに番組タイトルの透かしを描画する</div>\r\n                <div class=\"settings__item-label\">\r\n                    ツイートするキャプチャに、透かしとして視聴中の番組タイトルを描画するかを設定します。<br>\r\n                    透かしの描画位置は 左上・右上・左下・右下 から選択できます。<br>\r\n                </div>\r\n                <v-select class=\"settings__item-form\" outlined hide-details :dense=\"is_form_dense\"\r\n                    :items=\"tweet_capture_watermark_position\" v-model=\"settingsStore.settings.tweet_capture_watermark_position\">\r\n                </v-select>\r\n            </div>\r\n        </div>\r\n        <v-overlay :value=\"is_twitter_password_auth_sending\" z-index=\"300\">\r\n            <v-progress-circular color=\"secondary\" indeterminate size=\"64\" />\r\n        </v-overlay>\r\n    </SettingsBase>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport Message from '@/message';\r\nimport Twitter from '@/services/Twitter';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport useUserStore from '@/stores/UserStore';\r\nimport Utils from '@/utils';\r\nimport SettingsBase from '@/views/Settings/Base.vue';\r\n\r\nexport default defineComponent({\r\n    name: 'Settings-Twitter',\r\n    components: {\r\n        SettingsBase,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // フォームを小さくするかどうか\r\n            is_form_dense: Utils.isSmartphoneHorizontal(),\r\n\r\n            // デフォルトで表示されるパネルのタブの選択肢\r\n            twitter_active_tab: [\r\n                {text: 'ツイート検索タブ', value: 'Search'},\r\n                {text: 'タイムラインタブ', value: 'Timeline'},\r\n                {text: 'キャプチャタブ', value: 'Capture'},\r\n            ],\r\n\r\n            // ツイートにつけるハッシュタグの位置の選択肢\r\n            tweet_hashtag_position: [\r\n                {text: 'ツイート本文の前に追加する', value: 'Prepend'},\r\n                {text: 'ツイート本文の後に追加する', value: 'Append'},\r\n                {text: 'ツイート本文の前に追加してから改行する', value: 'PrependWithLineBreak'},\r\n                {text: 'ツイート本文の後に改行してから追加する', value: 'AppendWithLineBreak'},\r\n            ],\r\n\r\n            // ツイートするキャプチャに番組タイトルの透かしを描画する位置の選択肢\r\n            tweet_capture_watermark_position: [\r\n                {text: '透かしを描画しない', value: 'None'},\r\n                {text: '透かしをキャプチャの左上に描画する', value: 'TopLeft'},\r\n                {text: '透かしをキャプチャの右上に描画する', value: 'TopRight'},\r\n                {text: '透かしをキャプチャの左下に描画する', value: 'BottomLeft'},\r\n                {text: '透かしをキャプチャの右下に描画する', value: 'BottomRight'},\r\n            ],\r\n\r\n            // ローディング中かどうか\r\n            is_loading: true,\r\n\r\n            // パスワード認証実行中かどうか\r\n            is_twitter_password_auth_sending: false,\r\n\r\n            // パスワード認証用ダイヤログ\r\n            twitter_password_auth_dialog: false,\r\n\r\n            // Twitter のスクリーンネームとパスワード\r\n            twitter_screen_name: '',\r\n            twitter_password: '',\r\n            twitter_password_showing: false,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useSettingsStore, useUserStore),\r\n    },\r\n    async created() {\r\n\r\n        // アカウント情報を更新\r\n        await this.userStore.fetchUser();\r\n\r\n        // ローディング状態を解除\r\n        this.is_loading = false;\r\n    },\r\n    methods: {\r\n        async loginTwitterAccountWithPasswordForm() {\r\n            // ログインしていない場合はエラーにする\r\n            if (this.userStore.is_logged_in === false) {\r\n                Message.warning('連携をはじめるには、KonomiTV アカウントにログインしてください。');\r\n                await Utils.sleep(0.01);\r\n                this.twitter_password_auth_dialog = false;\r\n                return;\r\n            }\r\n            this.twitter_password_auth_dialog = true;\r\n        },\r\n\r\n        async loginTwitterAccountWithPassword() {\r\n\r\n            // バリデーションを実行\r\n            if ((this.$refs.twitter_form as any).validate() === false) {\r\n                return;\r\n            }\r\n\r\n            // Twitter パスワード認証 API にリクエスト\r\n            this.is_twitter_password_auth_sending = true;\r\n            const result = await Twitter.authWithPassword({\r\n                screen_name: this.twitter_screen_name,\r\n                password: this.twitter_password,\r\n            });\r\n            this.is_twitter_password_auth_sending = false;\r\n            if (result === false) {\r\n                return;\r\n            }\r\n\r\n            // アカウント情報を強制的に更新\r\n            await this.userStore.fetchUser(true);\r\n            if (this.userStore.user === null) {\r\n                Message.error('アカウント情報を取得できませんでした。');\r\n                return;\r\n            }\r\n\r\n            // ログイン中のユーザーに紐づく Twitter アカウントのうち、一番 updated_at が新しいものを取得\r\n            // ログインすると updated_at が更新されるため、この時点で一番 updated_at が新しいアカウントが今回連携したものだと判断できる\r\n            // ref: https://stackoverflow.com/a/12192544/17124142 (ISO8601 のソートアルゴリズム)\r\n            const current_twitter_account = [...this.userStore.user.twitter_accounts].sort((a, b) => {\r\n                return (a.updated_at < b.updated_at) ? 1 : ((a.updated_at > b.updated_at) ? -1 : 0);\r\n            })[0];\r\n\r\n            Message.success(`Twitter @${current_twitter_account.screen_name} と連携しました。`);\r\n\r\n            // フォームをリセットし、非表示にする\r\n            (this.$refs.twitter_form as any).reset();\r\n            this.twitter_password_auth_dialog = false;\r\n        },\r\n\r\n        async logoutTwitterAccount(screen_name: string) {\r\n\r\n            // Twitter アカウント連携解除 API にリクエスト\r\n            const result = await Twitter.logoutAccount(screen_name);\r\n            if (result === false) {\r\n                return;\r\n            }\r\n\r\n            // アカウント情報を強制的に更新\r\n            await this.userStore.fetchUser(true);\r\n\r\n            Message.success(`Twitter @${screen_name} との連携を解除しました。`);\r\n        },\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.settings__content {\r\n    opacity: 1;\r\n    transition: opacity 0.4s;\r\n\r\n    &--loading {\r\n        opacity: 0;\r\n    }\r\n}\r\n\r\n.twitter-accounts {\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 20px 20px;\r\n    border-radius: 15px;\r\n    background: var(--v-background-lighten2);\r\n    @include smartphone-horizontal {\r\n        padding: 16px 20px;\r\n        border-radius: 10px;\r\n    }\r\n    @include smartphone-vertical {\r\n        padding: 16px 12px;\r\n        border-radius: 10px;\r\n    }\r\n\r\n    &__heading {\r\n        display: flex;\r\n        align-items: center;\r\n        font-size: 18px;\r\n        font-weight: bold;\r\n    }\r\n\r\n    &__guide {\r\n        display: flex;\r\n        align-items: center;\r\n\r\n        .text-h6 {\r\n            @include tablet-vertical {\r\n                font-size: 19px !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                font-size: 17px !important;\r\n            }\r\n        }\r\n\r\n        svg {\r\n            @include smartphone-horizontal-short {\r\n                display: none;\r\n            }\r\n            @include smartphone-vertical {\r\n                display: none;\r\n            }\r\n        }\r\n        svg + div {\r\n            @include smartphone-horizontal-short {\r\n                margin-left: 0px !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                margin-left: 0px !important;\r\n            }\r\n        }\r\n    }\r\n\r\n    .twitter-account {\r\n        display: flex;\r\n        align-items: center;\r\n        margin-top: 20px;\r\n        @include smartphone-horizontal {\r\n            margin-top: 16px;\r\n        }\r\n\r\n        &__icon {\r\n            flex-shrink: 0;\r\n            width: 70px;\r\n            height: 70px;\r\n            margin-right: 16px;\r\n            border-radius: 50%;\r\n            object-fit: cover;\r\n            // 読み込まれるまでのアイコンの背景\r\n            background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n            // 低解像度で表示する画像がぼやけないようにする\r\n            // ref: https://sho-log.com/chrome-image-blurred/\r\n            image-rendering: -webkit-optimize-contrast;\r\n            @include smartphone-horizontal {\r\n                width: 52px;\r\n                height: 52px;\r\n            }\r\n            @include smartphone-vertical {\r\n                width: 48px;\r\n                height: 48px;\r\n                margin-right: 10px;\r\n            }\r\n        }\r\n\r\n        &__info {\r\n            display: flex;\r\n            flex-direction: column;\r\n            min-width: 0;\r\n            margin-right: 16px;\r\n            @include smartphone-vertical {\r\n                margin-right: 10px;\r\n            }\r\n\r\n            &-name {\r\n                display: inline-flex;\r\n                align-items: center;\r\n\r\n                &-text {\r\n                    display: inline-block;\r\n                    color: var(--v-text-base);\r\n                    font-size: 20px;\r\n                    font-weight: bold;\r\n                    overflow: hidden;\r\n                    white-space: nowrap;\r\n                    text-overflow: ellipsis;  // はみ出た部分を … で省略\r\n                    @include smartphone-horizontal {\r\n                        font-size: 18px;\r\n                    }\r\n                    @include smartphone-vertical {\r\n                        font-size: 16px;\r\n                    }\r\n                }\r\n            }\r\n\r\n            &-screen-name {\r\n                display: inline-block;\r\n                color: var(--v-text-darken1);\r\n                font-size: 16px;\r\n                @include smartphone-horizontal {\r\n                    font-size: 14px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    font-size: 13.5px;\r\n                }\r\n            }\r\n        }\r\n\r\n        &__login {\r\n            margin-top: 20px;\r\n            margin-left: auto;\r\n            margin-right: auto;\r\n            border-radius: 7px;\r\n            font-size: 15px;\r\n            letter-spacing: 0;\r\n            @include tablet-vertical {\r\n                height: 42px !important;\r\n                font-size: 14.5px;\r\n            }\r\n            @include smartphone-horizontal {\r\n                height: 42px !important;\r\n                font-size: 14.5px;\r\n            }\r\n            @include smartphone-vertical {\r\n                height: 42px !important;\r\n                font-size: 14.5px;\r\n            }\r\n        }\r\n\r\n        &__logout {\r\n            background: var(--v-gray-base);\r\n            border-radius: 7px;\r\n            font-size: 15px;\r\n            letter-spacing: 0;\r\n            @include smartphone-horizontal {\r\n                width: 116px !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                width: 100px !important;\r\n                height: 48px !important;\r\n                border-radius: 5px;\r\n                font-size: 14px;\r\n                svg {\r\n                    width: 20px;\r\n                    margin-right: 4px !important;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Twitter.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Twitter.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Twitter.vue?vue&type=template&id=4ae5ee08&scoped=true\"\nimport script from \"./Twitter.vue?vue&type=script&lang=ts\"\nexport * from \"./Twitter.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Twitter.vue?vue&type=style&index=0&id=4ae5ee08&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4ae5ee08\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"route-container\"},[_c('Header'),_c('main',[_c('Navigation'),_c('div',{staticClass:\"channels-container channels-container--home\",class:{'channels-container--loading': _vm.is_loading}},[_c('v-tabs-fix',{staticClass:\"channels-tab\",attrs:{\"centered\":\"\"},model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},_vm._l((Array.from(_vm.channelsStore.channels_list_with_pinned)),function([channels_type,]){return _c('v-tab',{key:channels_type,staticClass:\"channels-tab__item\"},[_vm._v(\" \"+_vm._s(channels_type)+\" \")])}),1),_c('v-tabs-items-fix',{staticClass:\"channels-list\",model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},_vm._l((Array.from(_vm.channelsStore.channels_list_with_pinned)),function([channels_type, channels]){return _c('v-tab-item-fix',{key:channels_type,staticClass:\"channels-tabitem\"},[_c('div',{staticClass:\"channels\",class:`channels--tab-${channels_type} channels--length-${channels.length}`},[_vm._l((channels),function(channel){return _c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],key:channel.id,staticClass:\"channel\",attrs:{\"to\":`/tv/watch/${channel.display_channel_id}`}},[_c('div',{staticClass:\"channel__broadcaster\"},[_c('img',{staticClass:\"channel__broadcaster-icon\",attrs:{\"src\":`${_vm.Utils.api_base_url}/channels/${channel.id}/logo`}}),_c('div',{staticClass:\"channel__broadcaster-content\"},[_c('span',{staticClass:\"channel__broadcaster-name\"},[_vm._v(\"Ch: \"+_vm._s(channel.channel_number)+\" \"+_vm._s(channel.name))]),_c('div',{staticClass:\"channel__broadcaster-status\"},[_c('div',{staticClass:\"channel__broadcaster-status-force\",class:`channel__broadcaster-status-force--${_vm.ChannelUtils.getChannelForceType(channel.jikkyo_force)}`},[_c('svg',{staticClass:\"iconify iconify--fa-solid\",attrs:{\"width\":\"10.5px\",\"height\":\"12px\",\"viewBox\":\"0 0 448 512\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M323.56 51.2c-20.8 19.3-39.58 39.59-56.22 59.97C240.08 73.62 206.28 35.53 168 0C69.74 91.17 0 209.96 0 281.6C0 408.85 100.29 512 224 512s224-103.15 224-230.4c0-53.27-51.98-163.14-124.44-230.4zm-19.47 340.65C282.43 407.01 255.72 416 226.86 416C154.71 416 96 368.26 96 290.75c0-38.61 24.31-72.63 72.79-130.75c6.93 7.98 98.83 125.34 98.83 125.34l58.63-66.88c4.14 6.85 7.91 13.55 11.27 19.97c27.35 52.19 15.81 118.97-33.43 153.42z\"}})]),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"勢い:\")]),_c('span',{staticClass:\"ml-1\"},[_vm._v(_vm._s(channel.jikkyo_force ?? '--'))]),_c('span',{staticStyle:{\"margin-left\":\"3px\"}},[_vm._v(\" コメ/分\")])]),_c('div',{staticClass:\"channel__broadcaster-status-viewers ml-4\"},[_c('svg',{staticClass:\"iconify iconify--fa-solid\",attrs:{\"width\":\"15.75px\",\"height\":\"14px\",\"viewBox\":\"0 0 576 512\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144a143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79a47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z\"}})]),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"視聴数:\")]),_c('span',{staticClass:\"ml-1\"},[_vm._v(_vm._s(channel.viewer_count))])])])]),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"},{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.isPinnedChannel(channel) ? 'ピン留めを外す' : 'ピン留めする'),expression:\"isPinnedChannel(channel) ? 'ピン留めを外す' : 'ピン留めする'\"}],staticClass:\"channel__broadcaster-pin\",class:{'channel__broadcaster-pin--pinned': _vm.isPinnedChannel(channel)},on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();_vm.isPinnedChannel(channel) ? _vm.removePinnedChannel(channel) : _vm.addPinnedChannel(channel)},\"mousedown\":function($event){$event.preventDefault();$event.stopPropagation();/* 親要素の波紋が広がらないように */}}},[_c('svg',{staticClass:\"iconify iconify--fluent\",attrs:{\"width\":\"24px\",\"height\":\"24px\",\"viewBox\":\"0 0 20 20\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M13.325 2.617a2 2 0 0 0-3.203.52l-1.73 3.459a1.5 1.5 0 0 1-.784.721l-3.59 1.436a1 1 0 0 0-.335 1.636L6.293 13L3 16.292V17h.707L7 13.706l2.61 2.61a1 1 0 0 0 1.636-.335l1.436-3.59a1.5 1.5 0 0 1 .722-.784l3.458-1.73a2 2 0 0 0 .52-3.203l-4.057-4.057Z\"}})])])]),_c('div',{staticClass:\"channel__program-present\"},[_c('div',{staticClass:\"channel__program-present-title-wrapper\"},[_c('span',{staticClass:\"channel__program-present-title\",domProps:{\"innerHTML\":_vm._s(_vm.ProgramUtils.decorateProgramInfo(channel.program_present, 'title'))}}),_c('span',{staticClass:\"channel__program-present-time\"},[_vm._v(_vm._s(_vm.ProgramUtils.getProgramTime(channel.program_present)))])]),_c('span',{staticClass:\"channel__program-present-description\",domProps:{\"innerHTML\":_vm._s(_vm.ProgramUtils.decorateProgramInfo(channel.program_present, 'description'))}})]),_c('v-spacer'),_c('div',{staticClass:\"channel__program-following\"},[_c('div',{staticClass:\"channel__program-following-title\"},[_c('span',{staticClass:\"channel__program-following-title-decorate\"},[_vm._v(\"NEXT\")]),_c('svg',{staticClass:\"channel__program-following-title-icon iconify iconify--fluent\",attrs:{\"width\":\"16px\",\"height\":\"16px\",\"viewBox\":\"0 0 20 20\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M10.018 5.486a1 1 0 0 1 1.592-.806l5.88 4.311a1.25 1.25 0 0 1 0 2.017l-5.88 4.311a1 1 0 0 1-1.592-.806v-3.16L4.61 15.319a1 1 0 0 1-1.592-.806V5.486A1 1 0 0 1 4.61 4.68l5.408 3.966v-3.16Z\"}})]),_c('span',{staticClass:\"channel__program-following-title-text\",domProps:{\"innerHTML\":_vm._s(_vm.ProgramUtils.decorateProgramInfo(channel.program_following, 'title'))}})]),_c('span',{staticClass:\"channel__program-following-time\"},[_vm._v(_vm._s(_vm.ProgramUtils.getProgramTime(channel.program_following)))])]),_c('div',{staticClass:\"channel__progressbar\"},[_c('div',{staticClass:\"channel__progressbar-progress\",style:(`width:${_vm.ProgramUtils.getProgramProgress(channel.program_present)}%;`)})])],1)}),(channels_type === 'ピン留め' && channels.length === 0)?_c('div',{staticClass:\"pinned-container d-flex justify-center align-center w-100\"},[_c('div',{staticClass:\"d-flex justify-center align-center flex-column\"},[_c('h2',[_vm._v(\"ピン留めされているチャンネルが\"),_c('br'),_vm._v(\"ありません。\")]),_c('div',{staticClass:\"mt-4 text--text text--darken-1\"},[_vm._v(\"各チャンネルの \"),_c('Icon',{staticStyle:{\"position\":\"relative\",\"bottom\":\"-5px\"},attrs:{\"icon\":\"fluent:pin-20-filled\",\"width\":\"22px\"}}),_vm._v(\" アイコンから、よくみる\"),_c('br'),_vm._v(\"チャンネルをこのタブにピン留めできます。\")],1),_c('div',{staticClass:\"mt-2 text--text text--darken-1\"},[_vm._v(\"チャンネルをピン留めすると、\"),_c('br'),_vm._v(\"このタブが最初に表示されます。\")])])]):_vm._e()],2)])}),1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"route-container\">\r\n        <Header/>\r\n        <main>\r\n            <Navigation/>\r\n            <div class=\"channels-container channels-container--home\" :class=\"{'channels-container--loading': is_loading}\">\r\n                <v-tabs-fix centered class=\"channels-tab\" v-model=\"tab\">\r\n                    <v-tab class=\"channels-tab__item\"\r\n                        v-for=\"[channels_type,] in Array.from(channelsStore.channels_list_with_pinned)\" :key=\"channels_type\">\r\n                        {{channels_type}}\r\n                    </v-tab>\r\n                </v-tabs-fix>\r\n                <v-tabs-items-fix class=\"channels-list\" v-model=\"tab\">\r\n                    <v-tab-item-fix class=\"channels-tabitem\"\r\n                        v-for=\"[channels_type, channels] in Array.from(channelsStore.channels_list_with_pinned)\" :key=\"channels_type\">\r\n                        <div class=\"channels\" :class=\"`channels--tab-${channels_type} channels--length-${channels.length}`\">\r\n                            <router-link v-ripple class=\"channel\"\r\n                                v-for=\"channel in channels\" :key=\"channel.id\" :to=\"`/tv/watch/${channel.display_channel_id}`\">\r\n                                <!-- 以下では Icon コンポーネントを使うとチャンネルが多いときに高負荷になるため、意図的に SVG を直書きしている -->\r\n                                <div class=\"channel__broadcaster\">\r\n                                    <img class=\"channel__broadcaster-icon\" :src=\"`${Utils.api_base_url}/channels/${channel.id}/logo`\">\r\n                                    <div class=\"channel__broadcaster-content\">\r\n                                        <span class=\"channel__broadcaster-name\">Ch: {{channel.channel_number}} {{channel.name}}</span>\r\n                                        <div class=\"channel__broadcaster-status\">\r\n                                            <div class=\"channel__broadcaster-status-force\"\r\n                                                :class=\"`channel__broadcaster-status-force--${ChannelUtils.getChannelForceType(channel.jikkyo_force)}`\">\r\n                                                <svg class=\"iconify iconify--fa-solid\" width=\"10.5px\" height=\"12px\" viewBox=\"0 0 448 512\">\r\n                                                    <path fill=\"currentColor\" d=\"M323.56 51.2c-20.8 19.3-39.58 39.59-56.22 59.97C240.08 73.62 206.28 35.53 168 0C69.74 91.17 0 209.96 0 281.6C0 408.85 100.29 512 224 512s224-103.15 224-230.4c0-53.27-51.98-163.14-124.44-230.4zm-19.47 340.65C282.43 407.01 255.72 416 226.86 416C154.71 416 96 368.26 96 290.75c0-38.61 24.31-72.63 72.79-130.75c6.93 7.98 98.83 125.34 98.83 125.34l58.63-66.88c4.14 6.85 7.91 13.55 11.27 19.97c27.35 52.19 15.81 118.97-33.43 153.42z\"></path>\r\n                                                </svg>\r\n                                                <span class=\"ml-1\">勢い:</span>\r\n                                                <span class=\"ml-1\">{{channel.jikkyo_force ?? '--'}}</span>\r\n                                                <span style=\"margin-left: 3px;\"> コメ/分</span>\r\n                                            </div>\r\n                                            <div class=\"channel__broadcaster-status-viewers ml-4\">\r\n                                                <svg class=\"iconify iconify--fa-solid\" width=\"15.75px\" height=\"14px\" viewBox=\"0 0 576 512\">\r\n                                                    <path fill=\"currentColor\" d=\"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144a143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79a47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z\"></path>\r\n                                                </svg>\r\n                                                <span class=\"ml-1\">視聴数:</span>\r\n                                                <span class=\"ml-1\">{{channel.viewer_count}}</span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div v-ripple class=\"channel__broadcaster-pin\"\r\n                                        v-tooltip=\"isPinnedChannel(channel) ? 'ピン留めを外す' : 'ピン留めする'\"\r\n                                        :class=\"{'channel__broadcaster-pin--pinned': isPinnedChannel(channel)}\"\r\n                                        @click.prevent.stop=\"isPinnedChannel(channel) ? removePinnedChannel(channel) : addPinnedChannel(channel)\"\r\n                                        @mousedown.prevent.stop=\"/* 親要素の波紋が広がらないように */\">\r\n                                        <svg class=\"iconify iconify--fluent\" width=\"24px\" height=\"24px\" viewBox=\"0 0 20 20\">\r\n                                            <path fill=\"currentColor\" d=\"M13.325 2.617a2 2 0 0 0-3.203.52l-1.73 3.459a1.5 1.5 0 0 1-.784.721l-3.59 1.436a1 1 0 0 0-.335 1.636L6.293 13L3 16.292V17h.707L7 13.706l2.61 2.61a1 1 0 0 0 1.636-.335l1.436-3.59a1.5 1.5 0 0 1 .722-.784l3.458-1.73a2 2 0 0 0 .52-3.203l-4.057-4.057Z\"></path>\r\n                                        </svg>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"channel__program-present\">\r\n                                    <div class=\"channel__program-present-title-wrapper\">\r\n                                        <span class=\"channel__program-present-title\"\r\n                                            v-html=\"ProgramUtils.decorateProgramInfo(channel.program_present, 'title')\"></span>\r\n                                        <span class=\"channel__program-present-time\">{{ProgramUtils.getProgramTime(channel.program_present)}}</span>\r\n                                    </div>\r\n                                    <span class=\"channel__program-present-description\"\r\n                                          v-html=\"ProgramUtils.decorateProgramInfo(channel.program_present, 'description')\"></span>\r\n                                </div>\r\n                                <v-spacer></v-spacer>\r\n                                <div class=\"channel__program-following\">\r\n                                    <div class=\"channel__program-following-title\">\r\n                                        <span class=\"channel__program-following-title-decorate\">NEXT</span>\r\n                                        <svg class=\"channel__program-following-title-icon iconify iconify--fluent\" width=\"16px\" height=\"16px\" viewBox=\"0 0 20 20\">\r\n                                            <path fill=\"currentColor\" d=\"M10.018 5.486a1 1 0 0 1 1.592-.806l5.88 4.311a1.25 1.25 0 0 1 0 2.017l-5.88 4.311a1 1 0 0 1-1.592-.806v-3.16L4.61 15.319a1 1 0 0 1-1.592-.806V5.486A1 1 0 0 1 4.61 4.68l5.408 3.966v-3.16Z\"></path>\r\n                                        </svg>\r\n                                        <span class=\"channel__program-following-title-text\"\r\n                                              v-html=\"ProgramUtils.decorateProgramInfo(channel.program_following, 'title')\"></span>\r\n                                    </div>\r\n                                    <span class=\"channel__program-following-time\">{{ProgramUtils.getProgramTime(channel.program_following)}}</span>\r\n                                </div>\r\n                                <div class=\"channel__progressbar\">\r\n                                    <div class=\"channel__progressbar-progress\"\r\n                                         :style=\"`width:${ProgramUtils.getProgramProgress(channel.program_present)}%;`\"></div>\r\n                                </div>\r\n                            </router-link>\r\n                            <div class=\"pinned-container d-flex justify-center align-center w-100\"\r\n                                v-if=\"channels_type === 'ピン留め' && channels.length === 0\">\r\n                                <div class=\"d-flex justify-center align-center flex-column\">\r\n                                    <h2>ピン留めされているチャンネルが<br>ありません。</h2>\r\n                                    <div class=\"mt-4 text--text text--darken-1\">各チャンネルの <Icon style=\"position: relative; bottom: -5px;\" icon=\"fluent:pin-20-filled\" width=\"22px\" /> アイコンから、よくみる<br>チャンネルをこのタブにピン留めできます。</div>\r\n                                    <div class=\"mt-2 text--text text--darken-1\">チャンネルをピン留めすると、<br>このタブが最初に表示されます。</div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </v-tab-item-fix>\r\n                </v-tabs-items-fix>\r\n            </div>\r\n        </main>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport Header from '@/components/Header.vue';\r\nimport Navigation from '@/components/Navigation.vue';\r\nimport Message from '@/message';\r\nimport { ILiveChannel } from '@/services/Channels';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils, { ChannelUtils, ProgramUtils } from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'TV-Home',\r\n    components: {\r\n        Header,\r\n        Navigation,\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n            ChannelUtils: Object.freeze(ChannelUtils),\r\n            ProgramUtils: Object.freeze(ProgramUtils),\r\n\r\n            // タブの状態管理\r\n            tab: null as number | null,\r\n\r\n            // ローディング中かどうか\r\n            is_loading: true,\r\n\r\n            // インターバル ID\r\n            // ページ遷移時に setInterval(), setTimeout() の実行を止めるのに使う\r\n            // setInterval(), setTimeout() の返り値を登録する\r\n            interval_ids: [] as number[],\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useChannelsStore, useSettingsStore),\r\n    },\r\n    // 開始時に実行\r\n    async created() {\r\n\r\n        // ピン留めされているチャンネルがないなら、タブを地デジタブに切り替える\r\n        // ピン留めができる事を示唆するためにピン留めタブ自体は残す\r\n        if (this.settingsStore.settings.pinned_channel_ids.length === 0) {\r\n            this.tab = 1;\r\n        }\r\n\r\n        // 00秒までの残り秒数を取得\r\n        // 現在 16:01:34 なら 26 (秒) になる\r\n        const residue_second = 60 - new Date().getSeconds();\r\n\r\n        // 00秒になるまで待ってから実行するタイマー\r\n        // 番組は基本1分単位で組まれているため、20秒や45秒など中途半端な秒数で更新してしまうと番組情報の反映が遅れてしまう\r\n        this.interval_ids.push(window.setTimeout(() => {\r\n\r\n            // この時点で00秒なので、チャンネル情報を更新\r\n            this.channelsStore.update(true);\r\n\r\n            // 以降、30秒おきにチャンネル情報を更新\r\n            this.interval_ids.push(window.setInterval(() => this.channelsStore.update(true), 30 * 1000));\r\n\r\n        }, residue_second * 1000));\r\n\r\n        // チャンネル情報を更新 (初回)\r\n        await this.channelsStore.update();\r\n\r\n        // 少しだけ待つ\r\n        // v-tabs-slider-wrapper をアニメーションさせないために必要\r\n        await Utils.sleep(0.01);\r\n\r\n        // この時点でピン留めされているチャンネルがないなら、タブを地デジタブに切り替える\r\n        // ピン留めされているチャンネル自体はあるが、現在放送されていないため表示できない場合に備える\r\n        if (this.channelsStore.channels_list_with_pinned.get('ピン留め')?.length === 0) {\r\n            this.tab = 1;\r\n        }\r\n\r\n        // チャンネル情報の更新が終わったタイミングでローディング状態を解除する\r\n        this.is_loading = false;\r\n    },\r\n    // 終了前に実行\r\n    beforeDestroy() {\r\n\r\n        // clearInterval() ですべての setInterval(), setTimeout() の実行を止める\r\n        // clearInterval() と clearTimeout() は中身共通なので問題ない\r\n        for (const interval_id of this.interval_ids) {\r\n            window.clearInterval(interval_id);\r\n        }\r\n    },\r\n    methods: {\r\n\r\n        // チャンネルをピン留めする\r\n        addPinnedChannel(channel: ILiveChannel) {\r\n\r\n            // ピン留めするチャンネルの ID リストに追加 (保存は自動で行われる)\r\n            this.settingsStore.settings.pinned_channel_ids.push(channel.id);\r\n\r\n            // ピン留めしたチャンネルを通知\r\n            Message.show(`${channel.name}をピン留めしました。`);\r\n        },\r\n\r\n        // チャンネルをピン留めから外す\r\n        removePinnedChannel(channel: ILiveChannel) {\r\n\r\n            // ピン留めするチャンネルの ID リストから削除 (保存は自動で行われる)\r\n            this.settingsStore.settings.pinned_channel_ids.splice(this.settingsStore.settings.pinned_channel_ids.indexOf(channel.id), 1);\r\n\r\n            // この時点でピン留めされているチャンネルがないなら、タブを地デジタブに切り替える\r\n            if (this.channelsStore.channels_list_with_pinned.get('ピン留め')?.length === 0) {\r\n                this.tab = 1;\r\n            }\r\n\r\n            // ピン留めを外したチャンネルを通知\r\n            Message.show(`${channel.name}のピン留めを外しました。`);\r\n        },\r\n\r\n        // チャンネルがピン留めされているか\r\n        isPinnedChannel(channel: ILiveChannel): boolean {\r\n            return this.settingsStore.settings.pinned_channel_ids.includes(channel.id);\r\n        }\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\">\r\n\r\n// 上書きしたいスタイル\r\n.channels-container.channels-container--home {\r\n    .v-tabs-bar {\r\n        height: 54px;\r\n        // 下線を引く\r\n        background: linear-gradient(to bottom, var(--v-background-base) calc(100% - 3px), var(--v-background-lighten1) 3px);\r\n        @include smartphone-horizontal {\r\n            height: 46px;\r\n        }\r\n    }\r\n    .v-tabs-slider-wrapper {\r\n        height: 3px !important;\r\n        transition: left 0.3s cubic-bezier(0.25, 0.8, 0.5, 1);\r\n    }\r\n\r\n    .v-window__container {\r\n        // 1px はスクロールバーを表示させるためのもの\r\n        min-height: calc(100vh - 65px - 116px + 1px);\r\n        min-height: calc(100dvh - 65px - 116px + 1px);\r\n        // タッチデバイスではスクロールバーを気にする必要がないので無効化\r\n        @media (hover: none) {\r\n            min-height: auto;\r\n        }\r\n    }\r\n}\r\n.channels-container.channels-container--home.channels-container--loading {\r\n    .v-tabs-slider-wrapper {\r\n        transition: none !important;\r\n    }\r\n}\r\n\r\n</style>\r\n<style lang=\"scss\" scoped>\r\n\r\n.channels-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n    width: 100%;\r\n    margin-left: 21px;\r\n    margin-right: 21px;\r\n    opacity: 1;\r\n    transition: opacity 0.2s;\r\n    @include smartphone-vertical {\r\n        margin-left: 0px;\r\n        margin-right: 0px;\r\n    }\r\n\r\n    &--loading {\r\n        opacity: 0;\r\n    }\r\n\r\n    .channels-tab {\r\n        position: sticky;\r\n        flex: none;\r\n        top: 65px;  // ヘッダーの高さ分\r\n        padding-top: 2px;\r\n        padding-bottom: 12px;\r\n        background:var(--v-background-base);\r\n        z-index: 1;\r\n        @include smartphone-horizontal {\r\n            top: 0px;\r\n            padding-top: 0px;\r\n            padding-bottom: 8px;\r\n        }\r\n        @include smartphone-vertical {\r\n            top: 0px;\r\n            padding-top: 0px;\r\n            padding-bottom: 10px;\r\n        }\r\n\r\n        .channels-tab__item {\r\n            width: 98px;\r\n            padding: 0;\r\n            color: var(--v-text-base) !important;\r\n            font-size: 16px;\r\n            text-transform: none;\r\n            @include smartphone-horizontal {\r\n                font-size: 15px;\r\n            }\r\n            @include smartphone-vertical {\r\n                width: auto;\r\n                font-size: 15px;\r\n            }\r\n        }\r\n    }\r\n\r\n    .channels-list {\r\n        padding-bottom: 20px;\r\n        background: transparent !important;\r\n        overflow: inherit;\r\n        @include smartphone-horizontal {\r\n            padding-bottom: 12px;\r\n        }\r\n        @include smartphone-vertical {\r\n            padding-left: 8px;\r\n            padding-right: 8px;\r\n            padding-bottom: 12px;\r\n        }\r\n\r\n        .channels {\r\n            display: grid;\r\n            grid-template-columns: repeat(auto-fit, minmax(365px, 1fr));\r\n            grid-row-gap: 12px;\r\n            grid-column-gap: 16px;\r\n            justify-content: center;\r\n            // 背後を通過する別のタブのアニメーションが写らないようにするのに必要\r\n            background: var(--v-background-base);\r\n            // will-change を入れておく事で、アニメーションが GPU で処理される\r\n            will-change: transform;\r\n            @include tablet-vertical {\r\n                grid-row-gap: 10px;\r\n                grid-template-columns: 1fr;\r\n            }\r\n            @include smartphone-horizontal {\r\n                grid-row-gap: 8px;\r\n                grid-template-columns: 1fr;\r\n            }\r\n            @include smartphone-vertical {\r\n                grid-row-gap: 10px;\r\n                grid-template-columns: 1fr;\r\n            }\r\n\r\n            // チャンネルリストでの content-visibility: auto; はちょっと描画上の副作用もあるので、\r\n            // パフォーマンス向上が顕著なスマホ・タブレット (タッチデバイス) のみに適用する\r\n            @media (hover: none) {\r\n                content-visibility: auto;\r\n                contain-intrinsic-height: 2000px;  // だいたい 2000px 分の高さを確保\r\n            }\r\n\r\n            // 1630px 以上で幅を 445px に固定\r\n            @media (min-width: 1630px) {\r\n                grid-template-columns: repeat(auto-fit, 445px);\r\n            }\r\n\r\n            // ピン留めされているチャンネルがないとき\r\n            &.channels--length-0.channels--tab-ピン留め {\r\n                display: flex;\r\n                min-height: calc(100vh - 65px - 116px + 1px);\r\n                min-height: calc(100dvh - 65px - 116px + 1px);\r\n                @include smartphone-horizontal {\r\n                    min-height: calc(100vh - 54px - 12px);\r\n                    min-height: calc(100dvh - 54px - 12px);\r\n                }\r\n            }\r\n\r\n            // カードが横いっぱいに表示されてしまうのを回避する\r\n            // チャンネルリストにチャンネルが1つしか表示されていないとき\r\n            &.channels--length-1 {\r\n                // 2列\r\n                @media (min-width: 1008px) {\r\n                    // 16px は余白の幅のこと\r\n                    margin-right: calc((((100% - (16px * 1)) / 2) * 1) + (16px * 1));  // もう1つ分のカード幅を埋める\r\n                }\r\n                // 3列でカード幅が自動\r\n                @media (min-width: 1389px) {\r\n                    margin-right: calc((((100% - (16px * 2)) / 3) * 2) + (16px * 2));  // もう2つ分のカード幅を埋める\r\n                }\r\n                // 3列でカード幅が 445px\r\n                @media (min-width: 1630px) {\r\n                    margin-right: calc((445px * 2) + (16px * 2));  // もう2つ分のカード幅を埋める\r\n                }\r\n                // 4列でカード幅が 445px\r\n                @media (min-width: 2090px) {\r\n                    margin-right: calc((445px * 3) + (16px * 3));  // もう3つ分のカード幅を埋める\r\n                }\r\n            }\r\n            // チャンネルリストにチャンネルが2つしか表示されていないとき\r\n            &.channels--length-2 {\r\n                // 3列でカード幅が自動\r\n                @media (min-width: 1389px) {\r\n                    margin-right: calc((((100% - (16px * 2)) / 3) * 1) + (16px * 1));  // もう1つ分のカード幅を埋める\r\n                }\r\n                // 3列でカード幅が 445px\r\n                @media (min-width: 1630px) {\r\n                    margin-right: calc(445px + 16px);  // もう1つ分のカード幅を埋める\r\n                }\r\n                // 4列でカード幅が 445px\r\n                @media (min-width: 2090px) {\r\n                    margin-right: calc((445px * 2) + (16px * 2));  // もう2つ分のカード幅を埋める\r\n                }\r\n            }\r\n            // チャンネルリストにチャンネルが3つしか表示されていないとき\r\n            &.channels--length-3 {\r\n                // 4列でカード幅が 445px\r\n                @media (min-width: 2090px) {\r\n                    margin-right: calc(445px + 16px);  // もう1つ分のカード幅を埋める\r\n                }\r\n            }\r\n\r\n            .channel {\r\n                display: flex;\r\n                flex-direction: column;\r\n                position: relative;\r\n                height: 270px;\r\n                padding: 18px 20px;\r\n                padding-bottom: 19px;\r\n                border-radius: 14px;\r\n                color: var(--v-text-base);\r\n                background: var(--v-background-lighten1);\r\n                transition: background-color 0.15s;\r\n                overflow: hidden;  // progressbar を切り抜くために必要\r\n                text-decoration: none;\r\n                user-select: none;\r\n                cursor: pointer;\r\n                // content-visibility: auto; を付与するだけでスマホでの描画パフォーマンスが大幅に向上する\r\n                content-visibility: auto;\r\n                contain-intrinsic-height: 233px;\r\n\r\n                // 1列表示\r\n                @media (max-width: 1007.9px) {\r\n                    height: auto;\r\n                }\r\n                @include tablet-vertical {\r\n                    padding: 14px 16px;\r\n                    padding-top: 12px;\r\n                    height: auto;\r\n                    border-radius: 11px;\r\n                    contain-intrinsic-height: 162.25px;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    padding: 12px 14px;\r\n                    padding-top: 10px;\r\n                    height: auto;\r\n                    border-radius: 11px;\r\n                    contain-intrinsic-height: 125px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    padding: 12px 14px;\r\n                    padding-top: 10px;\r\n                    height: auto;\r\n                    border-radius: 11px;\r\n                    contain-intrinsic-height: 162.25px;\r\n                }\r\n\r\n                &:hover {\r\n                    background: var(--v-background-lighten2);\r\n                }\r\n                // タッチデバイスで hover を無効にする\r\n                @media (hover: none) {\r\n                    &:hover {\r\n                        background: var(--v-background-lighten1);\r\n                    }\r\n                }\r\n\r\n                .channel__broadcaster {\r\n                    display: flex;\r\n                    height: 44px;\r\n                    @include tablet-vertical {\r\n                        height: 40px;\r\n                    }\r\n                    @include smartphone-horizontal {\r\n                        height: 29px;\r\n                    }\r\n                    @include smartphone-vertical {\r\n                        height: 40px;\r\n                    }\r\n\r\n                    &-icon {\r\n                        display: inline-block;\r\n                        flex-shrink: 0;\r\n                        width: 80px;\r\n                        height: 44px;\r\n                        border-radius: 5px;\r\n                        // 読み込まれるまでのアイコンの背景\r\n                        background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n                        object-fit: cover;\r\n                        @include tablet-vertical {\r\n                            width: 69px;\r\n                            height: 40px;\r\n                            border-radius: 4px;\r\n                        }\r\n                        @include smartphone-horizontal {\r\n                            width: 54px;\r\n                            height: 29px;\r\n                            border-radius: 4px;\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            width: 69px;\r\n                            height: 40px;\r\n                            border-radius: 4px;\r\n                        }\r\n                    }\r\n\r\n                    &-content {\r\n                        display: flex;\r\n                        flex-direction: column;\r\n                        margin-left: 16px;\r\n                        width: 100%;\r\n                        min-width: 0;\r\n                        @include tablet-vertical {\r\n                            margin-left: 14px;\r\n                        }\r\n                        @include smartphone-horizontal {\r\n                            align-items: center;\r\n                            flex-direction: row;\r\n                            margin-left: 12px;\r\n                            margin-right: 6px;\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            margin-left: 14px;\r\n                        }\r\n                    }\r\n\r\n                    &-name {\r\n                        flex-shrink: 0;\r\n                        font-size: 18px;\r\n                        overflow: hidden;\r\n                        white-space: nowrap;\r\n                        text-overflow: ellipsis;\r\n                        @include tablet-vertical {\r\n                            font-size: 15.5px;\r\n                        }\r\n                        @include smartphone-horizontal {\r\n                            font-size: 15px;\r\n                            margin-right: 8px;\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            font-size: 15.5px;\r\n                        }\r\n                    }\r\n\r\n                    &-status {\r\n                        display: flex;\r\n                        position: relative;\r\n                        top: -1.5px;\r\n                        flex-shrink: 0;\r\n                        align-items: center;\r\n                        margin-top: 2px;\r\n                        font-size: 12px;\r\n                        color: var(--v-text-darken1);\r\n                        @include tablet-vertical {\r\n                            margin-top: 2px;\r\n                            font-size: 11px;\r\n                        }\r\n                        @include smartphone-horizontal {\r\n                            margin-top: 3px;\r\n                            margin-left: auto;\r\n                            font-size: 12px;\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            margin-top: 2px;\r\n                            font-size: 11px;\r\n                        }\r\n\r\n                        &-force, &-viewers {\r\n                            display: flex;\r\n                            align-items: center;\r\n                            @include smartphone-horizontal {\r\n                                span:nth-child(2), span:nth-child(4) {\r\n                                    display: none;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        @include smartphone-horizontal {\r\n                            &-viewers {\r\n                                margin-left: 12px !important;\r\n                            }\r\n                        }\r\n\r\n                        &-force--festival {\r\n                            color: #E7556E;\r\n                        }\r\n                        &-force--so-many {\r\n                            color: #E76B55;\r\n                        }\r\n                        &-force--many {\r\n                            color: #E7A355;\r\n                        }\r\n                    }\r\n\r\n                    &-pin {\r\n                        display: flex;\r\n                        align-items: center;\r\n                        justify-content: center;\r\n                        flex-shrink: 0;\r\n                        position: relative;\r\n                        top: -5px;\r\n                        right: -5px;\r\n                        width: 34px;\r\n                        height: 34px;\r\n                        padding: 4px;\r\n                        color: var(--v-text-darken1);\r\n                        border-radius: 50%;\r\n                        transition: color 0.15s ease, background-color 0.15s ease;\r\n                        user-select: none;\r\n                        @include smartphone-horizontal {\r\n                            top: -1px;\r\n                        }\r\n\r\n                        &:before {\r\n                            content: \"\";\r\n                            position: absolute;\r\n                            top: 0;\r\n                            left: 0;\r\n                            right: 0;\r\n                            bottom: 0;\r\n                            border-radius: inherit;\r\n                            background-color: currentColor;\r\n                            color: inherit;\r\n                            opacity: 0;\r\n                            transition: opacity 0.2s cubic-bezier(0.4, 0, 0.6, 1);\r\n                            pointer-events: none;\r\n                        }\r\n                        &:hover {\r\n                            color: var(--v-text-base);\r\n                            &:before {\r\n                                opacity: 0.15;\r\n                            }\r\n                        }\r\n                        &--pinned {\r\n                            color: var(--v-primary-base);\r\n                            &:hover{\r\n                                color: var(--v-primary-lighten1);\r\n                            }\r\n                            @include smartphone-horizontal {\r\n                                color: var(--v-secondary-lighten2);\r\n                                &:hover{\r\n                                    color: var(--v-secondary-lighten3);\r\n                                }\r\n                            }\r\n                            @include smartphone-vertical {\r\n                                color: var(--v-secondary-lighten2);\r\n                                &:hover{\r\n                                    color: var(--v-secondary-lighten3);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                .channel__program-present {\r\n                    display: flex;\r\n                    flex-direction: column;\r\n\r\n                    &-title-wrapper {\r\n                        margin-top: 14px;\r\n\r\n                        @include tablet-vertical {\r\n                            display: flex;\r\n                            flex-direction: column;\r\n                            margin-top: 8px;\r\n                        }\r\n                        @include smartphone-horizontal {\r\n                            display: flex;\r\n                            align-items: center;\r\n                            margin-top: 8px;\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            display: flex;\r\n                            flex-direction: column;\r\n                            margin-top: 8px;\r\n                        }\r\n                    }\r\n\r\n                    &-title {\r\n                        display: -webkit-box;\r\n                        font-size: 16px;\r\n                        font-weight: 700;\r\n                        font-feature-settings: \"palt\" 1;  // 文字詰め\r\n                        letter-spacing: 0.07em;  // 字間を少し空ける\r\n                        overflow: hidden;\r\n                        -webkit-line-clamp: 2;  // 2行までに制限\r\n                        -webkit-box-orient: vertical;\r\n                        @include tablet-vertical {\r\n                            font-size: 14px;\r\n                        }\r\n                        @include smartphone-horizontal {\r\n                            font-size: 14px;\r\n                            -webkit-line-clamp: 1;  // 1行までに制限\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            font-size: 14px;\r\n                            -webkit-line-clamp: 1;  // 1行までに制限\r\n                        }\r\n                    }\r\n\r\n                    &-time {\r\n                        margin-top: 4px;\r\n                        color: var(--v-text-darken1);\r\n                        font-size: 13.5px;\r\n                        @include tablet-vertical {\r\n                            flex-shrink: 0;\r\n                            margin-top: 2px;\r\n                            font-size: 13px;\r\n                        }\r\n                        @include smartphone-horizontal {\r\n                            flex-shrink: 0;\r\n                            margin-top: 0px;\r\n                            margin-left: auto;\r\n                            padding-left: 10px;\r\n                            font-size: 12px;\r\n                        }\r\n                        @include smartphone-horizontal-short {\r\n                            font-size: 11px;\r\n                            padding-left: 6px;\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            flex-shrink: 0;\r\n                            margin-top: 1px;\r\n                            font-size: 12px;\r\n                        }\r\n                    }\r\n\r\n                    &-description {\r\n                        display: -webkit-box;\r\n                        margin-top: 6px;\r\n                        color: var(--v-text-darken1);\r\n                        font-size: 10.5px;\r\n                        line-height: 175%;\r\n                        overflow-wrap: break-word;\r\n                        font-feature-settings: \"palt\" 1;  // 文字詰め\r\n                        letter-spacing: 0.07em;  // 字間を少し空ける\r\n                        overflow: hidden;\r\n                        -webkit-line-clamp: 3;  // 3行までに制限\r\n                        -webkit-box-orient: vertical;\r\n                        @include tablet-vertical {\r\n                            margin-top: 4px;\r\n                            font-size: 11px;\r\n                            line-height: 155%;\r\n                            -webkit-line-clamp: 2;  // 2行までに制限\r\n                        }\r\n                        @include smartphone-horizontal {\r\n                            margin-top: 3px;\r\n                            font-size: 10px;\r\n                            line-height: 160%;\r\n                            -webkit-line-clamp: 2;  // 2行までに制限\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            margin-top: 4px;\r\n                            font-size: 10px;\r\n                            line-height: 155%;\r\n                            -webkit-line-clamp: 2;  // 2行までに制限\r\n                        }\r\n                    }\r\n                }\r\n\r\n                .channel__program-following {\r\n                    display: flex;\r\n                    flex-direction: column;\r\n                    color: var(--v-text-base);\r\n                    font-size: 12.5px;\r\n                    // 1列表示\r\n                    @media (max-width: 1007.9px) {\r\n                        margin-top: 6px;\r\n                    }\r\n                    @include smartphone-horizontal {\r\n                        flex-direction: row;\r\n                        margin-top: 4px;\r\n                        font-size: 12px;\r\n                    }\r\n                    @include smartphone-vertical {\r\n                        margin-top: 4px;\r\n                        font-size: 12px;\r\n                    }\r\n\r\n                    &-title {\r\n                        display: flex;\r\n                        align-items: center;\r\n                        min-width: 0;  // magic!\r\n\r\n                        &-decorate {\r\n                            flex-shrink: 0;\r\n                            font-weight: bold;\r\n                        }\r\n                        &-icon {\r\n                            flex-shrink: 0;\r\n                            margin-left: 3px;\r\n                        }\r\n                        &-text {\r\n                            margin-left: 2px;\r\n                            white-space: nowrap;\r\n                            text-overflow: ellipsis;  // はみ出た部分を … で省略\r\n                            overflow: hidden;\r\n                        }\r\n                    }\r\n                    &-time {\r\n                        color: var(--v-text-darken1);\r\n                        @include smartphone-horizontal {\r\n                            flex-shrink: 0;\r\n                            margin-left: auto;\r\n                            padding-left: 8px;\r\n                            font-size: 11.5px;\r\n                        }\r\n                        @include smartphone-horizontal-short {\r\n                            font-size: 11px;\r\n                            padding-left: 6px;\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            flex-shrink: 0;\r\n                            font-size: 11.5px;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                .channel__progressbar {\r\n                    position: absolute;\r\n                    left: 0;\r\n                    right: 0;\r\n                    bottom: 0;\r\n                    height: 4px;\r\n                    background: var(--v-gray-base);\r\n\r\n                    &-progress {\r\n                        height: 4px;\r\n                        background: var(--v-primary-base);\r\n                        transition: width 0.3s;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .pinned-container {\r\n        br {\r\n            display: none;\r\n        }\r\n        @include tablet-vertical {\r\n            h2 {\r\n                font-size: 21px !important;\r\n            }\r\n            div {\r\n                font-size: 12.5px !important;\r\n                text-align: center;\r\n            }\r\n        }\r\n        @include smartphone-horizontal {\r\n            padding-top: 12px;\r\n            h2 {\r\n                font-size: 21px !important;\r\n            }\r\n            div {\r\n                font-size: 13px !important;\r\n                text-align: center;\r\n                .mt-4 {\r\n                    margin-top: 12px !important;\r\n                }\r\n                svg {\r\n                    width: 16px;\r\n                }\r\n            }\r\n        }\r\n        @include smartphone-horizontal-short {\r\n            h2 {\r\n                font-size: 16px !important;\r\n            }\r\n            div {\r\n                font-size: 10.5px !important;\r\n                .mt-4 {\r\n                    margin-top: 8px !important;\r\n                }\r\n            }\r\n        }\r\n        @include smartphone-vertical {\r\n            min-height: calc(100vh - 56px - 64px - 12px);\r\n            min-height: calc(100dvh - 56px - 64px - 12px);\r\n            padding-top: 12px;\r\n            br {\r\n                display: inline;\r\n            }\r\n            h2 {\r\n                font-size: 22px !important;\r\n                text-align: center;\r\n            }\r\n            div {\r\n                font-size: 15px !important;\r\n                text-align: center;\r\n                .mt-4 {\r\n                    margin-top: 8px !important;\r\n                }\r\n                svg {\r\n                    width: 20px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Home.vue?vue&type=template&id=4686a97e&scoped=true\"\nimport script from \"./Home.vue?vue&type=script&lang=ts\"\nexport * from \"./Home.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Home.vue?vue&type=style&index=0&id=4686a97e&prod&lang=scss\"\nimport style1 from \"./Home.vue?vue&type=style&index=1&id=4686a97e&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4686a97e\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('Watch',{attrs:{\"playback_mode\":'Live'}})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"route-container\"},[_c('main',{staticClass:\"watch-container\",class:{\n            'watch-container--control-display': _vm.playerStore.is_control_display,\n            'watch-container--panel-display': _vm.Utils.isSmartphoneVertical() || _vm.Utils.isTabletVertical() ? true : _vm.playerStore.is_panel_display,\n            'watch-container--fullscreen': _vm.playerStore.is_fullscreen,\n            'watch-container--video': _vm.playback_mode === 'Video',\n        }},[_c('WatchNavigation'),_c('div',{staticClass:\"watch-content\",on:{\"mousemove\":function($event){return _vm.playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event, is_player_region_event: true})},\"touchmove\":function($event){return _vm.playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event, is_player_region_event: true})},\"click\":function($event){return _vm.playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event, is_player_region_event: true})}}},[_c('WatchHeader',{attrs:{\"playback_mode\":_vm.playback_mode}}),_c('WatchPlayer',{attrs:{\"playback_mode\":_vm.playback_mode}})],1),_c('WatchPanel',{attrs:{\"playback_mode\":_vm.playback_mode}})],1),_c('KeyboardShortcutList',{attrs:{\"playback_mode\":_vm.playback_mode}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('header',{staticClass:\"watch-header\",class:{'watch-header--video': _vm.playback_mode === 'Video'}},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"watch-header__back-icon\",attrs:{\"to\":_vm.playback_mode === 'Live' ? '/tv/' : '/video/'}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-left-12-filled\",\"width\":\"25px\"}})],1),(_vm.playback_mode === 'Live')?_c('img',{staticClass:\"watch-header__broadcaster\",attrs:{\"src\":`${_vm.Utils.api_base_url}/channels/${_vm.channelsStore.channel.current.id}/logo`}}):_vm._e(),_c('span',{staticClass:\"watch-header__program-title\",domProps:{\"innerHTML\":_vm._s(_vm.ProgramUtils.decorateProgramInfo(\n        _vm.playback_mode === 'Live' ? _vm.channelsStore.channel.current.program_present : _vm.playerStore.recorded_program, 'title'\n    ))}}),_c('span',{staticClass:\"watch-header__program-time\"},[_vm._v(\" \"+_vm._s(_vm.ProgramUtils.getProgramTime(_vm.playback_mode === 'Live' ? _vm.channelsStore.channel.current.program_present : _vm.playerStore.recorded_program, true))+\" \")]),_c('v-spacer'),_c('span',{staticClass:\"watch-header__now\"},[_vm._v(_vm._s(_vm.time))])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\r\nimport APIClient from  '@/services/APIClient';\r\nimport { IChannel } from '@/services/Channels';\r\nimport { CommentUtils } from '@/utils';\r\n\r\n\r\n/** 録画ファイル情報を表すインターフェース */\r\nexport interface IRecordedVideo {\r\n    id: number;\r\n    file_path: string;\r\n    file_hash: string;\r\n    file_size: number;\r\n    recording_start_time: string | null;\r\n    recording_end_time: string | null;\r\n    duration: number;\r\n    container_format: 'MPEG-TS';\r\n    video_codec: 'MPEG-2' | 'H.264' | 'H.265';\r\n    video_codec_profile: 'High' | 'High 10' | 'Main' | 'Main 10' | 'Baseline';\r\n    video_scan_type: 'Interlaced' | 'Progressive';\r\n    video_frame_rate: number;\r\n    video_resolution_width: number;\r\n    video_resolution_height: number;\r\n    primary_audio_codec: 'AAC-LC' | 'HE-AAC' | 'MP2';\r\n    primary_audio_channel: 'Monaural' | 'Stereo' | '5.1ch';\r\n    primary_audio_sampling_rate: number;\r\n    secondary_audio_codec: 'AAC-LC' | 'HE-AAC' | 'MP2' | null;\r\n    secondary_audio_channel: 'Monaural' | 'Stereo' | '5.1ch' | null;\r\n    secondary_audio_sampling_rate: number | null;\r\n    cm_sections: { start_time: number; end_time: number; }[];\r\n}\r\n\r\n/** 録画ファイル情報を表すインターフェースのデフォルト値 */\r\nexport const IRecordedVideoDefault: IRecordedVideo = {\r\n    id: -1,\r\n    file_path: '',\r\n    file_hash: '',\r\n    file_size: 0,\r\n    recording_start_time: null,\r\n    recording_end_time: null,\r\n    duration: 0,\r\n    container_format: 'MPEG-TS',\r\n    video_codec: 'MPEG-2',\r\n    video_codec_profile: 'High',\r\n    video_scan_type: 'Interlaced',\r\n    video_frame_rate: 29.97,\r\n    video_resolution_width: 1440,\r\n    video_resolution_height: 1080,\r\n    primary_audio_codec: 'AAC-LC',\r\n    primary_audio_channel: 'Stereo',\r\n    primary_audio_sampling_rate: 48000,\r\n    secondary_audio_codec: null,\r\n    secondary_audio_channel: null,\r\n    secondary_audio_sampling_rate: null,\r\n    cm_sections: [],\r\n};\r\n\r\n/** 録画番組情報を表すインターフェース */\r\nexport interface IRecordedProgram {\r\n    id: number;\r\n    recorded_video: IRecordedVideo;\r\n    recording_start_margin: number;\r\n    recording_end_margin: number;\r\n    is_partially_recorded: boolean;\r\n    channel: IChannel | null;\r\n    network_id: number | null;\r\n    service_id: number | null;\r\n    event_id: number | null;\r\n    series_id: number | null;\r\n    series_broadcast_period_id: number | null;\r\n    title: string;\r\n    series_title: string | null;\r\n    episode_number: string | null;\r\n    subtitle: string | null;\r\n    description: string;\r\n    detail: { [key: string]: string };\r\n    start_time: string;\r\n    end_time: string;\r\n    duration: number;\r\n    is_free: boolean;\r\n    genres: { major: string; middle: string; }[];\r\n    primary_audio_type: string;\r\n    primary_audio_language: string;\r\n    secondary_audio_type: string | null;\r\n    secondary_audio_language: string | null;\r\n}\r\n\r\n/** 録画番組情報を表すインターフェースのデフォルト値 */\r\nexport const IRecordedProgramDefault: IRecordedProgram = {\r\n    id: -1,\r\n    recorded_video: IRecordedVideoDefault,\r\n    recording_start_margin: 0,\r\n    recording_end_margin: 0,\r\n    is_partially_recorded: false,\r\n    channel: null,\r\n    network_id: null,\r\n    service_id: null,\r\n    event_id: null,\r\n    series_id: null,\r\n    series_broadcast_period_id: null,\r\n    title: '取得中…',\r\n    series_title: null,\r\n    episode_number: null,\r\n    subtitle: null,\r\n    description: '取得中…',\r\n    detail: {},\r\n    start_time: '2000-01-01T00:00:00+09:00',\r\n    end_time: '2000-01-01T00:00:00+09:00',\r\n    duration: 0,\r\n    is_free: true,\r\n    genres: [],\r\n    primary_audio_type: '2/0モード(ステレオ)',\r\n    primary_audio_language: '日本語',\r\n    secondary_audio_type: null,\r\n    secondary_audio_language: null,\r\n};\r\n\r\n/** 録画番組情報リストを表すインターフェース */\r\nexport interface IRecordedPrograms {\r\n    total: number;\r\n    recorded_programs: IRecordedProgram[];\r\n}\r\n\r\n/** 過去ログコメントを表すインターフェース */\r\nexport interface IJikkyoComment {\r\n    time: number;\r\n    type: 'top' | 'right' | 'bottom';\r\n    size: 'big' | 'medium' | 'small';\r\n    color: string;\r\n    author: string;\r\n    text: string;\r\n}\r\n\r\n/** 過去ログコメントのリストを表すインターフェース */\r\nexport interface IJikkyoComments {\r\n    is_success: boolean;\r\n    comments: IJikkyoComment[];\r\n    detail: string;\r\n}\r\n\r\n\r\nclass Videos {\r\n\r\n    /**\r\n     * 録画番組情報を取得する\r\n     * @param video_id 録画番組の ID\r\n     * @returns 録画番組情報 or 録画番組情報の取得に失敗した場合は null\r\n     */\r\n    static async fetchVideo(video_id: number): Promise<IRecordedProgram | null> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.get<IRecordedProgram>(`/videos/${video_id}`);\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, '録画番組情報を取得できませんでした。');\r\n            return null;\r\n        }\r\n\r\n        return response.data;\r\n    }\r\n\r\n\r\n    /**\r\n     * 録画番組の放送中に投稿されたニコニコ実況の過去ログコメントを取得する\r\n     * @param video_id 録画番組の ID\r\n     * @returns 過去ログコメントのリスト\r\n     */\r\n    static async fetchVideoJikkyoComments(video_id: number): Promise<IJikkyoComments> {\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.get<IJikkyoComments>(`/videos/${video_id}/jikkyo`);\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            APIClient.showGenericError(response, '過去ログコメントを取得できませんでした。');\r\n            return {\r\n                is_success: false,\r\n                comments: [],\r\n                detail: '過去ログコメントを取得できませんでした。',\r\n            };\r\n        }\r\n\r\n        // ミュート対象のコメントを除外して返す\r\n        response.data.comments = response.data.comments.filter((comment) => {\r\n            return CommentUtils.isMutedComment(comment.text, comment.author, comment.color, comment.type, comment.size) === false;\r\n        });\r\n        return response.data;\r\n    }\r\n}\r\n\r\nexport default Videos;\r\n","\r\nimport mitt from 'mitt';\r\nimport { defineStore } from 'pinia';\r\n\r\nimport { ITweetCapture } from '@/components/Watch/Panel/Twitter.vue';\r\nimport { ICommentData } from '@/services/player/managers/LiveCommentManager';\r\nimport { IRecordedProgram, IRecordedProgramDefault } from '@/services/Videos';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\n\r\n\r\n/**\r\n * プレイヤーに関連するイベントの型\r\n * PlayerManager 側からのイベントも UI 側からのイベントも PlayerEvents を通じて行う\r\n */\r\nexport type PlayerEvents = {\r\n    // UI コンポーネントからプレイヤーに通知メッセージの送信を要求する\r\n    // DPlayer.notice() の引数と同じで、そのまま DPlayer.notice() に渡される\r\n    SendNotification: {\r\n        message: string;  // 通知メッセージの内容\r\n        duration?: number;  // 通知メッセージの表示時間 (ミリ秒)\r\n        opacity?: number;  // 通知メッセージの透明度\r\n        color?: string;  // 通知メッセージの文字色\r\n    }\r\n    // PlayerManager からプレイヤーの再起動が必要になったことを通知する\r\n    PlayerRestartRequired: {\r\n        message?: string;  // プレイヤーに通知するメッセージ\r\n        is_error_message?: boolean;  // メッセージをエラーメッセージとして表示するか (既定は true)\r\n    };\r\n    // PlayerController.setControlDisplayTimer() をそのまま呼び出す\r\n    SetControlDisplayTimer: {\r\n        event?: Event;  // マウスやタッチイベント (手動実行する際は省略する)\r\n        is_player_region_event?: boolean;  // プレイヤー画面の中で発火したイベントなら true に設定する\r\n    }\r\n    // CaptureManager からキャプチャの撮影が完了したことを通知する\r\n    CaptureCompleted: {\r\n        capture: Blob;  // キャプチャの Blob\r\n        filename: string;  // キャプチャのファイル名 (UI からの手動ダウンロード時に使う)\r\n    };\r\n    // LiveCommentManager からコメントを受信したことを通知する\r\n    CommentReceived: {\r\n        is_initial_comments: boolean;  // 初期コメントかどうか\r\n        comments: ICommentData[];  // コメントデータのリスト\r\n    }\r\n    // ライブ視聴: LiveCommentManager からコメントを送信したことを通知する\r\n    CommentSendCompleted: {\r\n        comment: ICommentData;  // 送信したコメントデータ (を整形したもの)\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * プレイヤー側の再生系ロジックと UI 側で共有される状態を管理するストア\r\n * 主に PlayerController や PlayerManager から状態変化に合わせて変更された値をリアクティブに UI に反映するためのもの\r\n */\r\nconst usePlayerStore = defineStore('player', {\r\n    state: () => ({\r\n\r\n        // 現在視聴画面を表示しているか\r\n        // 既定で表示していない\r\n        is_watching: false,\r\n\r\n        // PlayerController が初期化されているか\r\n        is_player_initialized: false,\r\n\r\n        // プレイヤーに関連するイベントを発行する EventEmitter\r\n        event_emitter: mitt<PlayerEvents>(),\r\n\r\n        // 現在視聴中の録画番組の情報\r\n        // 視聴中の録画番組がない場合は IRecordedProgramDefault を設定すべき (初期値も IRecordedProgramDefault にしている)\r\n        recorded_program: IRecordedProgramDefault as IRecordedProgram,\r\n\r\n        // 仮想キーボードが表示されているか\r\n        // 既定で表示されていない想定\r\n        is_virtual_keyboard_display: false,\r\n\r\n        // フルスクリーン状態かどうか\r\n        is_fullscreen: false,\r\n\r\n        // コントロールを表示するか\r\n        is_control_display: true,\r\n\r\n        // パネルを表示するか\r\n        // panel_display_state が \"AlwaysDisplay\" なら常に表示し、\"AlwaysFold\" なら常に折りたたむ\r\n        // \"RestorePreviousState\" なら showed_panel_last_time の値を使い､前回の状態を復元する\r\n        is_panel_display: (() => {\r\n            const settings_store = useSettingsStore();\r\n            switch (settings_store.settings.panel_display_state) {\r\n                case 'AlwaysDisplay':\r\n                    return true;\r\n                case 'AlwaysFold':\r\n                    return false;\r\n                case 'RestorePreviousState':\r\n                    return settings_store.settings.showed_panel_last_time;\r\n            }\r\n        })(),\r\n\r\n        // ライブ視聴: 表示されるパネルのタブ\r\n        tv_panel_active_tab: useSettingsStore().settings.tv_panel_active_tab,\r\n\r\n        // ビデオ視聴: 表示されるパネルのタブ\r\n        video_panel_active_tab: useSettingsStore().settings.video_panel_active_tab,\r\n\r\n        // パネルの Twitter タブ内で表示されるタブ\r\n        twitter_active_tab: useSettingsStore().settings.twitter_active_tab,\r\n\r\n        // リモコンを表示するか\r\n        is_remocon_display: false,\r\n\r\n        // ザッピング（「前/次のチャンネル」ボタン or 上下キーショートカット）によるチャンネル移動かどうか\r\n        is_zapping: false,\r\n\r\n        // プレイヤーのローディング状態\r\n        // 既定でローディングとする\r\n        is_loading: true,\r\n\r\n        // プレイヤーが映像の再生をバッファリングしているか\r\n        // 視聴開始時以外にも、ネットワークが遅くて再生が一時的に途切れたときなどで表示される\r\n        // 既定でバッファリング中とする\r\n        is_video_buffering: true,\r\n\r\n        // プレイヤーの再生が停止しているか\r\n        // 既定で再生中とする\r\n        is_video_paused: false,\r\n\r\n        // プレイヤーの背景を表示するか\r\n        // 既定で表示しない\r\n        is_background_display: false,\r\n\r\n        // プレイヤーの背景の URL\r\n        background_url: '',\r\n\r\n        // キーボードショートカットの一覧のモーダルを表示するか\r\n        shortcut_key_modal: false,\r\n\r\n        // ライブ視聴: 現在のライブストリームのステータス\r\n        // 既定で null (未視聴) とする\r\n        live_stream_status: null as 'Offline' | 'Standby' | 'ONAir' | 'Idling' | 'Restart' | null,\r\n\r\n        // ライブ視聴: ニコニコ実況への接続に失敗した際のエラーメッセージ\r\n        // null のとき、エラーは発生していないとみなす\r\n        live_comment_init_failed_message: null as string | null,\r\n\r\n        // ビデオ視聴: 過去ログコメントへの取得に失敗した際のエラーメッセージ\r\n        // null のとき、エラーは発生していないとみなす\r\n        video_comment_init_failed_message: null as string | null,\r\n\r\n        // Twitter パネルコンポーネントで利用する、ツイート添付候補のキャプチャのリスト\r\n        // UI 上と KeyboardShortcutManager の両方から操作する必要があるため PlayerStore に持たせている\r\n        twitter_captures: [] as ITweetCapture[],\r\n\r\n        // Twitter パネルコンポーネントで利用する、キャプチャを拡大表示するモーダルの表示状態\r\n        // UI 上と KeyboardShortcutManager の両方から操作する必要があるため PlayerStore に持たせている\r\n        twitter_zoom_capture_modal: false,\r\n\r\n        // Twitter パネルコンポーネントで利用する、現在モーダルで拡大表示中のキャプチャ\r\n        // UI 上と KeyboardShortcutManager の両方から操作する必要があるため PlayerStore に持たせている\r\n        twitter_zoom_capture: null as ITweetCapture | null,\r\n    }),\r\n    actions: {\r\n\r\n        /**\r\n         * 視聴画面を開き、再生処理を開始する際に必ず呼び出さなければならない\r\n         * 呼び出すと自動的に状態がリセットされ、is_watching が true になる\r\n         */\r\n        startWatching(): void {\r\n            this.reset();\r\n            this.is_watching = true;\r\n        },\r\n\r\n        /**\r\n         * 視聴画面を閉じ、再生処理を終了する際に必ず呼び出さなければならない\r\n         * 呼び出すと自動的に状態がリセットされ、is_watching が false になる\r\n         */\r\n        stopWatching(): void {\r\n            this.reset();\r\n            this.is_watching = false;\r\n        },\r\n\r\n        /**\r\n         * PlayerStore の内容を初期値に戻す\r\n         * startWatching() / stopWatching() で呼び出される\r\n         */\r\n        reset(): void {\r\n            this.is_watching = false;\r\n            this.is_player_initialized = false;\r\n            this.recorded_program = IRecordedProgramDefault;\r\n            this.is_virtual_keyboard_display = false;\r\n            this.is_fullscreen = false;\r\n            this.is_control_display = true;\r\n            this.is_panel_display = (() => {\r\n                const settings_store = useSettingsStore();\r\n                switch (settings_store.settings.panel_display_state) {\r\n                    case 'AlwaysDisplay':\r\n                        return true;\r\n                    case 'AlwaysFold':\r\n                        return false;\r\n                    case 'RestorePreviousState':\r\n                        return settings_store.settings.showed_panel_last_time;\r\n                }\r\n            })();\r\n            this.tv_panel_active_tab = useSettingsStore().settings.tv_panel_active_tab;\r\n            this.video_panel_active_tab = useSettingsStore().settings.video_panel_active_tab;\r\n            this.twitter_active_tab = useSettingsStore().settings.twitter_active_tab;\r\n            this.is_remocon_display = false;\r\n            this.is_zapping = false;\r\n            this.is_loading = true;\r\n            this.is_video_buffering = true;\r\n            this.is_video_paused = false;\r\n            this.is_background_display = false;\r\n            this.background_url = '';\r\n            this.shortcut_key_modal = false;\r\n            this.live_stream_status = null;\r\n            this.live_comment_init_failed_message = null;\r\n            this.twitter_captures = [];\r\n            this.twitter_zoom_capture_modal = false;\r\n            this.twitter_zoom_capture = null;\r\n        }\r\n    }\r\n});\r\n\r\nexport default usePlayerStore;\r\n","<template>\r\n    <header class=\"watch-header\" :class=\"{'watch-header--video': playback_mode === 'Video'}\">\r\n        <router-link class=\"watch-header__back-icon\" v-ripple :to=\"playback_mode === 'Live' ? '/tv/' : '/video/'\">\r\n            <Icon icon=\"fluent:arrow-left-12-filled\" width=\"25px\" />\r\n        </router-link>\r\n        <img class=\"watch-header__broadcaster\" v-if=\"playback_mode === 'Live'\"\r\n            :src=\"`${Utils.api_base_url}/channels/${channelsStore.channel.current.id}/logo`\">\r\n        <span class=\"watch-header__program-title\" v-html=\"ProgramUtils.decorateProgramInfo(\r\n            playback_mode === 'Live' ? channelsStore.channel.current.program_present : playerStore.recorded_program, 'title'\r\n        )\"></span>\r\n        <span class=\"watch-header__program-time\">\r\n            {{ProgramUtils.getProgramTime(playback_mode === 'Live' ? channelsStore.channel.current.program_present : playerStore.recorded_program, true)}}\r\n        </span>\r\n        <v-spacer></v-spacer>\r\n        <span class=\"watch-header__now\">{{time}}</span>\r\n    </header>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent, PropType } from 'vue';\r\n\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport Utils, { dayjs, ProgramUtils } from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'Watch-Header',\r\n    props: {\r\n        playback_mode: {\r\n            type: String as PropType<'Live' | 'Video'>,\r\n            required: true,\r\n        },\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n            ProgramUtils: Object.freeze(ProgramUtils),\r\n\r\n            // 現在時刻\r\n            time: dayjs().format(Utils.isSmartphoneHorizontal() ? 'HH:mm:ss' : 'YYYY/MM/DD HH:mm:ss'),\r\n\r\n            // 現在時刻更新用のインターバルの ID\r\n            time_interval_id: 0,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useChannelsStore, usePlayerStore),\r\n    },\r\n    created() {\r\n        // 現在時刻を1秒おきに更新\r\n        this.time_interval_id = window.setInterval(() => {\r\n            this.time = dayjs().format(Utils.isSmartphoneHorizontal() ? 'HH:mm:ss' : 'YYYY/MM/DD HH:mm:ss');\r\n        }, 1 * 1000);\r\n    },\r\n    beforeUnmount() {\r\n        // インターバルをクリア\r\n        window.clearInterval(this.time_interval_id);\r\n    },\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.watch-header {\r\n    display: flex;\r\n    align-items: center;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 82px;\r\n    padding-left: calc(68px + 30px);\r\n    padding-right: 30px;\r\n    background: linear-gradient(to bottom, #000000cf, transparent);\r\n    transition: opacity 0.3s, visibility 0.3s;\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    z-index: 5;\r\n\r\n    @include tablet-vertical {\r\n        height: 66px;\r\n        padding-left: 16px;\r\n        padding-right: 16px;\r\n    }\r\n    @include smartphone-horizontal {\r\n        padding-left: calc(68px + 16px);\r\n        padding-right: 16px;\r\n    }\r\n    @include smartphone-horizontal {\r\n        height: 66px;\r\n        padding-left: calc(0px + 16px);\r\n    }\r\n    @include smartphone-vertical {\r\n        height: 50px;\r\n        padding-left: 16px;\r\n        padding-right: 16px;\r\n    }\r\n\r\n    &.watch-header--video {\r\n        .watch-header__program-time {\r\n            font-size: 13px;\r\n        }\r\n        .watch-header__now {\r\n            display: none;\r\n        }\r\n    }\r\n\r\n    .watch-header__back-icon {\r\n        display: none;\r\n        @include tablet-vertical {\r\n            display: flex;\r\n            position: relative !important;\r\n            align-items: center;\r\n            justify-content: center;\r\n            flex-shrink: 0;\r\n            width: 40px;\r\n            height: 40px;\r\n            left: -6px;\r\n            padding: 6px;\r\n            margin-right: 2px;\r\n            border-radius: 50%;\r\n            color: var(--v-text-base);\r\n        }\r\n        @include smartphone-horizontal {\r\n            display: flex;\r\n            position: relative !important;\r\n            align-items: center;\r\n            justify-content: center;\r\n            flex-shrink: 0;\r\n            width: 36px;\r\n            height: 36px;\r\n            left: -6px;\r\n            padding: 6px;\r\n            margin-right: 2px;\r\n            border-radius: 50%;\r\n            color: var(--v-text-base);\r\n        }\r\n        @include smartphone-vertical {\r\n            display: flex;\r\n            position: relative !important;\r\n            align-items: center;\r\n            justify-content: center;\r\n            flex-shrink: 0;\r\n            width: 36px;\r\n            height: 36px;\r\n            left: -6px;\r\n            padding: 6px;\r\n            margin-right: 2px;\r\n            border-radius: 50%;\r\n            color: var(--v-text-base);\r\n        }\r\n    }\r\n\r\n    .watch-header__broadcaster {\r\n        display: inline-block;\r\n        flex-shrink: 0;\r\n        width: 64px;\r\n        height: 36px;\r\n        margin-right: 18px;\r\n        border-radius: 5px;\r\n        background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n        object-fit: cover;\r\n        user-select: none;\r\n\r\n        @include tablet-vertical {\r\n            width: 48px;\r\n            height: 28px;\r\n            margin-right: 12px;\r\n            border-radius: 4px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            width: 36px;\r\n            height: 28px;\r\n            margin-right: 12px;\r\n            border-radius: 4px;\r\n        }\r\n        @include smartphone-vertical {\r\n            display: none;\r\n            margin-right: 0px;\r\n        }\r\n    }\r\n\r\n    .watch-header__program-title {\r\n        font-size: 18px;\r\n        font-weight: bold;\r\n        font-feature-settings: \"palt\" 1;  // 文字詰め\r\n        letter-spacing: 0.05em;  // 字間を少し空ける\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n\r\n        @include tablet-vertical {\r\n            font-size: 16px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            font-size: 16px;\r\n        }\r\n        @include smartphone-vertical {\r\n            font-size: 14px;\r\n        }\r\n    }\r\n\r\n    .watch-header__program-time {\r\n        flex-shrink: 0;\r\n        margin-left: 16px;\r\n        font-size: 15px;\r\n        font-weight: 500;\r\n\r\n        @include smartphone-horizontal {\r\n            margin-left: 8px;\r\n            font-size: 14px;\r\n        }\r\n        @include smartphone-vertical {\r\n            margin-left: 8px;\r\n            font-size: 13px;\r\n        }\r\n    }\r\n\r\n    .watch-header__now {\r\n        flex-shrink: 0;\r\n        margin-left: 16px;\r\n        font-size: 13px;\r\n        font-weight: 500;\r\n\r\n        @include smartphone-horizontal {\r\n            margin-left: 8px;\r\n        }\r\n        @include smartphone-vertical {\r\n            display: none;\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Header.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Header.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Header.vue?vue&type=template&id=0d431a38&scoped=true\"\nimport script from \"./Header.vue?vue&type=script&lang=ts\"\nexport * from \"./Header.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Header.vue?vue&type=style&index=0&id=0d431a38&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0d431a38\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('v-dialog',{attrs:{\"max-width\":\"1050\",\"transition\":\"slide-y-transition\"},model:{value:(_vm.playerStore.shortcut_key_modal),callback:function ($$v) {_vm.$set(_vm.playerStore, \"shortcut_key_modal\", $$v)},expression:\"playerStore.shortcut_key_modal\"}},[_c('v-card',[_c('v-card-title',{staticClass:\"px-5 pt-4 pb-3 d-flex align-center font-weight-bold\"},[_c('Icon',{attrs:{\"icon\":\"fluent:keyboard-20-filled\",\"height\":\"28px\"}}),_c('span',{staticClass:\"ml-3\"},[_vm._v(\"キーボードショートカット\")]),_c('v-spacer'),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"d-flex align-center rounded-circle cursor-pointer px-2 py-2\",on:{\"click\":function($event){_vm.playerStore.shortcut_key_modal = false}}},[_c('Icon',{attrs:{\"icon\":\"fluent:dismiss-12-filled\",\"width\":\"23px\",\"height\":\"23px\"}})],1)],1),_c('div',{staticClass:\"px-5 pb-4\"},[_c('v-row',_vm._l((_vm.shortcut_list),function(shortcut_key_column,shortcut_key_column_name){return _c('v-col',{key:shortcut_key_column_name,attrs:{\"cols\":\"6\"}},_vm._l((shortcut_key_column),function(shortcut_keys){return _c('div',{key:shortcut_keys.name,staticClass:\"mt-3\"},[_c('div',{staticClass:\"text-subtitle-1 d-flex align-center font-weight-bold\"},[_c('Icon',{attrs:{\"icon\":shortcut_keys.icon,\"height\":shortcut_keys.icon_height}}),_c('span',{staticClass:\"ml-2\"},[_vm._v(_vm._s(shortcut_keys.name))])],1),_vm._l((shortcut_keys.shortcuts),function(shortcut){return _c('div',{key:shortcut.name,staticClass:\"mt-3\"},[_c('div',{staticClass:\"text-subtitle-2 mt-2 d-flex align-center font-weight-medium\"},[_c('span',{staticClass:\"mr-2\",domProps:{\"innerHTML\":_vm._s(shortcut.name)}}),_c('div',{staticClass:\"ml-auto d-flex align-center flex-shrink-0\"},_vm._l((shortcut.keys),function(key,index){return _c('div',{key:key.name,staticClass:\"ml-auto d-flex align-center\"},[_c('span',{staticClass:\"shortcut-key\"},[_vm._l((key.name.split(';')),function(key_name){return _c('Icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(key.icon === true),expression:\"key.icon === true\"}],key:key_name,attrs:{\"icon\":key_name,\"height\":\"18px\"}})}),(key.icon === false)?_c('span',{domProps:{\"innerHTML\":_vm._s(key.name)}}):_vm._e()],2),(index < (shortcut.keys.length - 1))?_c('span',{staticClass:\"shortcut-key-plus\"},[_vm._v(\"+\")]):_vm._e()])}),0)])])})],2)}),0)}),1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <v-dialog max-width=\"1050\" transition=\"slide-y-transition\" v-model=\"playerStore.shortcut_key_modal\">\r\n        <v-card>\r\n            <v-card-title class=\"px-5 pt-4 pb-3 d-flex align-center font-weight-bold\">\r\n                <Icon icon=\"fluent:keyboard-20-filled\" height=\"28px\" />\r\n                <span class=\"ml-3\">キーボードショートカット</span>\r\n                <v-spacer></v-spacer>\r\n                <div v-ripple class=\"d-flex align-center rounded-circle cursor-pointer px-2 py-2\" @click=\"playerStore.shortcut_key_modal = false\">\r\n                    <Icon icon=\"fluent:dismiss-12-filled\" width=\"23px\" height=\"23px\" />\r\n                </div>\r\n            </v-card-title>\r\n            <div class=\"px-5 pb-4\">\r\n                <v-row>\r\n                    <v-col cols=\"6\" v-for=\"(shortcut_key_column, shortcut_key_column_name) in shortcut_list\" :key=\"shortcut_key_column_name\">\r\n                        <div class=\"mt-3\" v-for=\"shortcut_keys in shortcut_key_column\" :key=\"shortcut_keys.name\">\r\n                            <div class=\"text-subtitle-1 d-flex align-center font-weight-bold\">\r\n                                <Icon :icon=\"shortcut_keys.icon\" :height=\"shortcut_keys.icon_height\" />\r\n                                <span class=\"ml-2\">{{shortcut_keys.name}}</span>\r\n                            </div>\r\n                            <div class=\"mt-3\" v-for=\"shortcut in shortcut_keys.shortcuts\" :key=\"shortcut.name\">\r\n                                <div class=\"text-subtitle-2 mt-2 d-flex align-center font-weight-medium\">\r\n                                    <span class=\"mr-2\" v-html=\"shortcut.name\"></span>\r\n                                    <div class=\"ml-auto d-flex align-center flex-shrink-0\">\r\n                                        <div class=\"ml-auto d-flex align-center\" v-for=\"(key, index) in shortcut.keys\" :key=\"key.name\">\r\n                                            <span class=\"shortcut-key\">\r\n                                                <Icon v-show=\"key.icon === true\" :icon=\"key_name\" height=\"18px\"\r\n                                                    v-for=\"key_name in key.name.split(';')\" :key=\"key_name\" />\r\n                                                <span v-if=\"key.icon === false\" v-html=\"key.name\"></span>\r\n                                            </span>\r\n                                            <span class=\"shortcut-key-plus\" v-if=\"index < (shortcut.keys.length - 1)\">+</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </v-col>\r\n                </v-row>\r\n            </div>\r\n        </v-card>\r\n    </v-dialog>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent, PropType } from 'vue';\r\n\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils from '@/utils';\r\n\r\ninterface IShortcutList {\r\n    left_column: IShortcutGroup[];\r\n    right_column: IShortcutGroup[];\r\n}\r\n\r\ninterface IShortcutGroup {\r\n    name: string;\r\n    icon: string;\r\n    icon_height: string;\r\n    shortcuts: IShortcut[];\r\n}\r\n\r\ninterface IShortcut {\r\n    name: string;\r\n    keys: {\r\n        name: string;\r\n        icon: boolean;\r\n    }[];\r\n}\r\n\r\n// キーボードショートカットの一覧に表示するショートカットキーのリスト (ライブ視聴)\r\nconst LIVE_SHORTCUT_LIST: IShortcutList = {\r\n    left_column: [\r\n        {\r\n            name: '全般',\r\n            icon: 'fluent:home-20-filled',\r\n            icon_height: '22px',\r\n            shortcuts: [\r\n                { name: '数字キー/テンキーに対応するリモコン番号 (1~12) の地デジチャンネルに切り替える', keys: [{name: '1~9, 0, -(=), ^(~)', icon: false}] },\r\n                { name: '数字キー/テンキーに対応するリモコン番号 (1~12) の BS チャンネルに切り替える', keys: [{name: 'Shift', icon: false}, {name: '1~9, 0, -(=), ^(~)', icon: false}] },\r\n                { name: '前のチャンネルに切り替える', keys: [{name: 'fluent:arrow-up-12-filled', icon: true}] },\r\n                { name: '次のチャンネルに切り替える', keys: [{name: 'fluent:arrow-down-12-filled', icon: true}] },\r\n                { name: 'キーボードショートカットの一覧を表示する', keys: [{name: '／(？)', icon: false}] },\r\n            ]\r\n        },\r\n        {\r\n            name: 'プレイヤー',\r\n            icon: 'fluent:play-20-filled',\r\n            icon_height: '20px',\r\n            shortcuts: [\r\n                { name: '再生 / 一時停止の切り替え', keys: [{name: 'Space', icon: false}] },\r\n                { name: '再生 / 一時停止の切り替え (キャプチャタブ表示時)', keys: [{name: 'Shift', icon: false}, {name: 'Space', icon: false}] },\r\n                { name: '停止して0.5秒早戻し', keys: [{name: Utils.CtrlOrCmd(), icon: false}, {name: 'fluent:arrow-left-12-filled', icon: true}] },\r\n                { name: '停止して0.5秒早送り', keys: [{name: Utils.CtrlOrCmd(), icon: false}, {name: 'fluent:arrow-right-12-filled', icon: true}] },\r\n                { name: 'プレイヤーの音量を上げる', keys: [{name: Utils.CtrlOrCmd(), icon: false}, {name: 'fluent:arrow-up-12-filled', icon: true}] },\r\n                { name: 'プレイヤーの音量を下げる', keys: [{name: Utils.CtrlOrCmd(), icon: false}, {name: 'fluent:arrow-down-12-filled', icon: true}] },\r\n                { name: 'プレイヤーの音量をミュートする', keys: [{name: 'Q', icon: false}] },\r\n                { name: 'ライブストリームを同期する', keys: [{name: 'W', icon: false}] },\r\n                { name: 'プレイヤーを再起動する', keys: [{name: 'R', icon: false}] },\r\n                { name: 'フルスクリーンの切り替え', keys: [{name: 'F', icon: false}] },\r\n                { name: 'Picture-in-Picture の表示切り替え', keys: [{name: 'E', icon: false}] },\r\n                { name: '字幕の表示切り替え', keys: [{name: 'S', icon: false}] },\r\n                { name: 'コメントの表示切り替え', keys: [{name: 'D', icon: false}] },\r\n                { name: '映像をキャプチャする', keys: [{name: 'C', icon: false}] },\r\n                { name: '映像をコメントを付けてキャプチャする', keys: [{name: 'V', icon: false}] },\r\n                { name: 'コメント入力フォームにフォーカスする', keys: [{name: 'M', icon: false}] },\r\n                { name: 'コメント入力フォームを閉じる', keys: [{name: Utils.CtrlOrCmd(), icon: false}, {name: 'M', icon: false}] },\r\n                { name: 'コメントを送信する', keys: [{name: 'コメント入力フォームを表示', icon: false}, {name: 'Enter', icon: false}] },\r\n            ]\r\n        },\r\n    ],\r\n    right_column: [\r\n        {\r\n            name: 'パネル',\r\n            icon: 'fluent:panel-right-20-filled',\r\n            icon_height: '24px',\r\n            shortcuts: [\r\n                { name: 'パネルの表示切り替え', keys: [{name: 'P', icon: false}] },\r\n                { name: '番組情報タブを表示する', keys: [{name: 'K', icon: false}] },\r\n                { name: 'チャンネルタブを表示する', keys: [{name: 'L', icon: false}] },\r\n                { name: 'コメントタブを表示する', keys: [{name: '；(＋)', icon: false}] },\r\n                { name: 'Twitter タブを表示する', keys: [{name: '：(＊)', icon: false}] },\r\n            ]\r\n        },\r\n        {\r\n            name: 'Twitter',\r\n            icon: 'fa-brands:twitter',\r\n            icon_height: '22px',\r\n            shortcuts: [\r\n                { name: 'ツイート検索タブを表示する', keys: [{name: '［ (「)', icon: false}] },\r\n                { name: 'タイムラインタブを表示する', keys: [{name: '］ (」)', icon: false}] },\r\n                { name: 'キャプチャタブを表示する', keys: [{name: '＼(￥)', icon: false}] },\r\n                { name: 'ツイート入力フォームにフォーカスを当てる/フォーカスを外す', keys: [{name: 'Tab', icon: false}] },\r\n                { name: 'キャプチャにフォーカスする', keys: [{name: 'キャプチャタブを表示', icon: false}, {name: 'fluent:arrow-up-12-filled;fluent:arrow-down-12-filled;fluent:arrow-left-12-filled;fluent:arrow-right-12-filled', icon: true}] },\r\n                { name: 'キャプチャを拡大表示する/<br>キャプチャの拡大表示を閉じる', keys: [{name: 'キャプチャにフォーカス', icon: false}, {name: 'Enter', icon: false}] },\r\n                { name: 'キャプチャを選択する/<br>キャプチャの選択を解除する', keys: [{name: 'キャプチャにフォーカス', icon: false}, {name: 'Space', icon: false}] },\r\n                { name: 'クリップボード内の画像を<br>キャプチャとして取り込む', keys: [{name: 'ツイート入力<br>フォームにフォーカス', icon: false}, {name: Utils.CtrlOrCmd(), icon: false}, {name: 'V', icon: false}] },\r\n                { name: 'ツイートを送信する', keys: [{name: 'Twitter タブを表示', icon: false}, {name: Utils.CtrlOrCmd(), icon: false}, {name: 'Enter', icon: false}] },\r\n            ]\r\n        },\r\n    ],\r\n};\r\n\r\n// キーボードショートカットの一覧に表示するショートカットキーのリスト (ビデオ視聴)\r\nconst VIDEO_SHORTCUT_LIST: IShortcutList = {\r\n    left_column: [\r\n        {\r\n            name: '全般',\r\n            icon: 'fluent:home-20-filled',\r\n            icon_height: '22px',\r\n            shortcuts: [\r\n                { name: 'キーボードショートカットの一覧を表示する', keys: [{name: '／(？)', icon: false}] },\r\n            ]\r\n        },\r\n        {\r\n            name: 'プレイヤー',\r\n            icon: 'fluent:play-20-filled',\r\n            icon_height: '20px',\r\n            shortcuts: [\r\n                { name: '再生 / 一時停止の切り替え', keys: [{name: 'Space', icon: false}] },\r\n                { name: '再生 / 一時停止の切り替え (キャプチャタブ表示時)', keys: [{name: 'Shift', icon: false}, {name: 'Space', icon: false}] },\r\n                { name: 'プレイヤーの音量を上げる', keys: [{name: Utils.CtrlOrCmd(), icon: false}, {name: 'fluent:arrow-up-12-filled', icon: true}] },\r\n                { name: 'プレイヤーの音量を下げる', keys: [{name: Utils.CtrlOrCmd(), icon: false}, {name: 'fluent:arrow-down-12-filled', icon: true}] },\r\n                { name: 'プレイヤーの音量をミュートする', keys: [{name: 'Q', icon: false}] },\r\n                { name: 'プレイヤーを再起動する', keys: [{name: 'R', icon: false}] },\r\n                { name: 'フルスクリーンの切り替え', keys: [{name: 'F', icon: false}] },\r\n                { name: 'Picture-in-Picture の表示切り替え', keys: [{name: 'E', icon: false}] },\r\n                { name: '字幕の表示切り替え', keys: [{name: 'S', icon: false}] },\r\n                { name: 'コメントの表示切り替え', keys: [{name: 'D', icon: false}] },\r\n                { name: '映像をキャプチャする', keys: [{name: 'C', icon: false}] },\r\n                { name: '映像をコメントを付けてキャプチャする', keys: [{name: 'V', icon: false}] },\r\n            ]\r\n        },\r\n    ],\r\n    right_column: [\r\n        {\r\n            name: 'パネル',\r\n            icon: 'fluent:panel-right-20-filled',\r\n            icon_height: '24px',\r\n            shortcuts: [\r\n                { name: 'パネルの表示切り替え', keys: [{name: 'P', icon: false}] },\r\n                { name: '番組情報タブを表示する', keys: [{name: 'K', icon: false}] },\r\n                { name: 'シリーズタブを表示する', keys: [{name: 'L', icon: false}] },\r\n                { name: 'コメントタブを表示する', keys: [{name: '；(＋)', icon: false}] },\r\n                { name: 'Twitter タブを表示する', keys: [{name: '：(＊)', icon: false}] },\r\n            ]\r\n        },\r\n        {\r\n            name: 'Twitter',\r\n            icon: 'fa-brands:twitter',\r\n            icon_height: '22px',\r\n            shortcuts: [\r\n                { name: 'ツイート検索タブを表示する', keys: [{name: '［ (「)', icon: false}] },\r\n                { name: 'タイムラインタブを表示する', keys: [{name: '］ (」)', icon: false}] },\r\n                { name: 'キャプチャタブを表示する', keys: [{name: '＼(￥)', icon: false}] },\r\n                { name: 'ツイート入力フォームにフォーカスを当てる/フォーカスを外す', keys: [{name: 'Tab', icon: false}] },\r\n                { name: 'キャプチャにフォーカスする', keys: [{name: 'キャプチャタブを表示', icon: false}, {name: 'fluent:arrow-up-12-filled;fluent:arrow-down-12-filled;fluent:arrow-left-12-filled;fluent:arrow-right-12-filled', icon: true}] },\r\n                { name: 'キャプチャを拡大表示する/<br>キャプチャの拡大表示を閉じる', keys: [{name: 'キャプチャにフォーカス', icon: false}, {name: 'Enter', icon: false}] },\r\n                { name: 'キャプチャを選択する/<br>キャプチャの選択を解除する', keys: [{name: 'キャプチャにフォーカス', icon: false}, {name: 'Space', icon: false}] },\r\n                { name: 'クリップボード内の画像を<br>キャプチャとして取り込む', keys: [{name: 'ツイート入力<br>フォームにフォーカス', icon: false}, {name: Utils.CtrlOrCmd(), icon: false}, {name: 'V', icon: false}] },\r\n                { name: 'ツイートを送信する', keys: [{name: 'Twitter タブを表示', icon: false}, {name: Utils.CtrlOrCmd(), icon: false}, {name: 'Enter', icon: false}] },\r\n            ]\r\n        },\r\n    ],\r\n};\r\n\r\nexport default defineComponent({\r\n    name: 'KeyboardShortcutList',\r\n    props: {\r\n        playback_mode: {\r\n            type: String as PropType<'Live' | 'Video'>,\r\n            required: true,\r\n        },\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n\r\n            // キーボードショートカットの一覧に表示するショートカットキーのリスト (ライブ視聴)\r\n            // created() で設定を反映するため、コンポーネントの破棄後に変更が残らないよう structuredClone() でクローンする\r\n            live_shortcut_list: structuredClone(LIVE_SHORTCUT_LIST),\r\n\r\n            // キーボードショートカットの一覧に表示するショートカットキーのリスト (ビデオ視聴)\r\n            // created() で設定を反映するため、コンポーネントの破棄後に変更が残らないよう structuredClone() でクローンする\r\n            video_shortcut_list: structuredClone(VIDEO_SHORTCUT_LIST),\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(usePlayerStore, useSettingsStore),\r\n\r\n        // キーボードショートカットの一覧に表示するショートカットキーのリスト\r\n        // ライブ視聴の場合は live_shortcut_key_list を、ビデオ視聴の場合は video_shortcut_key_list を返す\r\n        shortcut_list() {\r\n            if (this.playback_mode === 'Live') {\r\n                return this.live_shortcut_list;\r\n            } else {\r\n                return this.video_shortcut_list;\r\n            }\r\n        },\r\n    },\r\n    created() {\r\n        // チャンネル選局のキーボードショートカットを Alt or Option + 数字キー/テンキーに変更する設定が有効なら、\r\n        // キーボードショートカット一覧に反映する\r\n        if (this.settingsStore.settings.tv_channel_selection_requires_alt_key === true) {\r\n            this.live_shortcut_list.left_column[0].shortcuts[0].keys.unshift({name: Utils.AltOrOption(), icon: false});\r\n            this.live_shortcut_list.left_column[0].shortcuts[1].keys.unshift({name: Utils.AltOrOption(), icon: false});\r\n        }\r\n    },\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.shortcut-key {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    flex-shrink: 0;\r\n    min-width: 32px;\r\n    min-height: 28px;\r\n    padding: 3px 8px;\r\n    border-radius: 5px;\r\n    background-color: var(--v-background-lighten2);\r\n    font-size: 14.5px;\r\n    text-align: center;\r\n}\r\n\r\n.shortcut-key-plus {\r\n    display: inline-block;\r\n    margin: 0px 5px;\r\n    flex-shrink: 0;\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KeyboardShortcutList.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KeyboardShortcutList.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./KeyboardShortcutList.vue?vue&type=template&id=14960b1a&scoped=true\"\nimport script from \"./KeyboardShortcutList.vue?vue&type=script&lang=ts\"\nexport * from \"./KeyboardShortcutList.vue?vue&type=script&lang=ts\"\nimport style0 from \"./KeyboardShortcutList.vue?vue&type=style&index=0&id=14960b1a&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"14960b1a\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('nav',{staticClass:\"watch-navigation\",on:{\"mousemove\":function($event){return _vm.playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})},\"touchmove\":function($event){return _vm.playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})},\"click\":function($event){return _vm.playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})}}},[_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"watch-navigation__icon\",attrs:{\"to\":\"/tv/\"}},[_c('img',{staticClass:\"watch-navigation__icon-image\",attrs:{\"src\":\"/assets/images/icon.svg\",\"width\":\"23px\"}})]),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"},{name:\"tooltip\",rawName:\"v-tooltip.right\",value:('テレビをみる'),expression:\"'テレビをみる'\",modifiers:{\"right\":true}}],staticClass:\"watch-navigation__link\",attrs:{\"active-class\":\"watch-navigation__link--active\",\"to\":\"/tv/\"}},[_c('Icon',{staticClass:\"watch-navigation__link-icon\",attrs:{\"icon\":\"fluent:tv-20-regular\",\"width\":\"26px\"}})],1),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"},{name:\"tooltip\",rawName:\"v-tooltip.right\",value:('ビデオをみる'),expression:\"'ビデオをみる'\",modifiers:{\"right\":true}}],staticClass:\"watch-navigation__link\",attrs:{\"active-class\":\"watch-navigation__link--active\",\"to\":\"/videos/\"}},[_c('Icon',{staticClass:\"watch-navigation__link-icon\",attrs:{\"icon\":\"fluent:movies-and-tv-20-regular\",\"width\":\"26px\"}})],1),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"},{name:\"tooltip\",rawName:\"v-tooltip.right\",value:('番組表'),expression:\"'番組表'\",modifiers:{\"right\":true}}],staticClass:\"watch-navigation__link\",attrs:{\"active-class\":\"watch-navigation__link--active\",\"to\":\"/timetable/\"}},[_c('Icon',{staticClass:\"watch-navigation__link-icon\",attrs:{\"icon\":\"fluent:calendar-ltr-20-regular\",\"width\":\"26px\"}})],1),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"},{name:\"tooltip\",rawName:\"v-tooltip.right\",value:('録画予約'),expression:\"'録画予約'\",modifiers:{\"right\":true}}],staticClass:\"watch-navigation__link\",attrs:{\"active-class\":\"watch-navigation__link--active\",\"to\":\"/reserves/\"}},[_c('Icon',{staticClass:\"watch-navigation__link-icon\",staticStyle:{\"padding\":\"0.5px\"},attrs:{\"icon\":\"fluent:timer-16-regular\",\"width\":\"26px\"}})],1),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"},{name:\"tooltip\",rawName:\"v-tooltip.right\",value:('マイリスト'),expression:\"'マイリスト'\",modifiers:{\"right\":true}}],staticClass:\"watch-navigation__link\",attrs:{\"active-class\":\"watch-navigation__link--active\",\"to\":\"/mylist/\"}},[_c('Icon',{staticClass:\"watch-navigation__link-icon\",attrs:{\"icon\":\"ic:round-playlist-play\",\"width\":\"26px\"}})],1),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"},{name:\"tooltip\",rawName:\"v-tooltip.right\",value:('キャプチャ'),expression:\"'キャプチャ'\",modifiers:{\"right\":true}}],staticClass:\"watch-navigation__link\",attrs:{\"active-class\":\"watch-navigation__link--active\",\"to\":\"/captures/\"}},[_c('Icon',{staticClass:\"watch-navigation__link-icon\",attrs:{\"icon\":\"fluent:image-multiple-24-regular\",\"width\":\"26px\"}})],1),_c('v-spacer'),_c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"},{name:\"tooltip\",rawName:\"v-tooltip.right\",value:('設定'),expression:\"'設定'\",modifiers:{\"right\":true}}],staticClass:\"watch-navigation__link\",attrs:{\"active-class\":\"watch-navigation__link--active\",\"to\":\"/settings/\"}},[_c('Icon',{staticClass:\"watch-navigation__link-icon\",attrs:{\"icon\":\"fluent:settings-20-regular\",\"width\":\"26px\"}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <nav class=\"watch-navigation\"\r\n            @mousemove=\"playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})\"\r\n            @touchmove=\"playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})\"\r\n            @click=\"playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})\">\r\n        <router-link v-ripple class=\"watch-navigation__icon\" to=\"/tv/\">\r\n            <img class=\"watch-navigation__icon-image\" src=\"/assets/images/icon.svg\" width=\"23px\">\r\n        </router-link>\r\n        <router-link v-ripple class=\"watch-navigation__link\" active-class=\"watch-navigation__link--active\"\r\n            v-tooltip.right=\"'テレビをみる'\" to=\"/tv/\">\r\n            <Icon class=\"watch-navigation__link-icon\" icon=\"fluent:tv-20-regular\" width=\"26px\" />\r\n        </router-link>\r\n        <router-link v-ripple class=\"watch-navigation__link\" active-class=\"watch-navigation__link--active\"\r\n            v-tooltip.right=\"'ビデオをみる'\"  to=\"/videos/\">\r\n            <Icon class=\"watch-navigation__link-icon\" icon=\"fluent:movies-and-tv-20-regular\" width=\"26px\" />\r\n        </router-link>\r\n        <router-link v-ripple class=\"watch-navigation__link\" active-class=\"watch-navigation__link--active\"\r\n            v-tooltip.right=\"'番組表'\" to=\"/timetable/\">\r\n            <Icon class=\"watch-navigation__link-icon\" icon=\"fluent:calendar-ltr-20-regular\" width=\"26px\" />\r\n        </router-link>\r\n        <router-link v-ripple class=\"watch-navigation__link\" active-class=\"watch-navigation__link--active\"\r\n            v-tooltip.right=\"'録画予約'\" to=\"/reserves/\">\r\n            <Icon class=\"watch-navigation__link-icon\" icon=\"fluent:timer-16-regular\" width=\"26px\" style=\"padding: 0.5px;\"/>\r\n        </router-link>\r\n        <router-link v-ripple class=\"watch-navigation__link\" active-class=\"watch-navigation__link--active\"\r\n            v-tooltip.right=\"'マイリスト'\" to=\"/mylist/\">\r\n            <Icon class=\"watch-navigation__link-icon\" icon=\"ic:round-playlist-play\" width=\"26px\" />\r\n        </router-link>\r\n        <router-link v-ripple class=\"watch-navigation__link\" active-class=\"watch-navigation__link--active\"\r\n            v-tooltip.right=\"'キャプチャ'\" to=\"/captures/\">\r\n            <Icon class=\"watch-navigation__link-icon\" icon=\"fluent:image-multiple-24-regular\" width=\"26px\" />\r\n        </router-link>\r\n        <v-spacer></v-spacer>\r\n        <router-link v-ripple class=\"watch-navigation__link\" active-class=\"watch-navigation__link--active\"\r\n            v-tooltip.right=\"'設定'\" to=\"/settings/\">\r\n            <Icon class=\"watch-navigation__link-icon\" icon=\"fluent:settings-20-regular\" width=\"26px\" />\r\n        </router-link>\r\n    </nav>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\n\r\nexport default defineComponent({\r\n    name: 'Watch-Navigation',\r\n    computed: {\r\n        ...mapStores(usePlayerStore),\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.watch-navigation {\r\n    display: flex;\r\n    flex-direction: column;\r\n    position: fixed;\r\n    width: 68px;\r\n    top: 0px;\r\n    left: 0px;\r\n    // スマホ・タブレットのブラウザでアドレスバーが完全に引っ込むまでビューポートの高さが更新されず、\r\n    // その間下に何も背景がない部分ができてしまうのを防ぐ\r\n    bottom: -100px;\r\n    padding: 18px 8px 122px;\r\n    background: #2F221F80;\r\n    transition: opacity 0.3s, visibility 0.3s;\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    z-index: 10;\r\n    @include tablet-vertical {\r\n        display: none;\r\n    }\r\n    @include smartphone-horizontal {\r\n        display: none;\r\n    }\r\n    @include smartphone-vertical {\r\n        display: none;\r\n    }\r\n\r\n    .watch-navigation__icon {\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        height: 52px;\r\n        margin-bottom: 17px;\r\n        border-radius: 11px;\r\n        font-size: 16px;\r\n        color: var(--v-text-base);\r\n        transition: background-color 0.15s;\r\n        text-decoration: none;\r\n        user-select: none;\r\n        @include smartphone-horizontal {\r\n            height: 32px;\r\n            border-radius: 10px;\r\n        }\r\n    }\r\n\r\n    @include smartphone-horizontal {\r\n        // スペースを確保するため、スペーサーを非表示に\r\n        div.spacer {\r\n            display: none;\r\n        }\r\n    }\r\n\r\n    .watch-navigation__link {\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        height: 52px;\r\n        border-radius: 11px;\r\n        font-size: 16px;\r\n        color: var(--v-text-base);\r\n        transition: background-color 0.15s;\r\n        text-decoration: none;\r\n        user-select: none;\r\n        @include smartphone-horizontal {\r\n            height: 44px;\r\n            border-radius: 10px;\r\n            // スペースを確保するため、設定・バージョン情報のアイコンを非表示に\r\n            &:nth-last-child(1), &:nth-last-child(2) {\r\n                display: none;\r\n            }\r\n        }\r\n\r\n        &:hover {\r\n            background: #433532A0;\r\n        }\r\n\r\n        @include smartphone-horizontal {\r\n            &-icon {\r\n                width: 26px;\r\n                height: 26px;\r\n            }\r\n        }\r\n\r\n        &--active {\r\n            color: var(--v-primary-base);\r\n            background: #433532A0;\r\n        }\r\n        + .watch-navigation__link {\r\n            margin-top: 4px;\r\n            @include smartphone-horizontal {\r\n                margin-top: auto;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Navigation.vue?vue&type=template&id=7ed62a3d&scoped=true\"\nimport script from \"./Navigation.vue?vue&type=script&lang=ts\"\nexport * from \"./Navigation.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Navigation.vue?vue&type=style&index=0&id=7ed62a3d&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7ed62a3d\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"watch-panel\",on:{\"mousemove\":function($event){return _vm.playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})}}},[_c('div',{staticClass:\"watch-panel__header\"},[_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"panel-close-button\",on:{\"click\":function($event){_vm.playerStore.is_panel_display = false}}},[_c('Icon',{staticClass:\"panel-close-button__icon\",attrs:{\"icon\":\"akar-icons:chevron-right\",\"width\":\"25px\"}}),_c('span',{staticClass:\"panel-close-button__text\"},[_vm._v(\"閉じる\")])],1),_c('v-spacer'),(_vm.playback_mode === 'Live')?_c('div',{staticClass:\"panel-broadcaster\"},[_c('img',{staticClass:\"panel-broadcaster__icon\",attrs:{\"src\":`${_vm.Utils.api_base_url}/channels/${_vm.channelsStore.channel.current.id}/logo`}}),_c('div',{staticClass:\"panel-broadcaster__number\"},[_vm._v(_vm._s(_vm.channelsStore.channel.current.channel_number))]),_c('div',{staticClass:\"panel-broadcaster__name\"},[_vm._v(_vm._s(_vm.channelsStore.channel.current.name))])]):_vm._e()],1),_c('div',{staticClass:\"watch-panel__content-container\"},[(_vm.playback_mode === 'Live')?_c('Program',{staticClass:\"watch-panel__content\",class:{'watch-panel__content--active': _vm.panel_active_tab === 'Program'}}):_vm._e(),(_vm.playback_mode === 'Video')?_c('RecordedProgram',{staticClass:\"watch-panel__content\",class:{'watch-panel__content--active': _vm.panel_active_tab === 'RecordedProgram'}}):_vm._e(),(_vm.playback_mode === 'Live')?_c('Channel',{staticClass:\"watch-panel__content\",class:{'watch-panel__content--active': _vm.panel_active_tab === 'Channel'}}):_vm._e(),(_vm.playback_mode === 'Video')?_c('Series',{staticClass:\"watch-panel__content\",class:{'watch-panel__content--active': _vm.panel_active_tab === 'Series'}}):_vm._e(),_c('Comment',{staticClass:\"watch-panel__content\",class:{'watch-panel__content--active': _vm.panel_active_tab === 'Comment'},attrs:{\"playback_mode\":_vm.playback_mode}}),_c('Twitter',{staticClass:\"watch-panel__content\",class:{'watch-panel__content--active': _vm.panel_active_tab === 'Twitter'},attrs:{\"playback_mode\":_vm.playback_mode}}),(_vm.playback_mode === 'Live')?_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"watch-panel__content-remocon-button elevation-8\",class:{'watch-panel__content-remocon-button--active': _vm.panel_active_tab === 'Program' || _vm.panel_active_tab === 'Channel'},on:{\"click\":function($event){_vm.playerStore.is_remocon_display = !_vm.playerStore.is_remocon_display}}},[_c('Icon',{staticClass:\"panel-close-button__icon\",attrs:{\"icon\":\"material-symbols:remote-gen\",\"width\":\"25px\"}})],1):_vm._e(),(_vm.playback_mode === 'Live')?_c('Remocon',{staticClass:\"watch-panel__remocon\",attrs:{\"modelValue\":(_vm.panel_active_tab === 'Program' || _vm.panel_active_tab === 'Channel') && _vm.playerStore.is_remocon_display === true},on:{\"update:modelValue\":function($event){_vm.playerStore.is_remocon_display = $event}}}):_vm._e()],1),_c('div',{staticClass:\"watch-panel__navigation\"},[(_vm.playback_mode === 'Live')?_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"panel-navigation-button\",class:{'panel-navigation-button--active': _vm.panel_active_tab === 'Program'},on:{\"click\":function($event){_vm.playerStore.tv_panel_active_tab = 'Program'}}},[_c('Icon',{staticClass:\"panel-navigation-button__icon\",attrs:{\"icon\":\"fa-solid:info-circle\",\"width\":\"33px\"}}),_c('span',{staticClass:\"panel-navigation-button__text\"},[_vm._v(\"番組情報\")])],1):_vm._e(),(_vm.playback_mode === 'Video')?_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"panel-navigation-button\",class:{'panel-navigation-button--active': _vm.panel_active_tab === 'RecordedProgram'},on:{\"click\":function($event){_vm.playerStore.video_panel_active_tab = 'RecordedProgram'}}},[_c('Icon',{staticClass:\"panel-navigation-button__icon\",attrs:{\"icon\":\"fa-solid:info-circle\",\"width\":\"33px\"}}),_c('span',{staticClass:\"panel-navigation-button__text\"},[_vm._v(\"番組情報\")])],1):_vm._e(),(_vm.playback_mode === 'Live')?_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"panel-navigation-button\",class:{'panel-navigation-button--active': _vm.panel_active_tab === 'Channel'},on:{\"click\":function($event){_vm.playerStore.tv_panel_active_tab = 'Channel'}}},[_c('Icon',{staticClass:\"panel-navigation-button__icon\",attrs:{\"icon\":\"fa-solid:broadcast-tower\",\"width\":\"34px\"}}),_c('span',{staticClass:\"panel-navigation-button__text\"},[_vm._v(\"チャンネル\")])],1):_vm._e(),(_vm.playback_mode === 'Video')?_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"panel-navigation-button\",class:{'panel-navigation-button--active': _vm.panel_active_tab === 'Series'},on:{\"click\":function($event){_vm.playerStore.video_panel_active_tab = 'Series'}}},[_c('Icon',{staticClass:\"panel-navigation-button__icon\",staticStyle:{\"width\":\"39px\",\"height\":\"39px\",\"margin-top\":\"-4px\",\"margin-bottom\":\"-4px\"},attrs:{\"icon\":\"fluent:video-clip-multiple-16-filled\",\"width\":\"34px\"}}),_c('span',{staticClass:\"panel-navigation-button__text\"},[_vm._v(\"シリーズ\")])],1):_vm._e(),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"panel-navigation-button\",class:{'panel-navigation-button--active': _vm.panel_active_tab === 'Comment'},on:{\"click\":function($event){_vm.playback_mode === 'Live' ? _vm.playerStore.tv_panel_active_tab = 'Comment' : _vm.playerStore.video_panel_active_tab = 'Comment'}}},[_c('Icon',{staticClass:\"panel-navigation-button__icon\",attrs:{\"icon\":\"bi:chat-left-text-fill\",\"width\":\"29px\"}}),_c('span',{staticClass:\"panel-navigation-button__text\"},[_vm._v(\"コメント\")])],1),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"panel-navigation-button\",class:{'panel-navigation-button--active': _vm.panel_active_tab === 'Twitter'},on:{\"click\":function($event){_vm.playback_mode === 'Live' ? _vm.playerStore.tv_panel_active_tab = 'Twitter' : _vm.playerStore.video_panel_active_tab = 'Twitter'}}},[_c('Icon',{staticClass:\"panel-navigation-button__icon\",attrs:{\"icon\":\"fa-brands:twitter\",\"width\":\"34px\"}}),_c('span',{staticClass:\"panel-navigation-button__text\"},[_vm._v(\"Twitter\")])],1)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"channels-container channels-container--watch\"},[_c('v-tabs-fix',{staticClass:\"channels-tab\",attrs:{\"centered\":\"\",\"show-arrows\":\"\"},model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},_vm._l((Array.from(_vm.channelsStore.channels_list_with_pinned_for_watch)),function([channels_type,]){return _c('v-tab',{key:channels_type,staticClass:\"channels-tab__item\"},[_vm._v(\" \"+_vm._s(channels_type)+\" \")])}),1),_c('div',{staticClass:\"channels-list-container\"},[_c('v-tabs-items-fix',{staticClass:\"channels-list\",model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},_vm._l((Array.from(_vm.channelsStore.channels_list_with_pinned_for_watch)),function([channels_type, channels]){return _c('v-tab-item-fix',{key:channels_type,staticClass:\"channels\"},_vm._l((channels),function(channel){return _c('router-link',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],key:channel.id,staticClass:\"channel\",attrs:{\"to\":`/tv/watch/${channel.display_channel_id}`}},[_c('div',{staticClass:\"channel__broadcaster\"},[_c('img',{staticClass:\"channel__broadcaster-icon\",attrs:{\"src\":`${_vm.Utils.api_base_url}/channels/${channel.id}/logo`}}),_c('div',{staticClass:\"channel__broadcaster-content\"},[_c('span',{staticClass:\"channel__broadcaster-name\"},[_vm._v(\"Ch: \"+_vm._s(channel.channel_number)+\" \"+_vm._s(channel.name))]),_c('div',{staticClass:\"channel__broadcaster-force\",class:`channel__broadcaster-force--${_vm.ChannelUtils.getChannelForceType(channel.jikkyo_force)}`},[_c('svg',{staticClass:\"iconify iconify--fa-solid\",attrs:{\"width\":\"9.63px\",\"height\":\"11px\",\"viewBox\":\"0 0 448 512\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M323.56 51.2c-20.8 19.3-39.58 39.59-56.22 59.97C240.08 73.62 206.28 35.53 168 0C69.74 91.17 0 209.96 0 281.6C0 408.85 100.29 512 224 512s224-103.15 224-230.4c0-53.27-51.98-163.14-124.44-230.4zm-19.47 340.65C282.43 407.01 255.72 416 226.86 416C154.71 416 96 368.26 96 290.75c0-38.61 24.31-72.63 72.79-130.75c6.93 7.98 98.83 125.34 98.83 125.34l58.63-66.88c4.14 6.85 7.91 13.55 11.27 19.97c27.35 52.19 15.81 118.97-33.43 153.42z\"}})]),_c('span',{staticClass:\"ml-1\"},[_vm._v(_vm._s(channel.jikkyo_force ?? '--'))])])])]),_c('div',{staticClass:\"channel__program-present\"},[_c('span',{staticClass:\"channel__program-present-title\",domProps:{\"innerHTML\":_vm._s(_vm.ProgramUtils.decorateProgramInfo(channel.program_present, 'title'))}}),_c('span',{staticClass:\"channel__program-present-time\"},[_vm._v(_vm._s(_vm.ProgramUtils.getProgramTime(channel.program_present)))])]),_c('div',{staticClass:\"channel__program-following\"},[_c('div',{staticClass:\"channel__program-following-title\"},[_c('span',{staticClass:\"channel__program-following-title-decorate\"},[_vm._v(\"NEXT\")]),_c('svg',{staticClass:\"channel__program-following-title-icon iconify iconify--fluent\",attrs:{\"width\":\"16px\",\"height\":\"16px\",\"viewBox\":\"0 0 20 20\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M10.018 5.486a1 1 0 0 1 1.592-.806l5.88 4.311a1.25 1.25 0 0 1 0 2.017l-5.88 4.311a1 1 0 0 1-1.592-.806v-3.16L4.61 15.319a1 1 0 0 1-1.592-.806V5.486A1 1 0 0 1 4.61 4.68l5.408 3.966v-3.16Z\"}})]),_c('span',{staticClass:\"channel__program-following-title-text\",domProps:{\"innerHTML\":_vm._s(_vm.ProgramUtils.decorateProgramInfo(channel.program_following, 'title'))}})]),_c('span',{staticClass:\"channel__program-following-time\"},[_vm._v(_vm._s(_vm.ProgramUtils.getProgramTime(channel.program_following)))])]),_c('div',{staticClass:\"channel__progressbar\"},[_c('div',{staticClass:\"channel__progressbar-progress\",style:(`width:${_vm.ProgramUtils.getProgramProgress(channel.program_present)}%;`)})])])}),1)}),1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"channels-container channels-container--watch\">\r\n        <v-tabs-fix centered show-arrows class=\"channels-tab\" v-model=\"tab\">\r\n            <v-tab class=\"channels-tab__item\"\r\n                v-for=\"[channels_type,] in Array.from(channelsStore.channels_list_with_pinned_for_watch)\" :key=\"channels_type\">\r\n                {{channels_type}}\r\n            </v-tab>\r\n        </v-tabs-fix>\r\n        <div class=\"channels-list-container\">\r\n            <v-tabs-items-fix class=\"channels-list\" v-model=\"tab\">\r\n                <v-tab-item-fix class=\"channels\"\r\n                    v-for=\"[channels_type, channels] in Array.from(channelsStore.channels_list_with_pinned_for_watch)\" :key=\"channels_type\">\r\n                    <router-link v-ripple class=\"channel\" v-for=\"channel in channels\" :key=\"channel.id\" :to=\"`/tv/watch/${channel.display_channel_id}`\">\r\n                        <!-- 以下では Icon コンポーネントを使うとチャンネルが多いときに高負荷になるため、意図的に SVG を直書きしている -->\r\n                        <div class=\"channel__broadcaster\">\r\n                            <img class=\"channel__broadcaster-icon\" :src=\"`${Utils.api_base_url}/channels/${channel.id}/logo`\">\r\n                            <div class=\"channel__broadcaster-content\">\r\n                                <span class=\"channel__broadcaster-name\">Ch: {{channel.channel_number}} {{channel.name}}</span>\r\n                                <div class=\"channel__broadcaster-force\"\r\n                                    :class=\"`channel__broadcaster-force--${ChannelUtils.getChannelForceType(channel.jikkyo_force)}`\">\r\n                                    <svg class=\"iconify iconify--fa-solid\" width=\"9.63px\" height=\"11px\" viewBox=\"0 0 448 512\">\r\n                                        <path fill=\"currentColor\" d=\"M323.56 51.2c-20.8 19.3-39.58 39.59-56.22 59.97C240.08 73.62 206.28 35.53 168 0C69.74 91.17 0 209.96 0 281.6C0 408.85 100.29 512 224 512s224-103.15 224-230.4c0-53.27-51.98-163.14-124.44-230.4zm-19.47 340.65C282.43 407.01 255.72 416 226.86 416C154.71 416 96 368.26 96 290.75c0-38.61 24.31-72.63 72.79-130.75c6.93 7.98 98.83 125.34 98.83 125.34l58.63-66.88c4.14 6.85 7.91 13.55 11.27 19.97c27.35 52.19 15.81 118.97-33.43 153.42z\"></path>\r\n                                    </svg>\r\n                                    <span class=\"ml-1\">{{channel.jikkyo_force ?? '--'}}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"channel__program-present\">\r\n                            <span class=\"channel__program-present-title\"\r\n                                v-html=\"ProgramUtils.decorateProgramInfo(channel.program_present, 'title')\">\r\n                            </span>\r\n                            <span class=\"channel__program-present-time\">{{ProgramUtils.getProgramTime(channel.program_present)}}</span>\r\n                        </div>\r\n                        <div class=\"channel__program-following\">\r\n                            <div class=\"channel__program-following-title\">\r\n                                <span class=\"channel__program-following-title-decorate\">NEXT</span>\r\n                                <svg class=\"channel__program-following-title-icon iconify iconify--fluent\" width=\"16px\" height=\"16px\" viewBox=\"0 0 20 20\">\r\n                                    <path fill=\"currentColor\" d=\"M10.018 5.486a1 1 0 0 1 1.592-.806l5.88 4.311a1.25 1.25 0 0 1 0 2.017l-5.88 4.311a1 1 0 0 1-1.592-.806v-3.16L4.61 15.319a1 1 0 0 1-1.592-.806V5.486A1 1 0 0 1 4.61 4.68l5.408 3.966v-3.16Z\"></path>\r\n                                </svg>\r\n                                <span class=\"channel__program-following-title-text\"\r\n                                    v-html=\"ProgramUtils.decorateProgramInfo(channel.program_following, 'title')\">\r\n                                </span>\r\n                            </div>\r\n                            <span class=\"channel__program-following-time\">{{ProgramUtils.getProgramTime(channel.program_following)}}</span>\r\n                        </div>\r\n                        <div class=\"channel__progressbar\">\r\n                            <div class=\"channel__progressbar-progress\"\r\n                                 :style=\"`width:${ProgramUtils.getProgramProgress(channel.program_present)}%;`\"></div>\r\n                        </div>\r\n                    </router-link>\r\n                </v-tab-item-fix>\r\n            </v-tabs-items-fix>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport Utils, { ChannelUtils, ProgramUtils } from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'Panel-ChannelTab',\r\n    data() {\r\n        return {\r\n\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n            ChannelUtils: Object.freeze(ChannelUtils),\r\n            ProgramUtils: Object.freeze(ProgramUtils),\r\n\r\n            // タブの状態管理\r\n            tab: null as number | null,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useChannelsStore),\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\">\r\n\r\n// 上書きしたいスタイル\r\n.channels-container.channels-container--watch {\r\n    .v-tabs-bar {\r\n        // スペースが少ないので高さを抑える\r\n        height: 42px;\r\n        // 下線を引く\r\n        background: linear-gradient(to bottom, var(--v-background-base) calc(100% - 3px), var(--v-background-lighten1) 3px);\r\n        @include tablet-vertical {\r\n            height: 50px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            height: 44px;\r\n        }\r\n        @include smartphone-vertical {\r\n            height: 46px;\r\n        }\r\n\r\n        // 幅を縮める\r\n        .v-slide-group__prev, .v-slide-group__next {\r\n            flex: auto !important;\r\n            min-width: 28px !important;\r\n        }\r\n    }\r\n    .v-tabs-slider-wrapper {\r\n        height: 3px !important;\r\n        transition: left 0.3s cubic-bezier(0.25, 0.8, 0.5, 1);\r\n    }\r\n}\r\n\r\n</style>\r\n<style lang=\"scss\" scoped>\r\n\r\n.channels-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    .channels-tab {\r\n        position: sticky;\r\n        flex: none;\r\n        top: 0px;\r\n        padding-left: 16px;\r\n        padding-right: 16px;\r\n        padding-bottom: 14px;\r\n        background:var(--v-background-base);\r\n        z-index: 1;\r\n        @include tablet-vertical {\r\n            padding-left: 24px;\r\n            padding-right: 24px;\r\n            padding-bottom: 10px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            padding-bottom: 8px;\r\n            margin-top: 0px;\r\n        }\r\n        @include smartphone-vertical {\r\n            padding-bottom: 8px;\r\n            margin-top: 0px;\r\n        }\r\n\r\n        .channels-tab__item {\r\n            min-width: 72px !important;\r\n            padding: 0 8px;\r\n            color: var(--v-text-base) !important;\r\n            font-size: 15px;\r\n            text-transform: none;\r\n            @include smartphone-horizontal {\r\n                font-size: 14.5px;\r\n            }\r\n        }\r\n    }\r\n\r\n    .channels-list-container {\r\n        overflow-y: auto;\r\n\r\n        .channels-list {\r\n            padding-left: 16px;\r\n            padding-right: 10px;\r\n            padding-bottom: 16px;\r\n            background: transparent !important;\r\n            overflow: visible !important;\r\n            @include tablet-vertical {\r\n                padding-left: 24px;\r\n                padding-right: 24px;\r\n            }\r\n            @include smartphone-horizontal {\r\n                padding-bottom: 12px;\r\n            }\r\n\r\n            .channels {\r\n                display: flex;\r\n                justify-content: center;\r\n                flex-direction: column;\r\n                // will-change を入れておく事で、アニメーションが GPU で処理される\r\n                will-change: transform;\r\n\r\n                // チャンネルリストでの content-visibility: auto; はちょっと描画上の副作用もあるので、\r\n                // パフォーマンス向上が顕著なスマホ・タブレット (タッチデバイス) のみに適用する\r\n                @media (hover: none) {\r\n                    content-visibility: auto;\r\n                    contain-intrinsic-size: 319.3px 2000px;  // だいたい 2000px 分の高さを確保\r\n                    @include smartphone-horizontal {\r\n                        contain-intrinsic-size: 277.3px 2000px;\r\n                    }\r\n                }\r\n\r\n                // 1630px 以上で幅を 445px に固定\r\n                @media (min-width: 1630px) {\r\n                    grid-template-columns: repeat(auto-fit, 445px);\r\n                }\r\n\r\n                .channel {\r\n                    display: flex;\r\n                    flex-direction: column;\r\n                    position: relative;\r\n                    margin-top: 12px;\r\n                    padding: 10px 12px 14px 12px;\r\n                    border-radius: 10px;\r\n                    color: var(--v-text-base);\r\n                    background: var(--v-background-lighten1);\r\n                    transition: background-color 0.15s;\r\n                    overflow: hidden;  // progressbar を切り抜くために必要\r\n                    text-decoration: none;\r\n                    user-select: none;\r\n                    cursor: pointer;\r\n                    // content-visibility: auto; を付与するだけでスマホでの描画パフォーマンスが大幅に向上する\r\n                    content-visibility: auto;\r\n                    contain-intrinsic-size: 295.3px 137.3px;\r\n\r\n                    &:first-of-type {\r\n                        margin-top: 0px;\r\n                    }\r\n                    @include smartphone-horizontal {\r\n                        margin-top: 8px;\r\n                        padding: 8px 12px 12px 12px;\r\n                        border-radius: 8px;\r\n                        contain-intrinsic-size: 253.3px 107.2px;\r\n                    }\r\n                    @include smartphone-vertical {\r\n                        margin-top: 8px;\r\n                        padding: 8px 12px 12px 12px;\r\n                        border-radius: 8px;\r\n                        contain-intrinsic-size: 253.3px 107.2px;\r\n                    }\r\n\r\n                    &:hover {\r\n                        background: var(--v-background-lighten2);\r\n                    }\r\n                    // タッチデバイスで hover を無効にする\r\n                    @media (hover: none) {\r\n                        &:hover {\r\n                            background: var(--v-background-lighten1);\r\n                        }\r\n                    }\r\n\r\n                    .channel__broadcaster {\r\n                        display: flex;\r\n                        height: 28px;\r\n                        @include smartphone-horizontal {\r\n                            height: 24px;\r\n                        }\r\n\r\n                        &-icon {\r\n                            display: inline-block;\r\n                            flex-shrink: 0;\r\n                            width: 48px;\r\n                            height: 100%;\r\n                            border-radius: 4px;\r\n                            background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n                            object-fit: cover;\r\n                            @include smartphone-horizontal {\r\n                                width: 46px;\r\n                            }\r\n                        }\r\n\r\n                        &-content {\r\n                            display: flex;\r\n                            align-items: center;\r\n                            margin-left: 12px;\r\n                            width: 100%;\r\n                            min-width: 0;\r\n                            @include smartphone-horizontal {\r\n                                margin-left: 8px;\r\n                            }\r\n                        }\r\n\r\n                        &-name {\r\n                            font-size: 14.5px;\r\n                            overflow: hidden;\r\n                            white-space: nowrap;\r\n                            text-overflow: ellipsis;\r\n                            @include smartphone-horizontal {\r\n                                font-size: 13.5px;\r\n                            }\r\n                            @include smartphone-vertical {\r\n                                font-size: 13.5px;\r\n                            }\r\n                        }\r\n\r\n                        &-force {\r\n                            display: flex;\r\n                            align-items: center;\r\n                            flex-shrink: 0;\r\n                            margin-top: 2px;\r\n                            margin-left: auto;\r\n                            padding-left: 6px;\r\n                            font-size: 12px;\r\n                            color: var(--v-text-darken1);\r\n\r\n                            &--festival {\r\n                                color: #E7556E;\r\n                            }\r\n                            &--so-many {\r\n                                color: #E76B55;\r\n                            }\r\n                            &--many {\r\n                                color: #E7A355;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    .channel__program-present {\r\n                        display: flex;\r\n                        flex-direction: column;\r\n\r\n                        &-title {\r\n                            display: -webkit-box;\r\n                            margin-top: 8px;\r\n                            font-size: 13.5px;\r\n                            font-weight: 700;\r\n                            font-feature-settings: \"palt\" 1;  // 文字詰め\r\n                            letter-spacing: 0.07em;  // 字間を少し空ける\r\n                            overflow: hidden;\r\n                            -webkit-line-clamp: 2;  // 2行までに制限\r\n                            -webkit-box-orient: vertical;\r\n                            @include smartphone-horizontal {\r\n                                margin-top: 5px;\r\n                                font-size: 12.5px;\r\n                                -webkit-line-clamp: 1;  // 1行までに制限\r\n                            }\r\n                            @include smartphone-vertical {\r\n                                margin-top: 5px;\r\n                                font-size: 12.5px;\r\n                                -webkit-line-clamp: 1;  // 1行までに制限\r\n                            }\r\n                        }\r\n\r\n                        &-time {\r\n                            margin-top: 4px;\r\n                            color: var(--v-text-darken1);\r\n                            font-size: 11.5px;\r\n                            @include smartphone-horizontal {\r\n                                margin-top: 1px;\r\n                                font-size: 10px;\r\n                            }\r\n                            @include smartphone-vertical {\r\n                                margin-top: 1px;\r\n                                font-size: 10px;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    .channel__program-following {\r\n                        display: flex;\r\n                        flex-direction: column;\r\n                        margin-top: 4px;\r\n                        color: var(--v-text-darken1);\r\n                        font-size: 11.5px;\r\n                        @include smartphone-horizontal {\r\n                            margin-top: 2px;\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            margin-top: 2px;\r\n                        }\r\n\r\n                        &-title {\r\n                            display: flex;\r\n                            align-items: center;\r\n\r\n                            &-decorate {\r\n                                flex-shrink: 0;\r\n                            }\r\n                            &-icon {\r\n                                flex-shrink: 0;\r\n                                margin-left: 3px;\r\n                            }\r\n                            &-text {\r\n                                margin-left: 2px;\r\n                                overflow: hidden;\r\n                                white-space: nowrap;\r\n                                text-overflow: ellipsis;  // はみ出た部分を … で省略\r\n                            }\r\n                        }\r\n\r\n                        &-time {\r\n                            margin-top: 1px;\r\n                            @include smartphone-horizontal {\r\n                                font-size: 10px;\r\n                            }\r\n                            @include smartphone-vertical {\r\n                                font-size: 10px;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    .channel__progressbar {\r\n                        position: absolute;\r\n                        left: 0;\r\n                        right: 0;\r\n                        bottom: 0;\r\n                        height: 4px;\r\n                        background: var(--v-gray-base);\r\n\r\n                        &-progress {\r\n                            height: 4px;\r\n                            background: var(--v-primary-base);\r\n                            transition: width 0.3s;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Channel.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Channel.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Channel.vue?vue&type=template&id=135a854b&scoped=true\"\nimport script from \"./Channel.vue?vue&type=script&lang=ts\"\nexport * from \"./Channel.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Channel.vue?vue&type=style&index=0&id=135a854b&prod&lang=scss\"\nimport style1 from \"./Channel.vue?vue&type=style&index=1&id=135a854b&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"135a854b\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"comment-container\"},[_c('section',{staticClass:\"comment-header\"},[_c('h2',{staticClass:\"comment-header__title\"},[_c('Icon',{staticClass:\"comment-header__title-icon\",attrs:{\"icon\":\"bi:chat-left-text-fill\",\"height\":\"18.5px\"}}),_c('span',{staticClass:\"comment-header__title-text\"},[_vm._v(\"コメント\")])],1),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"comment-header__button ml-auto\",on:{\"click\":function($event){_vm.comment_mute_settings_modal = !_vm.comment_mute_settings_modal}}},[_c('Icon',{attrs:{\"icon\":\"heroicons-solid:filter\",\"height\":\"11px\"}}),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"ミュート設定\")])],1)]),_c('section',{ref:\"comment_list_wrapper\",staticClass:\"comment-list-wrapper\"},[_c('div',{staticClass:\"comment-list-dropdown\",class:{'comment-list-dropdown--display': _vm.is_comment_list_dropdown_display},style:({'--comment-list-dropdown-top': `${_vm.comment_list_dropdown_top}px`})},[_c('v-list',{staticStyle:{\"background\":\"var(--v-background-lighten1)\"}},[_c('v-list-item',{staticStyle:{\"min-height\":\"30px\"},attrs:{\"dense\":\"\"},on:{\"click\":function($event){return _vm.copyTextToClipboard()}}},[_c('v-list-item-title',{staticClass:\"d-flex align-center\"},[_c('Icon',{attrs:{\"icon\":\"fluent:clipboard-paste-20-filled\",\"width\":\"20px\"}}),_c('span',{staticClass:\"ml-2\"},[_vm._v(\"クリップボードにコピー\")])],1)],1),_c('v-list-item',{staticStyle:{\"min-height\":\"30px\"},attrs:{\"dense\":\"\"},on:{\"click\":function($event){return _vm.addMutedKeywords()}}},[_c('v-list-item-title',{staticClass:\"d-flex align-center\"},[_c('Icon',{attrs:{\"icon\":\"fluent:comment-dismiss-20-filled\",\"width\":\"20px\"}}),_c('span',{staticClass:\"ml-2\"},[_vm._v(\"このコメントをミュート\")])],1)],1),_c('v-list-item',{staticStyle:{\"min-height\":\"30px\"},attrs:{\"dense\":\"\"},on:{\"click\":function($event){return _vm.addMutedNiconicoUserIds()}}},[_c('v-list-item-title',{staticClass:\"d-flex align-center\"},[_c('Icon',{attrs:{\"icon\":\"fluent:person-prohibited-20-filled\",\"width\":\"20px\"}}),_c('span',{staticClass:\"ml-2\"},[_vm._v(\"このコメントの投稿者をミュート\")])],1)],1)],1)],1),_c('div',{staticClass:\"comment-list-cover\",class:{'comment-list-cover--display': _vm.is_comment_list_dropdown_display},on:{\"click\":function($event){return _vm.hideCommentListDropdown()}}}),_c('DynamicScroller',{staticClass:\"comment-list\",attrs:{\"direction\":'vertical',\"items\":_vm.comment_list,\"min-item-size\":34},scopedSlots:_vm._u([{key:\"default\",fn:function({item, active}){return [_c('DynamicScrollerItem',{attrs:{\"item\":item,\"active\":active,\"size-dependencies\":[item.text]}},[_c('div',{staticClass:\"comment\",class:{'comment--my-post': item.my_post}},[_c('span',{staticClass:\"comment__text\"},[_vm._v(_vm._s(item.text))]),_c('span',{staticClass:\"comment__time\"},[_vm._v(_vm._s(item.time))]),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\",value:(!_vm.Utils.isTouchDevice()),expression:\"!Utils.isTouchDevice()\"}],staticClass:\"comment__icon\",on:{\"mouseup\":function($event){return _vm.showCommentListDropdown($event, item)},\"touchend\":function($event){return _vm.showCommentListDropdown($event, item)}}},[_c('svg',{staticClass:\"iconify iconify--fluent\",attrs:{\"width\":\"20px\",\"height\":\"20px\",\"viewBox\":\"0 0 20 20\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M10 6.5A1.75 1.75 0 1 1 10 3a1.75 1.75 0 0 1 0 3.5ZM10 17a1.75 1.75 0 1 1 0-3.5a1.75 1.75 0 0 1 0 3.5Zm-1.75-7a1.75 1.75 0 1 0 3.5 0a1.75 1.75 0 0 0-3.5 0Z\"}})])])])])]}}])}),(_vm.playback_mode === 'Live' && _vm.playerStore.live_comment_init_failed_message === null && _vm.comment_list.length === 0)?_c('div',{staticClass:\"comment-announce\"},[_c('div',{staticClass:\"comment-announce__heading\"},[_vm._v(\"まだコメントがありません。\")]),_vm._m(0)]):_vm._e(),(_vm.playback_mode === 'Live' && _vm.playerStore.live_comment_init_failed_message !== null && _vm.comment_list.length === 0)?_c('div',{staticClass:\"comment-announce\"},[_c('div',{staticClass:\"comment-announce__heading\"},[_vm._v(\"コメントがありません。\")]),_c('div',{staticClass:\"comment-announce__text\"},[_c('p',{staticClass:\"mt-0 mb-0\"},[_vm._v(_vm._s(_vm.playerStore.live_comment_init_failed_message))])])]):_vm._e(),(_vm.playback_mode === 'Video' && _vm.playerStore.video_comment_init_failed_message === null && _vm.comment_list.length === 0)?_c('div',{staticClass:\"comment-announce\"},[_c('div',{staticClass:\"comment-announce__heading\"},[_vm._v(\"まだコメントがありません。\")]),_vm._m(1)]):_vm._e(),(_vm.playback_mode === 'Video' && _vm.playerStore.video_comment_init_failed_message !== null && _vm.comment_list.length === 0)?_c('div',{staticClass:\"comment-announce\"},[_c('div',{staticClass:\"comment-announce__heading\"},[_vm._v(\"コメントがありません。\")]),_c('div',{staticClass:\"comment-announce__text\"},[_c('p',{staticClass:\"mt-0 mb-0\"},[_vm._v(_vm._s(_vm.playerStore.video_comment_init_failed_message))])])]):_vm._e()],1),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"comment-scroll-button elevation-5\",class:{'comment-scroll-button--display': _vm.is_manual_scroll},on:{\"click\":function($event){_vm.is_manual_scroll = false; _vm.scrollCommentList(true);}}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-down-12-filled\",\"height\":\"29px\"}})],1),_c('CommentMuteSettings',{attrs:{\"modelValue\":_vm.comment_mute_settings_modal},on:{\"update:modelValue\":function($event){_vm.comment_mute_settings_modal = $event}}})],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"comment-announce__text\"},[_c('p',{staticClass:\"mt-0 mb-0\"},[_vm._v(\"このチャンネルに対応するニコニコ実況のコメントが、リアルタイムで表示されます。\")])])\n},function (){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"comment-announce__text\"},[_c('p',{staticClass:\"mt-0 mb-0\"},[_vm._v(\"この録画番組に対応する、ニコニコ実況の過去ログコメントを取得しています...\")])])\n}]\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"comment-container\">\r\n        <section class=\"comment-header\">\r\n            <h2 class=\"comment-header__title\">\r\n                <Icon class=\"comment-header__title-icon\" icon=\"bi:chat-left-text-fill\" height=\"18.5px\" />\r\n                <span class=\"comment-header__title-text\">コメント</span>\r\n            </h2>\r\n            <button v-ripple class=\"comment-header__button ml-auto\" @click=\"comment_mute_settings_modal = !comment_mute_settings_modal\">\r\n                <Icon icon=\"heroicons-solid:filter\" height=\"11px\" />\r\n                <span class=\"ml-1\">ミュート設定</span>\r\n            </button>\r\n        </section>\r\n        <section class=\"comment-list-wrapper\" ref=\"comment_list_wrapper\">\r\n            <div class=\"comment-list-dropdown\" :class=\"{'comment-list-dropdown--display': is_comment_list_dropdown_display}\"\r\n                :style=\"{'--comment-list-dropdown-top': `${comment_list_dropdown_top}px`}\">\r\n                <v-list style=\"background: var(--v-background-lighten1)\">\r\n                    <v-list-item dense style=\"min-height: 30px\" @click=\"copyTextToClipboard()\">\r\n                        <v-list-item-title class=\"d-flex align-center\">\r\n                            <Icon icon=\"fluent:clipboard-paste-20-filled\" width=\"20px\" />\r\n                            <span class=\"ml-2\">クリップボードにコピー</span>\r\n                        </v-list-item-title>\r\n                    </v-list-item>\r\n                    <v-list-item dense style=\"min-height: 30px\" @click=\"addMutedKeywords()\">\r\n                        <v-list-item-title class=\"d-flex align-center\">\r\n                            <Icon icon=\"fluent:comment-dismiss-20-filled\" width=\"20px\" />\r\n                            <span class=\"ml-2\">このコメントをミュート</span>\r\n                        </v-list-item-title>\r\n                    </v-list-item>\r\n                    <v-list-item dense style=\"min-height: 30px\" @click=\"addMutedNiconicoUserIds()\">\r\n                        <v-list-item-title class=\"d-flex align-center\" >\r\n                            <Icon icon=\"fluent:person-prohibited-20-filled\" width=\"20px\" />\r\n                            <span class=\"ml-2\">このコメントの投稿者をミュート</span>\r\n                        </v-list-item-title>\r\n                    </v-list-item>\r\n                </v-list>\r\n            </div>\r\n            <div class=\"comment-list-cover\" :class=\"{'comment-list-cover--display': is_comment_list_dropdown_display}\"\r\n                @click=\"hideCommentListDropdown()\"></div>\r\n            <DynamicScroller class=\"comment-list\" :direction=\"'vertical'\" :items=\"comment_list\" :min-item-size=\"34\">\r\n                <template v-slot=\"{item, active}\">\r\n                <DynamicScrollerItem :item=\"item\" :active=\"active\" :size-dependencies=\"[item.text]\">\r\n                    <!-- 以下では Icon コンポーネントを使うと個数が多いときに高負荷になるため、意図的に SVG を直書きしている -->\r\n                    <div class=\"comment\" :class=\"{'comment--my-post': item.my_post}\">\r\n                        <span class=\"comment__text\">{{item.text}}</span>\r\n                        <span class=\"comment__time\">{{item.time}}</span>\r\n                        <!-- なぜか @click だとスマホで発火しないので @touchend にしている -->\r\n                        <div class=\"comment__icon\" v-ripple=\"!Utils.isTouchDevice()\"\r\n                            @mouseup=\"showCommentListDropdown($event, item)\"\r\n                            @touchend=\"showCommentListDropdown($event, item)\">\r\n                            <svg class=\"iconify iconify--fluent\" width=\"20px\" height=\"20px\" viewBox=\"0 0 20 20\">\r\n                                <path fill=\"currentColor\" d=\"M10 6.5A1.75 1.75 0 1 1 10 3a1.75 1.75 0 0 1 0 3.5ZM10 17a1.75 1.75 0 1 1 0-3.5a1.75 1.75 0 0 1 0 3.5Zm-1.75-7a1.75 1.75 0 1 0 3.5 0a1.75 1.75 0 0 0-3.5 0Z\"></path>\r\n                            </svg>\r\n                        </div>\r\n                    </div>\r\n                </DynamicScrollerItem>\r\n                </template>\r\n            </DynamicScroller>\r\n            <div class=\"comment-announce\"\r\n                v-if=\"playback_mode === 'Live' && playerStore.live_comment_init_failed_message === null && comment_list.length === 0\">\r\n                <div class=\"comment-announce__heading\">まだコメントがありません。</div>\r\n                <div class=\"comment-announce__text\">\r\n                    <p class=\"mt-0 mb-0\">このチャンネルに対応するニコニコ実況のコメントが、リアルタイムで表示されます。</p>\r\n                </div>\r\n            </div>\r\n            <div class=\"comment-announce\"\r\n                v-if=\"playback_mode === 'Live' && playerStore.live_comment_init_failed_message !== null && comment_list.length === 0\">\r\n                <div class=\"comment-announce__heading\">コメントがありません。</div>\r\n                <div class=\"comment-announce__text\">\r\n                    <p class=\"mt-0 mb-0\">{{playerStore.live_comment_init_failed_message}}</p>\r\n                </div>\r\n            </div>\r\n            <div class=\"comment-announce\"\r\n                v-if=\"playback_mode === 'Video' && playerStore.video_comment_init_failed_message === null && comment_list.length === 0\">\r\n                <div class=\"comment-announce__heading\">まだコメントがありません。</div>\r\n                <div class=\"comment-announce__text\">\r\n                    <p class=\"mt-0 mb-0\">この録画番組に対応する、ニコニコ実況の過去ログコメントを取得しています...</p>\r\n                </div>\r\n            </div>\r\n            <div class=\"comment-announce\"\r\n                v-if=\"playback_mode === 'Video' && playerStore.video_comment_init_failed_message !== null && comment_list.length === 0\">\r\n                <div class=\"comment-announce__heading\">コメントがありません。</div>\r\n                <div class=\"comment-announce__text\">\r\n                    <p class=\"mt-0 mb-0\">{{playerStore.video_comment_init_failed_message}}</p>\r\n                </div>\r\n            </div>\r\n        </section>\r\n        <div v-ripple class=\"comment-scroll-button elevation-5\" @click=\"is_manual_scroll = false; scrollCommentList(true);\"\r\n             :class=\"{'comment-scroll-button--display': is_manual_scroll}\">\r\n            <Icon icon=\"fluent:arrow-down-12-filled\" height=\"29px\" />\r\n        </div>\r\n        <CommentMuteSettings :modelValue=\"comment_mute_settings_modal\" @update:modelValue=\"comment_mute_settings_modal = $event\" />\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent, PropType } from 'vue';\r\n\r\nimport CommentMuteSettings from '@/components/Settings/CommentMuteSettings.vue';\r\nimport { ICommentData } from '@/services/player/managers/LiveCommentManager';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport Utils, { CommentUtils } from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'Panel-CommentTab',\r\n    components: {\r\n        CommentMuteSettings,\r\n    },\r\n    props: {\r\n        playback_mode: {\r\n            type: String as PropType<'Live' | 'Video'>,\r\n            required: true,\r\n        },\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n\r\n            // 手動スクロール状態かどうか\r\n            is_manual_scroll: false,\r\n\r\n            // 自動スクロール中かどうか\r\n            // 自動スクロール中の場合、scroll イベントが発火しても無視する\r\n            is_auto_scrolling: false,\r\n\r\n            // コメントリストの配列\r\n            comment_list: [] as ICommentData[],\r\n\r\n            // コメントリストの要素\r\n            comment_list_element: null as HTMLElement | null,\r\n\r\n            // コメントリストのドロップダウン関連\r\n            is_comment_list_dropdown_display: false as boolean,\r\n            comment_list_dropdown_top: 0 as number,\r\n            comment_list_dropdown_comment: null as ICommentData | null,\r\n\r\n            // コメントのミュート設定のモーダルを表示するか\r\n            comment_mute_settings_modal: false,\r\n\r\n            // visibilitychange イベントのリスナー\r\n            visibilitychange_listener: null as (() => void) | null,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useChannelsStore, usePlayerStore),\r\n    },\r\n    watch: {\r\n\r\n        // ライブ視聴のみ: ChannelsStore の channel.current.id の変更を監視する\r\n        // 現在視聴中のチャンネルが変更されたときにコメントリストをクリアする\r\n        'channelsStore.channel.current.id': {\r\n            handler() {\r\n                if (this.playback_mode === 'Live') {\r\n                    // 明示的に空の配列を入れてクリアしないと、コメントリストが残ったままになる\r\n                    this.comment_list = [];\r\n                }\r\n            }\r\n        }\r\n    },\r\n    mounted() {\r\n\r\n        // コメントリストの要素を取得\r\n        if (this.comment_list_element === null) {\r\n            this.comment_list_element = this.$el.querySelector('.comment-list')!;\r\n        }\r\n\r\n        // 現在コメントリストがユーザーイベントでスクロールされているかどうか\r\n        let is_user_scrolling = false;\r\n\r\n        // mousedown → mouseup 中: スクロールバーをマウスでドラッグ\r\n        // 残念ながらスクロールバーのドラッグ中は mousemove のイベントが発火しないため、直接 is_user_scrolling を設定する\r\n        this.comment_list_element.onmousedown = (event: MouseEvent) => {\r\n            // コメントリストの要素の左上を起点としたカーソルのX座標を求める\r\n            if (this.comment_list_element === null) return;\r\n            const x = event.clientX - this.comment_list_element.getBoundingClientRect().left;\r\n            // 座標が clientWidth 以上であれば、スクロールバー上で mousedown されたものとする\r\n            if (x > this.comment_list_element.clientWidth) is_user_scrolling = true;\r\n        };\r\n        this.comment_list_element.onmouseup = (event: MouseEvent) => {\r\n            // コメントリストの要素の左上を起点としたカーソルのX座標を求める\r\n            if (this.comment_list_element === null) return;\r\n            const x = event.clientX - this.comment_list_element.getBoundingClientRect().left;\r\n            // 座標が clientWidth 以上であれば、スクロールバー上で mouseup されたものとする\r\n            if (x > this.comment_list_element.clientWidth) is_user_scrolling = false;\r\n        };\r\n\r\n        // ユーザーによるスクロールイベントで is_user_scrolling を true にする\r\n        // 0.1 秒後に false にする（継続してイベントが発火すれば再び true になる）\r\n        const on_user_scrolling = () => {\r\n            is_user_scrolling = true;\r\n            window.setTimeout(() => is_user_scrolling = false, 100);\r\n        };\r\n\r\n        // 現在コメントリストがドラッグされているかどうか\r\n        let is_dragging = false;\r\n        // touchstart → touchend 中: スクロールバーをタップでドラッグ\r\n        this.comment_list_element.ontouchstart = () => is_dragging = true;\r\n        this.comment_list_element.ontouchend = () => is_dragging = false;\r\n        // touchmove + is_dragging 中: コメントリストをタップでドラッグしてスクロール\r\n        this.comment_list_element.ontouchmove = () => is_dragging === true ? on_user_scrolling(): '';\r\n\r\n        // wheel 中: マウスホイールの回転\r\n        this.comment_list_element.onwheel = on_user_scrolling;\r\n\r\n        // コメントリストがスクロールされた際、自動スクロール中でない&ユーザーイベントで操作されていれば、手動スクロールモードに設定\r\n        // 手動スクロールモードでは自動スクロールを行わず、ユーザーがコメントリストをスクロールできるようにする\r\n        this.comment_list_element.onscroll = async () => {\r\n            if (this.comment_list_element === null) return;\r\n\r\n            // scroll イベントは自動スクロールでも発火してしまうので、ユーザーイベントによるスクロールかを確認しないといけない\r\n            // 自動スクロール中かどうかは is_auto_scrolling が true のときで判定できるはずだが、\r\n            // コメントが多くなると is_auto_scrolling が false なのに scroll イベントが遅れて発火してしまうことがある\r\n            if (this.is_auto_scrolling === false && is_user_scrolling === true) {\r\n\r\n                // 手動スクロールを有効化\r\n                this.is_manual_scroll = true;\r\n\r\n                // イベント発火時点では scrollTop の値が完全に下にスクロールされていない場合があるため、0.1秒だけ待つ\r\n                await Utils.sleep(0.1);\r\n\r\n                // 一番下までスクロールされていたら自動スクロールに戻す\r\n                if ((this.comment_list_element.scrollTop + this.comment_list_element.offsetHeight) >\r\n                    (this.comment_list_element.scrollHeight - 10)) {  // 一番下から 10px 以内\r\n                    this.is_manual_scroll = false;  // 手動スクロールを無効化\r\n                }\r\n            }\r\n        };\r\n\r\n        // ***** イベントリスナーの登録 *****\r\n\r\n        // タブが非表示状態のときにコメントを格納する配列\r\n        // タブが表示状態になったらコメントリストにのみ表示する（遅れているのでプレイヤーには表示しない）\r\n        const comment_list_buffer: ICommentData[] = [];\r\n\r\n        // コメントの最大保持数\r\n        const max_comment_count = 500;\r\n\r\n        // LiveCommentManager からコメントを受信したときのイベントハンドラーを登録\r\n        // 非同期関数で登録することで、気持ち高速化を図る\r\n        // ビデオ視聴での過去ログコメントは PlayerController から直接このイベントに送信される\r\n        this.playerStore.event_emitter.on('CommentReceived', async (event) => {\r\n\r\n            // 初回の過去コメント (最大50件) を受信したとき\r\n            if (event.is_initial_comments === true) {\r\n\r\n                // チャンネル or 録画番組が切り替わった可能性があるので、既存のコメントリストをクリア\r\n                this.comment_list = [];\r\n\r\n                // コメントリストに一括で追加\r\n                this.comment_list.push(...event.comments);\r\n\r\n                // ライブ視聴のみ: コメントリストを一番下までスクロール\r\n                if (this.playback_mode === 'Live') {\r\n                    this.scrollCommentList();\r\n                }\r\n\r\n            // 通常のコメントを受信したとき\r\n            } else {\r\n\r\n                // タブが非表示状態のときは、バッファにコメントを追加するだけで終了する\r\n                // ここで追加すると、タブが表示状態になったときに一斉に描画されて大変なことになる\r\n                if (document.visibilityState === 'hidden') {\r\n                    comment_list_buffer.push(...event.comments);\r\n                    return;\r\n                }\r\n\r\n                // コメントリストのコメント数が max_comment_count 件を超えたら、古いものから順に削除する\r\n                // 仮想スクロールとはいえ、さすがに max_comment_count 件を超えると重くなりそう\r\n                // 手動スクロール時は実行しない\r\n                if (this.comment_list.length >= max_comment_count && this.is_manual_scroll === false) {\r\n                    this.comment_list.splice(0, Math.max(0, this.comment_list.length - max_comment_count));\r\n                }\r\n\r\n                // コメントリストに追加\r\n                // 通常コメントは1つだが、コメントが殺到した場合は DOM 描画負荷軽減のため一括で送信されてくる\r\n                this.comment_list.push(...event.comments);\r\n\r\n                // コメントリストを一番下までスクロール\r\n                // ビデオ視聴では is_initial_comments が true のイベントしか送られてこないので、そもそも実行されない\r\n                this.scrollCommentList();\r\n            }\r\n        });\r\n\r\n        // LiveCommentManager からコメントの送信完了イベントを受信したときのイベントハンドラーを登録\r\n        // ビデオ視聴では利用しない\r\n        this.playerStore.event_emitter.on('CommentSendCompleted', async (event) => {\r\n\r\n            // 送信した自分のコメントをコメントリストに追加\r\n            this.comment_list.push(event.comment);\r\n\r\n            // コメントリストを一番下までスクロール\r\n            // ビデオ視聴ではコメントを送信できないので、そもそも実行されない\r\n            this.scrollCommentList();\r\n        });\r\n\r\n        // タブが表示状態になったときのイベントハンドラーを登録\r\n        this.visibilitychange_listener = () => {\r\n            if (document.visibilityState === 'visible') {\r\n\r\n                // コメントリスト + バッファの合計コメント数が max_comment_count 件を超えたら、\r\n                // コメントリスト内のコメントを古いものから順に削除し、max_comment_count 件になるようにする\r\n                const comment_list_and_buffer_length = this.comment_list.length + comment_list_buffer.length;\r\n                if (comment_list_and_buffer_length >= max_comment_count && this.is_manual_scroll === false) {\r\n                    this.comment_list.splice(0, Math.max(0, comment_list_and_buffer_length - max_comment_count));\r\n                }\r\n\r\n                // バッファ内のコメントをコメントリストに一括で追加する\r\n                this.comment_list.push(...comment_list_buffer);\r\n                comment_list_buffer.length = 0;  // バッファを空にする\r\n\r\n                // コメントリストを一番下までスクロール\r\n                this.scrollCommentList();\r\n            }\r\n        };\r\n        document.addEventListener('visibilitychange', this.visibilitychange_listener);\r\n    },\r\n    // 終了前に実行\r\n    beforeDestroy() {\r\n\r\n        // ***** イベントリスナーの登録解除 *****\r\n\r\n        // タブの表示/非表示の状態が切り替わったときのイベントを削除\r\n        if (this.visibilitychange_listener !== null) {\r\n            document.removeEventListener('visibilitychange', this.visibilitychange_listener);\r\n            this.visibilitychange_listener = null;\r\n        }\r\n\r\n        // LiveCommentManager からコメントを受信したときのイベントハンドラーを削除\r\n        this.playerStore.event_emitter.off('CommentReceived');  // CommentReceived イベントの全てのイベントハンドラーを削除\r\n        this.playerStore.event_emitter.off('CommentSendCompleted');  // CommentSendCompleted イベントの全てのイベントハンドラーを削除\r\n\r\n        // コメントリストをクリア\r\n        this.comment_list = [];\r\n    },\r\n    methods: {\r\n\r\n        // ドロップダウンメニューを表示する\r\n        showCommentListDropdown(event: Event, comment: ICommentData) {\r\n            const comment_list_wrapper_rect = (this.$refs.comment_list_wrapper as HTMLDivElement).getBoundingClientRect();\r\n            const comment_list_dropdown_height = 106;  // 106px はドロップダウンメニューの高さ\r\n            const comment_button_rect = (event.currentTarget as HTMLElement).getBoundingClientRect();\r\n            // メニューの表示位置をクリックされたコメントに合わせる\r\n            this.comment_list_dropdown_top = comment_button_rect.top - comment_list_wrapper_rect.top;\r\n            // メニューがコメントリストからはみ出るときだけ、表示位置を上側に調整\r\n            if ((this.comment_list_dropdown_top + comment_list_dropdown_height) > comment_list_wrapper_rect.height) {\r\n                this.comment_list_dropdown_top = this.comment_list_dropdown_top - comment_list_dropdown_height + comment_button_rect.height;\r\n            }\r\n            // 表示位置を調整できたので、メニューを表示\r\n            this.comment_list_dropdown_comment = comment;\r\n            this.is_comment_list_dropdown_display = true;\r\n        },\r\n\r\n        // ドロップダウンメニューを非表示にする\r\n        hideCommentListDropdown() {\r\n            this.is_comment_list_dropdown_display = false;\r\n            this.comment_list = this.comment_list.filter((comment) => {\r\n                return CommentUtils.isMutedComment(comment.text, comment.user_id) === false;\r\n            });\r\n        },\r\n\r\n        // コメントのテキストをクリップボードにコピーする\r\n        copyTextToClipboard() {\r\n            if (this.comment_list_dropdown_comment === null) return;\r\n            navigator.clipboard.writeText(this.comment_list_dropdown_comment.text);\r\n            this.hideCommentListDropdown();\r\n        },\r\n\r\n        // ミュートするキーワードを追加する\r\n        addMutedKeywords() {\r\n            if (this.comment_list_dropdown_comment === null) return;\r\n            CommentUtils.addMutedKeywords(this.comment_list_dropdown_comment.text);\r\n            this.hideCommentListDropdown();\r\n        },\r\n\r\n        // ミュートするニコニコユーザー ID を追加する\r\n        addMutedNiconicoUserIds() {\r\n            if (this.comment_list_dropdown_comment === null) return;\r\n            CommentUtils.addMutedNiconicoUserIDs(this.comment_list_dropdown_comment.user_id);\r\n            this.hideCommentListDropdown();\r\n        },\r\n\r\n        // コメントリストを一番下までスクロールする\r\n        async scrollCommentList(smooth: boolean = false) {\r\n            if (this.comment_list_element === null) return;\r\n\r\n            // ドロップダウンメニュー表示中なら手動スクロールモードに設定\r\n            if (this.is_comment_list_dropdown_display === true) {\r\n                this.is_manual_scroll = true;\r\n            }\r\n\r\n            // 手動スクロールモードの時は実行しない\r\n            if (this.is_manual_scroll === true) return;\r\n\r\n            // 自動スクロール中のフラグを立てる\r\n            this.is_auto_scrolling = true;\r\n\r\n            // window.requestAnimationFrame() でアニメーション更新を待ってからスクロールする (重要)\r\n            // すぐに scrollTo() を実行すると、DOM 描画のタイミングの関係なのか、なぜか最後までスクロールされないことがある\r\n            window.requestAnimationFrame(() => {\r\n                if (smooth === true) {  // スムーズスクロール\r\n                    this.comment_list_element?.scrollTo({top: this.comment_list_element.scrollHeight, left: 0, behavior: 'smooth'});\r\n                } else {\r\n                    this.comment_list_element?.scrollTo(0, this.comment_list_element.scrollHeight);\r\n                }\r\n            });\r\n\r\n            // 0.1 秒待つ（重要）\r\n            await Utils.sleep(0.1);\r\n\r\n            // 自動スクロール中のフラグを降ろす\r\n            this.is_auto_scrolling = false;\r\n        },\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.comment-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    .comment-header {\r\n        display: flex;\r\n        align-items: center;\r\n        flex-shrink: 0;\r\n        width: 100%;\r\n        height: 26px;\r\n        padding-left: 16px;\r\n        padding-right: 16px;\r\n        @include tablet-vertical {\r\n            margin-top: 20px;\r\n            padding-left: 24px;\r\n            padding-right: 24px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            margin-top: 12px;\r\n        }\r\n        @include smartphone-vertical {\r\n            margin-top: 14px;\r\n        }\r\n\r\n        &__title {\r\n            display: flex;\r\n            align-items: center;\r\n            font-size: 18.5px;\r\n            font-weight: bold;\r\n            line-height: 145%;\r\n            @include tablet-vertical {\r\n                font-size: 19px;\r\n            }\r\n            @include smartphone-horizontal {\r\n                font-size: 16.5px;\r\n            }\r\n            @include smartphone-vertical {\r\n                font-size: 17px;\r\n            }\r\n\r\n            &-icon {\r\n                margin-bottom: -3px;  // 高さ調整\r\n                @include tablet-vertical {\r\n                    width: 24px;\r\n                    height: 24px;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    height: 17.5px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    height: 18px;\r\n                }\r\n            }\r\n            &-text {\r\n                margin-left: 12px;\r\n                @include tablet-vertical {\r\n                    margin-left: 16px;\r\n                }\r\n            }\r\n        }\r\n\r\n        &__button {\r\n            display: flex;\r\n            align-items: center;\r\n            height: 26px;\r\n            padding: 0 9px;\r\n            border-radius: 4px;\r\n            background: var(--v-background-lighten3);\r\n            font-size: 11px;\r\n            line-height: 1.8;\r\n            letter-spacing: 0;\r\n        }\r\n    }\r\n\r\n    .comment-list-wrapper {\r\n        position: relative;\r\n        width: 100%;\r\n        height: 100%;\r\n        min-height: 0;\r\n        margin-top: 16px;\r\n        @include tablet-vertical {\r\n            margin-top: 20px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            margin-top: 12px;\r\n        }\r\n        @include smartphone-vertical {\r\n            margin-top: 14px;\r\n        }\r\n\r\n        .comment-list-dropdown {\r\n            display: inline-block;\r\n            position: absolute;\r\n            top: var(--comment-list-dropdown-top, 0px);\r\n            right: 16px;\r\n            border-radius: 4px;\r\n            overflow-x: hidden;\r\n            overflow-y: auto;\r\n            box-shadow: 0px 5px 5px -3px rgb(0 0 0 / 20%),\r\n                        0px 8px 10px 1px rgb(0 0 0 / 14%),\r\n                        0px 3px 14px 2px rgb(0 0 0 / 12%);\r\n            opacity: 0;\r\n            visibility: hidden;\r\n            transition: opacity 0.15s ease, visibility 0.15s ease;\r\n            z-index: 8;\r\n            &--display {\r\n                opacity: 1;\r\n                visibility: visible;\r\n            }\r\n        }\r\n\r\n        .comment-list-cover {\r\n            display: none;\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            z-index: 7;\r\n            &--display {\r\n                display: block;\r\n            }\r\n        }\r\n\r\n        .comment-list {\r\n            width: 100%;\r\n            height: 100%;\r\n            padding-left: 16px;\r\n            padding-right: 10px;\r\n            padding-bottom: 12px;\r\n            overflow-y: scroll !important;\r\n            @include tablet-vertical {\r\n                padding-left: 24px;\r\n                padding-right: 18px;\r\n                padding-bottom: 0px;\r\n            }\r\n            @include smartphone-vertical {\r\n                padding-bottom: 0px;\r\n            }\r\n\r\n            .comment {\r\n                display: flex;\r\n                position: relative;\r\n                align-items: center;\r\n                min-height: 28px;\r\n                padding-top: 6px;\r\n                word-break: break-all;\r\n                &--my-post {\r\n                    color: var(--v-secondary-lighten2);\r\n                }\r\n\r\n                &__text {\r\n                    font-size: 13px;\r\n                }\r\n\r\n                &__time {\r\n                    flex-shrink: 0;\r\n                    margin-left: auto;\r\n                    padding-left: 8px;\r\n                    color: var(--v-text-darken1);\r\n                    font-size: 13px;\r\n                }\r\n\r\n                &__icon {\r\n                    width: 20px;\r\n                    height: 20px;\r\n                    margin-left: 8px;\r\n                    border-radius: 5px;\r\n                    color: var(--v-text-base);\r\n                    cursor: pointer;\r\n                }\r\n            }\r\n        }\r\n\r\n        .comment-announce {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            flex-direction: column;\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            padding-left: 12px;\r\n            padding-right: 12px;\r\n\r\n            &__heading {\r\n                font-size: 20px;\r\n                font-weight: bold;\r\n                @include smartphone-horizontal {\r\n                    font-size: 16px;\r\n                }\r\n            }\r\n            &__text {\r\n                margin-top: 12px;\r\n                color: var(--v-text-darken1);\r\n                font-size: 13.5px;\r\n                text-align: center;\r\n                @include smartphone-horizontal {\r\n                    font-size: 12px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .comment-scroll-button {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        position: absolute;\r\n        left: 0px;\r\n        right: 0px;\r\n        bottom: 22px;\r\n        width: 42px;\r\n        height: 42px;\r\n        margin: 0 auto;\r\n        border-radius: 50%;\r\n        background: var(--v-primary-base);\r\n        transition: background-color 0.15s, opacity 0.3s, visibility 0.3s;\r\n        visibility: hidden;\r\n        opacity: 0;\r\n        user-select: none;\r\n        cursor: pointer;\r\n\r\n        &--display {\r\n            opacity: 1;\r\n            visibility: visible;\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Comment.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Comment.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Comment.vue?vue&type=template&id=2080c210&scoped=true\"\nimport script from \"./Comment.vue?vue&type=script&lang=ts\"\nexport * from \"./Comment.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Comment.vue?vue&type=style&index=0&id=2080c210&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2080c210\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"program-container\"},[_c('section',{staticClass:\"program-broadcaster\"},[_c('img',{staticClass:\"program-broadcaster__icon\",attrs:{\"src\":`${_vm.Utils.api_base_url}/channels/${_vm.channelsStore.channel.current.id}/logo`}}),_c('div',{staticClass:\"program-broadcaster__number\"},[_vm._v(\"Ch: \"+_vm._s(_vm.channelsStore.channel.current.channel_number))]),_c('div',{staticClass:\"program-broadcaster__name\"},[_vm._v(_vm._s(_vm.channelsStore.channel.current.name))])]),_c('section',{staticClass:\"program-info\"},[_c('h1',{staticClass:\"program-info__title\",domProps:{\"innerHTML\":_vm._s(_vm.ProgramUtils.decorateProgramInfo(_vm.channelsStore.channel.current.program_present, 'title'))}}),_c('div',{staticClass:\"program-info__time\"},[_vm._v(\" \"+_vm._s(_vm.ProgramUtils.getProgramTime(_vm.channelsStore.channel.current.program_present))+\" \")]),_c('div',{staticClass:\"program-info__description\",domProps:{\"innerHTML\":_vm._s(_vm.ProgramUtils.decorateProgramInfo(_vm.channelsStore.channel.current.program_present, 'description'))}}),_c('div',{staticClass:\"program-info__genre-container\"},_vm._l((_vm.channelsStore.channel.current.program_present?.genres ?? []),function(genre,genre_index){return _c('div',{key:genre_index,staticClass:\"program-info__genre\"},[_vm._v(\" \"+_vm._s(genre.major)+\" / \"+_vm._s(genre.middle)+\" \")])}),0),_c('div',{staticClass:\"program-info__next\"},[_c('span',{staticClass:\"program-info__next-decorate\"},[_vm._v(\"NEXT\")]),_c('Icon',{staticClass:\"program-info__next-icon\",attrs:{\"icon\":\"fluent:fast-forward-20-filled\",\"width\":\"16px\"}})],1),_c('span',{staticClass:\"program-info__next-title\",domProps:{\"innerHTML\":_vm._s(_vm.ProgramUtils.decorateProgramInfo(_vm.channelsStore.channel.current.program_following, 'title'))}}),_c('div',{staticClass:\"program-info__next-time\"},[_vm._v(\" \"+_vm._s(_vm.ProgramUtils.getProgramTime(_vm.channelsStore.channel.current.program_following))+\" \")]),_c('div',{staticClass:\"program-info__status\"},[_c('div',{staticClass:\"program-info__status-force\",class:`program-info__status-force--${_vm.ChannelUtils.getChannelForceType(_vm.channelsStore.channel.current.jikkyo_force)}`},[_c('Icon',{attrs:{\"icon\":\"fa-solid:fire-alt\",\"height\":\"14px\"}}),_c('span',{staticClass:\"ml-2\"},[_vm._v(\"勢い:\")]),_c('span',{staticClass:\"ml-2\"},[_vm._v(_vm._s(_vm.channelsStore.channel.current.jikkyo_force ?? '--')+\" コメ/分\")])],1),_c('div',{staticClass:\"program-info__status-viewers ml-5\"},[_c('Icon',{attrs:{\"icon\":\"fa-solid:eye\",\"height\":\"14px\"}}),_c('span',{staticClass:\"ml-2\"},[_vm._v(\"視聴数:\")]),_c('span',{staticClass:\"ml-1\"},[_vm._v(_vm._s(_vm.channelsStore.channel.current.viewer_count))])],1)])]),_c('section',{staticClass:\"program-detail-container\"},_vm._l((_vm.channelsStore.channel.current.program_present?.detail ?? {}),function(detail_text,detail_heading){return _c('div',{key:detail_heading,staticClass:\"program-detail\"},[_c('h2',{staticClass:\"program-detail__heading\"},[_vm._v(_vm._s(detail_heading))]),_c('div',{staticClass:\"program-detail__text\",domProps:{\"innerHTML\":_vm._s(_vm.Utils.URLtoLink(detail_text))}})])}),0)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"program-container\">\r\n        <section class=\"program-broadcaster\">\r\n            <img class=\"program-broadcaster__icon\" :src=\"`${Utils.api_base_url}/channels/${channelsStore.channel.current.id}/logo`\">\r\n            <div class=\"program-broadcaster__number\">Ch: {{channelsStore.channel.current.channel_number}}</div>\r\n            <div class=\"program-broadcaster__name\">{{channelsStore.channel.current.name}}</div>\r\n        </section>\r\n        <section class=\"program-info\">\r\n            <h1 class=\"program-info__title\"\r\n                v-html=\"ProgramUtils.decorateProgramInfo(channelsStore.channel.current.program_present, 'title')\">\r\n            </h1>\r\n            <div class=\"program-info__time\">\r\n                {{ProgramUtils.getProgramTime(channelsStore.channel.current.program_present)}}\r\n            </div>\r\n            <div class=\"program-info__description\"\r\n                v-html=\"ProgramUtils.decorateProgramInfo(channelsStore.channel.current.program_present, 'description')\">\r\n            </div>\r\n            <div class=\"program-info__genre-container\">\r\n                <div class=\"program-info__genre\" :key=\"genre_index\"\r\n                    v-for=\"(genre, genre_index) in channelsStore.channel.current.program_present?.genres ?? []\">\r\n                    {{genre.major}} / {{genre.middle}}\r\n                </div>\r\n            </div>\r\n            <div class=\"program-info__next\">\r\n                <span class=\"program-info__next-decorate\">NEXT</span>\r\n                <Icon class=\"program-info__next-icon\" icon=\"fluent:fast-forward-20-filled\" width=\"16px\" />\r\n            </div>\r\n            <span class=\"program-info__next-title\"\r\n                v-html=\"ProgramUtils.decorateProgramInfo(channelsStore.channel.current.program_following, 'title')\">\r\n            </span>\r\n            <div class=\"program-info__next-time\">\r\n                {{ProgramUtils.getProgramTime(channelsStore.channel.current.program_following)}}\r\n            </div>\r\n            <div class=\"program-info__status\">\r\n                <div class=\"program-info__status-force\"\r\n                    :class=\"`program-info__status-force--${ChannelUtils.getChannelForceType(channelsStore.channel.current.jikkyo_force)}`\">\r\n                    <Icon icon=\"fa-solid:fire-alt\" height=\"14px\" />\r\n                    <span class=\"ml-2\">勢い:</span>\r\n                    <span class=\"ml-2\">{{channelsStore.channel.current.jikkyo_force ?? '--'}} コメ/分</span>\r\n                </div>\r\n                <div class=\"program-info__status-viewers ml-5\">\r\n                    <Icon icon=\"fa-solid:eye\" height=\"14px\" />\r\n                    <span class=\"ml-2\">視聴数:</span>\r\n                    <span class=\"ml-1\">{{channelsStore.channel.current.viewer_count}}</span>\r\n                </div>\r\n            </div>\r\n        </section>\r\n        <section class=\"program-detail-container\">\r\n            <div class=\"program-detail\" :key=\"detail_heading\"\r\n                v-for=\"(detail_text, detail_heading) in channelsStore.channel.current.program_present?.detail ?? {}\">\r\n                <h2 class=\"program-detail__heading\">{{detail_heading}}</h2>\r\n                <div class=\"program-detail__text\" v-html=\"Utils.URLtoLink(detail_text)\"></div>\r\n            </div>\r\n        </section>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport Utils, { ChannelUtils, ProgramUtils } from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'Panel-ProgramTab',\r\n    data() {\r\n        return {\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n            ChannelUtils: Object.freeze(ChannelUtils),\r\n            ProgramUtils: Object.freeze(ProgramUtils),\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useChannelsStore),\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.program-container {\r\n    padding-left: 16px;\r\n    padding-right: 16px;\r\n    overflow-y: auto;\r\n    @include tablet-vertical {\r\n        padding-left: 24px;\r\n        padding-right: 24px;\r\n    }\r\n\r\n    .program-broadcaster {\r\n        display: none;\r\n        align-items: center;\r\n        min-width: 0;\r\n        @include tablet-vertical {\r\n            display: flex;\r\n            margin-top: 20px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            display: flex;\r\n            margin-top: 16px;\r\n        }\r\n        @include smartphone-vertical {\r\n            display: flex;\r\n            margin-top: 16px;\r\n        }\r\n\r\n        &__icon {\r\n            display: inline-block;\r\n            flex-shrink: 0;\r\n            width: 43px;\r\n            height: 24px;\r\n            border-radius: 3px;\r\n            background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n            object-fit: cover;\r\n            user-select: none;\r\n            @include tablet-vertical {\r\n                width: 58px;\r\n                height: 32px;\r\n            }\r\n            @include smartphone-horizontal {\r\n                width: 42px;\r\n                height: 23.5px;\r\n            }\r\n            @include smartphone-vertical {\r\n                width: 58px;\r\n                height: 32px;\r\n            }\r\n        }\r\n\r\n        &__number {\r\n            flex-shrink: 0;\r\n            margin-left: 12px;\r\n            font-size: 16.5px;\r\n            @include tablet-vertical {\r\n                margin-left: 16px;\r\n                font-size: 19px;\r\n            }\r\n        }\r\n\r\n        &__name {\r\n            margin-left: 5px;\r\n            font-size: 16.5px;\r\n            overflow: hidden;\r\n            white-space: nowrap;\r\n            text-overflow: ellipsis;\r\n            @include tablet-vertical {\r\n                margin-left: 8px;\r\n                font-size: 19px;\r\n            }\r\n            @include smartphone-vertical {\r\n                font-size: 18px;\r\n            }\r\n        }\r\n    }\r\n\r\n    .program-info {\r\n        .program-info__title {\r\n            font-size: 22px;\r\n            font-weight: bold;\r\n            line-height: 145%;\r\n            font-feature-settings: \"palt\" 1;  // 文字詰め\r\n            letter-spacing: 0.05em;  // 字間を少し空ける\r\n            @include tablet-vertical {\r\n                margin-top: 16px;\r\n            }\r\n            @include smartphone-horizontal {\r\n                margin-top: 10px;\r\n                font-size: 18px;\r\n            }\r\n            @include smartphone-vertical {\r\n                margin-top: 16px;\r\n                font-size: 19px;\r\n            }\r\n        }\r\n        .program-info__time {\r\n            margin-top: 8px;\r\n            color: var(--v-text-darken1);\r\n            font-size: 14px;\r\n            @include smartphone-horizontal {\r\n                font-size: 13px;\r\n            }\r\n        }\r\n        .program-info__description {\r\n            margin-top: 12px;\r\n            color: var(--v-text-darken1);\r\n            font-size: 12px;\r\n            line-height: 168%;\r\n            overflow-wrap: break-word;\r\n            font-feature-settings: \"palt\" 1;  // 文字詰め\r\n            letter-spacing: 0.08em;  // 字間を少し空ける\r\n            @include smartphone-horizontal {\r\n                margin-top: 8px;\r\n                font-size: 11px;\r\n            }\r\n        }\r\n        .program-info__genre-container {\r\n            display: flex;\r\n            flex-wrap: wrap;\r\n            margin-top: 10px;\r\n\r\n            .program-info__genre {\r\n                display: inline-block;\r\n                font-size: 10.5px;\r\n                padding: 3px;\r\n                margin-top: 4px;\r\n                margin-right: 4px;\r\n                border-radius: 4px;\r\n                background: var(--v-background-lighten2);\r\n                @include smartphone-horizontal {\r\n                    font-size: 9px;\r\n                }\r\n            }\r\n        }\r\n        .program-info__next {\r\n            display: flex;\r\n            align-items: center;\r\n            margin-top: 18px;\r\n            color: var(--v-text-base);\r\n            font-size: 14px;\r\n            font-weight: bold;\r\n            user-select: none;\r\n            @include smartphone-horizontal {\r\n                margin-top: 14px;\r\n                font-size: 13px;\r\n            }\r\n            &-decorate {\r\n                flex-shrink: 0;\r\n            }\r\n            &-icon {\r\n                flex-shrink: 0;\r\n                margin-left: 3px;\r\n                font-size: 15px;\r\n            }\r\n        }\r\n        .program-info__next-title {\r\n            display: -webkit-box;\r\n            margin-top: 2px;\r\n            color: var(--v-text-base);\r\n            font-size: 14px;\r\n            font-weight: bold;\r\n            overflow: hidden;\r\n            -webkit-line-clamp: 2;  // 2行までに制限\r\n            -webkit-box-orient: vertical;\r\n            @include smartphone-horizontal {\r\n                font-size: 13px;\r\n            }\r\n        }\r\n        .program-info__next-time {\r\n            margin-top: 3px;\r\n            color: var(--v-text-darken1);\r\n            font-size: 13.5px;\r\n        }\r\n\r\n        .program-info__status {\r\n            display: flex;\r\n            align-items: center;\r\n            margin-top: 16px;\r\n            font-size: 14px;\r\n            color: var(--v-text-darken1);\r\n            @include smartphone-horizontal {\r\n                margin-top: 10px;\r\n                font-size: 12px;\r\n            }\r\n\r\n            &-force, &-viewers {\r\n                display: flex;\r\n                align-items: center;\r\n            }\r\n\r\n            &-force--festival {\r\n                color: #E7556E;\r\n            }\r\n            &-force--so-many {\r\n                color: #E76B55;\r\n            }\r\n            &-force--many {\r\n                color: #E7A355;\r\n            }\r\n        }\r\n    }\r\n\r\n    .program-detail-container {\r\n        margin-top: 24px;\r\n        margin-bottom: 24px;\r\n        @include tablet-vertical {\r\n            margin-top: 20px;\r\n            margin-bottom: 20px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            margin-top: 20px;\r\n            margin-bottom: 16px;\r\n        }\r\n\r\n        .program-detail {\r\n            margin-top: 16px;\r\n\r\n            .program-detail__heading {\r\n                font-size: 18px;\r\n                @include smartphone-horizontal {\r\n                    font-size: 16px;\r\n                }\r\n            }\r\n            .program-detail__text {\r\n                margin-top: 8px;\r\n                color: var(--v-text-darken1);\r\n                font-size: 12px;\r\n                line-height: 168%;\r\n                overflow-wrap: break-word;\r\n                white-space: pre-wrap;  // \\n で改行する\r\n                font-feature-settings: \"palt\" 1;  // 文字詰め\r\n                letter-spacing: 0.08em;  // 字間を少し空ける\r\n                @include smartphone-horizontal {\r\n                    font-size: 11px;\r\n                }\r\n\r\n                // リンクの色\r\n                :deep(a:link), :deep(a:visited) {\r\n                    color: var(--v-primary-lighten1);\r\n                    text-underline-offset: 3px;  // 下線と字の間隔を空ける\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Program.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Program.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Program.vue?vue&type=template&id=2d7a5a51&scoped=true\"\nimport script from \"./Program.vue?vue&type=script&lang=ts\"\nexport * from \"./Program.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Program.vue?vue&type=style&index=0&id=2d7a5a51&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2d7a5a51\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"program-container\"},[_c('section',{staticClass:\"program-info\"},[_c('h1',{staticClass:\"program-info__title\",domProps:{\"innerHTML\":_vm._s(_vm.ProgramUtils.decorateProgramInfo(_vm.playerStore.recorded_program, 'title'))}}),(_vm.playerStore.recorded_program.channel !== null)?_c('div',{staticClass:\"program-info__broadcaster\"},[_c('img',{staticClass:\"program-info__broadcaster-icon\",attrs:{\"src\":`${_vm.Utils.api_base_url}/channels/${_vm.playerStore.recorded_program.channel.id}/logo`}}),_c('div',{staticClass:\"program-info__broadcaster-container\"},[_c('div',{staticClass:\"d-flex align-center\"},[_c('div',{staticClass:\"program-info__broadcaster-number\"},[_vm._v(\"Ch: \"+_vm._s(_vm.playerStore.recorded_program.channel.channel_number))]),_c('div',{staticClass:\"program-info__broadcaster-name\"},[_vm._v(_vm._s(_vm.playerStore.recorded_program.channel.name))])]),_c('div',{staticClass:\"program-info__broadcaster-time\"},[_vm._v(\" \"+_vm._s(_vm.ProgramUtils.getProgramTime(_vm.playerStore.recorded_program))+\" \")])])]):_vm._e(),_c('div',{staticClass:\"program-info__description\",domProps:{\"innerHTML\":_vm._s(_vm.ProgramUtils.decorateProgramInfo(_vm.playerStore.recorded_program, 'description'))}}),_c('div',{staticClass:\"program-info__genre-container\"},_vm._l((_vm.playerStore.recorded_program.genres ?? []),function(genre,genre_index){return _c('div',{key:genre_index,staticClass:\"program-info__genre\"},[_vm._v(\" \"+_vm._s(genre.major)+\" / \"+_vm._s(genre.middle)+\" \")])}),0),_c('div',{staticClass:\"program-info__status\"},[_c('div',{staticClass:\"program-info__status-force\"},[_c('Icon',{staticStyle:{\"margin-top\":\"3px\"},attrs:{\"icon\":\"bi:chat-left-text-fill\",\"height\":\"14px\"}}),_c('span',{staticClass:\"ml-2\"},[_vm._v(\"コメント数:\")]),_c('span',{staticClass:\"ml-2\"},[_vm._v(_vm._s(_vm.comment_count ?? '--'))])],1)])]),_c('section',{staticClass:\"program-detail-container\"},_vm._l((_vm.playerStore.recorded_program.detail ?? {}),function(detail_text,detail_heading){return _c('div',{key:detail_heading,staticClass:\"program-detail\"},[_c('h2',{staticClass:\"program-detail__heading\"},[_vm._v(_vm._s(detail_heading))]),_c('div',{staticClass:\"program-detail__text\",domProps:{\"innerHTML\":_vm._s(_vm.Utils.URLtoLink(detail_text))}})])}),0)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"program-container\">\r\n        <section class=\"program-info\">\r\n            <h1 class=\"program-info__title\"\r\n                v-html=\"ProgramUtils.decorateProgramInfo(playerStore.recorded_program, 'title')\">\r\n            </h1>\r\n            <div class=\"program-info__broadcaster\" v-if=\"playerStore.recorded_program.channel !== null\">\r\n                <img class=\"program-info__broadcaster-icon\" :src=\"`${Utils.api_base_url}/channels/${playerStore.recorded_program.channel.id}/logo`\">\r\n                <div class=\"program-info__broadcaster-container\">\r\n                    <div class=\"d-flex align-center\">\r\n                        <div class=\"program-info__broadcaster-number\">Ch: {{playerStore.recorded_program.channel.channel_number}}</div>\r\n                        <div class=\"program-info__broadcaster-name\">{{playerStore.recorded_program.channel.name}}</div>\r\n                    </div>\r\n                    <div class=\"program-info__broadcaster-time\">\r\n                        {{ProgramUtils.getProgramTime(playerStore.recorded_program)}}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"program-info__description\"\r\n                v-html=\"ProgramUtils.decorateProgramInfo(playerStore.recorded_program, 'description')\">\r\n            </div>\r\n            <div class=\"program-info__genre-container\">\r\n                <div class=\"program-info__genre\" :key=\"genre_index\"\r\n                    v-for=\"(genre, genre_index) in playerStore.recorded_program.genres ?? []\">\r\n                    {{genre.major}} / {{genre.middle}}\r\n                </div>\r\n            </div>\r\n            <div class=\"program-info__status\">\r\n                <div class=\"program-info__status-force\">\r\n                    <Icon icon=\"bi:chat-left-text-fill\" height=\"14px\" style=\"margin-top: 3px\" />\r\n                    <span class=\"ml-2\">コメント数:</span>\r\n                    <span class=\"ml-2\">{{comment_count ?? '--'}}</span>\r\n                </div>\r\n            </div>\r\n        </section>\r\n        <section class=\"program-detail-container\">\r\n            <div class=\"program-detail\" :key=\"detail_heading\"\r\n                v-for=\"(detail_text, detail_heading) in playerStore.recorded_program.detail ?? {}\">\r\n                <h2 class=\"program-detail__heading\">{{detail_heading}}</h2>\r\n                <div class=\"program-detail__text\" v-html=\"Utils.URLtoLink(detail_text)\"></div>\r\n            </div>\r\n        </section>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport Utils, { ProgramUtils } from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'Panel-RecordedProgramTab',\r\n    data() {\r\n        return {\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n            ProgramUtils: Object.freeze(ProgramUtils),\r\n\r\n            // コメント数カウント\r\n            comment_count: null as number | null,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(usePlayerStore),\r\n    },\r\n    created() {\r\n        // PlayerController 側からCommentReceived イベントで過去ログコメントを受け取り、コメント数を算出する\r\n        this.playerStore.event_emitter.on('CommentReceived', (event) => {\r\n            if (event.is_initial_comments === true) {  // 録画では初期コメントしか発生しない\r\n                this.comment_count = event.comments.length;\r\n            }\r\n        });\r\n    },\r\n    beforeDestroy() {\r\n        // CommentReceived イベントの全てのイベントハンドラーを削除\r\n        this.playerStore.event_emitter.off('CommentReceived');\r\n    },\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.program-container {\r\n    padding-left: 16px;\r\n    padding-right: 16px;\r\n    overflow-y: auto;\r\n    @include tablet-vertical {\r\n        padding-left: 24px;\r\n        padding-right: 24px;\r\n    }\r\n\r\n    .program-info {\r\n        .program-info__title {\r\n            font-size: 22px;\r\n            font-weight: bold;\r\n            line-height: 145%;\r\n            font-feature-settings: \"palt\" 1;  // 文字詰め\r\n            letter-spacing: 0.05em;  // 字間を少し空ける\r\n            @include tablet-vertical {\r\n                margin-top: 16px;\r\n            }\r\n            @include smartphone-horizontal {\r\n                margin-top: 10px;\r\n                font-size: 18px;\r\n            }\r\n            @include smartphone-vertical {\r\n                margin-top: 16px;\r\n                font-size: 19px;\r\n            }\r\n        }\r\n        .program-info__broadcaster {\r\n            display: flex;\r\n            align-items: center;\r\n            min-width: 0;\r\n            margin-top: 16px;\r\n            color: var(--v-text-darken1);\r\n            &-icon {\r\n                display: inline-block;\r\n                flex-shrink: 0;\r\n                width: 44px;\r\n                height: 36px;\r\n                border-radius: 3px;\r\n                background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n                object-fit: cover;\r\n                user-select: none;\r\n                @include tablet-vertical {\r\n                    width: 58px;\r\n                    height: 32px;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    width: 42px;\r\n                    height: 23.5px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    width: 58px;\r\n                    height: 32px;\r\n                }\r\n            }\r\n            .program-info__broadcaster-container {\r\n                display: flex;\r\n                flex-direction: column;\r\n                margin-left: 12px;\r\n                .program-info__broadcaster-number {\r\n                    flex-shrink: 0;\r\n                    font-size: 14px;\r\n                    @include tablet-vertical {\r\n                        margin-left: 16px;\r\n                        font-size: 13px;\r\n                    }\r\n                }\r\n                .program-info__broadcaster-name {\r\n                    margin-left: 5px;\r\n                    font-size: 14px;\r\n                    overflow: hidden;\r\n                    white-space: nowrap;\r\n                    text-overflow: ellipsis;\r\n                    @include tablet-vertical {\r\n                        margin-left: 8px;\r\n                        font-size: 13px;\r\n                    }\r\n                    @include smartphone-vertical {\r\n                        font-size: 13px;\r\n                    }\r\n                }\r\n                .program-info__broadcaster-time {\r\n                    margin-top: 2px;\r\n                    color: var(--v-text-darken1);\r\n                    font-size: 13.5px;\r\n                    @include smartphone-horizontal {\r\n                        font-size: 12.5px;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        .program-info__description {\r\n            margin-top: 12px;\r\n            color: var(--v-text-darken1);\r\n            font-size: 12px;\r\n            line-height: 168%;\r\n            overflow-wrap: break-word;\r\n            font-feature-settings: \"palt\" 1;  // 文字詰め\r\n            letter-spacing: 0.08em;  // 字間を少し空ける\r\n            @include smartphone-horizontal {\r\n                margin-top: 8px;\r\n                font-size: 11px;\r\n            }\r\n        }\r\n        .program-info__genre-container {\r\n            display: flex;\r\n            flex-wrap: wrap;\r\n            margin-top: 10px;\r\n\r\n            .program-info__genre {\r\n                display: inline-block;\r\n                font-size: 10.5px;\r\n                padding: 3px;\r\n                margin-top: 4px;\r\n                margin-right: 4px;\r\n                border-radius: 4px;\r\n                background: var(--v-background-lighten2);\r\n                @include smartphone-horizontal {\r\n                    font-size: 9px;\r\n                }\r\n            }\r\n        }\r\n\r\n        .program-info__status {\r\n            display: flex;\r\n            align-items: center;\r\n            margin-top: 16px;\r\n            font-size: 14px;\r\n            color: var(--v-text-darken1);\r\n            @include smartphone-horizontal {\r\n                margin-top: 10px;\r\n                font-size: 12px;\r\n            }\r\n\r\n            &-force, &-viewers {\r\n                display: flex;\r\n                align-items: center;\r\n            }\r\n        }\r\n    }\r\n\r\n    .program-detail-container {\r\n        margin-top: 24px;\r\n        margin-bottom: 24px;\r\n        @include tablet-vertical {\r\n            margin-top: 20px;\r\n            margin-bottom: 20px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            margin-top: 20px;\r\n            margin-bottom: 16px;\r\n        }\r\n\r\n        .program-detail {\r\n            margin-top: 16px;\r\n\r\n            .program-detail__heading {\r\n                font-size: 18px;\r\n                @include smartphone-horizontal {\r\n                    font-size: 16px;\r\n                }\r\n            }\r\n            .program-detail__text {\r\n                margin-top: 8px;\r\n                color: var(--v-text-darken1);\r\n                font-size: 12px;\r\n                line-height: 168%;\r\n                overflow-wrap: break-word;\r\n                white-space: pre-wrap;  // \\n で改行する\r\n                font-feature-settings: \"palt\" 1;  // 文字詰め\r\n                letter-spacing: 0.08em;  // 字間を少し空ける\r\n                @include smartphone-horizontal {\r\n                    font-size: 11px;\r\n                }\r\n\r\n                // リンクの色\r\n                :deep(a:link), :deep(a:visited) {\r\n                    color: var(--v-primary-lighten1);\r\n                    text-underline-offset: 3px;  // 下線と字の間隔を空ける\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./RecordedProgram.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./RecordedProgram.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./RecordedProgram.vue?vue&type=template&id=08a0f40d&scoped=true\"\nimport script from \"./RecordedProgram.vue?vue&type=script&lang=ts\"\nexport * from \"./RecordedProgram.vue?vue&type=script&lang=ts\"\nimport style0 from \"./RecordedProgram.vue?vue&type=style&index=0&id=08a0f40d&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"08a0f40d\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"remote-control-container\",class:{'remote-control-container--showing': _vm.modelValue},on:{\"click\":function($event){return _vm.$emit('update:modelValue', false)}}},[_c('div',{staticClass:\"remote-control elevation-6\",on:{\"click\":function($event){$event.stopPropagation();}}},[_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control__close d-flex align-center rounded-circle cursor-pointer px-2 py-2\",on:{\"click\":function($event){return _vm.$emit('update:modelValue', false)}}},[_c('Icon',{attrs:{\"icon\":\"fluent:dismiss-12-filled\",\"width\":\"23px\",\"height\":\"23px\"}})],1),_c('div',{staticClass:\"remote-control-data-broadcasting remote-control-data-broadcasting--disabled\"},[_c('v-progress-circular',{staticClass:\"remote-control__loading\",attrs:{\"indeterminate\":\"\",\"size\":\"60\",\"width\":\"6\"}}),_c('div',{staticClass:\"remote-control__directional-key\"},[_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control-button-up\",attrs:{\"data-arib-key-code\":\"1\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:chevron-up-12-filled\",\"width\":\"26px\",\"height\":\"26px\"}})],1),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control-button-left\",attrs:{\"data-arib-key-code\":\"3\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:chevron-left-12-filled\",\"width\":\"26px\",\"height\":\"26px\"}})],1),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control-button-select\",attrs:{\"data-arib-key-code\":\"18\"}},[_vm._v(\" 決定 \")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control-button-right\",attrs:{\"data-arib-key-code\":\"4\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:chevron-right-12-filled\",\"width\":\"26px\",\"height\":\"26px\"}})],1),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control-button-down\",attrs:{\"data-arib-key-code\":\"2\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:chevron-down-12-filled\",\"width\":\"26px\",\"height\":\"26px\"}})],1)]),_c('div',{staticClass:\"remote-control__control-key\"},[_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control-button-data\",attrs:{\"data-arib-key-code\":\"20\"}},[_c('svg',{attrs:{\"width\":\"20px\",\"height\":\"20px\",\"viewBox\":\"0 0 512 512\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M248.039 381.326L355.039 67.8258C367.539 28.3257 395.039 34.3258 406.539 34.3258C431.039 34.3258 453.376 61.3258 441.039 96.8258C362.639 322.426 343.539 375.326 340.539 384.826C338.486 391.326 342.039 391.326 345.539 391.326C377.039 391.326 386.539 418.326 386.539 435.326C386.539 458.826 371.539 477.326 350.039 477.326H214.539C179.039 477.326 85.8269 431.3 88.0387 335.826C91.0387 206.326 192.039 183.326 243.539 183.326H296.539L265.539 272.326H243.539C185.539 272.326 174.113 314.826 176.039 334.326C180.039 374.826 215.039 389.814 237.039 390.326C244.539 390.5 246.039 386.826 248.039 381.326Z\"}})]),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"データ\")])]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control-button-back\",attrs:{\"data-arib-key-code\":\"19\"}},[_c('Icon',{attrs:{\"icon\":\"fluent:arrow-left-12-filled\",\"width\":\"20px\"}}),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"戻る\")])],1),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control-button-blue blue darken-3\",attrs:{\"data-arib-key-code\":\"21\"}},[_vm._v(\"青\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control-button-red red darken-3\",attrs:{\"data-arib-key-code\":\"22\"}},[_vm._v(\"赤\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control-button-green green darken-3\",attrs:{\"data-arib-key-code\":\"23\"}},[_vm._v(\"緑\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"remote-control-button-yellow yellow darken-3\",attrs:{\"data-arib-key-code\":\"24\"}},[_vm._v(\"黄\")])])],1),_c('div',{staticClass:\"remote-control__number-key\"},[_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"1\",\"data-arib-key-code\":\"6\"}},[_vm._v(\"1\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"2\",\"data-arib-key-code\":\"7\"}},[_vm._v(\"2\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"3\",\"data-arib-key-code\":\"8\"}},[_vm._v(\"3\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"4\",\"data-arib-key-code\":\"9\"}},[_vm._v(\"4\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"5\",\"data-arib-key-code\":\"10\"}},[_vm._v(\"5\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"6\",\"data-arib-key-code\":\"11\"}},[_vm._v(\"6\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"7\",\"data-arib-key-code\":\"12\"}},[_vm._v(\"7\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"8\",\"data-arib-key-code\":\"13\"}},[_vm._v(\"8\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"9\",\"data-arib-key-code\":\"14\"}},[_vm._v(\"9\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"10\",\"data-arib-key-code\":\"15\"}},[_vm._v(\"10\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"11\",\"data-arib-key-code\":\"16\"}},[_vm._v(\"11\")]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],attrs:{\"data-remocon-id\":\"12\",\"data-arib-key-code\":\"17\"}},[_vm._v(\"12\")])])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"remote-control-container\" :class=\"{'remote-control-container--showing': modelValue}\"\r\n        @click=\"$emit('update:modelValue', false)\">\r\n        <div class=\"remote-control elevation-6\" @click.stop>\r\n            <div v-ripple class=\"remote-control__close d-flex align-center rounded-circle cursor-pointer px-2 py-2\"\r\n                @click=\"$emit('update:modelValue', false)\">\r\n                <Icon icon=\"fluent:dismiss-12-filled\" width=\"23px\" height=\"23px\" />\r\n            </div>\r\n            <div class=\"remote-control-data-broadcasting remote-control-data-broadcasting--disabled\">\r\n                <v-progress-circular indeterminate size=\"60\" width=\"6\" class=\"remote-control__loading\"></v-progress-circular>\r\n                <div class=\"remote-control__directional-key\">\r\n                    <button v-ripple class=\"remote-control-button-up\" data-arib-key-code=\"1\">\r\n                        <Icon icon=\"fluent:chevron-up-12-filled\" width=\"26px\" height=\"26px\"></Icon>\r\n                    </button>\r\n                    <button v-ripple class=\"remote-control-button-left\" data-arib-key-code=\"3\">\r\n                        <Icon icon=\"fluent:chevron-left-12-filled\" width=\"26px\" height=\"26px\"></Icon>\r\n                    </button>\r\n                    <button v-ripple class=\"remote-control-button-select\" data-arib-key-code=\"18\">\r\n                        決定\r\n                    </button>\r\n                    <button v-ripple class=\"remote-control-button-right\" data-arib-key-code=\"4\">\r\n                        <Icon icon=\"fluent:chevron-right-12-filled\" width=\"26px\" height=\"26px\"></Icon>\r\n                    </button>\r\n                    <button v-ripple class=\"remote-control-button-down\" data-arib-key-code=\"2\">\r\n                        <Icon icon=\"fluent:chevron-down-12-filled\" width=\"26px\" height=\"26px\"></Icon>\r\n                    </button>\r\n                </div>\r\n                <div class=\"remote-control__control-key\">\r\n                    <button v-ripple class=\"remote-control-button-data\" data-arib-key-code=\"20\">\r\n                        <svg width=\"20px\" height=\"20px\" viewBox=\"0 0 512 512\">\r\n                            <path fill=\"currentColor\" d=\"M248.039 381.326L355.039 67.8258C367.539 28.3257 395.039 34.3258 406.539 34.3258C431.039 34.3258 453.376 61.3258 441.039 96.8258C362.639 322.426 343.539 375.326 340.539 384.826C338.486 391.326 342.039 391.326 345.539 391.326C377.039 391.326 386.539 418.326 386.539 435.326C386.539 458.826 371.539 477.326 350.039 477.326H214.539C179.039 477.326 85.8269 431.3 88.0387 335.826C91.0387 206.326 192.039 183.326 243.539 183.326H296.539L265.539 272.326H243.539C185.539 272.326 174.113 314.826 176.039 334.326C180.039 374.826 215.039 389.814 237.039 390.326C244.539 390.5 246.039 386.826 248.039 381.326Z\" />\r\n                        </svg>\r\n                        <span class=\"ml-1\">データ</span>\r\n                    </button>\r\n                    <button v-ripple class=\"remote-control-button-back\" data-arib-key-code=\"19\">\r\n                        <Icon icon=\"fluent:arrow-left-12-filled\" width=\"20px\" />\r\n                        <span class=\"ml-1\">戻る</span>\r\n                    </button>\r\n                    <button v-ripple class=\"remote-control-button-blue blue darken-3\" data-arib-key-code=\"21\">青</button>\r\n                    <button v-ripple class=\"remote-control-button-red red darken-3\" data-arib-key-code=\"22\">赤</button>\r\n                    <button v-ripple class=\"remote-control-button-green green darken-3\" data-arib-key-code=\"23\">緑</button>\r\n                    <button v-ripple class=\"remote-control-button-yellow yellow darken-3\" data-arib-key-code=\"24\">黄</button>\r\n                </div>\r\n            </div>\r\n            <div class=\"remote-control__number-key\">\r\n                <button v-ripple data-remocon-id=\"1\" data-arib-key-code=\"6\">1</button>\r\n                <button v-ripple data-remocon-id=\"2\" data-arib-key-code=\"7\">2</button>\r\n                <button v-ripple data-remocon-id=\"3\" data-arib-key-code=\"8\">3</button>\r\n                <button v-ripple data-remocon-id=\"4\" data-arib-key-code=\"9\">4</button>\r\n                <button v-ripple data-remocon-id=\"5\" data-arib-key-code=\"10\">5</button>\r\n                <button v-ripple data-remocon-id=\"6\" data-arib-key-code=\"11\">6</button>\r\n                <button v-ripple data-remocon-id=\"7\" data-arib-key-code=\"12\">7</button>\r\n                <button v-ripple data-remocon-id=\"8\" data-arib-key-code=\"13\">8</button>\r\n                <button v-ripple data-remocon-id=\"9\" data-arib-key-code=\"14\">9</button>\r\n                <button v-ripple data-remocon-id=\"10\" data-arib-key-code=\"15\">10</button>\r\n                <button v-ripple data-remocon-id=\"11\" data-arib-key-code=\"16\">11</button>\r\n                <button v-ripple data-remocon-id=\"12\" data-arib-key-code=\"17\">12</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { defineComponent, PropType } from 'vue';\r\n\r\nexport default defineComponent({\r\n    name: 'Panel-Remocon',\r\n    props: {\r\n        modelValue: {\r\n            type: Boolean as PropType<boolean>,\r\n            required: true,\r\n        }\r\n    },\r\n    emits: {\r\n        'update:modelValue': (value: boolean) => true,\r\n    },\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.remote-control-container {\r\n    display: grid;\r\n    place-items: center;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    background: rgba(30, 19, 16, 50%);\r\n    transition: opacity 0.2s, visibility 0.2s;\r\n    overflow-y: scroll;\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    z-index: 5;\r\n    &--showing {\r\n        opacity: 1;\r\n        visibility: visible;\r\n    }\r\n\r\n    .remote-control {\r\n        position: relative;\r\n        width: 234px;\r\n        height: 514px;\r\n        padding: 24px 16px;\r\n        margin: 0 auto;\r\n        border-radius: 8px;\r\n        background: var(--v-background-base);\r\n        user-select: none;\r\n\r\n        .remote-control__close {\r\n            position: absolute !important;\r\n            top: 10px;\r\n            right: 10px;\r\n            width: 36px;\r\n            height: 36px;\r\n            z-index: 2;\r\n        }\r\n\r\n        .remote-control-data-broadcasting {\r\n            position: relative;\r\n            opacity: 1;\r\n            transition: opacity 0.2s ease;\r\n\r\n            &--disabled {\r\n                opacity: 0.4;\r\n                pointer-events: none;\r\n            }\r\n            &--loading {\r\n                opacity: 0.4;\r\n                pointer-events: none;\r\n                .remote-control__loading {\r\n                    opacity: 1 !important;\r\n                    visibility: visible !important;\r\n                }\r\n            }\r\n\r\n            .remote-control__loading {\r\n                position: absolute;\r\n                top: 50%;\r\n                left: 50%;\r\n                transform: translate(-50%, -50%);\r\n                color: var(--v-gray-base);\r\n                filter: drop-shadow(0px 0px 3px rgba(0, 0, 0, 0.3));\r\n                opacity: 0;\r\n                visibility: hidden;\r\n                transition: opacity 0.2s cubic-bezier(0.4, 0.38, 0.49, 0.94), visibility 0.2s cubic-bezier(0.4, 0.38, 0.49, 0.94);\r\n                will-change: opacity;\r\n                z-index: 3;\r\n            }\r\n\r\n            .remote-control__directional-key {\r\n                display: grid;\r\n                grid-template-columns: 1fr 90px 1fr;\r\n                grid-template-rows: 1fr 90px 1fr;\r\n                width: 160px;\r\n                height: 160px;\r\n                margin-left: auto;\r\n                margin-right: auto;\r\n                border-radius: 50%;\r\n                background: var(--v-background-lighten1);\r\n                overflow: hidden;\r\n\r\n                button {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                    border-radius: 8px;\r\n                    background: var(--v-background-lighten1);\r\n                    color: var(--v-text-base);\r\n                    font-size: 14px;\r\n                    font-weight: bold;\r\n                    outline: none;\r\n                    &.remote-control-button-up {\r\n                        grid-column: 2;\r\n                        grid-row: 1;\r\n                        padding-top: 4px;\r\n                    }\r\n                    &.remote-control-button-left {\r\n                        grid-column: 1;\r\n                        grid-row: 2;\r\n                        padding-left: 4px;\r\n                    }\r\n                    &.remote-control-button-select {\r\n                        grid-column: 2;\r\n                        grid-row: 2;\r\n                        border-radius: 50%;\r\n                        background: var(--v-background-base);\r\n                    }\r\n                    &.remote-control-button-right {\r\n                        grid-column: 3;\r\n                        grid-row: 2;\r\n                        padding-right: 4px;\r\n                    }\r\n                    &.remote-control-button-down {\r\n                        grid-column: 2;\r\n                        grid-row: 3;\r\n                        padding-bottom: 4px;\r\n                    }\r\n                }\r\n            }\r\n\r\n            .remote-control__control-key {\r\n                display: grid;\r\n                grid-template-columns: 1fr 1fr 1fr 1fr;\r\n                grid-template-rows: 35px 35px;\r\n                gap: 8px;\r\n                width: 200px;\r\n                margin-top: 12px;\r\n                margin-left: auto;\r\n                margin-right: auto;\r\n                button {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                    border-radius: 5px;\r\n                    background: var(--v-background-lighten1);\r\n                    color: var(--v-text-base);\r\n                    font-size: 15px;\r\n                    font-weight: bold;\r\n                    outline: none;\r\n                    &.remote-control-button-data {\r\n                        grid-column: 1 / 3;\r\n                        grid-row: 1;\r\n                    }\r\n                    &.remote-control-button-back {\r\n                        grid-column: 3 / 5;\r\n                        grid-row: 1;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .remote-control__number-key {\r\n            display: grid;\r\n            grid-template-columns: 1fr 1fr 1fr;\r\n            grid-template-rows: 44px 44px 44px 44px;\r\n            gap: 8px;\r\n            width: 200px;\r\n            margin-top: 16px;\r\n            margin-left: auto;\r\n            margin-right: auto;\r\n            button {\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n                border-radius: 5px;\r\n                background: var(--v-background-lighten1);\r\n                color: var(--v-text-base);\r\n                font-size: 26px;\r\n                font-weight: bold;\r\n                outline: none;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Remocon.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Remocon.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Remocon.vue?vue&type=template&id=40a878e8&scoped=true\"\nimport script from \"./Remocon.vue?vue&type=script&lang=ts\"\nexport * from \"./Remocon.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Remocon.vue?vue&type=style&index=0&id=40a878e8&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"40a878e8\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"series-container\"},[_vm._v(\" 鋭意実装中… \")])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"series-container\">\r\n        鋭意実装中…\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent } from 'vue';\r\n\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport Utils from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'Panel-SeriesTab',\r\n    data() {\r\n        return {\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(usePlayerStore),\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.series-container {\r\n    padding-left: 16px;\r\n    padding-right: 16px;\r\n    overflow-y: auto;\r\n    @include tablet-vertical {\r\n        padding-left: 24px;\r\n        padding-right: 24px;\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Series.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Series.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Series.vue?vue&type=template&id=26a6ea9c&scoped=true\"\nimport script from \"./Series.vue?vue&type=script&lang=ts\"\nexport * from \"./Series.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Series.vue?vue&type=style&index=0&id=26a6ea9c&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"26a6ea9c\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"twitter-container\"},[_c('v-dialog',{attrs:{\"content-class\":\"zoom-capture-modal-container\",\"max-width\":\"980\",\"transition\":\"slide-y-transition\"},model:{value:(_vm.playerStore.twitter_zoom_capture_modal),callback:function ($$v) {_vm.$set(_vm.playerStore, \"twitter_zoom_capture_modal\", $$v)},expression:\"playerStore.twitter_zoom_capture_modal\"}},[_c('div',{staticClass:\"zoom-capture-modal\"},[_c('img',{staticClass:\"zoom-capture-modal__image\",attrs:{\"src\":_vm.playerStore.twitter_zoom_capture ? _vm.playerStore.twitter_zoom_capture.image_url: ''}}),_c('a',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"zoom-capture-modal__download\",attrs:{\"href\":_vm.playerStore.twitter_zoom_capture ? _vm.playerStore.twitter_zoom_capture.image_url : '',\"download\":_vm.playerStore.twitter_zoom_capture ? _vm.playerStore.twitter_zoom_capture.filename : ''}},[_c('Icon',{attrs:{\"icon\":\"fa6-solid:download\",\"width\":\"45px\"}})],1)])]),_c('div',{staticClass:\"tab-container\"},[_c('div',{staticClass:\"tab-content tab-content--search\",class:{'tab-content--active': _vm.playerStore.twitter_active_tab === 'Search'}},[_c('div',{staticClass:\"search px-4\"},[_vm._v(\" リアルタイム検索機能は鋭意開発中です。 \")])]),_c('div',{staticClass:\"tab-content tab-content--timeline\",class:{'tab-content--active': _vm.playerStore.twitter_active_tab === 'Timeline'}},[_c('div',{staticClass:\"search px-4\"},[_vm._v(\" タイムライン機能は鋭意開発中です。 \")])]),_c('div',{staticClass:\"tab-content tab-content--capture\",class:{'tab-content--active': _vm.playerStore.twitter_active_tab === 'Capture'}},[_c('div',{staticClass:\"captures\"},_vm._l((_vm.playerStore.twitter_captures),function(capture){return _c('div',{key:capture.image_url,staticClass:\"capture\",class:{\n                        'capture--selected': capture.selected,\n                        'capture--focused': capture.focused,\n                        'capture--disabled': !capture.selected && _vm.tweet_captures.length >= 4,\n                    },on:{\"click\":function($event){return _vm.clickCapture(capture)}}},[_c('img',{staticClass:\"capture__image\",attrs:{\"src\":capture.image_url}}),_c('div',{staticClass:\"capture__disabled-cover\"}),_c('div',{staticClass:\"capture__selected-number\"},[_vm._v(_vm._s(_vm.tweet_captures.findIndex(blob => blob === capture.blob) + 1))]),_c('svg',{staticClass:\"capture__selected-checkmark iconify iconify--fluent\",attrs:{\"width\":\"1em\",\"height\":\"1em\",\"viewBox\":\"0 0 16 16\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M8 2a6 6 0 1 1 0 12A6 6 0 0 1 8 2Zm2.12 4.164L7.25 9.042L5.854 7.646a.5.5 0 1 0-.708.708l1.75 1.75a.5.5 0 0 0 .708 0l3.224-3.234a.5.5 0 0 0-.708-.706Z\"}})]),_c('div',{staticClass:\"capture__selected-border\"}),_c('div',{staticClass:\"capture__focused-border\"}),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"capture__zoom\",on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();_vm.playerStore.twitter_zoom_capture_modal = true; _vm.playerStore.twitter_zoom_capture = capture},\"mousedown\":function($event){$event.preventDefault();$event.stopPropagation();/* 親要素の波紋が広がらないように */}}},[_c('svg',{staticClass:\"iconify iconify--fluent\",attrs:{\"width\":\"32px\",\"height\":\"32px\",\"viewBox\":\"0 0 16 16\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M7 4.5a.5.5 0 0 0-1 0V6H4.5a.5.5 0 0 0 0 1H6v1.5a.5.5 0 0 0 1 0V7h1.5a.5.5 0 0 0 0-1H7V4.5ZM6.5 11a4.481 4.481 0 0 0 2.809-.984l3.837 3.838a.5.5 0 0 0 .708-.708L10.016 9.31A4.5 4.5 0 1 0 6.5 11Zm0-8a3.5 3.5 0 1 1 0 7a3.5 3.5 0 0 1 0-7Z\"}})])])])}),0),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.playerStore.twitter_captures.length === 0),expression:\"playerStore.twitter_captures.length === 0\"}],staticClass:\"capture-announce\"},[_c('div',{staticClass:\"capture-announce__heading\"},[_vm._v(\"まだキャプチャがありません。\")]),_vm._m(0)])])]),_c('div',{staticClass:\"tab-button-container\"},[_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"tab-button\",class:{'tab-button--active': _vm.playerStore.twitter_active_tab === 'Search'},on:{\"click\":function($event){_vm.playerStore.twitter_active_tab = 'Search'}}},[_c('Icon',{attrs:{\"icon\":\"fluent:search-16-filled\",\"height\":\"18px\"}}),_c('span',{staticClass:\"tab-button__text\"},[_vm._v(\"ツイート検索\")])],1),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"tab-button\",class:{'tab-button--active': _vm.playerStore.twitter_active_tab === 'Timeline'},on:{\"click\":function($event){_vm.playerStore.twitter_active_tab = 'Timeline'}}},[_c('Icon',{attrs:{\"icon\":\"fluent:home-16-regular\",\"height\":\"18px\"}}),_c('span',{staticClass:\"tab-button__text\"},[_vm._v(\"タイムライン\")])],1),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"tab-button\",class:{'tab-button--active': _vm.playerStore.twitter_active_tab === 'Capture'},on:{\"click\":function($event){_vm.playerStore.twitter_active_tab = 'Capture'}}},[_c('Icon',{attrs:{\"icon\":\"fluent:image-copy-20-regular\",\"height\":\"18px\"}}),_c('span',{staticClass:\"tab-button__text\"},[_vm._v(\"キャプチャ\")])],1)]),_c('div',{staticClass:\"tweet-form\",class:{\n        'tweet-form--focused': _vm.is_tweet_hashtag_form_focused || _vm.is_tweet_text_form_focused,\n        'tweet-form--virtual-keyboard-display': _vm.playerStore.is_virtual_keyboard_display &&\n            (_vm.Utils.hasActiveElementClass('tweet-form__hashtag-form') || _vm.Utils.hasActiveElementClass('tweet-form__textarea')) &&\n            (() => {_vm.is_hashtag_list_display = false; return true;})(),\n    }},[_c('div',{staticClass:\"tweet-form__hashtag\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.tweet_hashtag),expression:\"tweet_hashtag\"}],staticClass:\"tweet-form__hashtag-form\",attrs:{\"type\":\"search\",\"placeholder\":\"#ハッシュタグ\",\"spellcheck\":\"false\"},domProps:{\"value\":(_vm.tweet_hashtag)},on:{\"input\":[function($event){if($event.target.composing)return;_vm.tweet_hashtag=$event.target.value},function($event){return _vm.updateTweetLetterCount()}],\"focus\":function($event){_vm.is_tweet_hashtag_form_focused = true},\"blur\":function($event){_vm.is_tweet_hashtag_form_focused = false},\"change\":function($event){_vm.tweet_hashtag = _vm.formatHashtag(_vm.tweet_hashtag); _vm.updateTweetLetterCount()}}}),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"tweet-form__hashtag-list-button\",on:{\"click\":function($event){return _vm.clickHashtagListButton()}}},[_c('Icon',{attrs:{\"icon\":\"fluent:clipboard-text-ltr-32-regular\",\"height\":\"22px\"}})],1)]),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.tweet_text),expression:\"tweet_text\"}],ref:\"tweet_text\",staticClass:\"tweet-form__textarea\",attrs:{\"placeholder\":\"ツイート\",\"spellcheck\":\"false\"},domProps:{\"value\":(_vm.tweet_text)},on:{\"input\":[function($event){if($event.target.composing)return;_vm.tweet_text=$event.target.value},function($event){return _vm.updateTweetLetterCount()}],\"paste\":function($event){return _vm.pasteClipboardData($event)},\"focus\":function($event){_vm.is_tweet_text_form_focused = true},\"blur\":function($event){_vm.is_tweet_text_form_focused = false}}}),_c('div',{staticClass:\"tweet-form__control\"},[_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"account-button\",class:{'account-button--no-login': !_vm.is_logged_in_twitter},on:{\"click\":function($event){return _vm.clickAccountButton()}}},[_c('img',{staticClass:\"account-button__icon\",attrs:{\"src\":_vm.is_logged_in_twitter ? _vm.selected_twitter_account?.icon_url : '/assets/images/account-icon-default.png'}}),_c('span',{staticClass:\"account-button__screen-name\"},[_vm._v(\" \"+_vm._s(_vm.is_logged_in_twitter ? `@${_vm.selected_twitter_account?.screen_name}` : '連携されていません')+\" \")]),_c('Icon',{staticClass:\"account-button__menu\",attrs:{\"icon\":\"fluent:more-circle-20-regular\",\"width\":\"22px\"}})],1),_c('div',{staticClass:\"limit-meter\"},[_c('div',{staticClass:\"limit-meter__content\",class:{\n                    'limit-meter__content--yellow': _vm.tweet_letter_remain_count <= 20,\n                    'limit-meter__content--red': _vm.tweet_letter_remain_count <= 0,\n                }},[_c('Icon',{staticStyle:{\"margin-right\":\"-2px\"},attrs:{\"icon\":\"fa-brands:twitter\",\"width\":\"12px\"}}),_c('span',[_vm._v(_vm._s(_vm.tweet_letter_remain_count))])],1),_c('div',{staticClass:\"limit-meter__content\"},[_c('Icon',{attrs:{\"icon\":\"fluent:image-16-filled\",\"width\":\"14px\"}}),_c('span',[_vm._v(_vm._s(_vm.tweet_captures.length)+\"/4\")])],1)]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"tweet-button\",attrs:{\"disabled\":_vm.is_logged_in_twitter === false || _vm.tweet_letter_remain_count < 0 ||\n                    ((_vm.tweet_text.trim() === '' || _vm.tweet_letter_remain_count === 140) && _vm.tweet_captures.length === 0)},on:{\"click\":function($event){return _vm.sendTweet()},\"touchstart\":function($event){return _vm.sendTweet()}}},[_c('Icon',{attrs:{\"icon\":\"fa-brands:twitter\",\"height\":\"16px\"}}),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"ツイート\")])],1)])]),_c('div',{staticClass:\"hashtag-list\",class:{\n        'hashtag-list--display': _vm.is_hashtag_list_display,\n        'hashtag-list--virtual-keyboard-display': _vm.playerStore.is_virtual_keyboard_display && _vm.Utils.hasActiveElementClass('hashtag__input'),\n    }},[_c('div',{staticClass:\"hashtag-heading\"},[_c('div',{staticClass:\"hashtag-heading__text\"},[_c('Icon',{attrs:{\"icon\":\"charm:hash\",\"width\":\"17px\"}}),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"ハッシュタグリスト\")])],1),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"hashtag-heading__add-button\",on:{\"click\":function($event){_vm.saved_twitter_hashtags.push({id: _vm.Utils.time(), text: '#ここにハッシュタグを入力', editing: false})}}},[_c('Icon',{attrs:{\"icon\":\"fluent:add-12-filled\",\"width\":\"17px\"}}),_c('span',{staticClass:\"ml-1\"},[_vm._v(\"追加\")])],1)]),_c('draggable',{staticClass:\"hashtag-container\",attrs:{\"handle\":\".hashtag__sort-handle\"},model:{value:(_vm.saved_twitter_hashtags),callback:function ($$v) {_vm.saved_twitter_hashtags=$$v},expression:\"saved_twitter_hashtags\"}},_vm._l((_vm.saved_twitter_hashtags),function(hashtag){return _c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\",value:(!hashtag.editing),expression:\"!hashtag.editing\"}],key:hashtag.id,staticClass:\"hashtag\",class:{'hashtag--editing': hashtag.editing},on:{\"click\":function($event){return _vm.clickHashtag(hashtag)}}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(hashtag.text),expression:\"hashtag.text\"}],staticClass:\"hashtag__input\",attrs:{\"type\":\"search\",\"spellcheck\":\"false\",\"disabled\":!hashtag.editing},domProps:{\"value\":(hashtag.text)},on:{\"click\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing)return;_vm.$set(hashtag, \"text\", $event.target.value)}}}),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"hashtag__edit-button\",on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();hashtag.editing = !hashtag.editing;\n                        hashtag.text = _vm.formatHashtag(hashtag.text, true); _vm.updateTweetLetterCount()}}},[(hashtag.editing === false)?_c('svg',{staticClass:\"iconify iconify--fluent\",attrs:{\"width\":\"17px\",\"height\":\"17px\",\"viewBox\":\"0 0 16 16\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M10.529 1.764a2.621 2.621 0 1 1 3.707 3.707l-.779.779L9.75 2.543l.779-.779ZM9.043 3.25L2.657 9.636a2.955 2.955 0 0 0-.772 1.354l-.87 3.386a.5.5 0 0 0 .61.608l3.385-.869a2.95 2.95 0 0 0 1.354-.772l6.386-6.386L9.043 3.25Z\"}})]):_vm._e(),(hashtag.editing === true)?_c('svg',{staticClass:\"iconify iconify--fluent\",attrs:{\"width\":\"17px\",\"height\":\"17px\",\"viewBox\":\"0 0 16 16\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032Z\"}})]):_vm._e()]),_c('button',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"hashtag__delete-button\",on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();_vm.saved_twitter_hashtags.splice(_vm.saved_twitter_hashtags.indexOf(hashtag), 1)}}},[_c('svg',{staticClass:\"iconify iconify--fluent\",attrs:{\"width\":\"17px\",\"height\":\"17px\",\"viewBox\":\"0 0 16 16\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M7 3h2a1 1 0 0 0-2 0ZM6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1h4Zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5ZM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5Z\"}})])]),_c('div',{staticClass:\"hashtag__sort-handle\"},[_c('svg',{staticClass:\"iconify iconify--material-symbols\",attrs:{\"width\":\"17px\",\"height\":\"17px\",\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M5 15q-.425 0-.713-.288T4 14q0-.425.288-.713T5 13h14q.425 0 .713.288T20 14q0 .425-.288.713T19 15H5Zm0-4q-.425 0-.713-.288T4 10q0-.425.288-.713T5 9h14q.425 0 .713.288T20 10q0 .425-.288.713T19 11H5Z\"}})])])])}),0)],1),_c('div',{staticClass:\"twitter-account-list\",class:{'twitter-account-list--display': _vm.is_twitter_account_list_display}},_vm._l((_vm.userStore.user ? _vm.userStore.user.twitter_accounts : []),function(twitter_account){return _c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],key:twitter_account.id,staticClass:\"twitter-account\",on:{\"click\":function($event){return _vm.updateSelectedTwitterAccount(twitter_account)}}},[_c('img',{staticClass:\"twitter-account__icon\",attrs:{\"src\":twitter_account.icon_url}}),_c('div',{staticClass:\"twitter-account__info\"},[_c('div',{staticClass:\"twitter-account__name\"},[_vm._v(_vm._s(twitter_account.name))]),_c('div',{staticClass:\"twitter-account__screen-name\"},[_vm._v(\"@\"+_vm._s(twitter_account.screen_name))])]),_c('svg',{directives:[{name:\"show\",rawName:\"v-show\",value:(twitter_account.id === _vm.settingsStore.settings.selected_twitter_account_id),expression:\"twitter_account.id === settingsStore.settings.selected_twitter_account_id\"}],staticClass:\"twitter-account__check iconify iconify--fluent\",attrs:{\"width\":\"24px\",\"height\":\"24px\",\"viewBox\":\"0 0 16 16\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032Z\"}})])])}),0)],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"capture-announce__text\"},[_c('p',{staticClass:\"mt-0 mb-0\"},[_vm._v(\"プレイヤーのキャプチャボタンやショートカットキーでキャプチャを撮ると、ここに表示されます。\")]),_c('p',{staticClass:\"mt-2 mb-0\"},[_vm._v(\"表示されたキャプチャを選択してからツイートすると、キャプチャを付けてツイートできます。\")])])\n}]\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"twitter-container\">\r\n        <v-dialog content-class=\"zoom-capture-modal-container\" max-width=\"980\" transition=\"slide-y-transition\"\r\n            v-model=\"playerStore.twitter_zoom_capture_modal\">\r\n            <div class=\"zoom-capture-modal\">\r\n                <img class=\"zoom-capture-modal__image\"\r\n                    :src=\"playerStore.twitter_zoom_capture ? playerStore.twitter_zoom_capture.image_url: ''\">\r\n                <a v-ripple class=\"zoom-capture-modal__download\"\r\n                    :href=\"playerStore.twitter_zoom_capture ? playerStore.twitter_zoom_capture.image_url : ''\"\r\n                    :download=\"playerStore.twitter_zoom_capture ? playerStore.twitter_zoom_capture.filename : ''\">\r\n                    <Icon icon=\"fa6-solid:download\" width=\"45px\" />\r\n                </a>\r\n            </div>\r\n        </v-dialog>\r\n        <div class=\"tab-container\">\r\n            <div class=\"tab-content tab-content--search\" :class=\"{'tab-content--active': playerStore.twitter_active_tab === 'Search'}\">\r\n                <div class=\"search px-4\">\r\n                    リアルタイム検索機能は鋭意開発中です。\r\n                </div>\r\n            </div>\r\n            <div class=\"tab-content tab-content--timeline\" :class=\"{'tab-content--active': playerStore.twitter_active_tab === 'Timeline'}\">\r\n                <div class=\"search px-4\">\r\n                    タイムライン機能は鋭意開発中です。\r\n                </div>\r\n            </div>\r\n            <div class=\"tab-content tab-content--capture\" :class=\"{'tab-content--active': playerStore.twitter_active_tab === 'Capture'}\">\r\n                <div class=\"captures\">\r\n                    <div class=\"capture\" :class=\"{\r\n                            'capture--selected': capture.selected,\r\n                            'capture--focused': capture.focused,\r\n                            'capture--disabled': !capture.selected && tweet_captures.length >= 4,\r\n                        }\"\r\n                        v-for=\"capture in playerStore.twitter_captures\" :key=\"capture.image_url\"\r\n                        @click=\"clickCapture(capture)\">\r\n                        <!-- 以下では Icon コンポーネントを使うと個数が多いときに高負荷になるため、意図的に SVG を直書きしている -->\r\n                        <img class=\"capture__image\" :src=\"capture.image_url\">\r\n                        <div class=\"capture__disabled-cover\"></div>\r\n                        <div class=\"capture__selected-number\">{{tweet_captures.findIndex(blob => blob === capture.blob) + 1}}</div>\r\n                        <svg class=\"capture__selected-checkmark iconify iconify--fluent\" width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\">\r\n                            <path fill=\"currentColor\" d=\"M8 2a6 6 0 1 1 0 12A6 6 0 0 1 8 2Zm2.12 4.164L7.25 9.042L5.854 7.646a.5.5 0 1 0-.708.708l1.75 1.75a.5.5 0 0 0 .708 0l3.224-3.234a.5.5 0 0 0-.708-.706Z\"></path>\r\n                        </svg>\r\n                        <div class=\"capture__selected-border\"></div>\r\n                        <div class=\"capture__focused-border\"></div>\r\n                        <div v-ripple class=\"capture__zoom\"\r\n                            @click.prevent.stop=\"playerStore.twitter_zoom_capture_modal = true; playerStore.twitter_zoom_capture = capture\"\r\n                            @mousedown.prevent.stop=\"/* 親要素の波紋が広がらないように */\">\r\n                            <svg class=\"iconify iconify--fluent\" width=\"32px\" height=\"32px\" viewBox=\"0 0 16 16\">\r\n                                <path fill=\"currentColor\" d=\"M7 4.5a.5.5 0 0 0-1 0V6H4.5a.5.5 0 0 0 0 1H6v1.5a.5.5 0 0 0 1 0V7h1.5a.5.5 0 0 0 0-1H7V4.5ZM6.5 11a4.481 4.481 0 0 0 2.809-.984l3.837 3.838a.5.5 0 0 0 .708-.708L10.016 9.31A4.5 4.5 0 1 0 6.5 11Zm0-8a3.5 3.5 0 1 1 0 7a3.5 3.5 0 0 1 0-7Z\"></path>\r\n                            </svg>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"capture-announce\" v-show=\"playerStore.twitter_captures.length === 0\">\r\n                    <div class=\"capture-announce__heading\">まだキャプチャがありません。</div>\r\n                    <div class=\"capture-announce__text\">\r\n                        <p class=\"mt-0 mb-0\">プレイヤーのキャプチャボタンやショートカットキーでキャプチャを撮ると、ここに表示されます。</p>\r\n                        <p class=\"mt-2 mb-0\">表示されたキャプチャを選択してからツイートすると、キャプチャを付けてツイートできます。</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"tab-button-container\">\r\n            <div v-ripple class=\"tab-button\" :class=\"{'tab-button--active': playerStore.twitter_active_tab === 'Search'}\"\r\n                @click=\"playerStore.twitter_active_tab = 'Search'\">\r\n                <Icon icon=\"fluent:search-16-filled\" height=\"18px\" />\r\n                <span class=\"tab-button__text\">ツイート検索</span>\r\n            </div>\r\n            <div v-ripple class=\"tab-button\" :class=\"{'tab-button--active': playerStore.twitter_active_tab === 'Timeline'}\"\r\n                @click=\"playerStore.twitter_active_tab = 'Timeline'\">\r\n                <Icon icon=\"fluent:home-16-regular\" height=\"18px\" />\r\n                <span class=\"tab-button__text\">タイムライン</span>\r\n            </div>\r\n            <div v-ripple class=\"tab-button\" :class=\"{'tab-button--active': playerStore.twitter_active_tab === 'Capture'}\"\r\n                @click=\"playerStore.twitter_active_tab = 'Capture'\">\r\n                <Icon icon=\"fluent:image-copy-20-regular\" height=\"18px\" />\r\n                <span class=\"tab-button__text\">キャプチャ</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"tweet-form\" :class=\"{\r\n            'tweet-form--focused': is_tweet_hashtag_form_focused || is_tweet_text_form_focused,\r\n            'tweet-form--virtual-keyboard-display': playerStore.is_virtual_keyboard_display &&\r\n                (Utils.hasActiveElementClass('tweet-form__hashtag-form') || Utils.hasActiveElementClass('tweet-form__textarea')) &&\r\n                (() => {is_hashtag_list_display = false; return true;})(),\r\n        }\">\r\n            <div class=\"tweet-form__hashtag\">\r\n                <input class=\"tweet-form__hashtag-form\" type=\"search\" placeholder=\"#ハッシュタグ\" spellcheck=\"false\"\r\n                    v-model=\"tweet_hashtag\" @input=\"updateTweetLetterCount()\"\r\n                    @focus=\"is_tweet_hashtag_form_focused = true\" @blur=\"is_tweet_hashtag_form_focused = false\"\r\n                    @change=\"tweet_hashtag = formatHashtag(tweet_hashtag); updateTweetLetterCount()\">\r\n                <div v-ripple class=\"tweet-form__hashtag-list-button\" @click=\"clickHashtagListButton()\">\r\n                    <Icon icon=\"fluent:clipboard-text-ltr-32-regular\" height=\"22px\" />\r\n                </div>\r\n            </div>\r\n            <textarea class=\"tweet-form__textarea\" placeholder=\"ツイート\" spellcheck=\"false\" v-model=\"tweet_text\" ref=\"tweet_text\"\r\n                @input=\"updateTweetLetterCount()\"\r\n                @paste=\"pasteClipboardData($event)\"\r\n                @focus=\"is_tweet_text_form_focused = true\"\r\n                @blur=\"is_tweet_text_form_focused = false\">\r\n            </textarea>\r\n            <div class=\"tweet-form__control\">\r\n                <div v-ripple class=\"account-button\" :class=\"{'account-button--no-login': !is_logged_in_twitter}\"\r\n                    @click=\"clickAccountButton()\">\r\n                    <img class=\"account-button__icon\"\r\n                        :src=\"is_logged_in_twitter ? selected_twitter_account?.icon_url : '/assets/images/account-icon-default.png'\">\r\n                    <span class=\"account-button__screen-name\">\r\n                        {{is_logged_in_twitter ? `@${selected_twitter_account?.screen_name}` : '連携されていません'}}\r\n                    </span>\r\n                    <Icon class=\"account-button__menu\" icon=\"fluent:more-circle-20-regular\" width=\"22px\" />\r\n                </div>\r\n                <div class=\"limit-meter\">\r\n                    <div class=\"limit-meter__content\" :class=\"{\r\n                        'limit-meter__content--yellow': tweet_letter_remain_count <= 20,\r\n                        'limit-meter__content--red': tweet_letter_remain_count <= 0,\r\n                    }\">\r\n                        <Icon icon=\"fa-brands:twitter\" width=\"12px\" style=\"margin-right: -2px;\" />\r\n                        <span>{{tweet_letter_remain_count}}</span>\r\n                    </div>\r\n                    <div class=\"limit-meter__content\">\r\n                        <Icon icon=\"fluent:image-16-filled\" width=\"14px\" />\r\n                        <span>{{tweet_captures.length}}/4</span>\r\n                    </div>\r\n                </div>\r\n                <button v-ripple class=\"tweet-button\"\r\n                    :disabled=\"is_logged_in_twitter === false || tweet_letter_remain_count < 0 ||\r\n                        ((tweet_text.trim() === '' || tweet_letter_remain_count === 140) && tweet_captures.length === 0)\"\r\n                    @click=\"sendTweet()\" @touchstart=\"sendTweet()\">\r\n                    <Icon icon=\"fa-brands:twitter\" height=\"16px\" />\r\n                    <span class=\"ml-1\">ツイート</span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class=\"hashtag-list\" :class=\"{\r\n            'hashtag-list--display': is_hashtag_list_display,\r\n            'hashtag-list--virtual-keyboard-display': playerStore.is_virtual_keyboard_display && Utils.hasActiveElementClass('hashtag__input'),\r\n        }\">\r\n            <div class=\"hashtag-heading\">\r\n                <div class=\"hashtag-heading__text\">\r\n                    <Icon icon=\"charm:hash\" width=\"17px\" />\r\n                    <span class=\"ml-1\">ハッシュタグリスト</span>\r\n                </div>\r\n                <button v-ripple class=\"hashtag-heading__add-button\"\r\n                    @click=\"saved_twitter_hashtags.push({id: Utils.time(), text: '#ここにハッシュタグを入力', editing: false})\">\r\n                    <Icon icon=\"fluent:add-12-filled\" width=\"17px\" />\r\n                    <span class=\"ml-1\">追加</span>\r\n                </button>\r\n            </div>\r\n            <draggable class=\"hashtag-container\" v-model=\"saved_twitter_hashtags\" handle=\".hashtag__sort-handle\">\r\n                <div v-ripple=\"!hashtag.editing\" class=\"hashtag\" :class=\"{'hashtag--editing': hashtag.editing}\"\r\n                    v-for=\"hashtag in saved_twitter_hashtags\" :key=\"hashtag.id\"\r\n                    @click=\"clickHashtag(hashtag)\">\r\n                        <!-- 以下では Icon コンポーネントを使うと個数が多いときに高負荷になるため、意図的に SVG を直書きしている -->\r\n                    <input type=\"search\" class=\"hashtag__input\" spellcheck=\"false\" v-model=\"hashtag.text\" :disabled=\"!hashtag.editing\" @click.stop=\"\">\r\n                    <button v-ripple class=\"hashtag__edit-button\"\r\n                        @click.prevent.stop=\"hashtag.editing = !hashtag.editing;\r\n                            hashtag.text = formatHashtag(hashtag.text, true); updateTweetLetterCount()\">\r\n                        <svg class=\"iconify iconify--fluent\" width=\"17px\" height=\"17px\" viewBox=\"0 0 16 16\" v-if=\"hashtag.editing === false\">\r\n                            <path fill=\"currentColor\" d=\"M10.529 1.764a2.621 2.621 0 1 1 3.707 3.707l-.779.779L9.75 2.543l.779-.779ZM9.043 3.25L2.657 9.636a2.955 2.955 0 0 0-.772 1.354l-.87 3.386a.5.5 0 0 0 .61.608l3.385-.869a2.95 2.95 0 0 0 1.354-.772l6.386-6.386L9.043 3.25Z\"></path>\r\n                        </svg>\r\n                        <svg class=\"iconify iconify--fluent\" width=\"17px\" height=\"17px\" viewBox=\"0 0 16 16\" v-if=\"hashtag.editing === true\">\r\n                            <path fill=\"currentColor\" d=\"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032Z\"></path>\r\n                        </svg>\r\n                    </button>\r\n                    <button v-ripple class=\"hashtag__delete-button\"\r\n                        @click.prevent.stop=\"saved_twitter_hashtags.splice(saved_twitter_hashtags.indexOf(hashtag), 1)\">\r\n                        <svg class=\"iconify iconify--fluent\" width=\"17px\" height=\"17px\" viewBox=\"0 0 16 16\">\r\n                            <path fill=\"currentColor\" d=\"M7 3h2a1 1 0 0 0-2 0ZM6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1h4Zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5ZM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5Z\"></path>\r\n                        </svg>\r\n                    </button>\r\n                    <div class=\"hashtag__sort-handle\">\r\n                        <svg class=\"iconify iconify--material-symbols\" width=\"17px\" height=\"17px\" viewBox=\"0 0 24 24\">\r\n                            <path fill=\"currentColor\" d=\"M5 15q-.425 0-.713-.288T4 14q0-.425.288-.713T5 13h14q.425 0 .713.288T20 14q0 .425-.288.713T19 15H5Zm0-4q-.425 0-.713-.288T4 10q0-.425.288-.713T5 9h14q.425 0 .713.288T20 10q0 .425-.288.713T19 11H5Z\"></path>\r\n                        </svg>\r\n                    </div>\r\n                </div>\r\n            </draggable>\r\n        </div>\r\n        <div class=\"twitter-account-list\" :class=\"{'twitter-account-list--display': is_twitter_account_list_display}\">\r\n            <div v-ripple class=\"twitter-account\" v-for=\"twitter_account in userStore.user ? userStore.user.twitter_accounts : []\"\r\n                :key=\"twitter_account.id\" @click=\"updateSelectedTwitterAccount(twitter_account)\">\r\n                <!-- 以下では Icon コンポーネントを使うと個数が多いときに高負荷になるため、意図的に SVG を直書きしている -->\r\n                <img class=\"twitter-account__icon\" :src=\"twitter_account.icon_url\">\r\n                <div class=\"twitter-account__info\">\r\n                    <div class=\"twitter-account__name\">{{twitter_account.name}}</div>\r\n                    <div class=\"twitter-account__screen-name\">@{{twitter_account.screen_name}}</div>\r\n                </div>\r\n                <svg class=\"twitter-account__check iconify iconify--fluent\" width=\"24px\" height=\"24px\" viewBox=\"0 0 16 16\"\r\n                    v-show=\"twitter_account.id === settingsStore.settings.selected_twitter_account_id\">\r\n                    <path fill=\"currentColor\" d=\"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032Z\"></path>\r\n                </svg>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent, PropType } from 'vue';\r\nimport draggable from 'vuedraggable';\r\n\r\nimport { IProgram } from '@/services/Programs';\r\nimport Twitter from '@/services/Twitter';\r\nimport { ITwitterAccount } from '@/services/Users';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport useUserStore from '@/stores/UserStore';\r\nimport Utils, { ChannelUtils } from '@/utils';\r\n\r\n// このコンポーネント内でのキャプチャのインターフェイス\r\nexport interface ITweetCapture {\r\n    blob: Blob;\r\n    filename: string;\r\n    image_url: string;\r\n    selected: boolean;\r\n    focused: boolean;\r\n}\r\n\r\n// このコンポーネント内でのハッシュタグのインターフェイス\r\ninterface IHashtag {\r\n    id: number;\r\n    text: string;\r\n    editing: boolean;\r\n}\r\n\r\nexport default defineComponent({\r\n    name: 'Panel-TwitterTab',\r\n    components: {\r\n        draggable,\r\n    },\r\n    props: {\r\n        playback_mode: {\r\n            type: String as PropType<'Live' | 'Video'>,\r\n            required: true,\r\n        },\r\n    },\r\n    data() {\r\n        return {\r\n\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n\r\n            // Twitter アカウントを1つでも連携しているかどうか\r\n            is_logged_in_twitter: false,\r\n\r\n            // 現在ツイート対象として選択されている Twitter アカウント\r\n            selected_twitter_account: null as ITwitterAccount | null,\r\n\r\n            // 連携している Twitter アカウントリストを表示しているか\r\n            is_twitter_account_list_display: false,\r\n\r\n            // 保存している Twitter のハッシュタグが入るリスト\r\n            saved_twitter_hashtags: useSettingsStore().settings.saved_twitter_hashtags.map((hashtag, index) => {\r\n                // id プロパティは :key=\"\" に指定するためにつける ID (ミリ秒単位のタイムスタンプ + index で適当に一意になるように)\r\n                return {id: Utils.time() + index, text: hashtag, editing: false} as IHashtag;\r\n            }),\r\n\r\n            // ハッシュタグリストを表示しているか\r\n            is_hashtag_list_display: false,\r\n\r\n            // キャプチャリストの要素\r\n            captures_element: null as HTMLDivElement | null,\r\n\r\n            // ツイートハッシュタグフォームにフォーカスしているか\r\n            is_tweet_hashtag_form_focused: false,\r\n\r\n            // ツイート本文フォームにフォーカスしているか\r\n            is_tweet_text_form_focused: false,\r\n\r\n            // ツイートのハッシュタグ\r\n            tweet_hashtag: '',\r\n\r\n            // ツイート本文\r\n            tweet_text: '',\r\n\r\n            // ツイートに添付するキャプチャの Blob のリスト\r\n            tweet_captures: [] as Blob[],\r\n\r\n            // 140 文字から引いた残りの文字数カウント\r\n            tweet_letter_remain_count: 140,\r\n\r\n            // ツイートを送信中か (API リクエストを実行するまで)\r\n            is_tweet_sending: false,\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useChannelsStore, usePlayerStore, useSettingsStore, useUserStore),\r\n    },\r\n    watch: {\r\n\r\n        // ライブ視聴のみ: ChannelsStore の channel.current.name の変更を監視する\r\n        // 現在視聴中のチャンネルが変更されたときに局タグを自動で更新する\r\n        'channelsStore.channel.current.name': {\r\n            handler(new_channel_name: string, old_channel_name: string) {\r\n                if (this.playback_mode === 'Live') {\r\n                    const old_channel_hashtag = ChannelUtils.getChannelHashtag(old_channel_name) ?? '';\r\n                    this.tweet_hashtag = this.formatHashtag(this.tweet_hashtag.replaceAll(old_channel_hashtag, ''));\r\n                    this.updateTweetLetterCount();\r\n                    // 「番組が切り替わったときにハッシュタグフォームをリセットする」がオンなら、ハッシュタグフォームを空にする\r\n                    if (this.settingsStore.settings.reset_hashtag_when_program_switches === true) {\r\n                        this.tweet_hashtag = this.formatHashtag('');\r\n                        this.updateTweetLetterCount();\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        // ライブ視聴のみ: ChannelsStore の channel.current.program_present の変更を監視する\r\n        // 現在視聴中の番組が変更されたときに局タグを自動で更新する\r\n        'channelsStore.channel.current.program_present': {\r\n            deep: true,  // ネストされたプロパティの変更も監視する\r\n            handler(new_program: IProgram | null, old_program: IProgram | null) {\r\n                if (this.playback_mode === 'Live') {\r\n                    // NID-SID-EID の組が変わったときのみ更新する\r\n                    if (new_program?.id !== old_program?.id) {\r\n                        // 「番組が切り替わったときにハッシュタグフォームをリセットする」がオンなら、ハッシュタグフォームを空にする\r\n                        if (this.settingsStore.settings.reset_hashtag_when_program_switches === true) {\r\n                            this.tweet_hashtag = this.formatHashtag('');\r\n                            this.updateTweetLetterCount();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        // 保存しているハッシュタグが変更されたら随時 LocalStorage に保存する\r\n        saved_twitter_hashtags: {\r\n            deep: true,\r\n            handler() {\r\n                this.settingsStore.settings.saved_twitter_hashtags = this.saved_twitter_hashtags.map(hashtag => hashtag.text);\r\n            }\r\n        }\r\n    },\r\n    async created() {\r\n\r\n        // アカウント情報を更新\r\n        await this.userStore.fetchUser();\r\n\r\n        // ログイン時のみ\r\n        if (this.userStore.is_logged_in === true) {\r\n\r\n            // 連携している Twitter アカウントがあれば true に設定\r\n            if (this.userStore.user && this.userStore.user.twitter_accounts.length > 0) {\r\n                this.is_logged_in_twitter = true;\r\n\r\n                // 現在ツイート対象として選択されている Twitter アカウントの ID が設定されていない or ID に紐づく Twitter アカウントがない\r\n                // 連携している Twitter アカウントのうち、一番最初のものを自動選択する\r\n                // ここで言う Twitter アカウントの ID は DB 上で連番で振られるもので、Twitter アカウントそのものの固有 ID ではない\r\n                if (this.settingsStore.settings.selected_twitter_account_id === null ||\r\n                    !this.userStore.user.twitter_accounts.some((twitter_account) => {\r\n                        return twitter_account.id === this.settingsStore.settings.selected_twitter_account_id;\r\n                    })) {\r\n                    this.settingsStore.settings.selected_twitter_account_id = this.userStore.user.twitter_accounts[0].id;\r\n                }\r\n\r\n                // 現在ツイート対象として選択されている Twitter アカウントを取得・設定\r\n                const twitter_account_index = this.userStore.user.twitter_accounts.findIndex((twitter_account) => {\r\n                    // Twitter アカウントの ID が選択されているものと一致する\r\n                    return twitter_account.id === this.settingsStore.settings.selected_twitter_account_id;\r\n                });\r\n                this.selected_twitter_account = this.userStore.user.twitter_accounts[twitter_account_index];\r\n            }\r\n        }\r\n\r\n        // 局タグ追加処理を走らせる (ハッシュタグフォームのフォーマット処理も同時に行われるが、元々空なので無意味)\r\n        this.tweet_hashtag = this.formatHashtag(this.tweet_hashtag);\r\n        this.updateTweetLetterCount();\r\n\r\n        // CaptureManager からキャプチャを受け取るイベントハンドラーを登録\r\n        // 非同期関数で登録することで、CaptureManager でキャプチャの登録完了を待たずに処理を続行できるはず\r\n        this.playerStore.event_emitter.on('CaptureCompleted', async (event) => {\r\n            this.addCaptureList(event.capture, event.filename);\r\n        });\r\n    },\r\n    beforeDestroy() {\r\n\r\n        // 終了前にすべてのキャプチャの Blob URL を revoke してリソースを解放する\r\n        for (const capture of this.playerStore.twitter_captures) {\r\n            URL.revokeObjectURL(capture.image_url);\r\n        }\r\n\r\n        // CaptureManager からキャプチャを受け取るイベントハンドラーを削除\r\n        this.playerStore.event_emitter.off('CaptureCompleted');  // CaptureCompleted イベントの全てのイベントハンドラーを削除\r\n    },\r\n    methods: {\r\n\r\n        // 文字数カウントを変更するイベント\r\n        updateTweetLetterCount() {\r\n\r\n            // サロゲートペアを考慮し、スプレッド演算子で一度配列化してから数えている\r\n            // ref: https://qiita.com/suin/items/3da4fb016728c024eaca\r\n            this.tweet_letter_remain_count = 140 - [...this.tweet_hashtag].length - [...this.tweet_text].length;\r\n        },\r\n\r\n        // クリップボード内のデータがペーストされたときのイベント\r\n        pasteClipboardData(event: ClipboardEvent) {\r\n            if (event.clipboardData === null) return;\r\n\r\n            // 一応配列になっているので回しているが、基本1回のペーストにつき DataTransferItem は1個しか入らない\r\n            for (const clipboard_item of event.clipboardData.items) {\r\n\r\n                // 画像のみを対象にする (DataTransferItem.type には MIME タイプが入る)\r\n                if (clipboard_item.type.startsWith('image/')) {\r\n\r\n                    // クリップボード内の画像データを File オブジェクトとして取得し、キャプチャリストに追加\r\n                    const file = clipboard_item.getAsFile();\r\n                    if (file) {\r\n                        this.addCaptureList(file, file.name);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        // ハッシュタグリストボタンが押されたときのイベント\r\n        clickHashtagListButton() {\r\n            this.is_hashtag_list_display = !this.is_hashtag_list_display;\r\n            // すべてのハッシュタグの編集状態を解除する\r\n            for (const hashtag of this.saved_twitter_hashtags) {\r\n                hashtag.editing = false;\r\n            }\r\n        },\r\n\r\n        // ハッシュタグがクリックされたときのイベント\r\n        clickHashtag(hashtag: IHashtag) {\r\n            this.tweet_hashtag = hashtag.text;\r\n            this.tweet_hashtag = this.formatHashtag(this.tweet_hashtag);\r\n            this.updateTweetLetterCount();\r\n            window.setTimeout(() => this.is_hashtag_list_display = false, 150);\r\n        },\r\n\r\n        // アカウントボタンが押されたときのイベント\r\n        clickAccountButton() {\r\n\r\n            // Twitter アカウントが連携されていない場合は Twitter 設定画面に飛ばす\r\n            if (!this.is_logged_in_twitter) {\r\n\r\n                // 視聴画面以外に遷移するため、フルスクリーンを解除しないと画面が崩れる\r\n                if (document.fullscreenElement) {\r\n                    document.exitFullscreen();\r\n                }\r\n\r\n                this.$router.push({path: '/settings/twitter'});\r\n                return;\r\n            }\r\n\r\n            // アカウントリストの表示/非表示を切り替え\r\n            this.is_twitter_account_list_display = !this.is_twitter_account_list_display;\r\n\r\n            // アカウントリストが表示されているなら、ハッシュタグリストを非表示にする\r\n            if (this.is_twitter_account_list_display === true) {\r\n                this.is_hashtag_list_display = false;\r\n            }\r\n        },\r\n\r\n        // 選択されている Twitter アカウントを更新する\r\n        updateSelectedTwitterAccount(twitter_account: ITwitterAccount) {\r\n            this.settingsStore.settings.selected_twitter_account_id = twitter_account.id;\r\n            this.selected_twitter_account = twitter_account;\r\n\r\n            // Twitter アカウントリストのオーバーレイを閉じる (少し待ってから閉じたほうが体感が良い)\r\n            window.setTimeout(() => this.is_twitter_account_list_display = false, 150);\r\n        },\r\n\r\n        // キャプチャリスト内のキャプチャがクリックされたときのイベント\r\n        clickCapture(capture: ITweetCapture) {\r\n\r\n            // 選択されたキャプチャが3枚まで & まだ選択されていないならキャプチャをツイート対象に追加する\r\n            if (this.tweet_captures.length < 4 && capture.selected === false) {\r\n                capture.selected = true;\r\n                this.tweet_captures.push(capture.blob);\r\n            } else {\r\n                // ツイート対象のキャプチャになっていたら取り除く\r\n                this.tweet_captures = this.tweet_captures.filter(blob => blob !== capture.blob);\r\n                // キャプチャの選択を解除\r\n                capture.selected = false;\r\n            }\r\n        },\r\n\r\n        // 撮ったキャプチャを親コンポーネントから受け取り、キャプチャリストに追加する\r\n        addCaptureList(blob: Blob, filename: string) {\r\n\r\n            if (this.captures_element === null) {\r\n                this.captures_element = this.$el.querySelector('.tab-content--capture')!;\r\n            }\r\n\r\n            // 撮ったキャプチャが 100 枚を超えていたら、重くなるので古いものから削除する\r\n            // 削除する前に Blob URL を revoke してリソースを解放するのがポイント\r\n            if (this.playerStore.twitter_captures.length > 100) {\r\n                URL.revokeObjectURL(this.playerStore.twitter_captures[0].image_url);\r\n                this.tweet_captures = this.tweet_captures.filter(blob => blob !== this.playerStore.twitter_captures[0].blob);\r\n                this.playerStore.twitter_captures.shift();\r\n            }\r\n\r\n            // キャプチャリストにキャプチャを追加\r\n            const blob_url = URL.createObjectURL(blob);\r\n            this.playerStore.twitter_captures.push({\r\n                blob: blob,\r\n                filename: filename,\r\n                image_url: blob_url,\r\n                selected: false,\r\n                focused: false,\r\n            });\r\n\r\n            // キャプチャリストを下にスクロール\r\n            // this.$nextTick() のコールバックで DOM の更新を待つ\r\n            this.$nextTick(() => {\r\n                if (this.captures_element === null) return;\r\n                this.captures_element.scrollTo({\r\n                    top: this.captures_element.scrollHeight,\r\n                    behavior: 'smooth',\r\n                });\r\n            });\r\n        },\r\n\r\n        // 撮ったキャプチャに番組タイトルの透かしを描画する\r\n        async drawProgramTitleOnCapture(capture: Blob): Promise<Blob> {\r\n\r\n            // キャプチャの Blob を createImageBitmap() で Canvas に描ける ImageBitmap に変換\r\n            const image_bitmap = await createImageBitmap(capture);\r\n\r\n            // OffscreenCanvas が使えるなら使う (OffscreenCanvas の方がパフォーマンスが良い)\r\n            const canvas = ('OffscreenCanvas' in window) ?\r\n                new OffscreenCanvas(image_bitmap.width, image_bitmap.height) : document.createElement('canvas');\r\n\r\n            // Canvas にキャプチャを描画\r\n            const context = canvas.getContext('2d', {\r\n                alpha: false,\r\n                desynchronized: true,\r\n                willReadFrequently: false,\r\n            }) as OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\r\n            context.drawImage(image_bitmap, 0, 0);\r\n            image_bitmap.close();\r\n\r\n            // 描画設定\r\n            context.font = 'bold 22px \"Open Sans\", \"YakuHanJPs\", \"Hiragino Sans\", \"Noto Sans JP\", sans-serif'; // フォント\r\n            context.fillStyle = 'rgba(255, 255, 255, 70%)';  // 半透明の白\r\n            context.shadowColor = 'rgba(0, 0, 0, 100%)';  // 影の色\r\n            context.shadowBlur = 4;  // 影をぼかすしきい値\r\n            context.shadowOffsetX = 0;  // 影のX座標\r\n            context.shadowOffsetY = 0;  // 影のY座標\r\n\r\n            // 現在視聴中の番組タイトルを取得\r\n            let title;\r\n            if (this.playback_mode === 'Live') {\r\n                title = this.channelsStore.channel.current.program_present?.title ?? '放送休止';\r\n            } else {\r\n                title = this.playerStore.recorded_program.title;\r\n            }\r\n\r\n            // 番組タイトルの透かしを描画\r\n            switch (this.settingsStore.settings.tweet_capture_watermark_position) {\r\n                case 'TopLeft': {\r\n                    context.textAlign = 'left'; // 左寄せ\r\n                    context.textBaseline = 'top'; // ベースラインを上寄せ\r\n                    context.fillText(title, 16, 12);\r\n                    break;\r\n                }\r\n                case 'TopRight': {\r\n                    context.textAlign = 'right'; // 右寄せ\r\n                    context.textBaseline = 'top'; // ベースラインを上寄せ\r\n                    context.fillText(title, canvas.width - 16, 12);\r\n                    break;\r\n                }\r\n                case 'BottomLeft': {\r\n                    context.textAlign = 'left'; // 左寄せ\r\n                    context.textBaseline = 'bottom'; // ベースラインを下寄せ\r\n                    context.fillText(title, 16, canvas.height - 12);\r\n                    break;\r\n                }\r\n                case 'BottomRight': {\r\n                    context.textAlign = 'right'; // 右寄せ\r\n                    context.textBaseline = 'bottom'; // ベースラインを下寄せ\r\n                    context.fillText(title, canvas.width - 16, canvas.height - 12);\r\n                    break;\r\n                }\r\n            }\r\n\r\n            // Blob にして返す\r\n            if (canvas instanceof OffscreenCanvas) {\r\n                return await canvas.convertToBlob({type: 'image/jpeg', quality: 1});\r\n            } else {\r\n                return new Promise((resolve, reject) => canvas.toBlob(blob => {\r\n                    if (blob === null) {\r\n                        reject();\r\n                    } else {\r\n                        resolve(blob);\r\n                    }\r\n                }, 'image/jpeg', 1));\r\n            }\r\n        },\r\n\r\n        // ハッシュタグを整形（余計なスペースなどを削り、全角ハッシュを半角ハッシュへ、全角スペースを半角スペースに置換）\r\n        formatHashtag(tweet_hashtag: string, from_hashtag_list: boolean = false): string {\r\n\r\n            // ハッシュとスペースの表記ゆれを統一し、連続するハッシュやスペースを1つにする\r\n            const tweet_hashtag_array = tweet_hashtag.trim()\r\n                .replaceAll('♯', '#').replaceAll('＃', '#').replace(/#{2,}/g, '#').replaceAll('　', ' ').replaceAll(/ +/g,' ').split(' ')\r\n                .filter(hashtag => hashtag !== '');\r\n\r\n            // ハッシュタグがついてない場合にハッシュタグを付与\r\n            for (let index in tweet_hashtag_array) {\r\n                if (!tweet_hashtag_array[index].startsWith('#')) {\r\n                    tweet_hashtag_array[index] = `#${tweet_hashtag_array[index]}`;\r\n                }\r\n            }\r\n\r\n            // ライブ視聴: 設定でオンになっている場合のみ、視聴中チャンネルの局タグを自動で追加する (ハッシュタグリスト内のハッシュタグは除外)\r\n            // ビデオ視聴ではリアルタイム実況ではないので追加しない\r\n            if (this.playback_mode === 'Live') {\r\n                if (this.settingsStore.settings.auto_add_watching_channel_hashtag === true && from_hashtag_list === false) {\r\n                    const channel_hashtag = ChannelUtils.getChannelHashtag(this.channelsStore.channel.current.name);\r\n                    if (channel_hashtag !== null) {\r\n                        if (tweet_hashtag_array.includes(channel_hashtag) === false) {\r\n                            tweet_hashtag_array.push(channel_hashtag);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            return tweet_hashtag_array.join(' ');\r\n        },\r\n\r\n        // ツイートを送信する\r\n        async sendTweet() {\r\n\r\n            // Twitter アカウントが連携されていない場合は何もしない\r\n            if (this.selected_twitter_account === null) return;\r\n\r\n            // 送信中フラグを立てる (重複送信防止)\r\n            if (this.is_tweet_sending === true) return;\r\n            this.is_tweet_sending = true;\r\n\r\n            // ハッシュタグを整形\r\n            this.tweet_hashtag = this.formatHashtag(this.tweet_hashtag);\r\n            const tweet_hashtag = this.tweet_hashtag;\r\n            this.updateTweetLetterCount();\r\n\r\n            // 実際に送るツイート本文を作成\r\n            let tweet_text = this.tweet_text;\r\n            if (tweet_hashtag !== '') {  // ハッシュタグが入力されているときのみ\r\n                switch (this.settingsStore.settings.tweet_hashtag_position) {\r\n                    // ツイート本文の前に追加する\r\n                    case 'Prepend': {\r\n                        tweet_text = `${tweet_hashtag} ${this.tweet_text}`;\r\n                        break;\r\n                    }\r\n                    // ツイート本文の後に追加する\r\n                    case 'Append': {\r\n                        tweet_text = `${this.tweet_text} ${tweet_hashtag}`;\r\n                        break;\r\n                    }\r\n                    // ツイート本文の前に追加してから改行する\r\n                    case 'PrependWithLineBreak': {\r\n                        tweet_text = `${tweet_hashtag}\\n${this.tweet_text}`;\r\n                        break;\r\n                    }\r\n                    // ツイート本文の後に改行してから追加する\r\n                    case 'AppendWithLineBreak': {\r\n                        tweet_text = `${this.tweet_text}\\n${tweet_hashtag}`;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // キャプチャへの透かしの描画がオンの場合、キャプチャの Blob を透かし付きのものに差し替える\r\n            const new_tweet_captures: Blob[] = [];\r\n            for (let tweet_capture of this.tweet_captures) {\r\n                if (this.settingsStore.settings.tweet_capture_watermark_position !== 'None') {\r\n                    tweet_capture = await this.drawProgramTitleOnCapture(tweet_capture);\r\n                }\r\n                new_tweet_captures.push(tweet_capture);\r\n            }\r\n\r\n            // 連投防止のため、フォーム上のツイート本文・キャプチャの選択・キャプチャのフォーカスを消去\r\n            // 送信した感を出す意味合いもある\r\n            this.tweet_text = '';\r\n            this.updateTweetLetterCount();\r\n            for (const capture of this.playerStore.twitter_captures) {\r\n                capture.selected = false;\r\n                capture.focused = false;\r\n            }\r\n            this.tweet_captures = [];\r\n\r\n            // ツイート送信 API にリクエスト\r\n            // レスポンスは待たない\r\n            Twitter.sendTweet(this.selected_twitter_account.screen_name, tweet_text, new_tweet_captures).then((result) => {\r\n                this.playerStore.event_emitter.emit('SendNotification', {\r\n                    message: result.message,\r\n                    color: result.is_error ? '#FF6F6A' : undefined,\r\n                });\r\n            });\r\n\r\n            // 送信中フラグを下ろす\r\n            this.is_tweet_sending = false;\r\n\r\n            // パネルを閉じる\r\n            if (this.settingsStore.settings.fold_panel_after_sending_tweet === true) {\r\n                this.playerStore.is_panel_display = false;\r\n                (this.$refs.tweet_text as HTMLTextAreaElement).blur();  // フォーカスを外す\r\n            }\r\n        },\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\">\r\n\r\n// 上書きしたいスタイル\r\n@include smartphone-horizontal {\r\n    .zoom-capture-modal-container.v-dialog {\r\n        width: auto !important;\r\n        max-width: auto !important;\r\n        aspect-ratio: 16 / 9;\r\n    }\r\n}\r\n\r\n</style>\r\n<style lang=\"scss\" scoped>\r\n\r\n.zoom-capture-modal {\r\n    position: relative;\r\n\r\n    &__image {\r\n        display: block;\r\n        width: 100%;\r\n        border-radius: 11px;\r\n    }\r\n\r\n    &__download {\r\n        display: flex;\r\n        position: absolute;\r\n        align-items: center;\r\n        justify-content: center;\r\n        right: 22px;\r\n        bottom: 20px;\r\n        width: 80px;\r\n        height: 80px;\r\n        border-radius: 50%;\r\n        color: var(--v-text-base);\r\n        filter: drop-shadow(0px 0px 4.5px rgba(0, 0, 0, 90%));\r\n    }\r\n}\r\n\r\n.twitter-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n    position: relative;\r\n    padding-bottom: 8px;\r\n    @include tablet-vertical {\r\n        padding-bottom: 0px;\r\n    }\r\n    @include smartphone-vertical {\r\n        padding-bottom: 0px;\r\n    }\r\n    &.watch-panel__content--active {\r\n        content-visibility: visible !important;\r\n    }\r\n    &.watch-panel__content--active .tab-container .tab-content--active {\r\n        opacity: 1;\r\n        visibility: visible;\r\n        @media (hover: none) {\r\n            content-visibility: auto;\r\n        }\r\n    }\r\n\r\n    .tab-container {\r\n        position: relative;\r\n        flex-grow: 1;\r\n        min-height: 0;  // magic!\r\n\r\n        .tab-content {\r\n            position: absolute;\r\n            width: 100%;\r\n            height: 100%;\r\n            transition: opacity 0.2s, visibility 0.2s;\r\n            opacity: 0;\r\n            visibility: hidden;\r\n            overflow-y: scroll;\r\n            &::-webkit-scrollbar {\r\n                width: 6px;\r\n            }\r\n            @include tablet-vertical {\r\n                padding-top: 16px;\r\n            }\r\n            @include smartphone-horizontal {\r\n                padding-top: 8px;\r\n            }\r\n            @include smartphone-vertical {\r\n                padding-top: 8px;\r\n            }\r\n\r\n            // スマホ・タブレット (タッチデバイス) ではアニメーションが重めなので、アニメーションを無効化\r\n            // アクティブなタブ以外は明示的に描画しない\r\n            @media (hover: none) {\r\n                transition: none;\r\n                content-visibility: hidden;\r\n            }\r\n\r\n            .captures {\r\n                display: grid;\r\n                grid-template-columns: 1fr 1fr;\r\n                grid-row-gap: 12px;\r\n                grid-column-gap: 12px;\r\n                padding-left: 12px;\r\n                padding-right: 6px;\r\n                max-height: 100%;\r\n                // iOS Safari のみ\r\n                @supports (-webkit-touch-callout: none) {\r\n                    padding-right: 12px;\r\n                }\r\n                @include tablet-vertical {\r\n                    grid-template-columns: 1fr 1fr 1fr;\r\n                    padding-left: 24px;\r\n                    padding-right: 24px;\r\n                    grid-row-gap: 10px;\r\n                    grid-column-gap: 16px;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    grid-row-gap: 8px;\r\n                    grid-column-gap: 8px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    grid-template-columns: 1fr 1fr 1fr;\r\n                    grid-row-gap: 10px;\r\n                    grid-column-gap: 10px;\r\n                }\r\n\r\n                .capture {\r\n                    position: relative;\r\n                    height: 82px;\r\n                    border-radius: 11px;\r\n                    // 読み込まれるまでのキャプチャの背景\r\n                    background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n                    overflow: hidden;\r\n                    user-select: none;\r\n                    cursor: pointer;\r\n                    content-visibility: auto;\r\n                    @include tablet-vertical {\r\n                        height: 90px;\r\n                        border-radius: 9px;\r\n                        .capture__image {\r\n                            object-fit: cover;\r\n                        }\r\n                    }\r\n                    @include smartphone-horizontal {\r\n                        height: 74px;\r\n                        border-radius: 9px;\r\n                        .capture__image {\r\n                            object-fit: cover;\r\n                        }\r\n                    }\r\n                    @include smartphone-vertical {\r\n                        height: 82px;\r\n                        border-radius: 9px;\r\n                        .capture__image {\r\n                            object-fit: cover;\r\n                        }\r\n                    }\r\n\r\n                    &__image {\r\n                        display: block;\r\n                        width: 100%;\r\n                        height: 100%;\r\n                    }\r\n\r\n                    &__zoom {\r\n                        display: flex;\r\n                        align-items: center;\r\n                        justify-content: center;\r\n                        position: absolute;\r\n                        top: 1px;\r\n                        right: 3px;\r\n                        width: 38px;\r\n                        height: 38px;\r\n                        border-radius: 50%;\r\n                        filter: drop-shadow(0px 0px 2.5px rgba(0, 0, 0, 90%));\r\n                        cursor: pointer;\r\n                    }\r\n\r\n                    &__disabled-cover {\r\n                        display: none;\r\n                        align-items: center;\r\n                        justify-content: center;\r\n                        position: absolute;\r\n                        top: 0;\r\n                        left: 0;\r\n                        right: 0;\r\n                        bottom: 0;\r\n                        background: rgba(30, 19, 16, 50%);\r\n                    }\r\n\r\n                    &__selected-number {\r\n                        display: none;\r\n                        align-items: center;\r\n                        justify-content: center;\r\n                        position: absolute;\r\n                        top: 0;\r\n                        left: 0;\r\n                        right: 0;\r\n                        bottom: 0;\r\n                        background: rgba(30, 19, 16, 50%);\r\n                        font-size: 38px;\r\n                        text-shadow: 0px 0px 2.5px rgba(0, 0, 0, 90%)\r\n                    }\r\n\r\n                    &__selected-checkmark {\r\n                        display: none;\r\n                        position: absolute;\r\n                        top: 6px;\r\n                        left: 7px;\r\n                        width: 20px;\r\n                        height: 20px;\r\n                        color: var(--v-primary-base);\r\n                    }\r\n\r\n                    &__selected-border {\r\n                        display: none;\r\n                        position: absolute;\r\n                        top: 0;\r\n                        left: 0;\r\n                        right: 0;\r\n                        bottom: 0;\r\n                        border-radius: 11px;\r\n                        border: 4px solid var(--v-primary-base);\r\n                    }\r\n\r\n                    &__focused-border {\r\n                        display: none;\r\n                        position: absolute;\r\n                        top: 0;\r\n                        left: 0;\r\n                        right: 0;\r\n                        bottom: 0;\r\n                        border-radius: 11px;\r\n                        border: 4px solid var(--v-secondary-base);\r\n                    }\r\n\r\n                    &--selected {\r\n                        .capture__selected-number, .capture__selected-checkmark, .capture__selected-border {\r\n                            display: flex;\r\n                        }\r\n                    }\r\n                    &--focused {\r\n                        .capture__focused-border {\r\n                            display: block;\r\n                        }\r\n                    }\r\n                    &--disabled {\r\n                        cursor: auto;\r\n                        .capture__disabled-cover {\r\n                            display: block;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            .capture-announce {\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n                flex-direction: column;\r\n                height: 100%;\r\n                padding-left: 12px;\r\n                padding-right: 5px;\r\n                @include tablet-vertical {\r\n                    padding-left: 24px;\r\n                    padding-right: 24px;\r\n                }\r\n\r\n                &__heading {\r\n                    font-size: 20px;\r\n                    font-weight: bold;\r\n                    @include smartphone-horizontal {\r\n                        font-size: 16px;\r\n                    }\r\n                }\r\n                &__text {\r\n                    margin-top: 12px;\r\n                    color: var(--v-text-darken1);\r\n                    font-size: 13.5px;\r\n                    text-align: center;\r\n                    @include smartphone-horizontal {\r\n                        font-size: 12px;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .tab-button-container {\r\n        display: flex;\r\n        flex-shrink: 0;\r\n        column-gap: 7px;\r\n        height: 40px;\r\n        margin-left: 12px;\r\n        margin-right: 12px;\r\n        padding-top: 8px;\r\n        padding-bottom: 6px;\r\n        @include tablet-vertical {\r\n            height: 40px;\r\n            margin-left: 24px;\r\n            margin-right: 24px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            height: 38px;\r\n            margin-left: 8px;\r\n            margin-right: 8px;\r\n        }\r\n        @include smartphone-vertical {\r\n            height: 38px;\r\n        }\r\n\r\n        .tab-button {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            flex: 1;\r\n            background: var(--v-background-lighten2);\r\n            border-radius: 7px;\r\n            font-size: 11px;\r\n            transition: background-color 0.15s ease;\r\n            user-select: none;\r\n            cursor: pointer;\r\n            @include tablet-vertical {\r\n                font-size: 11.5px;\r\n                border-radius: 7px;\r\n            }\r\n            @include smartphone-horizontal {\r\n                font-size: 10.5px;\r\n                border-radius: 6px;\r\n            }\r\n            @include smartphone-vertical {\r\n                font-size: 10.5px;\r\n                border-radius: 6px;\r\n            }\r\n            &--active {\r\n                background: var(--v-twitter-base);\r\n            }\r\n\r\n            &__text {\r\n                margin-left: 4px;\r\n                margin-right: 2px;\r\n                line-height: 2;\r\n            }\r\n        }\r\n    }\r\n\r\n    .tweet-form {\r\n        display: flex;\r\n        position: relative;\r\n        flex-direction: column;\r\n        flex-shrink: 0;\r\n        height: 136px;\r\n        margin-left: 12px;\r\n        margin-right: 12px;\r\n        border-radius: 12px;\r\n        border-bottom-left-radius: 7px;\r\n        border-bottom-right-radius: 7px;\r\n        background: var(--v-background-lighten1);\r\n        transition: box-shadow 0.09s ease;\r\n        @include tablet-vertical {\r\n            margin-left: 24px;\r\n            margin-right: 24px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            height: 96px;\r\n            margin-left: 8px;\r\n            margin-right: 8px;\r\n            border-radius: 6px;\r\n            border-bottom-left-radius: 5px;\r\n            border-bottom-right-radius: 5px;\r\n        }\r\n        @include smartphone-vertical {\r\n            height: 96px;\r\n            border-radius: 6px;\r\n            border-bottom-left-radius: 5px;\r\n            border-bottom-right-radius: 5px;\r\n        }\r\n\r\n        &--focused {\r\n            box-shadow: rgba(79, 130, 230, 60%) 0 0 0 3.5px;\r\n        }\r\n\r\n        &--virtual-keyboard-display {\r\n            position: relative;\r\n            bottom: calc(env(keyboard-inset-height, 0px) - 77px);\r\n            @include tablet-vertical {\r\n                bottom: calc(env(keyboard-inset-height, 0px) - 40px) !important;\r\n            }\r\n            @include smartphone-horizontal {\r\n                bottom: calc(env(keyboard-inset-height, 0px) - 34px);\r\n            }\r\n            @include smartphone-vertical {\r\n                bottom: calc(env(keyboard-inset-height, 0px) - 40px) !important;\r\n            }\r\n        }\r\n\r\n        &__hashtag {\r\n            display: block;\r\n            position: relative;\r\n            height: 19px;\r\n            margin-top: 12px;\r\n            margin-left: 12px;\r\n            margin-right: 12px;\r\n            @include smartphone-horizontal {\r\n                height: 16px;\r\n                margin-top: 8px;\r\n            }\r\n            @include smartphone-vertical {\r\n                height: 16px;\r\n                margin-top: 8px;\r\n            }\r\n\r\n            &-form {\r\n                display: block;\r\n                width: calc(100% - 24px);\r\n                height: 100%;\r\n                flex-grow: 1;\r\n                font-size: 12.5px;\r\n                color: var(--v-twitter-lighten2);\r\n                outline: none;\r\n                @include smartphone-horizontal {\r\n                    width: calc(100% - 22px);\r\n                    font-size: 12px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    width: calc(100% - 22px);\r\n                    font-size: 12px;\r\n                }\r\n                // iOS Safari でフォーカス時にズームされる問題への対処\r\n                @supports (-webkit-touch-callout: none) {\r\n                    @include smartphone-horizontal {\r\n                        width: calc(100% * 1.333 - 32px);\r\n                        height: calc(16px * 1.333 + 4px);\r\n                        font-size: 16px;\r\n                        transform: scale(0.75);\r\n                        transform-origin: 0 0;\r\n                    }\r\n                    @include smartphone-vertical {\r\n                        width: calc(100% * 1.333 - 32px);\r\n                        height: calc(16px * 1.333 + 4px);\r\n                        font-size: 16px;\r\n                        transform: scale(0.75);\r\n                        transform-origin: 0 0;\r\n                    }\r\n                }\r\n                &::placeholder {\r\n                    color: rgba(65, 165, 241, 60%);\r\n                }\r\n            }\r\n            &-list-button {\r\n                display: flex;\r\n                position: absolute;\r\n                align-items: center;\r\n                justify-content: center;\r\n                top: -8px;\r\n                right: -8px;\r\n                width: 34px;\r\n                height: 34px;\r\n                padding: 6px;\r\n                border-radius: 50%;\r\n                color: var(--v-twitter-lighten2);\r\n                cursor: pointer;\r\n                @include smartphone-horizontal {\r\n                    right: -11px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    right: -11px;\r\n                }\r\n            }\r\n        }\r\n\r\n        &__textarea {\r\n            display: block;\r\n            flex-grow: 1;\r\n            margin-top: 8px;\r\n            margin-left: 12px;\r\n            margin-right: 12px;\r\n            font-size: 12.5px;\r\n            color: var(--v-text-base);\r\n            word-break: break-all;\r\n            resize: none;\r\n            outline: none;\r\n            @include smartphone-horizontal {\r\n                margin-top: 6px;\r\n                font-size: 12px;\r\n            }\r\n            @include smartphone-vertical {\r\n                margin-top: 6px;\r\n                font-size: 12px;\r\n            }\r\n            // iOS Safari でフォーカス時にズームされる問題への対処\r\n            @supports (-webkit-touch-callout: none) {\r\n                @include smartphone-horizontal {\r\n                    position: absolute;\r\n                    top: 24px;\r\n                    left: -2px;\r\n                    min-width: calc(100% * 1.28 - 25px);\r\n                    min-height: 34px;\r\n                    font-size: 16px;\r\n                    transform: scale(0.78125);\r\n                    transform-origin: 0 0;\r\n                }\r\n                @include smartphone-vertical {\r\n                    position: absolute;\r\n                    top: 24px;\r\n                    left: -2px;\r\n                    min-width: calc(100% * 1.28 - 25px);\r\n                    min-height: 34px;\r\n                    font-size: 16px;\r\n                    transform: scale(0.78125);\r\n                    transform-origin: 0 0;\r\n                }\r\n            }\r\n            &::placeholder {\r\n                color: var(--v-text-darken2);\r\n            }\r\n        }\r\n\r\n        &__control {\r\n            display: flex;\r\n            align-items: center;\r\n            height: 32px;\r\n            margin-top: 6px;\r\n            @include smartphone-horizontal {\r\n                height: 26px;\r\n            }\r\n            @include smartphone-vertical {\r\n                height: 26px;\r\n            }\r\n            // iOS Safari でフォーカス時にズームされる問題への対処…の副作用の対処\r\n            @supports (-webkit-touch-callout: none) {\r\n                @include smartphone-horizontal {\r\n                    margin-top: auto;\r\n                }\r\n                @include smartphone-vertical {\r\n                    margin-top: auto;\r\n                }\r\n            }\r\n\r\n            .account-button {\r\n                display: flex;\r\n                align-items: center;\r\n                width: 183px;\r\n                height: 100%;\r\n                border-radius: 7px;\r\n                font-size: 13px;\r\n                color: var(--v-text-base);\r\n                background: var(--v-background-lighten2);\r\n                user-select: none;\r\n                cursor: pointer;\r\n                @include tablet-vertical {\r\n                    width: 200px;\r\n                    border-radius: 5px;\r\n                    font-size: 11.5px;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    width: 156px;\r\n                    border-radius: 5px;\r\n                    font-size: 11px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    width: auto;\r\n                    flex-grow: 1;\r\n                    border-radius: 5px;\r\n                    font-size: 11.5px;\r\n                }\r\n                &--no-login {\r\n                    .account-button__screen-name {\r\n                        font-weight: 500;\r\n                    }\r\n                    .account-button__menu {\r\n                        display: none;\r\n                    }\r\n                }\r\n\r\n                &__icon {\r\n                    display: block;\r\n                    width: 32px;\r\n                    height: 100%;\r\n                    border-radius: 7px;\r\n                    // 読み込まれるまでのアイコンの背景\r\n                    background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n                    @include smartphone-horizontal {\r\n                        width: 26px;\r\n                    }\r\n                    @include smartphone-vertical {\r\n                        width: 26px;\r\n                    }\r\n                }\r\n                &__screen-name {\r\n                    flex-grow: 1;\r\n                    line-height: 2;\r\n                    text-align: center;\r\n                    font-weight: bold;\r\n                }\r\n                &__menu {\r\n                    margin-right: 4px;\r\n                }\r\n            }\r\n\r\n            .limit-meter {\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n                flex-direction: column;\r\n                flex-grow: 1;\r\n                row-gap: 0.5px;\r\n                font-size: 10px;\r\n                color: var(--v-text-darken1);\r\n                user-select: none;\r\n                @include tablet-vertical {\r\n                    flex-grow: 1;\r\n                    flex-direction: row;\r\n                    width: auto;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    font-size: 9px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    flex-grow: unset;\r\n                    flex-direction: row;\r\n                    width: 88px;\r\n                }\r\n\r\n                &__content {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                    &:nth-child(2) {\r\n                        @include tablet-vertical {\r\n                            margin-left: 28px;\r\n                            padding-right: 3px;\r\n                        }\r\n                        @include smartphone-horizontal {\r\n                            margin-top: -2.5px;\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            margin-left: 6px;\r\n                        }\r\n                    }\r\n                    svg {\r\n                        width: 14px;\r\n                        @include tablet-vertical {\r\n                            width: 16px;\r\n                            height: 16px;\r\n                        }\r\n                    }\r\n                    span {\r\n                        width: 16px;\r\n                        margin-left: 5px;\r\n                        text-align: center;\r\n                        font-weight: bold;\r\n                        @include tablet-vertical {\r\n                            width: 25px;\r\n                            margin-left: 8px;\r\n                            font-size: 15px;\r\n                        }\r\n                    }\r\n                    &--yellow {\r\n                        color: var(--v-warning-base);\r\n                    }\r\n                    &--red {\r\n                        color: var(--v-error-base);\r\n                    }\r\n                }\r\n            }\r\n\r\n            .tweet-button {\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n                width: 94px;\r\n                height: 100%;\r\n                border-radius: 7px;\r\n                font-size: 12.5px;\r\n                line-height: 2;\r\n                color: var(--v-text-base);\r\n                background: var(--v-twitter-base);\r\n                user-select: none;\r\n                outline: none;\r\n                cursor: pointer;\r\n                @include tablet-vertical {\r\n                    width: 200px;\r\n                    border-radius: 5px;\r\n                    font-size: 11.8px;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    width: 86px;\r\n                    border-radius: 5px;\r\n                    font-size: 11.8px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    width: 100px;\r\n                    border-radius: 5px;\r\n                    font-size: 11.8px;\r\n                }\r\n\r\n                &[disabled] {\r\n                    opacity: 0.7;\r\n                    cursor: auto;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .hashtag-list {\r\n        position: absolute;\r\n        left: 12px;\r\n        right: 12px;\r\n        bottom: 149px;\r\n        max-height: calc(100vh - 239px);\r\n        max-height: calc(100dvh - 239px);\r\n        padding: 12px 4px;\r\n        padding-bottom: 10px;\r\n        border-radius: 7px;\r\n        // スクロールバーが表示されると角が丸くなくなる問題への対処\r\n        clip-path: inset(0% 0% 0% 0% round 7px);\r\n        background: var(--v-background-lighten2);\r\n        box-shadow: 0px 3px 4px rgba(0, 0, 0, 53%);\r\n        transition: opacity 0.15s ease, visibility 0.15s ease;\r\n        opacity: 0;\r\n        visibility: hidden;\r\n        overflow-y: auto;\r\n        z-index: 2;\r\n        @include tablet-vertical {\r\n            left: 24px;\r\n            right: 24px;\r\n            bottom: 142px;\r\n            max-height: calc(100% - 158px);\r\n        }\r\n        @include smartphone-horizontal {\r\n            left: 8px;\r\n            right: 8px;\r\n            bottom: 110px;\r\n            max-height: calc(100vh - 152px);\r\n            max-height: calc(100dvh - 152px);\r\n            padding: 6px 4px;\r\n            border-radius: 6px;\r\n            clip-path: inset(0% 0% 0% 0% round 6px);\r\n        }\r\n        @include smartphone-vertical {\r\n            bottom: 102px;\r\n            max-height: calc(100% - 110px);\r\n            padding: 8px 4px;\r\n            border-radius: 6px;\r\n            clip-path: inset(0% 0% 0% 0% round 6px);\r\n        }\r\n        &--display {\r\n            opacity: 1;\r\n            visibility: visible;\r\n        }\r\n        &--virtual-keyboard-display {\r\n            bottom: calc(env(keyboard-inset-height, 0px) - 74px) !important;\r\n            max-height: calc(100vh - calc(env(keyboard-inset-height, 0px) + 16px)) !important;\r\n            max-height: calc(100dvh - calc(env(keyboard-inset-height, 0px) + 16px)) !important;\r\n            @include smartphone-horizontal {\r\n                bottom: calc(env(keyboard-inset-height, 0px) - 26px) !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                bottom: calc(env(keyboard-inset-height, 0px) - 44px) !important;\r\n                max-height: calc(100% - env(keyboard-inset-height, 0px) + 36px) !important;\r\n            }\r\n        }\r\n        @include smartphone-horizontal {\r\n            &::-webkit-scrollbar {\r\n                width: 4px;\r\n            }\r\n        }\r\n        &::-webkit-scrollbar-track {\r\n            background: var(--v-background-lighten2);\r\n        }\r\n        &::-webkit-scrollbar-thumb {\r\n                background: var(--v-gray-base);\r\n            &:hover {\r\n                background: var(--v-gray-base);\r\n            }\r\n        }\r\n        // iOS Safari 向け\r\n        @supports (-webkit-touch-callout: none) {\r\n            @include smartphone-horizontal {\r\n                &::-webkit-scrollbar {\r\n                    width: 0.1px;\r\n                    -webkit-appearance: none;\r\n                }\r\n            }\r\n            @include smartphone-vertical {\r\n                &::-webkit-scrollbar {\r\n                    width: 0.1px;\r\n                    -webkit-appearance: none;\r\n                }\r\n            }\r\n        }\r\n\r\n        .hashtag-heading {\r\n            display: flex;\r\n            align-items: center;\r\n            font-weight: bold;\r\n            padding-left: 8px;\r\n            padding-right: 4px;\r\n            @include smartphone-horizontal {\r\n                padding-left: 4px;\r\n                padding-right: 2px;\r\n            }\r\n\r\n            &__text {\r\n                display: flex;\r\n                align-items: center;\r\n                flex-grow: 1;\r\n                font-size: 14px;\r\n            }\r\n\r\n            &__add-button {\r\n                display: flex;\r\n                align-items: center;\r\n                font-size: 13px;\r\n                padding: 4px 8px;\r\n                border-radius: 5px;\r\n                outline: none;\r\n                cursor: pointer;\r\n            }\r\n        }\r\n\r\n        .hashtag-container {\r\n            display: flex;\r\n            flex-direction: column;\r\n\r\n            .hashtag {\r\n                display: flex;\r\n                position: relative !important;\r\n                align-items: center;\r\n                padding-top: 1.5px;\r\n                padding-bottom: 1.5px;\r\n                padding-left: 8px;\r\n                padding-right: 4px;\r\n                border-radius: 7px;\r\n                transition: background-color 0.15s ease;\r\n                cursor: pointer;\r\n                @include smartphone-horizontal {\r\n                    padding-top: 0px;\r\n                    padding-bottom: 0px;\r\n                    padding-left: 4px;\r\n                    padding-right: 2px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    padding-top: 0px;\r\n                    padding-bottom: 0px;\r\n                }\r\n                &:first-of-type {\r\n                    margin-top: 6px;\r\n                    @include smartphone-vertical {\r\n                        margin-top: 0px;\r\n                    }\r\n                }\r\n                &:hover {\r\n                    background: rgba(255, 255, 255, 10%);\r\n                }\r\n                // タッチデバイスで hover を無効にする\r\n                @media (hover: none) {\r\n                    &:hover {\r\n                        background: transparent;\r\n                    }\r\n                }\r\n\r\n                &--editing {\r\n                    &:hover {\r\n                        background: transparent;\r\n                    }\r\n                    .hashtag__input {\r\n                        box-shadow: rgba(79, 130, 230, 60%) 0 0 0 3.5px;\r\n                        cursor: text;\r\n                        pointer-events: auto;\r\n                    }\r\n                }\r\n\r\n                &__input {\r\n                    display: block;\r\n                    flex-grow: 1;\r\n                    border-radius: 2px;\r\n                    color: var(--v-twitter-lighten2);\r\n                    opacity: 1;\r\n                    outline: none;\r\n                    cursor: pointer;\r\n                    transition: box-shadow 0.09s ease;\r\n                    margin-right: 4px;\r\n                    font-size: 12.5px;\r\n                    pointer-events: none;\r\n                    // iOS Safari でフォーカス時にズームされる問題への対処\r\n                    @supports (-webkit-touch-callout: none) {\r\n                        @include smartphone-horizontal {\r\n                            position: absolute !important;\r\n                            left: -26px !important;\r\n                            width: calc(100% - 6px);\r\n                            margin-right: 0px;\r\n                            font-size: 16px;\r\n                            transform: scale(0.78125);\r\n                        }\r\n                        @include smartphone-vertical {\r\n                            position: absolute !important;\r\n                            left: -26px !important;\r\n                            width: calc(100% - 21px);\r\n                            margin-right: 0px;\r\n                            font-size: 16px;\r\n                            transform: scale(0.78125);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                &__edit-button {\r\n                    margin-left: auto;\r\n                }\r\n                &__edit-button, &__delete-button, &__sort-handle {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                    width: 19px;\r\n                    height: 27px;\r\n                    border-radius: 5px;\r\n                    outline: none;\r\n                    cursor: pointer;\r\n                    @include smartphone-vertical {\r\n                        width: 25px;\r\n                    }\r\n                }\r\n                &__sort-handle {\r\n                    cursor: move;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .twitter-account-list {\r\n        position: absolute;\r\n        left: 12px;\r\n        right: 12px;\r\n        bottom: 48px;\r\n        max-height: calc(100vh - 137px);\r\n        max-height: calc(100dvh - 137px);\r\n        border-radius: 7px;\r\n        // スクロールバーが表示されると角が丸くなくなる問題への対処\r\n        clip-path: inset(0% 0% 0% 0% round 7px);\r\n        background: var(--v-background-lighten2);\r\n        box-shadow: 0px 3px 4px rgba(0, 0, 0, 53%);\r\n        transition: opacity 0.15s ease, visibility 0.15s ease;\r\n        opacity: 0;\r\n        visibility: hidden;\r\n        overflow-y: auto;\r\n        z-index: 3;\r\n        @include tablet-vertical {\r\n            left: 24px;\r\n            right: 24px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            left: 8px;\r\n            right: 8px;\r\n            bottom: 40px;\r\n            max-height: calc(100vh - 82px);\r\n            max-height: calc(100dvh - 82px);\r\n            border-radius: 6px;\r\n            clip-path: inset(0% 0% 0% 0% round 6px);\r\n        }\r\n        @include smartphone-vertical {\r\n            bottom: 32px;\r\n            max-height: calc(100% - 40px);\r\n            border-radius: 6px;\r\n            clip-path: inset(0% 0% 0% 0% round 6px);\r\n        }\r\n        &--display {\r\n            opacity: 1;\r\n            visibility: visible;\r\n        }\r\n        &::-webkit-scrollbar-track {\r\n            background: var(--v-background-lighten2);\r\n        }\r\n        &::-webkit-scrollbar-thumb {\r\n                background: var(--v-gray-base);\r\n            &:hover {\r\n                background: var(--v-gray-base);\r\n            }\r\n        }\r\n\r\n        .twitter-account {\r\n            display: flex;\r\n            align-items: center;\r\n            padding: 12px 12px;\r\n            border-radius: 7px;\r\n            user-select: none;\r\n            cursor: pointer;\r\n            @include smartphone-horizontal {\r\n                padding: 8px 12px;\r\n            }\r\n            @include smartphone-vertical {\r\n                padding: 8px 12px;\r\n            }\r\n\r\n            &__icon {\r\n                display: block;\r\n                width: 50px;\r\n                height: 50px;\r\n                border-radius: 50%;\r\n                @include smartphone-horizontal {\r\n                    width: 36px;\r\n                    height: 36px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    width: 36px;\r\n                    height: 36px;\r\n                }\r\n            }\r\n            &__info {\r\n                display: flex;\r\n                flex-direction: column;\r\n                flex-grow: 1;\r\n                min-width: 0;\r\n                margin-left: 12px;\r\n            }\r\n            &__name {\r\n                font-size: 17px;\r\n                font-weight: bold;\r\n                white-space: nowrap;\r\n                overflow: hidden;\r\n                text-overflow: ellipsis;\r\n                @include smartphone-horizontal {\r\n                    font-size: 14px;\r\n                    line-height: 1.3;\r\n                }\r\n                @include smartphone-vertical {\r\n                    font-size: 14px;\r\n                    line-height: 1.3;\r\n                }\r\n            }\r\n            &__screen-name {\r\n                color: var(--v-text-darken1);\r\n                font-size: 14px;\r\n                @include smartphone-horizontal {\r\n                    font-size: 13px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    font-size: 13px;\r\n                }\r\n            }\r\n            &__check {\r\n                flex-shrink: 0;\r\n                color: var(--v-twitter-lighten1);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Twitter.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Twitter.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Twitter.vue?vue&type=template&id=069c7275&scoped=true\"\nimport script from \"./Twitter.vue?vue&type=script&lang=ts\"\nexport * from \"./Twitter.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Twitter.vue?vue&type=style&index=0&id=069c7275&prod&lang=scss\"\nimport style1 from \"./Twitter.vue?vue&type=style&index=1&id=069c7275&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"069c7275\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <div class=\"watch-panel\"\r\n         @mousemove=\"playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})\">\r\n        <div class=\"watch-panel__header\">\r\n            <div v-ripple class=\"panel-close-button\" @click=\"playerStore.is_panel_display = false\">\r\n                <Icon class=\"panel-close-button__icon\" icon=\"akar-icons:chevron-right\" width=\"25px\" />\r\n                <span class=\"panel-close-button__text\">閉じる</span>\r\n            </div>\r\n            <v-spacer></v-spacer>\r\n            <div class=\"panel-broadcaster\" v-if=\"playback_mode === 'Live'\">\r\n                <img class=\"panel-broadcaster__icon\" :src=\"`${Utils.api_base_url}/channels/${channelsStore.channel.current.id}/logo`\">\r\n                <div class=\"panel-broadcaster__number\">{{channelsStore.channel.current.channel_number}}</div>\r\n                <div class=\"panel-broadcaster__name\">{{channelsStore.channel.current.name}}</div>\r\n            </div>\r\n        </div>\r\n        <div class=\"watch-panel__content-container\">\r\n            <Program class=\"watch-panel__content\" v-if=\"playback_mode === 'Live'\"\r\n                :class=\"{'watch-panel__content--active': panel_active_tab === 'Program'}\" />\r\n            <RecordedProgram class=\"watch-panel__content\" v-if=\"playback_mode === 'Video'\"\r\n                :class=\"{'watch-panel__content--active': panel_active_tab === 'RecordedProgram'}\" />\r\n            <Channel class=\"watch-panel__content\" v-if=\"playback_mode === 'Live'\"\r\n                :class=\"{'watch-panel__content--active': panel_active_tab === 'Channel'}\" />\r\n            <Series class=\"watch-panel__content\" v-if=\"playback_mode === 'Video'\"\r\n                :class=\"{'watch-panel__content--active': panel_active_tab === 'Series'}\" />\r\n            <Comment class=\"watch-panel__content\" :playback_mode=\"playback_mode\"\r\n                :class=\"{'watch-panel__content--active': panel_active_tab === 'Comment'}\" />\r\n            <Twitter class=\"watch-panel__content\" :playback_mode=\"playback_mode\"\r\n                :class=\"{'watch-panel__content--active': panel_active_tab === 'Twitter'}\" />\r\n            <button v-ripple class=\"watch-panel__content-remocon-button elevation-8\" v-if=\"playback_mode === 'Live'\"\r\n                :class=\"{'watch-panel__content-remocon-button--active': panel_active_tab === 'Program' || panel_active_tab === 'Channel'}\"\r\n                @click=\"playerStore.is_remocon_display = !playerStore.is_remocon_display\">\r\n                <Icon class=\"panel-close-button__icon\" icon=\"material-symbols:remote-gen\" width=\"25px\" />\r\n            </button>\r\n            <Remocon class=\"watch-panel__remocon\" v-if=\"playback_mode === 'Live'\"\r\n                :modelValue=\"(panel_active_tab === 'Program' || panel_active_tab === 'Channel') && playerStore.is_remocon_display === true\"\r\n                @update:modelValue=\"playerStore.is_remocon_display = $event\" />\r\n        </div>\r\n        <div class=\"watch-panel__navigation\">\r\n            <div v-ripple class=\"panel-navigation-button\" v-if=\"playback_mode === 'Live'\"\r\n                 :class=\"{'panel-navigation-button--active': panel_active_tab === 'Program'}\"\r\n                 @click=\"playerStore.tv_panel_active_tab = 'Program'\">\r\n                <Icon class=\"panel-navigation-button__icon\" icon=\"fa-solid:info-circle\" width=\"33px\" />\r\n                <span class=\"panel-navigation-button__text\">番組情報</span>\r\n            </div>\r\n            <div v-ripple class=\"panel-navigation-button\" v-if=\"playback_mode === 'Video'\"\r\n                 :class=\"{'panel-navigation-button--active': panel_active_tab === 'RecordedProgram'}\"\r\n                 @click=\"playerStore.video_panel_active_tab = 'RecordedProgram'\">\r\n                <Icon class=\"panel-navigation-button__icon\" icon=\"fa-solid:info-circle\" width=\"33px\" />\r\n                <span class=\"panel-navigation-button__text\">番組情報</span>\r\n            </div>\r\n            <div v-ripple class=\"panel-navigation-button\" v-if=\"playback_mode === 'Live'\"\r\n                 :class=\"{'panel-navigation-button--active': panel_active_tab === 'Channel'}\"\r\n                 @click=\"playerStore.tv_panel_active_tab = 'Channel'\">\r\n                <Icon class=\"panel-navigation-button__icon\" icon=\"fa-solid:broadcast-tower\" width=\"34px\" />\r\n                <span class=\"panel-navigation-button__text\">チャンネル</span>\r\n            </div>\r\n            <div v-ripple class=\"panel-navigation-button\" v-if=\"playback_mode === 'Video'\"\r\n                 :class=\"{'panel-navigation-button--active': panel_active_tab === 'Series'}\"\r\n                 @click=\"playerStore.video_panel_active_tab = 'Series'\">\r\n                <Icon class=\"panel-navigation-button__icon\" icon=\"fluent:video-clip-multiple-16-filled\" width=\"34px\"\r\n                    style=\"width: 39px; height: 39px; margin-top: -4px; margin-bottom: -4px;\" />\r\n                <span class=\"panel-navigation-button__text\">シリーズ</span>\r\n            </div>\r\n            <div v-ripple class=\"panel-navigation-button\"\r\n                 :class=\"{'panel-navigation-button--active': panel_active_tab === 'Comment'}\"\r\n                 @click=\"playback_mode === 'Live' ? playerStore.tv_panel_active_tab = 'Comment' : playerStore.video_panel_active_tab = 'Comment'\">\r\n                <Icon class=\"panel-navigation-button__icon\" icon=\"bi:chat-left-text-fill\" width=\"29px\" />\r\n                <span class=\"panel-navigation-button__text\">コメント</span>\r\n            </div>\r\n            <div v-ripple class=\"panel-navigation-button\"\r\n                 :class=\"{'panel-navigation-button--active': panel_active_tab === 'Twitter'}\"\r\n                 @click=\"playback_mode === 'Live' ? playerStore.tv_panel_active_tab = 'Twitter' : playerStore.video_panel_active_tab = 'Twitter'\">\r\n                <Icon class=\"panel-navigation-button__icon\" icon=\"fa-brands:twitter\" width=\"34px\" />\r\n                <span class=\"panel-navigation-button__text\">Twitter</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent, PropType } from 'vue';\r\n\r\nimport Channel from '@/components/Watch/Panel/Channel.vue';\r\nimport Comment from '@/components/Watch/Panel/Comment.vue';\r\nimport Program from '@/components/Watch/Panel/Program.vue';\r\nimport RecordedProgram from '@/components/Watch/Panel/RecordedProgram.vue';\r\nimport Remocon from '@/components/Watch/Panel/Remocon.vue';\r\nimport Series from '@/components/Watch/Panel/Series.vue';\r\nimport Twitter from '@/components/Watch/Panel/Twitter.vue';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport Utils from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'Watch-Panel',\r\n    components: {\r\n        Channel,\r\n        Comment,\r\n        Program,\r\n        RecordedProgram,\r\n        Remocon,\r\n        Series,\r\n        Twitter,\r\n    },\r\n    props: {\r\n        playback_mode: {\r\n            type: String as PropType<'Live' | 'Video'>,\r\n            required: true,\r\n        },\r\n    },\r\n    data() {\r\n        return {\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useChannelsStore, usePlayerStore),\r\n\r\n        // ライブ視聴なら tv_panel_active_tab を、ビデオ視聴なら video_panel_active_tab を返す\r\n        panel_active_tab() {\r\n            if (this.playback_mode === 'Live') {\r\n                return this.playerStore.tv_panel_active_tab;\r\n            } else {\r\n                return this.playerStore.video_panel_active_tab;\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.watch-panel {\r\n    display: flex;\r\n    flex-direction: column;\r\n    flex-shrink: 0;\r\n    width: 352px;\r\n    height: 100%;\r\n    background: var(--v-background-base);\r\n    @include tablet-vertical {\r\n        width: 100%;\r\n        height: auto;\r\n        flex-grow: 1;\r\n    }\r\n    @include smartphone-horizontal {\r\n        width: 310px;\r\n    }\r\n    @include smartphone-vertical {\r\n        width: 100%;\r\n        height: auto;\r\n        flex-grow: 1;\r\n    }\r\n\r\n    // タッチデバイスのみ、content-visibility: hidden でパネルを折り畳んでいるときの描画パフォーマンスを上げる\r\n    @media (hover: none) {\r\n        content-visibility: hidden;\r\n    }\r\n\r\n    .watch-panel__header {\r\n        display: flex;\r\n        align-items: center;\r\n        flex-shrink: 0;\r\n        width: 100%;\r\n        height: 70px;\r\n        padding-left: 16px;\r\n        padding-right: 16px;\r\n        @include tablet-vertical {\r\n            display: none;\r\n        }\r\n        @include smartphone-horizontal {\r\n            display: none;\r\n        }\r\n        @include smartphone-vertical {\r\n            display: none;\r\n        }\r\n\r\n        .panel-close-button {\r\n            display: flex;\r\n            position: relative;\r\n            align-items: center;\r\n            flex-shrink: 0;\r\n            left: -4px;\r\n            height: 35px;\r\n            padding: 0 4px;\r\n            border-radius: 5px;\r\n            font-size: 16px;\r\n            user-select: none;\r\n            cursor: pointer;\r\n\r\n            &__icon {\r\n                position: relative;\r\n                left: -4px;\r\n            }\r\n            &__text {\r\n                font-weight: bold;\r\n            }\r\n        }\r\n\r\n        .panel-broadcaster {\r\n            display: flex;\r\n            align-items: center;\r\n            min-width: 0;\r\n            margin-left: 16px;\r\n\r\n            &__icon {\r\n                display: inline-block;\r\n                flex-shrink: 0;\r\n                width: 43px;\r\n                height: 24px;\r\n                border-radius: 3px;\r\n                background: linear-gradient(150deg, var(--v-gray-base), var(--v-background-lighten2));\r\n                object-fit: cover;\r\n                user-select: none;\r\n            }\r\n\r\n            &__number {\r\n                flex-shrink: 0;\r\n                margin-left: 8px;\r\n                font-size: 16px;\r\n            }\r\n\r\n            &__name {\r\n                margin-left: 5px;\r\n                font-size: 16px;\r\n                overflow: hidden;\r\n                white-space: nowrap;\r\n                text-overflow: ellipsis;\r\n                @include smartphone-horizontal {\r\n                    font-size: 14px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .watch-panel__content-container {\r\n        position: relative;\r\n        height: 100%;\r\n\r\n        .watch-panel__content {\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            right: 0;\r\n            bottom: 0;\r\n            background: var(--v-background-base);\r\n            transition: opacity 0.2s, visibility 0.2s;\r\n            opacity: 0;\r\n            visibility: hidden;\r\n\r\n            // スマホ・タブレット (タッチデバイス) ではアニメーションが重めなので、アニメーションを無効化\r\n            // アクティブなタブ以外は明示的に描画しない\r\n            @media (hover: none) {\r\n                transition: none;\r\n                content-visibility: hidden;\r\n            }\r\n            &--active {\r\n                opacity: 1;\r\n                visibility: visible;\r\n                content-visibility: auto;\r\n            }\r\n        }\r\n\r\n        .watch-panel__content-remocon-button {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            position: absolute;\r\n            right: 16px;\r\n            bottom: 16px;\r\n            width: 48px;\r\n            height: 48px;\r\n            border-radius: 50%;\r\n            background: var(--v-background-lighten1);\r\n            outline: none;\r\n            transition: opacity 0.2s, visibility 0.2s;\r\n            opacity: 0;\r\n            visibility: hidden;\r\n\r\n            @media (hover: none) {\r\n                transition: none;\r\n            }\r\n            &--active {\r\n                opacity: 1;\r\n                visibility: visible;\r\n            }\r\n        }\r\n    }\r\n\r\n    .watch-panel__navigation {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-evenly;\r\n        flex-shrink: 0;\r\n        height: 77px;\r\n        background: var(--v-background-lighten1);\r\n        @include tablet-vertical {\r\n            height: 66px;\r\n            background: var(--v-background-base);\r\n        }\r\n        @include smartphone-horizontal {\r\n            height: 34px;\r\n        }\r\n        @include smartphone-vertical {\r\n            height: 50px;\r\n            background: var(--v-background-base);\r\n        }\r\n\r\n        .panel-navigation-button {\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            flex-direction: column;\r\n            width: 77px;\r\n            height: 56px;\r\n            padding: 6px 0px;\r\n            border-radius: 5px;\r\n            color: var(--v-text-base);\r\n            box-sizing: content-box;\r\n            transition: color 0.3s;\r\n            user-select: none;\r\n            cursor: pointer;\r\n            @include tablet-vertical {\r\n                width: 100px;\r\n                height: 56px;\r\n                padding: 4px 0px;\r\n                box-sizing: border-box;\r\n            }\r\n            @include smartphone-horizontal {\r\n                height: 34px;\r\n                padding: 5px 0px;\r\n                box-sizing: border-box;\r\n            }\r\n            @include smartphone-vertical {\r\n                height: 38px;\r\n                padding: 6px 0px;\r\n                box-sizing: border-box;\r\n            }\r\n\r\n            &--active {\r\n                color: var(--v-primary-base);\r\n                .panel-navigation-button__icon {\r\n                    color: var(--v-primary-base);\r\n                }\r\n                @include tablet-vertical {\r\n                    background: #5b2d3c;\r\n                }\r\n                @include smartphone-vertical {\r\n                    background: #5b2d3c;\r\n                }\r\n            }\r\n\r\n            &__icon {\r\n                height: 34px;\r\n                @include tablet-vertical {\r\n                    color: var(--v-text-base);\r\n                }\r\n                @include smartphone-vertical {\r\n                    color: var(--v-text-base);\r\n                }\r\n            }\r\n            &__text {\r\n                margin-top: 5px;\r\n                font-size: 13px;\r\n                @include tablet-vertical {\r\n                    margin-top: 3px;\r\n                    font-size: 12px;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    display: none;\r\n                }\r\n                @include smartphone-vertical {\r\n                    display: none;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Panel.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Panel.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Panel.vue?vue&type=template&id=6d5e6b6b&scoped=true\"\nimport script from \"./Panel.vue?vue&type=script&lang=ts\"\nexport * from \"./Panel.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Panel.vue?vue&type=style&index=0&id=6d5e6b6b&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6d5e6b6b\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"watch-player\",class:{\n    'watch-player--loading': _vm.playerStore.is_loading,\n    'watch-player--virtual-keyboard-display': _vm.playerStore.is_virtual_keyboard_display && _vm.Utils.hasActiveElementClass('dplayer-comment-input'),\n    'watch-player--video': _vm.playback_mode === 'Video',\n}},[_c('div',{staticClass:\"watch-player__background-wrapper\"},[_c('div',{staticClass:\"watch-player__background\",class:{'watch-player__background--display': _vm.playerStore.is_background_display},style:({backgroundImage: `url(${_vm.playerStore.background_url})`})},[_c('img',{staticClass:\"watch-player__background-logo\",attrs:{\"src\":\"/assets/images/logo.svg\"}})])]),_c('v-progress-circular',{staticClass:\"watch-player__buffering\",class:{'watch-player__buffering--display': _vm.playerStore.is_video_buffering},attrs:{\"indeterminate\":\"\",\"size\":\"60\",\"width\":\"6\"}}),_c('div',{staticClass:\"watch-player__dplayer\"}),_c('div',{staticClass:\"watch-player__button\",on:{\"mousemove\":function($event){return _vm.playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})},\"touchmove\":function($event){return _vm.playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})},\"click\":function($event){return _vm.playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})}}},[(_vm.playback_mode === 'Live')?_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"},{name:\"tooltip\",rawName:\"v-tooltip.top\",value:('前のチャンネル'),expression:\"'前のチャンネル'\",modifiers:{\"top\":true}}],staticClass:\"switch-button switch-button-up\",on:{\"click\":function($event){_vm.playerStore.is_zapping = true; _vm.$router.push({path: `/tv/watch/${_vm.channelsStore.channel.previous.display_channel_id}`})}}},[_c('Icon',{staticClass:\"switch-button-icon\",attrs:{\"icon\":\"fluent:ios-arrow-left-24-filled\",\"width\":\"32px\",\"rotate\":\"1\"}})],1):_vm._e(),_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"switch-button switch-button-panel switch-button-panel--open\",on:{\"click\":function($event){_vm.playerStore.is_panel_display = !_vm.playerStore.is_panel_display}}},[_c('Icon',{staticClass:\"switch-button-icon\",attrs:{\"icon\":\"fluent:navigation-16-filled\",\"width\":\"32px\"}})],1),(_vm.playback_mode === 'Live')?_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"},{name:\"tooltip\",rawName:\"v-tooltip.bottom\",value:('次のチャンネル'),expression:\"'次のチャンネル'\",modifiers:{\"bottom\":true}}],staticClass:\"switch-button switch-button-down\",on:{\"click\":function($event){_vm.playerStore.is_zapping = true; _vm.$router.push({path: `/tv/watch/${_vm.channelsStore.channel.next.display_channel_id}`})}}},[_c('Icon',{staticClass:\"switch-button-icon\",attrs:{\"icon\":\"fluent:ios-arrow-right-24-filled\",\"width\":\"33px\",\"rotate\":\"1\"}})],1):_vm._e()])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"watch-player\" :class=\"{\r\n        'watch-player--loading': playerStore.is_loading,\r\n        'watch-player--virtual-keyboard-display': playerStore.is_virtual_keyboard_display && Utils.hasActiveElementClass('dplayer-comment-input'),\r\n        'watch-player--video': playback_mode === 'Video',\r\n    }\">\r\n        <div class=\"watch-player__background-wrapper\">\r\n            <div class=\"watch-player__background\" :class=\"{'watch-player__background--display': playerStore.is_background_display}\"\r\n                :style=\"{backgroundImage: `url(${playerStore.background_url})`}\">\r\n                <img class=\"watch-player__background-logo\" src=\"/assets/images/logo.svg\">\r\n            </div>\r\n        </div>\r\n        <v-progress-circular indeterminate size=\"60\" width=\"6\" class=\"watch-player__buffering\"\r\n            :class=\"{'watch-player__buffering--display': playerStore.is_video_buffering}\">\r\n        </v-progress-circular>\r\n        <div class=\"watch-player__dplayer\"></div>\r\n        <div class=\"watch-player__button\"\r\n                @mousemove=\"playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})\"\r\n                @touchmove=\"playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})\"\r\n                @click=\"playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event})\">\r\n            <div v-ripple class=\"switch-button switch-button-up\" v-tooltip.top=\"'前のチャンネル'\" v-if=\"playback_mode === 'Live'\"\r\n                @click=\"playerStore.is_zapping = true; $router.push({path: `/tv/watch/${channelsStore.channel.previous.display_channel_id}`})\">\r\n                <Icon class=\"switch-button-icon\" icon=\"fluent:ios-arrow-left-24-filled\" width=\"32px\" rotate=\"1\" />\r\n            </div>\r\n            <div v-ripple class=\"switch-button switch-button-panel switch-button-panel--open\"\r\n                @click=\"playerStore.is_panel_display = !playerStore.is_panel_display\">\r\n                <Icon class=\"switch-button-icon\" icon=\"fluent:navigation-16-filled\" width=\"32px\" />\r\n            </div>\r\n            <div v-ripple class=\"switch-button switch-button-down\" v-tooltip.bottom=\"'次のチャンネル'\" v-if=\"playback_mode === 'Live'\"\r\n                    @click=\"playerStore.is_zapping = true; $router.push({path: `/tv/watch/${channelsStore.channel.next.display_channel_id}`})\">\r\n                <Icon class=\"switch-button-icon\" icon=\"fluent:ios-arrow-right-24-filled\" width=\"33px\" rotate=\"1\" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport { defineComponent, PropType } from 'vue';\r\n\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport Utils from '@/utils';\r\n\r\nexport default defineComponent({\r\n    name: 'Watch-Player',\r\n    props: {\r\n        playback_mode: {\r\n            type: String as PropType<'Live' | 'Video'>,\r\n            required: true,\r\n        },\r\n    },\r\n    data() {\r\n        return {\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useChannelsStore, usePlayerStore),\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\">\r\n\r\n// DPlayer のデフォルトスタイルを上書き\r\n.watch-player__dplayer {\r\n    svg circle, svg path {\r\n        fill: var(--v-text-base) !important;\r\n    }\r\n    .dplayer-video-wrap {\r\n        background: transparent !important;\r\n        .dplayer-video-wrap-aspect {\r\n            transition: opacity 0.2s cubic-bezier(0.4, 0.38, 0.49, 0.94);\r\n            opacity: 1;\r\n        }\r\n        .dplayer-danmaku {\r\n            max-width: 100%;\r\n            max-height: calc(100% - var(--comment-area-vertical-margin, 0px));\r\n            aspect-ratio: var(--comment-area-aspect-ratio, 16 / 9);\r\n            transition: max-height 0.5s cubic-bezier(0.42, 0.19, 0.53, 0.87), aspect-ratio 0.5s cubic-bezier(0.42, 0.19, 0.53, 0.87);\r\n            will-change: aspect-ratio;\r\n            overflow: hidden;\r\n        }\r\n        .dplayer-bml-browser {\r\n            display: block;\r\n            position: absolute;\r\n            width: var(--bml-browser-width, 960px);\r\n            height: var(--bml-browser-height, 540px);\r\n            color: rgb(0, 0, 0);\r\n            overflow: hidden;\r\n            transform-origin: center;\r\n            transform: scale(var(--bml-browser-scale-factor-width, 1), var(--bml-browser-scale-factor-height, 1));\r\n            transition: opacity 0.2s cubic-bezier(0.4, 0.38, 0.49, 0.94);\r\n            opacity: 1;\r\n            aspect-ratio: 16 / 9;\r\n        }\r\n        .dplayer-danloading {\r\n            display: none !important;\r\n        }\r\n        .dplayer-loading-icon {\r\n            // ローディング表示は自前でやるため不要\r\n            display: none !important;\r\n        }\r\n    }\r\n    .dplayer-controller-mask {\r\n        height: 82px !important;\r\n        background: linear-gradient(to bottom, transparent, #000000cf) !important;\r\n        opacity: 0 !important;\r\n        visibility: hidden;\r\n        transition: opacity 0.3s ease, visibility 0.3s ease !important;\r\n        @include tablet-vertical {\r\n            height: 66px !important;\r\n        }\r\n        @include smartphone-horizontal {\r\n            height: 66px !important;\r\n        }\r\n        @include smartphone-vertical {\r\n            height: 66px !important;\r\n        }\r\n    }\r\n\r\n    .dplayer-controller {\r\n        padding-left: calc(68px + 18px) !important;\r\n        padding-right: calc(0px + 18px) !important;\r\n        padding-bottom: 6px !important;\r\n        transition: opacity 0.3s ease, visibility 0.3s ease;\r\n        opacity: 0 !important;\r\n        visibility: hidden;\r\n        @include tablet-vertical {\r\n            padding-left: calc(0px + 18px) !important;\r\n            padding-right: calc(0px + 18px) !important;\r\n        }\r\n        @include smartphone-horizontal {\r\n            padding-left: calc(0px + 18px) !important;\r\n            padding-right: calc(0px + 18px) !important;\r\n        }\r\n        @include smartphone-vertical {\r\n            padding-left: calc(0px + 18px) !important;\r\n            padding-right: calc(0px + 18px) !important;\r\n        }\r\n\r\n        .dplayer-bar-wrap {\r\n            bottom: 54px !important;\r\n            width: calc(100% - 68px - (18px * 2));\r\n            box-sizing: border-box;\r\n        }\r\n        .dplayer-time, .dplayer-live-badge {\r\n            color: var(--v-text-base) !important;\r\n        }\r\n        .dplayer-volume-bar {\r\n            background: var(--v-text-base) !important;\r\n        }\r\n        .dplayer-icons {\r\n            bottom: auto !important;\r\n            &.dplayer-icons-right {\r\n                right: 22px !important;\r\n                @include tablet-vertical {\r\n                    right: 11px !important;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    right: 11px !important;\r\n                }\r\n                @include smartphone-vertical {\r\n                    right: 11px !important;\r\n                }\r\n            }\r\n            // ブラウザフルスクリーンボタンを削除（実質あまり意味がないため）\r\n            .dplayer-icon.dplayer-full-in-icon {\r\n                display: none !important;\r\n            }\r\n            .dplayer-icon {\r\n                @include tablet-vertical {\r\n                    &.dplayer-pip-icon:after {\r\n                        left: 25%;\r\n                    }\r\n                    &.dplayer-full-icon:after {\r\n                        left: -20%;\r\n                    }\r\n                }\r\n                @include smartphone-horizontal {\r\n                    &.dplayer-pip-icon:after {\r\n                        left: 25%;\r\n                    }\r\n                    &.dplayer-full-icon:after {\r\n                        left: -20%;\r\n                    }\r\n                }\r\n                @include smartphone-vertical {\r\n                    &.dplayer-pip-icon:after {\r\n                        left: 25%;\r\n                    }\r\n                    &.dplayer-full-icon:after {\r\n                        left: -20%;\r\n                    }\r\n                }\r\n                &.dplayer-capture-icon, &.dplayer-comment-capture-icon {\r\n                    transition: background-color 0.08s ease;\r\n                    border-radius: 6px;\r\n                    &.dplayer-capturing {\r\n                        background: var(--v-secondary-lighten1);\r\n                        .dplayer-icon-content {\r\n                            opacity: 1;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        .dplayer-comment-box {\r\n            transition: opacity 0.3s ease, visibility 0.3s ease !important;\r\n            .dplayer-comment-setting-icon {\r\n                z-index: 5;\r\n            }\r\n            .dplayer-comment-input {\r\n                transition: box-shadow 0.09s ease;\r\n                appearance: none;\r\n                -webkit-appearance: none;\r\n                &:focus {\r\n                    box-shadow: rgba(79, 130, 230, 60%) 0 0 0 3.5px;\r\n                }\r\n                // iOS Safari でフォーカス時にズームされる問題への対処\r\n                @supports (-webkit-touch-callout: none) {\r\n                    @include smartphone-horizontal {\r\n                        width: calc(100% * 1.142857) !important;\r\n                        height: calc(100% * 1.142857) !important;\r\n                        font-size: 16px !important;\r\n                        transform: scale(0.875);\r\n                        transform-origin: 0 0;\r\n                    }\r\n                    @include smartphone-vertical {\r\n                        width: calc(100% * 1.142857) !important;\r\n                        height: calc(100% * 1.142857) !important;\r\n                        font-size: 16px !important;\r\n                        transform: scale(0.875);\r\n                        transform-origin: 0 0;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    .dplayer-notice {\r\n        padding: 16px 22px !important;\r\n        margin-right: 30px;\r\n        border-radius: 4px !important;\r\n        font-size: 15px !important;\r\n        line-height: 1.6;\r\n        @include tablet-vertical {\r\n            top: auto;\r\n            left: 16px !important;\r\n            padding: 12px 16px !important;\r\n            margin-right: 16px;\r\n            font-size: 13.5px !important;\r\n        }\r\n        @include smartphone-horizontal {\r\n            padding: 12px 16px !important;\r\n            margin-right: 16px;\r\n            font-size: 13.5px !important;\r\n        }\r\n        @include smartphone-vertical {\r\n            top: auto;\r\n            left: 16px !important;\r\n            padding: 12px 16px !important;\r\n            margin-right: 16px;\r\n            font-size: 13.5px !important;\r\n        }\r\n    }\r\n    .dplayer-info-panel {\r\n        transition: top 0.3s, left 0.3s;\r\n    }\r\n    .dplayer-setting-box {\r\n        z-index: 10 !important;\r\n        @include tablet-vertical {\r\n            height: calc(100% - 60px) !important;\r\n        }\r\n        @include smartphone-vertical {\r\n            height: calc(100% - 60px) !important;\r\n        }\r\n        .dplayer-setting-audio-panel {\r\n            // 副音声がない番組で副音声を選択できないように\r\n            .dplayer-setting-audio-item.dplayer-setting-audio-item--disabled {\r\n                pointer-events: none;  // クリックイベントを無効化\r\n                .dplayer-label {\r\n                    color: #AAAAAA;  // グレーアウト\r\n                }\r\n            }\r\n        }\r\n    }\r\n    .dplayer-comment-setting-box {\r\n        z-index: 10 !important;\r\n        .dplayer-comment-setting-title {\r\n            color: var(--v-text-base);\r\n        }\r\n        .dplayer-comment-setting-type, .dplayer-comment-setting-size {\r\n            span {\r\n                border: 1px solid (--v-text-base);\r\n            }\r\n            input:checked + span {\r\n                background: var(--v-text-base);\r\n            }\r\n        }\r\n    }\r\n\r\n    // モバイルのみ適用されるスタイル\r\n    &.dplayer-mobile {\r\n        .dplayer-controller {\r\n            padding-left: calc(68px + 30px) !important;\r\n            padding-right: calc(0px + 30px) !important;\r\n            @include tablet-vertical {\r\n                padding-left: calc(0px + 18px) !important;\r\n                padding-right: calc(0px + 18px) !important;\r\n            }\r\n            @include smartphone-horizontal {\r\n                padding-left: calc(0px + 18px) !important;\r\n                padding-right: calc(0px + 18px) !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                padding-left: calc(0px + 18px) !important;\r\n                padding-right: calc(0px + 18px) !important;\r\n            }\r\n            .dplayer-bar-wrap {\r\n                bottom: 51px !important;\r\n                width: calc(100% - 68px - (30px * 2));\r\n                @include tablet-vertical {\r\n                    width: calc(100% - (18px * 2));\r\n                }\r\n                @include smartphone-horizontal {\r\n                    width: calc(100% - (18px * 2));\r\n                }\r\n                @include smartphone-vertical {\r\n                    width: calc(100% - (18px * 2));\r\n                }\r\n            }\r\n        }\r\n        &.dplayer-hide-controller .dplayer-controller {\r\n            transform: none !important;\r\n        }\r\n    }\r\n\r\n    // 狭小幅デバイスのみ適用されるスタイル\r\n    &.dplayer-narrow {\r\n        .dplayer-icons.dplayer-icons-right {\r\n            right: 14px !important;\r\n        }\r\n    }\r\n}\r\n\r\n// ロード中は DPlayer 内の動画と BML ブラウザを非表示にする\r\n.watch-player.watch-player--loading {\r\n    .watch-player__dplayer {\r\n        .dplayer-video-wrap-aspect, .dplayer-bml-browser {\r\n            opacity: 0 !important;\r\n        }\r\n    }\r\n}\r\n\r\n// 仮想キーボード表示時\r\n.watch-player.watch-player--virtual-keyboard-display {\r\n    .watch-player__dplayer {\r\n        .dplayer-controller-mask {\r\n            position: absolute;\r\n            bottom: env(keyboard-inset-height, 0px) !important;\r\n            @include tablet-vertical {\r\n                bottom: 0px !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                bottom: 0px !important;\r\n            }\r\n        }\r\n        .dplayer-icons.dplayer-comment-box {\r\n            position: absolute;\r\n            bottom: calc(env(keyboard-inset-height, 0px) + 4px) !important;\r\n            @include tablet-vertical {\r\n                bottom: 6px !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                bottom: 6px !important;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// ビデオ視聴時のみ適用されるスタイル\r\n.watch-player.watch-player--video {\r\n    .watch-player__dplayer {\r\n        // コメント送信用ボタンを削除\r\n        .dplayer-controller .dplayer-icons .dplayer-comment {\r\n            display: none !important;\r\n        }\r\n    }\r\n}\r\n\r\n// Safari のみ、アイコンに hover しても opacity が変わらないようにする\r\n// hover すると 1px ずれてしまい見苦しくなる Safari の描画バグを回避するための苦肉の策\r\n// ref: https://qiita.com/Butterthon/items/10e6b58d883236aa3838\r\n_::-webkit-full-page-media, _:future, :root .dplayer-icon:hover .dplayer-icon-content {\r\n    opacity: 0.8 !important;\r\n}\r\n\r\n</style>\r\n<style lang=\"scss\" scoped>\r\n\r\n.watch-player {\r\n    display: flex;\r\n    position: relative;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-size: contain;\r\n    background-position: center;\r\n    @include tablet-vertical {\r\n        aspect-ratio: 16 / 9;\r\n    }\r\n    @include smartphone-vertical {\r\n        aspect-ratio: 16 / 9;\r\n    }\r\n\r\n    &.watch-player--video {\r\n        .watch-player__button {\r\n            right: 0px;\r\n            .switch-button {\r\n                border-top-right-radius: 0px;\r\n                border-bottom-right-radius: 0px;\r\n            }\r\n        }\r\n    }\r\n\r\n    .watch-player__background-wrapper {\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n\r\n        .watch-player__background {\r\n            position: relative;\r\n            top: 50%;\r\n            left: 50%;\r\n            max-height: 100%;\r\n            aspect-ratio: 16 / 9;\r\n            transform: translate(-50%, -50%);\r\n            background-blend-mode: overlay;\r\n            background-color: rgba(14, 14, 18, 0.35);\r\n            background-size: cover;\r\n            background-image: none;\r\n            opacity: 0;\r\n            visibility: hidden;\r\n            transition: opacity 0.4s cubic-bezier(0.4, 0.38, 0.49, 0.94), visibility 0.4s cubic-bezier(0.4, 0.38, 0.49, 0.94);\r\n            will-change: opacity;\r\n\r\n            &--display {\r\n                opacity: 1;\r\n                visibility: visible;\r\n            }\r\n\r\n            .watch-player__background-logo {\r\n                display: inline-block;\r\n                position: absolute;\r\n                height: 34px;\r\n                right: 56px;\r\n                bottom: 44px;\r\n                filter: drop-shadow(0px 0px 5px var(--v-black-base));\r\n\r\n                @include tablet-vertical {\r\n                    height: 30px;\r\n                    right: 34px;\r\n                    bottom: 30px;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    height: 25px;\r\n                    right: 30px;\r\n                    bottom: 24px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    height: 22px;\r\n                    right: 30px;\r\n                    bottom: 24px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .watch-player__buffering {\r\n        position: absolute;\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n        color: var(--v-background-lighten3);\r\n        filter: drop-shadow(0px 0px 3px rgba(0, 0, 0, 0.3));\r\n        opacity: 0;\r\n        visibility: hidden;\r\n        transition: opacity 0.2s cubic-bezier(0.4, 0.38, 0.49, 0.94), visibility 0.2s cubic-bezier(0.4, 0.38, 0.49, 0.94);\r\n        will-change: opacity;\r\n        z-index: 3;\r\n        pointer-events: none;  // クリックイベントを無効化 (重要)\r\n\r\n        &--display {\r\n            opacity: 1;\r\n            visibility: visible;\r\n        }\r\n    }\r\n\r\n    .watch-player__dplayer {\r\n        width: 100%;\r\n    }\r\n\r\n    .watch-player__button {\r\n        display: flex;\r\n        justify-content: space-around;\r\n        flex-direction: column;\r\n        position: absolute;\r\n        top: 50%;\r\n        right: 28px;\r\n        height: 190px;\r\n        transform: translateY(-50%);\r\n        opacity: 0;\r\n        visibility: hidden;\r\n        transition: opacity 0.3s, visibility 0.3s;\r\n        @include tablet-vertical {\r\n            right: 15px;\r\n            height: 128px;\r\n        }\r\n        @include smartphone-horizontal {\r\n            right: 15px;\r\n            height: 155px;\r\n        }\r\n        @include smartphone-vertical {\r\n            right: 15px;\r\n            height: 100px;\r\n        }\r\n\r\n        .switch-button {\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            width: 48px;\r\n            height: 48px;\r\n            color: var(--v-text-base);\r\n            background: #2F221FC0;\r\n            border-radius: 7px;\r\n            transition: background-color 0.15s;\r\n            user-select: none;\r\n            cursor: pointer;\r\n            @include smartphone-horizontal {\r\n                width: 38px;\r\n                height: 38px;\r\n                border-radius: 5px;\r\n            }\r\n            @include smartphone-vertical {\r\n                width: 38px;\r\n                height: 38px;\r\n                border-radius: 5px;\r\n            }\r\n\r\n            &:hover {\r\n                background: #2F221FF0;\r\n            }\r\n            // タッチデバイスで hover を無効にする\r\n            @media (hover: none) {\r\n                &:hover {\r\n                    background: #2F221FC0;\r\n                }\r\n            }\r\n\r\n            svg {\r\n                @include smartphone-horizontal {\r\n                    height: 27px;\r\n                }\r\n                @include smartphone-vertical {\r\n                    height: 27px;\r\n                }\r\n            }\r\n\r\n            .switch-button-icon {\r\n                position: relative;\r\n            }\r\n\r\n            &-up > .switch-button-icon {\r\n                top: 6px;\r\n            }\r\n            &-panel {\r\n                @include tablet-vertical {\r\n                    display: none;\r\n                }\r\n                @include smartphone-vertical {\r\n                    display: none;\r\n                }\r\n            }\r\n            &-panel > .switch-button-icon {\r\n                top: 1.5px;\r\n                transition: color 0.4s cubic-bezier(0.26, 0.68, 0.55, 0.99);\r\n            }\r\n            &-down > .switch-button-icon {\r\n                bottom: 4px;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Player.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Player.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Player.vue?vue&type=template&id=5191087c&scoped=true\"\nimport script from \"./Player.vue?vue&type=script&lang=ts\"\nexport * from \"./Player.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Player.vue?vue&type=style&index=0&id=5191087c&prod&lang=scss\"\nimport style1 from \"./Player.vue?vue&type=style&index=1&id=5191087c&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5191087c\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <div class=\"route-container\">\r\n        <main class=\"watch-container\" :class=\"{\r\n                'watch-container--control-display': playerStore.is_control_display,\r\n                'watch-container--panel-display': Utils.isSmartphoneVertical() || Utils.isTabletVertical() ? true : playerStore.is_panel_display,\r\n                'watch-container--fullscreen': playerStore.is_fullscreen,\r\n                'watch-container--video': playback_mode === 'Video',\r\n            }\">\r\n            <WatchNavigation />\r\n            <div class=\"watch-content\"\r\n                 @mousemove=\"playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event, is_player_region_event: true})\"\r\n                 @touchmove=\"playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event, is_player_region_event: true})\"\r\n                 @click=\"playerStore.event_emitter.emit('SetControlDisplayTimer', {event: $event, is_player_region_event: true})\">\r\n                <WatchHeader :playback_mode=\"playback_mode\" />\r\n                <WatchPlayer :playback_mode=\"playback_mode\" />\r\n            </div>\r\n            <WatchPanel :playback_mode=\"playback_mode\" />\r\n        </main>\r\n        <KeyboardShortcutList :playback_mode=\"playback_mode\" />\r\n    </div>\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport Vue, { PropType } from 'vue';\r\n\r\nimport WatchHeader from '@/components/Watch/Header.vue';\r\nimport KeyboardShortcutList from '@/components/Watch/KeyboardShortcutList.vue';\r\nimport WatchNavigation from '@/components/Watch/Navigation.vue';\r\nimport WatchPanel from '@/components/Watch/Panel.vue';\r\nimport WatchPlayer from '@/components/Watch/Player.vue';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils from '@/utils';\r\n\r\n// ライブ視聴・ビデオ視聴共通の視聴画面\r\nexport default Vue.extend({\r\n    name: 'Watch',\r\n    components: {\r\n        KeyboardShortcutList,\r\n        WatchHeader,\r\n        WatchNavigation,\r\n        WatchPanel,\r\n        WatchPlayer,\r\n    },\r\n    props: {\r\n        playback_mode: {\r\n            type: String as PropType<'Live' | 'Video'>,\r\n            required: true,\r\n        },\r\n    },\r\n    data() {\r\n        return {\r\n            // ユーティリティをテンプレートで使えるように\r\n            Utils: Object.freeze(Utils),\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(usePlayerStore, useSettingsStore),\r\n    },\r\n    watch: {\r\n        // 前回視聴画面を開いた際にパネルが表示されていたかどうかを随時保存する\r\n        'playerStore.is_panel_display': {\r\n            handler() {\r\n                this.settingsStore.settings.showed_panel_last_time = this.playerStore.is_panel_display;\r\n            }\r\n        }\r\n    },\r\n    // 開始時に実行\r\n    created() {\r\n\r\n        // Virtual Keyboard API に対応している場合は、仮想キーボード周りの操作を自力で行うことをブラウザに伝える\r\n        // この視聴画面のみ\r\n        if ('virtualKeyboard' in navigator) {\r\n            navigator.virtualKeyboard.overlaysContent = true;\r\n            // 仮想キーボードが表示されたり閉じられたときのイベント\r\n            navigator.virtualKeyboard.ongeometrychange = (event) => {\r\n                if (event.target.boundingRect.width === 0 && event.target.boundingRect.height === 0) {\r\n                    this.playerStore.is_virtual_keyboard_display = false;\r\n                } else {\r\n                    this.playerStore.is_virtual_keyboard_display = true;\r\n                }\r\n            };\r\n        }\r\n\r\n        // PlayerStore に視聴画面を開いたことを伝える\r\n        // 視聴画面に入るまでに変更されているかもしれない初期値を反映させる\r\n        this.playerStore.startWatching();\r\n    },\r\n    // 終了前に実行\r\n    beforeDestroy() {\r\n\r\n        // PlayerStore に視聴画面を閉じたことを伝える\r\n        this.playerStore.stopWatching();\r\n\r\n        // 仮想キーボード周りの操作をブラウザに戻す\r\n        if ('virtualKeyboard' in navigator) {\r\n            navigator.virtualKeyboard.overlaysContent = false;\r\n        }\r\n    }\r\n});\r\n\r\n</script>\r\n<style lang=\"scss\">\r\n\r\n// 上書きしたいスタイル\r\n\r\n// コントロール表示時\r\n.watch-container.watch-container--control-display {\r\n    .watch-player__dplayer {\r\n        .dplayer-controller-mask, .dplayer-controller {\r\n            opacity: 1 !important;\r\n            visibility: visible !important;\r\n            .dplayer-comment-box {\r\n                left: calc(68px + 20px);\r\n                @include tablet-vertical {\r\n                    left: calc(0px + 16px);\r\n                }\r\n                @include smartphone-horizontal {\r\n                    left: calc(0px + 16px);\r\n                }\r\n                @include smartphone-vertical {\r\n                    left: calc(0px + 16px);\r\n                }\r\n            }\r\n        }\r\n        .dplayer-notice {\r\n            left: calc(68px + 30px);\r\n            bottom: 62px;\r\n            @include tablet-vertical {\r\n                left: calc(0px + 16px);\r\n                bottom: 62px !important;\r\n            }\r\n            @include smartphone-horizontal {\r\n                left: calc(0px + 16px);\r\n            }\r\n            @include smartphone-vertical {\r\n                left: calc(0px + 16px);\r\n                bottom: 62px !important;\r\n            }\r\n        }\r\n        .dplayer-info-panel {\r\n            top: 82px;\r\n            left: calc(68px + 30px);\r\n            @include tablet-horizontal {\r\n                left: calc(0px + 16px);\r\n            }\r\n            @include smartphone-horizontal {\r\n                left: calc(0px + 16px);\r\n            }\r\n            @include smartphone-vertical {\r\n                left: calc(0px + 16px);\r\n            }\r\n        }\r\n        .dplayer-comment-setting-box {\r\n            left: calc(68px + 20px);\r\n            @include tablet-vertical {\r\n                left: calc(0px + 16px);\r\n            }\r\n            @include smartphone-horizontal {\r\n                left: calc(0px + 16px);\r\n            }\r\n            @include smartphone-vertical {\r\n                left: calc(0px + 16px);\r\n            }\r\n        }\r\n        .dplayer-mobile .dplayer-mobile-icon-wrap {\r\n            opacity: 0.7 !important;\r\n            visibility: visible !important;\r\n        }\r\n    }\r\n}\r\n\r\n// コントロール非表示時\r\n.watch-container:not(.watch-container--control-display) {\r\n    .watch-player__dplayer {\r\n        .dplayer-danmaku {\r\n            max-height: 100% !important;\r\n            aspect-ratio: 16 / 9 !important;\r\n        }\r\n        .dplayer-notice {\r\n            bottom: 20px !important;\r\n        }\r\n    }\r\n}\r\n\r\n// フルスクリーン時\r\n.watch-container.watch-container--fullscreen {\r\n    .watch-player__dplayer {\r\n        .dplayer-controller {\r\n            padding-left: 20px !important;\r\n        }\r\n        &.dplayer-mobile .dplayer-controller {\r\n            padding-left: 30px !important;\r\n            @include tablet-vertical {\r\n                padding-left: 16px !important;\r\n            }\r\n            @include smartphone-horizontal {\r\n                padding-left: 16px !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                padding-left: 16px !important;\r\n            }\r\n        }\r\n        .dplayer-comment-box, .dplayer-comment-setting-box {\r\n            left: 20px !important;\r\n            @include tablet-vertical {\r\n                left: 16px !important;\r\n            }\r\n            @include smartphone-horizontal {\r\n                left: 16px !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                left: 16px !important;\r\n            }\r\n        }\r\n    }\r\n    .watch-header__back-icon {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n// フルスクリーン時 + コントロール表示時\r\n.watch-container.watch-container--fullscreen.watch-container--control-display {\r\n    .watch-player__dplayer {\r\n        .dplayer-notice, .dplayer-info-panel {\r\n            left: 30px !important;\r\n            @include tablet-vertical {\r\n                left: 16px !important;\r\n            }\r\n            @include smartphone-horizontal {\r\n                left: 16px !important;\r\n            }\r\n            @include smartphone-vertical {\r\n                left: 16px !important;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// ビデオ視聴時 + コントロール表示時のみ適用されるスタイル\r\n.watch-container.watch-container--video.watch-container--control-display {\r\n    .watch-player__dplayer {\r\n        .dplayer-notice {\r\n            bottom: 74px !important;\r\n        }\r\n        &.dplayer-mobile .dplayer-notice {\r\n            bottom: 71px !important;\r\n        }\r\n    }\r\n}\r\n\r\n// ビデオ視聴時 + フルスクリーン時のみ適用されるスタイル\r\n.watch-container.watch-container--video.watch-container--fullscreen {\r\n    .watch-player__dplayer {\r\n        .dplayer-bar-wrap {\r\n            width: calc(100% - (18px * 2));\r\n        }\r\n        &.dplayer-mobile .dplayer-bar-wrap {\r\n            width: calc(100% - (30px * 2));\r\n            @include tablet-vertical {\r\n                width: calc(100% - (18px * 2));\r\n            }\r\n            @include smartphone-horizontal {\r\n                width: calc(100% - (18px * 2));\r\n            }\r\n            @include smartphone-vertical {\r\n                width: calc(100% - (18px * 2));\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</style>\r\n<style lang=\"scss\" scoped>\r\n\r\n.route-container {\r\n    height: 100vh !important;\r\n    height: 100dvh !important;\r\n    border-bottom: env(safe-area-inset-bottom) solid var(--v-background-base);  // Home Indicator 分浮かせる余白の背景色\r\n    background: var(--v-black-base) !important;\r\n    overflow: hidden;\r\n    // タブレット横画面・スマホ横画面のみ Home Indicator 分浮かせる余白の背景色を var(--v-black-base) にする\r\n    // 映像の左右の黒い余白と背景色を合わせる\r\n    @include tablet-horizontal {\r\n        border-bottom: env(safe-area-inset-bottom) solid var(--v-black-base);\r\n        border-left: env(safe-area-inset-left) solid var(--v-background-base);\r\n        border-right: env(safe-area-inset-right) solid var(--v-background-base);\r\n    }\r\n    @include smartphone-horizontal {\r\n        border-bottom: env(safe-area-inset-bottom) solid var(--v-black-base);\r\n        border-left: env(safe-area-inset-left) solid var(--v-background-base);\r\n        border-right: env(safe-area-inset-right) solid var(--v-background-base);\r\n    }\r\n}\r\n\r\n.watch-container {\r\n    display: flex;\r\n    width: calc(100% + 352px);  // パネルの幅分はみ出す\r\n    height: 100%;\r\n    transition: width 0.4s cubic-bezier(0.26, 0.68, 0.55, 0.99);\r\n    @include tablet-vertical {\r\n        flex-direction: column;\r\n        width: 100%;\r\n    }\r\n    @include smartphone-horizontal {\r\n        width: calc(100% + 310px); // パネルの幅分はみ出す\r\n    }\r\n    @include smartphone-vertical {\r\n        flex-direction: column;\r\n        width: 100%;\r\n    }\r\n\r\n    // コントロール表示時\r\n    &.watch-container--control-display {\r\n        .watch-content {\r\n            cursor: auto !important;\r\n        }\r\n        .watch-navigation, .watch-header {\r\n            opacity: 1 !important;\r\n            visibility: visible !important;\r\n        }\r\n        // :deep() で子コンポーネントにも CSS が効くようにする\r\n        // ref: https://qiita.com/buntafujikawa/items/b1703a2a4344fd326fe0\r\n        .watch-player :deep() {\r\n            .watch-player__button {\r\n                opacity: 1 !important;\r\n                visibility: visible !important;\r\n            }\r\n        }\r\n    }\r\n\r\n    // パネル表示時\r\n    &.watch-container--panel-display {\r\n        width: 100%;  // 画面幅に収めるように\r\n\r\n        // パネルアイコンをハイライト\r\n        .switch-button-panel .switch-button-icon {\r\n            color: var(--v-primary-base);\r\n        }\r\n\r\n        // タッチデバイスのみ、content-visibility: visible で明示的にパネルを描画する\r\n        .watch-panel {\r\n            @media (hover: none) {\r\n                content-visibility: auto;\r\n            }\r\n        }\r\n    }\r\n    @include tablet-vertical {\r\n        width: 100%;\r\n        .watch-panel {\r\n            @media (hover: none) {\r\n                content-visibility: auto;\r\n            }\r\n        }\r\n    }\r\n    @include smartphone-vertical {\r\n        width: 100%;\r\n        .watch-panel {\r\n            @media (hover: none) {\r\n                content-visibility: auto;\r\n            }\r\n        }\r\n    }\r\n\r\n    // フルスクリーン時\r\n    &.watch-container--fullscreen {\r\n\r\n        // ナビゲーションを非表示\r\n        .watch-navigation {\r\n            display: none;\r\n        }\r\n        // ナビゲーションの分の余白を削除\r\n        .watch-content {\r\n            .watch-header {\r\n                padding-left: 30px;\r\n                @include tablet-vertical {\r\n                    padding-left: 16px;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    padding-left: 16px;\r\n                }\r\n                @include smartphone-horizontal {\r\n                    padding-left: 16px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .watch-content {\r\n        display: flex;\r\n        position: relative;\r\n        width: 100%;\r\n        cursor: none;\r\n    }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Watch.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Watch.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Watch.vue?vue&type=template&id=684372b6&scoped=true\"\nimport script from \"./Watch.vue?vue&type=script&lang=ts\"\nexport * from \"./Watch.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Watch.vue?vue&type=style&index=0&id=684372b6&prod&lang=scss\"\nimport style1 from \"./Watch.vue?vue&type=style&index=1&id=684372b6&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"684372b6\",\n  null\n  \n)\n\nexport default component.exports","\r\n\r\nimport DPlayer from 'dplayer';\r\nimport { watch } from 'vue';\r\n\r\nimport router from '@/router';\r\nimport PlayerManager from '@/services/player/PlayerManager';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils from '@/utils';\r\n\r\n\r\n/**\r\n * キーボードショートカットの定義\r\n * 一部の特殊なキーコンビネーションは表現しきれないため、キーボードイベント発生時の条件分岐で直接実装している\r\n */\r\ninterface ShortcutDefinition {\r\n    // 適用対象の再生モード (Live: ライブ視聴のみ, Video: ビデオ視聴のみ, Both: 両方に適用)\r\n    mode: 'Live' | 'Video' | 'Both';\r\n    // トリガー対象のキー (KeyboardEvent.code)\r\n    key: string;\r\n    // キーリピートを許可するかどうか\r\n    repeat: boolean;\r\n    // Ctrl キーの同時押しが必要かどうか\r\n    // Mac では Ctrl キーではなく Cmd キーで判定される\r\n    ctrl: boolean;\r\n    // Shift キーの同時押しが必要かどうか\r\n    shift: boolean;\r\n    // Alt キーの同時押しが必要かどうか\r\n    // Mac では Alt キーではなく Option キーで判定される\r\n    alt: boolean;\r\n    // キーが押されたときに実行する関数\r\n    handler: () => void;\r\n}\r\n\r\n\r\n/**\r\n * 視聴画面全体のキーボードショートカットイベントを管理する PlayerManager\r\n */\r\nclass KeyboardShortcutManager implements PlayerManager {\r\n\r\n    // ユーザー操作により DPlayer 側で画質が切り替わった際、この PlayerManager の再起動が必要かどうかを PlayerController に示す値\r\n    public readonly restart_required_when_quality_switched = false;\r\n\r\n    // DPlayer のインスタンス\r\n    // 設計上コンストラクタ以降で変更すべきでないため readonly にしている\r\n    private readonly player: DPlayer;\r\n\r\n    // 再生モード (Live: ライブ視聴, Video: ビデオ視聴)\r\n    private readonly playback_mode: 'Live' | 'Video';\r\n\r\n    // キーボードショートカットイベントをキャンセルする AbortController\r\n    private abort_controller: AbortController | null = null;\r\n\r\n    /**\r\n     * コンストラクタ\r\n     * @param player DPlayer のインスタンス\r\n     * @param playback_mode 再生モード (Live: ライブ視聴, Video: ビデオ視聴)\r\n     */\r\n    constructor(player: DPlayer, playback_mode: 'Live' | 'Video') {\r\n        this.player = player;\r\n        this.playback_mode = playback_mode;\r\n    }\r\n\r\n\r\n    /**\r\n     * キーボードショートカットイベントをブラウザに登録する\r\n     */\r\n    public async init(): Promise<void> {\r\n        const channels_store = useChannelsStore();\r\n        const player_store = usePlayerStore();\r\n        const settings_store = useSettingsStore();\r\n\r\n        // キーボードショートカットイベントをキャンセルする AbortController を生成\r\n        this.abort_controller = new AbortController();\r\n\r\n        // 視聴画面のルート要素を取得\r\n        const route_container_element = document.querySelector<HTMLDivElement>('.route-container')!;\r\n\r\n        // キャプチャボタンの HTML 要素を取得\r\n        // KeyboardShortcutManager より先に CaptureManager が初期化されていることが前提\r\n        const capture_button_element = this.player.container.querySelector<HTMLDivElement>('.dplayer-capture-icon')!;\r\n        const comment_capture_button_element = this.player.container.querySelector<HTMLDivElement>('.dplayer-comment-capture-icon')!;\r\n\r\n        // ツイート送信フォーム / ツイート送信ボタンの HTML 要素を取得\r\n        // Twitter パネルコンポーネントが視聴画面に追加されていることが前提\r\n        const tweet_form_element = document.querySelector<HTMLDivElement>('.tweet-form__textarea')!;\r\n        const tweet_button_element = document.querySelector<HTMLButtonElement>('.tweet-button')!;\r\n\r\n        // 一般的なキーボードショートカットの定義\r\n        // 一部の特殊なキーコンビネーションは表現しきれないため、キーボードイベント発生時の条件分岐で直接実装している\r\n        const shortcuts: ShortcutDefinition[] = [\r\n\r\n            // ***** 全般 *****\r\n\r\n            // ↑: 前のチャンネルに切り替える\r\n            {mode: 'Live', key: 'ArrowUp', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.is_zapping = true;  // ザッピング状態にする\r\n                router.push({path: `/tv/watch/${channels_store.channel.previous.display_channel_id}`});\r\n            }},\r\n\r\n            // ↓: 次のチャンネルに切り替える\r\n            {mode: 'Live', key: 'ArrowDown', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.is_zapping = true;  // ザッピング状態にする\r\n                router.push({path: `/tv/watch/${channels_store.channel.next.display_channel_id}`});\r\n            }},\r\n\r\n            // /(？): キーボードショートカットの一覧を表示する\r\n            {mode: 'Both', key: 'Slash', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.shortcut_key_modal = !player_store.shortcut_key_modal;  // 表示状態を反転\r\n            }},\r\n\r\n            // ***** プレイヤー *****\r\n\r\n            // Space: 再生 / 一時停止の切り替え\r\n            {mode: 'Both', key: 'Space', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                this.player.toggle();\r\n            }},\r\n\r\n            // Ctrl + ←: 停止して0.5秒早戻し\r\n            {mode: 'Live', key: 'ArrowLeft', repeat: true, ctrl: true, shift: false, alt: false, handler: () => {\r\n                if (this.player.video.paused === false) {\r\n                    this.player.video.pause();\r\n                }\r\n                this.player.video.currentTime = this.player.video.currentTime - 0.5;\r\n            }},\r\n\r\n            // Ctrl + →: 停止して0.5秒早送り\r\n            {mode: 'Live', key: 'ArrowRight', repeat: true, ctrl: true, shift: false, alt: false, handler: () => {\r\n                if (this.player.video.paused === false) {\r\n                    this.player.video.pause();\r\n                }\r\n                this.player.video.currentTime = this.player.video.currentTime + 0.5;\r\n            }},\r\n\r\n            // Ctrl + ↑: プレイヤーの音量を上げる\r\n            {mode: 'Both', key: 'ArrowUp', repeat: true, ctrl: true, shift: false, alt: false, handler: () => {\r\n                this.player.volume(this.player.volume() + 0.05);\r\n            }},\r\n\r\n            // Ctrl + ↓: プレイヤーの音量を下げる\r\n            {mode: 'Both', key: 'ArrowDown', repeat: true, ctrl: true, shift: false, alt: false, handler: () => {\r\n                this.player.volume(this.player.volume() - 0.05);\r\n            }},\r\n\r\n            // Q: プレイヤーの音量をミュートする\r\n            {mode: 'Both', key: 'KeyQ', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                if (this.player.container.classList.contains('dplayer-mobile')) {\r\n                    this.player.video.muted = !this.player.video.muted;\r\n                } else {\r\n                    this.player.template.volumeButtonIcon.click();\r\n                }\r\n                if (this.player.video.muted === true) {\r\n                    this.player.notice('音量をミュート中');\r\n                } else {\r\n                    this.player.notice('音量をミュート解除');\r\n                }\r\n            }},\r\n\r\n            // W: ライブストリームの同期\r\n            {mode: 'Live', key: 'KeyW', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                this.player.sync();\r\n            }},\r\n\r\n            // R: プレイヤーを再起動する\r\n            {mode: 'Both', key: 'KeyR', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.event_emitter.emit('PlayerRestartRequired', {\r\n                    message: 'プレイヤーを再起動しました。',\r\n                    is_error_message: false,  // 明示的に上記メッセージがエラーメッセージではないことを示す (通知時の色がデフォルトになる)\r\n                });\r\n            }},\r\n\r\n            // F: フルスクリーンの切り替え\r\n            {mode: 'Both', key: 'KeyF', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                this.player.fullScreen.toggle();\r\n            }},\r\n\r\n            // E: Picture-in-Picture の表示切り替え\r\n            {mode: 'Both', key: 'KeyE', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                if (document.pictureInPictureEnabled) {\r\n                    this.player.template.pipButton.click();\r\n                }\r\n            }},\r\n\r\n            // S: 字幕の表示切り替え\r\n            {mode: 'Both', key: 'KeyS', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                this.player.subtitle!.toggle();\r\n                if (!this.player.subtitle!.container.classList.contains('dplayer-subtitle-hide')) {\r\n                    this.player.notice(`${this.player.tran('Show subtitle')}`);\r\n                } else {\r\n                    this.player.notice(`${this.player.tran('Hide subtitle')}`);\r\n                }\r\n            }},\r\n\r\n            // D: コメントの表示切り替え\r\n            {mode: 'Both', key: 'KeyD', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                this.player.template.showDanmaku.click();\r\n                if (this.player.template.showDanmakuToggle.checked) {\r\n                    this.player.notice(`${this.player.tran('Show comment')}`);\r\n                } else {\r\n                    this.player.notice(`${this.player.tran('Hide comment')}`);\r\n                }\r\n            }},\r\n\r\n            // C: 映像をキャプチャする\r\n            {mode: 'Both', key: 'KeyC', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                capture_button_element.click();\r\n            }},\r\n\r\n            // V: 映像をコメントを付けてキャプチャする\r\n            {mode: 'Both', key: 'KeyV', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                comment_capture_button_element.click();\r\n            }},\r\n\r\n            // M: コメント入力フォームにフォーカスする\r\n            // ビデオ視聴ではコメント送信自体ができないため有効化しない\r\n            {mode: 'Live', key: 'KeyM', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                this.player.controller.show();\r\n                this.player.comment!.show();\r\n                player_store.event_emitter.emit('SetControlDisplayTimer', {});\r\n                window.setTimeout(() => this.player.template.commentInput.focus(), 100);\r\n            }},\r\n\r\n            // ***** パネル *****\r\n\r\n            // P: パネルの表示切り替え\r\n            {mode: 'Both', key: 'KeyP', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.is_panel_display = !player_store.is_panel_display;  // 表示状態を反転\r\n            }},\r\n\r\n            // K: ライブ視聴: 番組情報タブを表示する\r\n            {mode: 'Live', key: 'KeyK', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.tv_panel_active_tab = 'Program';\r\n            }},\r\n\r\n            // K: ビデオ視聴: 録画番組情報タブを表示する\r\n            {mode: 'Video', key: 'KeyK', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.video_panel_active_tab = 'RecordedProgram';\r\n            }},\r\n\r\n            // L: ライブ視聴: チャンネルタブを表示する\r\n            {mode: 'Live', key: 'KeyL', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.tv_panel_active_tab = 'Channel';\r\n            }},\r\n\r\n            // L: ビデオ視聴: シリーズタブを表示する\r\n            {mode: 'Video', key: 'KeyL', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.video_panel_active_tab = 'Series';\r\n            }},\r\n\r\n            // ;(＋): コメントタブを表示する\r\n            {mode: 'Both', key: 'Semicolon', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                if (this.playback_mode === 'Live') {\r\n                    player_store.tv_panel_active_tab = 'Comment';\r\n                } else {\r\n                    player_store.video_panel_active_tab = 'Comment';\r\n                }\r\n            }},\r\n\r\n            // :(＊): Twitter タブを表示する\r\n            {mode: 'Both', key: 'Quote', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                if (this.playback_mode === 'Live') {\r\n                    player_store.tv_panel_active_tab = 'Twitter';\r\n                } else {\r\n                    player_store.video_panel_active_tab = 'Twitter';\r\n                }\r\n            }},\r\n\r\n            // ***** Twitter *****\r\n\r\n            // [(「): ツイート検索タブを表示する\r\n            {mode: 'Both', key: 'BracketRight', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.twitter_active_tab = 'Search';\r\n            }},\r\n\r\n            // ](」): タイムラインタブを表示する\r\n            {mode: 'Both', key: 'Backslash', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.twitter_active_tab = 'Timeline';\r\n            }},\r\n\r\n            // \\(￥)キー: キャプチャタブを表示する\r\n            {mode: 'Both', key: 'IntlRo', repeat: false, ctrl: false, shift: false, alt: false, handler: () => {\r\n                player_store.twitter_active_tab = 'Capture';\r\n            }},\r\n        ];\r\n\r\n        // ドキュメント全体のキーボードショートカットイベント\r\n        let last_key_pressed_at = 0;  // 最終押下時刻\r\n        document.addEventListener('keydown', (event: KeyboardEvent) => {\r\n\r\n            // 日本語 IME による入力中は無視\r\n            // event.keyCode === 229 は日本語 IME 変換確定時に発火するらしい (謎のテクニック)\r\n            if (event.isComposing === true || event.keyCode === 229) {\r\n                return;\r\n            }\r\n\r\n            // キーリピート (押しっぱなし) 状態かを検知\r\n            let is_repeat = false;\r\n            if (event.repeat) {\r\n                is_repeat = true;\r\n            }\r\n            // キーリピート状態は event.repeat を見る事でだいたい検知できるが、最初の何回かは検知できないこともある\r\n            // そこで、0.05 秒以内に連続して発火したキーイベントをキーリピートとみなす\r\n            const now = Utils.time();\r\n            if (now - last_key_pressed_at < 0.05) {\r\n                is_repeat = true;\r\n            }\r\n            last_key_pressed_at = now;  // 最終押下時刻を更新\r\n\r\n            // Ctrl or Cmd (Mac) キーが押されているかどうか\r\n            // Mac では Ctrl キーではなく Cmd キーで判定される\r\n            const is_ctrl_or_cmd_pressed = (Utils.isMacOS() === true ? event.metaKey : event.ctrlKey);\r\n            // Shift キーが押されているかどうか\r\n            const is_shift_pressed = event.shiftKey;\r\n            // Alt or Option キーが押されているかどうか\r\n            // Mac では Alt キーではなく Option キーで判定される\r\n            const is_alt_pressed = event.altKey;\r\n\r\n            // 現在パネル上でアクティブなタブ\r\n            const panel_active_tab = this.playback_mode === 'Live' ? player_store.tv_panel_active_tab : player_store.video_panel_active_tab;\r\n\r\n            // 現在フォーム (input or textarea) にフォーカスがあるかどうか\r\n            const is_form_focused = (document.activeElement instanceof HTMLInputElement ||\r\n                                     document.activeElement instanceof HTMLTextAreaElement);\r\n\r\n            // ***** 特殊な処理を行うキーボードショートカットの処理 *****\r\n\r\n            // 1~9, 0, -(=), ^(~): (ライブ視聴のみ) 押されたキーに対応するチャンネルに切り替える\r\n            // チャンネル選局のキーボードショートカットを Alt or Option + 数字キー/テンキーに変更する設定が有効なときは、\r\n            // Alt or Option キーが押されていることを条件に追加する\r\n            // フォーカスが input or textarea にあるときは誤動作防止のため無効化\r\n            if ((this.playback_mode === 'Live') &&\r\n                (is_repeat === false) &&\r\n                (is_ctrl_or_cmd_pressed === false) &&\r\n                (is_alt_pressed === (settings_store.settings.tv_channel_selection_requires_alt_key === true)) &&\r\n                (is_form_focused === false)) {\r\n\r\n                // ***** 数字キーでチャンネルを切り替える *****\r\n\r\n                // Shift キーが同時押しされていたら BS チャンネルの方を選局する\r\n                const switch_channel_type = is_shift_pressed ? 'BS' : 'GR';\r\n\r\n                // 切り替えるチャンネルのリモコン ID\r\n                // リモコン ID に当てはまるキーが押下していなければ null のままになる\r\n                let switch_remocon_id: number | null = null;\r\n\r\n                // 1～9キー\r\n                if (['Digit1', 'Digit2', 'Digit3', 'Digit4', 'Digit5', 'Digit6', 'Digit7', 'Digit8', 'Digit9'].includes(event.code)) {\r\n                    switch_remocon_id = Number(event.code.replace('Digit', ''));\r\n                }\r\n                // 0キー: 10に割り当て\r\n                if (event.code === 'Digit0') switch_remocon_id = 10;\r\n                // -キー: 11に割り当て\r\n                if (event.code === 'Minus') switch_remocon_id = 11;\r\n                // ^キー: 12に割り当て\r\n                if (event.code === 'Equal') switch_remocon_id = 12;\r\n                // 1～9キー (テンキー)\r\n                if (['Numpad1', 'Numpad2', 'Numpad3', 'Numpad4', 'Numpad5', 'Numpad6', 'Numpad7', 'Numpad8', 'Numpad9'].includes(event.code)) {\r\n                    switch_remocon_id = Number(event.code.replace('Numpad', ''));\r\n                }\r\n                // 0キー (テンキー): 10に割り当て\r\n                if (event.code === 'Numpad0') switch_remocon_id = 10;\r\n\r\n                // この時点でリモコン ID が取得できている場合のみ実行\r\n                if (switch_remocon_id !== null) {\r\n\r\n                    // 切り替え先のチャンネルを取得する\r\n                    const switch_channel = channels_store.getChannelByRemoconID(switch_channel_type, switch_remocon_id);\r\n\r\n                    // チャンネルが取得できていれば、ルーティングをそのチャンネルに置き換える\r\n                    // 押されたキーに対応するリモコン ID のチャンネルがない場合や、現在と同じチャンネル ID の場合は何も起こらない\r\n                    if (switch_channel !== null && switch_channel.display_channel_id !== channels_store.display_channel_id) {\r\n                        router.push({path: `/tv/watch/${switch_channel.display_channel_id}`});\r\n\r\n                        // 既定のキーボードショートカットイベントをキャンセルして終了\r\n                        event.preventDefault();\r\n                        event.stopPropagation();\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Ctrl + M: (ライブ視聴のみ) コメント入力フォームを閉じる\r\n            // コメント入力フォームが表示されているときのみ有効\r\n            // コメント入力フォームにフォーカスが当たっている場合も実行する\r\n            if ((this.playback_mode === 'Live') &&\r\n                (event.code === 'KeyM') &&\r\n                (is_repeat === false) &&\r\n                (is_ctrl_or_cmd_pressed === true) &&\r\n                (is_shift_pressed === false) &&\r\n                (is_alt_pressed === false) &&\r\n                (this.player.template.controller.classList.contains('dplayer-controller-comment')) &&\r\n                (is_form_focused === false || document.activeElement === this.player.template.commentInput)) {\r\n\r\n                // コメント入力フォームを閉じる\r\n                this.player.comment!.hide();\r\n\r\n                // 既定のキーボードショートカットイベントをキャンセルして終了\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                return;\r\n            }\r\n\r\n            // Ctrl + Enter: ツイートを送信する (Shift + Enter は間違えたとき用の隠し機能)\r\n            // パネルが表示されていて、かつパネルで Twitter タブが表示されているときのみ有効\r\n            // ツイート入力フォームにフォーカスが当たっている場合も実行する\r\n            if ((event.code === 'Enter') &&\r\n                (is_repeat === false) &&\r\n                (is_ctrl_or_cmd_pressed === true || is_shift_pressed === true) &&\r\n                (is_alt_pressed === false) &&\r\n                (player_store.is_panel_display === true) &&\r\n                (panel_active_tab === 'Twitter') &&\r\n                (is_form_focused === false || document.activeElement === tweet_form_element)) {\r\n\r\n                // ツイートを送信する\r\n                tweet_button_element.click();\r\n\r\n                // 既定のキーボードショートカットイベントをキャンセルして終了\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                return;\r\n            }\r\n\r\n            // Tab: ツイート入力フォームにフォーカスを当てる/フォーカスを外す\r\n            // ツイート入力フォームにフォーカスが当たっていても実行する\r\n            if ((event.code === 'Tab') &&\r\n                (is_repeat === false) &&\r\n                (is_ctrl_or_cmd_pressed === false) &&\r\n                (is_shift_pressed === false) &&\r\n                (is_alt_pressed === false) &&\r\n                (is_form_focused === false || document.activeElement === tweet_form_element)) {\r\n\r\n                // ツイート入力フォームにフォーカスがすでに当たっていたら、フォーカスを外す\r\n                if (document.activeElement === tweet_form_element) {\r\n                    tweet_form_element.blur();\r\n\r\n                // ツイート入力フォームにフォーカスが当たっていなかったら、フォーカスを当てる\r\n                } else {\r\n\r\n                    // パネルを開く\r\n                    player_store.is_panel_display = true;\r\n\r\n                    // どのタブを開いていたかに関係なく Twitter タブに切り替える\r\n                    // この時点でパネルで他のタブが表示されていた場合は、Twitter タブに切り替わる\r\n                    if (this.playback_mode === 'Live') {\r\n                        player_store.tv_panel_active_tab = 'Twitter';\r\n                    } else {\r\n                        player_store.video_panel_active_tab = 'Twitter';\r\n                    }\r\n\r\n                    // ツイート入力フォームの textarea 要素にフォーカスを当てる\r\n                    tweet_form_element.focus();\r\n\r\n                    // フォーカスを当てると画面全体が勝手に横方向にスクロールされてしまうので、元に戻す\r\n                    route_container_element.scrollLeft = 0;\r\n\r\n                    // 0.1 秒後に実行\r\n                    window.setTimeout(() => {\r\n\r\n                        // 他のタブから切り替えると一発でフォーカスが当たらないことがあるので、ちょっとだけ待ってから念押し\r\n                        // $nextTick() だと上手くいかなかった…\r\n                        tweet_form_element.focus();\r\n\r\n                        // フォーカスを当てると画面全体が勝手に横方向にスクロールされてしまうので、元に戻す\r\n                        route_container_element.scrollLeft = 0;\r\n\r\n                    }, 0.1 * 1000);\r\n                }\r\n\r\n                // 既定のキーボードショートカットイベントをキャンセルして終了\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                return;\r\n            }\r\n\r\n            // Shift + Space: 再生 / 一時停止の切り替え\r\n            // パネルが表示されていて、かつパネルで Twitter タブが表示されていて、Twitter タブ内でキャプチャタブが表示されているときのみ有効\r\n            // キャプチャタブではツイート対象のキャプチャを選択する際に Space キーを使っているため、再生 / 一時停止の切り替えのショートカットが使えない\r\n            // そこでキャプチャタブ表示中のみ、代わりに Shift + Space キーで再生 / 一時停止の切り替えを行えるようにしている\r\n            // フォーカスが input or textarea にあるときは誤動作防止のため無効化\r\n            if ((event.code === 'Space') &&\r\n                (is_repeat === false) &&\r\n                (is_ctrl_or_cmd_pressed === false) &&\r\n                (is_shift_pressed === true) &&\r\n                (is_alt_pressed === false) &&\r\n                (player_store.is_panel_display === true) &&\r\n                (panel_active_tab === 'Twitter') &&\r\n                (player_store.twitter_active_tab === 'Capture') &&\r\n                (is_form_focused === false)) {\r\n\r\n                // 再生 / 一時停止の切り替え\r\n                this.player.toggle();\r\n\r\n                // 既定のキーボードショートカットイベントをキャンセルして終了\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                return;\r\n            }\r\n\r\n            // Twitter タブ内のキャプチャタブ専用の、キャプチャ選択操作用キーボードショートカット\r\n            // キーリピート状態でも実行する\r\n            // パネルが表示されていて、かつパネルで Twitter タブが表示されていて、Twitter タブ内でキャプチャタブが表示されているときのみ有効\r\n            // この場合キーが重複するため、通常プレイヤー操作に割り当てられている矢印キー/スペースキーのショートカットは動作しない\r\n            // フォーカスが input or textarea にあるときは誤動作防止のため無効化\r\n            if ((is_ctrl_or_cmd_pressed === false) &&\r\n                (is_shift_pressed === false) &&\r\n                (is_alt_pressed === false) &&\r\n                (player_store.is_panel_display === true) &&\r\n                (panel_active_tab === 'Twitter') &&\r\n                (player_store.twitter_active_tab === 'Capture') &&\r\n                (is_form_focused === false)) {\r\n\r\n                // 無名関数の中で実行し、戻り値が true の場合のみ既定のキーボードショートカットイベントをキャンセルする\r\n                // 途中で処理を中断した場合も、そのキーのイベントを処理していたら（誤作動防止のため）既定のイベントをキャンセルする\r\n                // 戻り値が false になるのは上記条件は満たしつつも、操作対象のキーが押されていない場合のみ\r\n                const result = ((): boolean => {\r\n\r\n                    // 上下左右キー: キャプチャのフォーカスを移動する\r\n                    if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(event.code)) {\r\n\r\n                        // キャプチャリストに一枚もキャプチャがない\r\n                        if (player_store.twitter_captures.length === 0) return true;\r\n\r\n                        // まだどのキャプチャにもフォーカスされていない場合は、一番新しいキャプチャにフォーカスして終了\r\n                        if (player_store.twitter_captures.some(capture => capture.focused === true) === false) {\r\n                            player_store.twitter_captures[player_store.twitter_captures.length - 1].focused = true;\r\n                            return true;\r\n                        }\r\n\r\n                        // 現在フォーカスされているキャプチャのインデックスを取得\r\n                        const focused_capture_index = player_store.twitter_captures.findIndex(capture => capture.focused === true);\r\n\r\n                        // ↑キー: 2つ前のキャプチャにフォーカスする\r\n                        // キャプチャリストは2列で並んでいるので、2つ後のキャプチャが現在フォーカスされているキャプチャの直上になる\r\n                        if (event.code === 'ArrowUp') {\r\n                            // 2つ前のキャプチャがないなら実行しない\r\n                            if (focused_capture_index - 2 < 0) return true;\r\n                            player_store.twitter_captures[focused_capture_index - 2].focused = true;\r\n                        }\r\n\r\n                        // ↓キー: 2つ後のキャプチャにフォーカスする\r\n                        // キャプチャリストは2列で並んでいるので、2つ後のキャプチャが現在フォーカスされているキャプチャの直下になる\r\n                        if (event.code === 'ArrowDown') {\r\n                            // 2つ後のキャプチャがないなら実行しない\r\n                            if (focused_capture_index + 2 > (player_store.twitter_captures.length - 1)) return true;\r\n                            player_store.twitter_captures[focused_capture_index + 2].focused = true;\r\n                        }\r\n\r\n                        // ←キー: 1つ前のキャプチャにフォーカスする\r\n                        if (event.code === 'ArrowLeft') {\r\n                            // 1つ前のキャプチャがないなら実行しない\r\n                            if (focused_capture_index - 1 < 0) return true;\r\n                            player_store.twitter_captures[focused_capture_index - 1].focused = true;\r\n                        }\r\n\r\n                        // ←キー: 1つ後のキャプチャにフォーカスする\r\n                        if (event.code === 'ArrowRight') {\r\n                            // 1つ後のキャプチャがないなら実行しない\r\n                            if (focused_capture_index + 1 > (player_store.twitter_captures.length - 1)) return true;\r\n                            player_store.twitter_captures[focused_capture_index + 1].focused = true;\r\n                        }\r\n\r\n                        // 現在フォーカスされているキャプチャのフォーカスを外す\r\n                        player_store.twitter_captures[focused_capture_index].focused = false;\r\n\r\n                        // 拡大表示のモーダルが開かれている場合は、フォーカスしたキャプチャをモーダルにセット\r\n                        // こうすることで、QuickLook みたいな挙動になる\r\n                        const focused_capture = player_store.twitter_captures.find(capture => capture.focused === true)!;\r\n                        if (player_store.twitter_zoom_capture_modal === true) {\r\n                            player_store.twitter_zoom_capture = focused_capture;\r\n                        }\r\n\r\n                        // 現在フォーカスされているキャプチャの要素を取得\r\n                        const focused_capture_element = document.querySelector(`img[src=\"${focused_capture.image_url}\"]`)!.parentElement!;\r\n\r\n                        // 現在フォーカスされているキャプチャが見える位置までスクロール\r\n                        // block: 'nearest' を指定することで、上下どちらにスクロールしてもフォーカスされているキャプチャが常に表示されるようになる\r\n                        if (is_repeat) {\r\n                            // キーリピート状態ではスムーズスクロールがフォーカスの移動に追いつけずスクロールの挙動がおかしくなるため、\r\n                            // スムーズスクロールは無効にしてある\r\n                            focused_capture_element.scrollIntoView({block: 'nearest', inline: 'nearest', behavior: 'auto'});\r\n                        } else {\r\n                            focused_capture_element.scrollIntoView({block: 'nearest', inline: 'nearest', behavior: 'smooth'});\r\n                        }\r\n\r\n                        return true;\r\n                    }\r\n\r\n                    // Enterキー: 現在フォーカスされているキャプチャを拡大表示する/拡大表示を閉じる\r\n                    if (event.code === 'Enter') {\r\n\r\n                        // Enter キーの押下がプレイヤー側のコメント送信由来のイベントの場合は実行しない\r\n                        // コメントを送信するとコメント入力フォームへのフォーカスが即座に外れるため、is_form_focused === false の条件をすり抜けてしまう\r\n                        // そのため、event.target がコメント入力フォームの場合は実行しないようにする\r\n                        if (event.target === this.player.template.commentInput) return true;\r\n\r\n                        // すでにモーダルが開かれている場合は、どのキャプチャが拡大表示されているかに関わらず閉じる\r\n                        if (player_store.twitter_zoom_capture_modal === true) {\r\n                            player_store.twitter_zoom_capture_modal = false;\r\n                            return true;\r\n                        }\r\n\r\n                        // 現在フォーカスされているキャプチャを取得\r\n                        // まだどのキャプチャにもフォーカスされていない場合は実行しない\r\n                        const focused_capture = player_store.twitter_captures.find(capture => capture.focused === true);\r\n                        if (focused_capture === undefined) return true;\r\n\r\n                        // モーダルを開き、モーダルで拡大表示するキャプチャとしてセット\r\n                        player_store.twitter_zoom_capture = focused_capture;\r\n                        player_store.twitter_zoom_capture_modal = true;\r\n\r\n                        return true;\r\n                    }\r\n\r\n                    // Spaceキー: 現在フォーカスされているキャプチャを選択する/選択を解除する\r\n                    if (event.code === 'Space') {\r\n\r\n                        // 現在フォーカスされているキャプチャを取得\r\n                        // まだどのキャプチャにもフォーカスされていない場合は実行しない\r\n                        const focused_capture = player_store.twitter_captures.find(capture => capture.focused === true);\r\n                        if (focused_capture === undefined) return true;\r\n\r\n                        // 現在フォーカスされているキャプチャの要素を取得\r\n                        const focused_capture_element = document.querySelector(`img[src=\"${focused_capture.image_url}\"]`)!.parentElement!;\r\n\r\n                        // 「キャプチャリスト内のキャプチャがクリックされたときのイベント」を呼ぶ\r\n                        // 選択されていなければ選択され、選択されていれば選択が解除される\r\n                        // キャプチャの枚数制限などはすべて clickCapture() の中で処理される\r\n                        focused_capture_element.click();\r\n\r\n                        return true;\r\n                    }\r\n\r\n                    // 操作対象のキーが押されていない\r\n                    return false;\r\n                })();\r\n\r\n                // 既定のキーボードショートカットイベントをキャンセル\r\n                // result が false の場合実際にはショートカット処理は実行されていないので、キャンセルする必要はない\r\n                if (result === true) {\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                    return;\r\n                }\r\n            }\r\n\r\n            // ***** 一般的なキーボードショートカットの処理 *****\r\n\r\n            // フォーカスが input or textarea にあるとき、上記以外のキーボードショートカットを無効化\r\n            if (is_form_focused === true) {\r\n                return;\r\n            }\r\n\r\n            // キーボードショートカットの定義を走査して、該当するものがあれば実行\r\n            for (const shortcut of shortcuts) {\r\n\r\n                // 適用対象の再生モード が Both ではなく、初期化時の再生モードと一致しない\r\n                if (shortcut.mode !== 'Both' && shortcut.mode !== this.playback_mode) {\r\n                    continue;\r\n                }\r\n                // キーが一致しない\r\n                if (shortcut.key !== event.code) {\r\n                    continue;\r\n                }\r\n                // キーリピートを許可しない設定のショートカットで、キーリピート状態である\r\n                // キーリピートを許可する設定のショートカットでは、キーリピート状態かに関わらず実行する\r\n                if (shortcut.repeat === false && is_repeat === true) {\r\n                    continue;\r\n                }\r\n                // Ctrl or Cmd (Mac) キーの同時押しが必要かどうかが一致しない\r\n                if (shortcut.ctrl !== is_ctrl_or_cmd_pressed) {\r\n                    continue;\r\n                }\r\n                // Shift キーの同時押しが必要かどうかが一致しない\r\n                if (shortcut.shift !== is_shift_pressed) {\r\n                    continue;\r\n                }\r\n                // Alt or Option キーの同時押しが必要かどうかが一致しない\r\n                if (shortcut.alt !== is_alt_pressed) {\r\n                    continue;\r\n                }\r\n\r\n                // キーボードショートカットの実行\r\n                shortcut.handler();\r\n\r\n                // 既定のキーボードショートカットイベントをキャンセル\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n\r\n                // 実行条件に一致しキーボードショートカットを実行し終えた時点で、即座にループを抜けて終了する\r\n                return;\r\n            }\r\n\r\n        }, { signal: this.abort_controller.signal });\r\n\r\n        console.log('[KeyboardShortcutManager] Initialized.');\r\n    }\r\n\r\n\r\n    /**\r\n     * キーボードショートカットイベントをブラウザから削除する\r\n     */\r\n    public async destroy(): Promise<void> {\r\n        const player_store = usePlayerStore();\r\n\r\n        // ライブ視聴: ザッピング中のみ、ザッピングが終わるだけ待ってから非同期でキーボードショートカットイベントをキャンセルする\r\n        // 即座にキーボードショートカットイベントをキャンセルしてしまうと、ザッピングが終わるまでキーボードショートカットが効かなくなってしまう\r\n        if (this.playback_mode === 'Live' && player_store.is_zapping === true) {\r\n\r\n            // PlayerController が初期化されているかの状態が変更されたときに実行するイベントを設定\r\n            // false から true に変わったときにザッピングが終わったとみなす\r\n            const unwatch_zapping = watch(() => player_store.is_player_initialized, (new_value, old_value) => {\r\n                if (old_value === false && new_value === true) {\r\n                    // 設定したウォッチャーを両方削除\r\n                    unwatch_zapping();\r\n                    unwatch_watching();\r\n                    // キーボードショートカットイベントをキャンセル\r\n                    if (this.abort_controller !== null) {\r\n                        this.abort_controller.abort();\r\n                        this.abort_controller = null;\r\n                    }\r\n                    console.log('[KeyboardShortcutManager] Destroyed. (Zapping finished)');\r\n                }\r\n            });\r\n\r\n            // ザッピング中に視聴画面を離れたときに実行するイベントを設定\r\n            // 設定しておかないと視聴画面を離れてもキーボードショートカットイベントがキャンセルされない\r\n            // true から false に変わったときにザッピングがキャンセルされたとみなす\r\n            const unwatch_watching = watch(() => player_store.is_watching, (new_value, old_value) => {\r\n                if (old_value === true && new_value === false) {\r\n                    // 設定したウォッチャーを両方削除\r\n                    unwatch_zapping();\r\n                    unwatch_watching();\r\n                    // キーボードショートカットイベントをキャンセル\r\n                    if (this.abort_controller !== null) {\r\n                        this.abort_controller.abort();\r\n                        this.abort_controller = null;\r\n                    }\r\n                    console.log('[KeyboardShortcutManager] Destroyed. (Zapping canceled)');\r\n                }\r\n            });\r\n\r\n        // ザッピング中でなければ、即座にキーボードショートカットイベントをキャンセル\r\n        } else {\r\n            if (this.abort_controller !== null) {\r\n                this.abort_controller.abort();\r\n                this.abort_controller = null;\r\n            }\r\n            console.log('[KeyboardShortcutManager] Destroyed.');\r\n        }\r\n    }\r\n}\r\n\r\nexport default KeyboardShortcutManager;\r\n","\r\nimport { AxiosError } from 'axios';\r\n\r\nimport Message from '@/message';\r\nimport APIClient from '@/services/APIClient';\r\n\r\n\r\nclass Captures {\r\n\r\n    /**\r\n     * キャプチャをサーバーにアップロードし保存する\r\n     * @param blob キャプチャ画像の Blob\r\n     * @param filename サーバーに保存するときのファイル名\r\n     */\r\n    static async uploadCapture(blob: Blob, filename: string): Promise<void> {\r\n\r\n        // キャプチャ画像の File オブジェクト (= Blob) を FormData に入れる\r\n        // multipart/form-data で送るために必要\r\n        // ref: https://r17n.page/2020/02/04/nodejs-axios-file-upload-api/\r\n        const form_data = new FormData();\r\n        form_data.append('image', blob, filename);\r\n\r\n        // API リクエストを実行\r\n        const response = await APIClient.post('/captures', form_data, {headers: {'Content-Type': 'multipart/form-data'}});\r\n\r\n        // エラー処理\r\n        if (response.type === 'error') {\r\n            switch (response.data.detail) {\r\n                case 'Permission denied to save the file': {\r\n                    Message.error('キャプチャのアップロードに失敗しました。保存先フォルダに書き込み権限がありません。');\r\n                    break;\r\n                }\r\n                case 'No space left on the device': {\r\n                    Message.error('キャプチャのアップロードに失敗しました。保存先フォルダに空き容量がありません。');\r\n                    break;\r\n                }\r\n                case 'Unexpected error occurred while saving the file': {\r\n                    Message.error('キャプチャのアップロードに失敗しました。保存中に予期しないエラーが発生しました。');\r\n                    break;\r\n                }\r\n                default: {\r\n                    if (Number.isNaN(response.status)) {\r\n                        // HTTP リクエスト自体が失敗した場合はネットワークエラーの可能性が高い & 基本アップロードに失敗してはならないので、リトライする\r\n                        if (response.error.code === AxiosError.ECONNABORTED) {\r\n                            // ネットワーク接続エラーの場合\r\n                            Message.warning('キャプチャのアップロード中にサーバーへの接続が切断されました。リトライします。');\r\n                        } else if (response.error.code === AxiosError.ETIMEDOUT) {\r\n                            // タイムアウトの場合\r\n                            Message.warning('キャプチャのアップロード中にサーバーへの接続がタイムアウトしました。リトライします。');\r\n                        } else if (response.error.code === AxiosError.ERR_NETWORK) {\r\n                            // 予期しないネットワークエラーの場合\r\n                            Message.warning('キャプチャのアップロード中に予期しないネットワークエラーが発生しました。リトライします。');\r\n                        } else {\r\n                            // それ以外のエラーの場合\r\n                            Message.warning('キャプチャのアップロードに失敗しました。リトライします。');\r\n                        }\r\n                        await this.uploadCapture(blob, filename);\r\n                    } else {\r\n                        APIClient.showGenericError(response, 'キャプチャのアップロードに失敗しました。');\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // TODO: キャプチャ管理機能の実装時に API を追加する\r\n}\r\n\r\nexport default Captures;\r\n","\r\nimport * as Comlink from 'comlink';\r\n\r\nimport { ICaptureCompositorConstructor } from '@/workers/CaptureCompositor';\r\n\r\n\r\n// CaptureCompositor を Web Worker 上で動作させるためのラッパー\r\n// Comlink を経由し、Web Worker とメインスレッド間でオブジェクトをやり取りする\r\n// ラップ元と同じファイルに定義すると Webpack から Circler Dependency として警告されブラウザの挙動が不安定になるため、別ファイルに定義している\r\nconst worker = new Worker(new URL('@/workers/CaptureCompositor', import.meta.url));\r\nconst CaptureCompositorProxy = Comlink.wrap<ICaptureCompositorConstructor>(worker);\r\nexport default CaptureCompositorProxy;\r\n","\r\nimport assert from 'assert';\r\n\r\nimport * as Comlink from 'comlink';\r\nimport { convertBlobToPng, copyBlobToClipboard } from 'copy-image-clipboard';\r\nimport DPlayer from 'dplayer';\r\n\r\nimport Captures from '@/services/Captures';\r\nimport PlayerManager from '@/services/player/PlayerManager';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils, { dayjs } from '@/utils';\r\nimport { ICaptureCommentData, ICaptureExifData } from '@/workers/CaptureCompositor';\r\nimport CaptureCompositorProxy from '@/workers/CaptureCompositorProxy';\r\n\r\n\r\n/**\r\n * キャプチャボタンとクリックイベントをセットアップし、キャプチャの合成と保存を行う PlayerManager\r\n */\r\nclass CaptureManager implements PlayerManager {\r\n\r\n    // ユーザー操作により DPlayer 側で画質が切り替わった際、この PlayerManager の再起動が必要かどうかを PlayerController に示す値\r\n    public readonly restart_required_when_quality_switched = false;\r\n\r\n    // DPlayer のインスタンス\r\n    // 設計上コンストラクタ以降で変更すべきでないため readonly にしている\r\n    private readonly player: DPlayer;\r\n\r\n    // 再生モード (Live: ライブ視聴, Video: ビデオ視聴)\r\n    private readonly playback_mode: 'Live' | 'Video';\r\n\r\n    // キャプチャボタンの HTML 要素\r\n    private capture_button: HTMLDivElement | null = null;\r\n    private comment_capture_button: HTMLDivElement | null = null;\r\n\r\n    /**\r\n     * コンストラクタ\r\n     * @param player DPlayer のインスタンス\r\n     * @param playback_mode 再生モード (Live: ライブ視聴, Video: ビデオ視聴)\r\n     */\r\n    constructor(player: DPlayer, playback_mode: 'Live' | 'Video') {\r\n        this.player = player;\r\n        this.playback_mode = playback_mode;\r\n    }\r\n\r\n\r\n    /**\r\n     * キャプチャボタンとクリックイベントのセットアップを行う\r\n     */\r\n    public async init(): Promise<void> {\r\n\r\n        // 万が一すでにキャプチャボタンが存在していた場合は削除する\r\n        const current_capture_button = this.player.container.querySelector('.dplayer-capture-icon');\r\n        const current_comment_capture_button = this.player.container.querySelector('.dplayer-comment-capture-icon');\r\n        if (current_capture_button !== null) {\r\n            current_capture_button.remove();\r\n        }\r\n        if (current_comment_capture_button !== null) {\r\n            current_comment_capture_button.remove();\r\n        }\r\n\r\n        // キャプチャボタンの HTML を追加\r\n        // 標準のスクリーンショット機能は貧弱なので、あえて独自に実装している（そのほうが自由度も高くてやりやすい）\r\n        this.player.container.querySelector('.dplayer-player-restart-icon')!.insertAdjacentHTML('afterend', `\r\n            <div class=\"dplayer-icon dplayer-capture-icon\" aria-label=\"キャプチャ\"\r\n                data-balloon-nofocus=\"\" data-balloon-pos=\"up\">\r\n                <span class=\"dplayer-icon-content\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 32\"><path d=\"M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z\"></path></svg>\r\n                </span>\r\n            </div>\r\n        `);\r\n        this.capture_button = this.player.container.querySelector('.dplayer-capture-icon')!;\r\n\r\n        // コメント付きキャプチャボタンの HTML を追加\r\n        this.capture_button.insertAdjacentHTML('afterend', `\r\n            <div class=\"dplayer-icon dplayer-comment-capture-icon\" aria-label=\"コメントを付けてキャプチャ\"\r\n                data-balloon-nofocus=\"\" data-balloon-pos=\"up\">\r\n                <span class=\"dplayer-icon-content\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 32\"><path d=\"M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z\"></path></svg>\r\n                </span>\r\n            </div>\r\n        `);\r\n        this.comment_capture_button = this.player.container.querySelector('.dplayer-comment-capture-icon')!;\r\n\r\n        // キャプチャボタンがクリックされたときのイベントを登録\r\n        // キャプチャボタンがクリックされたら、非同期でキャプチャと保存を行う\r\n        this.capture_button.addEventListener('click', () => this.captureAndSave(false));\r\n        this.comment_capture_button.addEventListener('click', () => this.captureAndSave(true));\r\n\r\n        // 事前に CaptureCompositor 側でフォントをロードしておく\r\n        await CaptureCompositorProxy.loadFonts();\r\n\r\n        console.log('[CaptureManager] Initialized.');\r\n    }\r\n\r\n\r\n    /**\r\n     * キャプチャボタンのハイライト (ボタンの周囲が赤くなる) を追加する\r\n     * @param comment_capture_button_instead 代わりにコメント付きキャプチャボタンの方をハイライトするか\r\n     */\r\n    private addHighlight(comment_capture_button_instead: boolean = false): void {\r\n        assert(this.capture_button !== null && this.comment_capture_button !== null);\r\n        if (comment_capture_button_instead) {\r\n            this.comment_capture_button.classList.add('dplayer-capturing');\r\n        } else {\r\n            this.capture_button.classList.add('dplayer-capturing');\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * キャプチャボタンのハイライト (ボタンの周囲が赤くなる) を外す\r\n     * @param comment_capture_button_instead 代わりにコメント付きキャプチャボタンの方のハイライトを外すか\r\n     */\r\n    private removeHighlight(comment_capture_button_instead: boolean = false): void {\r\n        assert(this.capture_button !== null && this.comment_capture_button !== null);\r\n        if (comment_capture_button_instead) {\r\n            this.comment_capture_button.classList.remove('dplayer-capturing');\r\n        } else {\r\n            this.capture_button.classList.remove('dplayer-capturing');\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * キャプチャに合成する際に必要なコメント情報を生成する\r\n     * @returns キャプチャに合成する際に必要なコメント情報\r\n     */\r\n    private createCaptureCommentData(): ICaptureCommentData | null {\r\n\r\n        const capture_comment_data: ICaptureCommentData = {\r\n            // DOM 上のコメントのコンテナ要素の幅と高さ (px)\r\n            container_width: this.player.danmaku!.container.offsetWidth,\r\n            container_height: this.player.danmaku!.container.offsetHeight,\r\n            // コメント全体の不透明度 (0.0 ～ 1.0)\r\n            opacity: this.player.danmaku!._opacity,\r\n            // コメントごとの情報\r\n            comments: [],\r\n        };\r\n\r\n        // 各コメントの DOM 要素を取得\r\n        const selector = '.dplayer-danmaku-item:not(.dplayer-danmaku-item--demo)';\r\n        for (const comment_element of this.player.danmaku!.container.querySelectorAll<HTMLDivElement>(selector)) {\r\n\r\n            // コメントのテキストが null の場合はスキップ (基本ないはず)\r\n            if (comment_element.textContent === null) {\r\n                continue;\r\n            }\r\n\r\n            // 取得したスタイル情報を基に、描画する上で必要となるコメント情報を構築\r\n            const computed_style = window.getComputedStyle(comment_element);\r\n            capture_comment_data.comments.push({\r\n                // スクロール中・固定表示中のコメントの表示座標を計算\r\n                top: comment_element.getBoundingClientRect().top - this.player.danmaku!.container.getBoundingClientRect().top,\r\n                left: comment_element.getBoundingClientRect().left - this.player.danmaku!.container.getBoundingClientRect().left,\r\n                // コメントの色\r\n                color: computed_style.color,\r\n                // コメントのフォントサイズ (px)\r\n                font_size: parseFloat(computed_style.fontSize.replaceAll('px', '')),\r\n                // コメントのテキスト\r\n                text: comment_element.textContent.trim(),  // 念のため前後の空白を削除\r\n            });\r\n        }\r\n\r\n        // もしコメントが一つもなかった場合は null を返す\r\n        if (capture_comment_data.comments.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        return capture_comment_data;\r\n    }\r\n\r\n\r\n    /**\r\n     * キャプチャした画像の EXIF に書き込むメタデータ情報を生成する\r\n     * ライブ視聴時とビデオ視聴時で設定するメタデータが異なる\r\n     * 現在時刻をキャプチャの撮影時刻として EXIF メタデータに設定するので、このメソッドはキャプチャを撮影する直前にのみ呼び出すこと\r\n     * is_caption_composited / is_comment_composited のみ、実際の状態に合わせて CaptureCompositor 側で上書きされる\r\n     * @returns キャプチャした画像の EXIF に書き込むメタデータ情報\r\n     */\r\n    private createCaptureExifData(): ICaptureExifData {\r\n        const channels_store = useChannelsStore();\r\n        const player_store = usePlayerStore();\r\n\r\n        // 現在の時刻 (ISO8601 フォーマット)\r\n        // 現在時刻をキャプチャの撮影時刻として EXIF に書き込む\r\n        const captured_at = dayjs().format();\r\n\r\n        // 字幕がプレイヤー上で表示されているかどうか\r\n        // 字幕自体は存在するが表示されていない場合は false になる\r\n        const aribb24_caption = this.player.plugins.aribb24Caption!;\r\n        const is_caption_showing = ((aribb24_caption as any).isShowing === true && aribb24_caption.isPresent());\r\n\r\n        // 字幕がプレイヤー上で表示されている場合、表示中の字幕のテキストを取得\r\n        // 取得した字幕のテキストは、キャプチャに字幕が合成されているかに関わらず、常に EXIF メタデータに書き込まれる\r\n        // 字幕が表示されていない場合は null を入れ、キャプチャしたシーンで字幕が表示されていなかったことを明示する\r\n        const caption_text = is_caption_showing ? aribb24_caption.getTextContent() : null;\r\n\r\n        // ライブ視聴: 現在視聴中のチャンネル情報・番組情報を EXIF メタデータに設定\r\n        let capture_exif_data: ICaptureExifData;\r\n        if (this.playback_mode === 'Live') {\r\n            capture_exif_data = {\r\n                captured_at: captured_at,\r\n                captured_playback_position: -1,  // 後の処理で設定するが、ここでは実装上の都合で -1 を入れておく\r\n                network_id: channels_store.channel.current.network_id,\r\n                service_id: channels_store.channel.current.service_id,\r\n                event_id: channels_store.channel.current.program_present?.event_id ?? -1,\r\n                title: channels_store.channel.current.program_present?.title ?? '放送休止',\r\n                description: channels_store.channel.current.program_present?.description ?? '',\r\n                start_time: channels_store.channel.current.program_present?.start_time ?? '2000-01-01T00:00:00+09:00',\r\n                end_time: channels_store.channel.current.program_present?.end_time ?? '2000-01-01T00:00:00+09:00',\r\n                duration: channels_store.channel.current.program_present?.duration ?? 0,\r\n                caption_text: caption_text,\r\n                is_caption_composited: false,  // 字幕が合成されているか (実際の状態に合わせて CaptureCompositor 側で上書きされる)\r\n                is_comment_composited: false,  // コメントが合成されているか (実際の状態に合わせて CaptureCompositor 側で上書きされる)\r\n            };\r\n        // ビデオ視聴: 現在視聴中の録画番組情報を EXIF メタデータに設定\r\n        } else {\r\n            capture_exif_data = {\r\n                captured_at: captured_at,\r\n                captured_playback_position: -1,  // 後の処理で設定するが、ここでは実装上の都合で -1 を入れておく\r\n                network_id: player_store.recorded_program.network_id ?? -1,\r\n                service_id: player_store.recorded_program.service_id ?? -1,\r\n                event_id: player_store.recorded_program.event_id ?? -1,\r\n                title: player_store.recorded_program.title,\r\n                description: player_store.recorded_program.description,\r\n                start_time: player_store.recorded_program.start_time,\r\n                end_time: player_store.recorded_program.end_time,\r\n                duration: player_store.recorded_program.duration,\r\n                caption_text: caption_text,\r\n                is_caption_composited: false,  // 字幕が合成されているか (実際の状態に合わせて CaptureCompositor 側で上書きされる)\r\n                is_comment_composited: false,  // コメントが合成されているか (実際の状態に合わせて CaptureCompositor 側で上書きされる)\r\n            };\r\n        }\r\n\r\n        // 番組開始時刻換算のキャプチャ時刻 (秒) を設定\r\n        // ライブ視聴: 現在進行形で放送されているので、番組開始時刻からの経過時間 (現在時刻 - 番組開始時刻) を設定する\r\n        if (this.playback_mode === 'Live') {\r\n            capture_exif_data.captured_playback_position = dayjs().diff(dayjs(capture_exif_data.start_time), 'second', true);\r\n        // ビデオ視聴: 動画の現在の再生位置から、録画開始マージンを引いた値を設定する\r\n        // これで (録画開始マージンが取得できていない場合以外は) ライブ視聴時と比較可能な値になる\r\n        } else {\r\n            capture_exif_data.captured_playback_position = this.player.video.currentTime - player_store.recorded_program.recording_start_margin;\r\n        }\r\n\r\n        return capture_exif_data;\r\n    }\r\n\r\n\r\n    /**\r\n     * 映像をキャプチャし、設定で指定された方法で保存する\r\n     * 映像のみと字幕付き (字幕表示時のみ) の両方のキャプチャを生成できる\r\n     * @param is_comment_composite キャプチャにコメントを合成するかどうか\r\n     */\r\n    private async captureAndSave(is_comment_composite: boolean): Promise<void> {\r\n        const channels_store = useChannelsStore();\r\n        const player_store = usePlayerStore();\r\n        const settings_store = useSettingsStore();\r\n        const start_time = Utils.time();\r\n\r\n        // ***** バリデーション *****\r\n\r\n        // ラジオチャンネルを視聴している場合 (映像がないのでキャプチャできない)\r\n        // この場合映像の幅/高さも 0 になるので、このチェックは必ず先に行う\r\n        if (this.playback_mode === 'Live' && channels_store.channel.current.is_radiochannel === true) {\r\n            this.player.notice('ラジオチャンネルはキャプチャできません。', undefined, undefined, '#FF6F6A');\r\n            return;\r\n        }\r\n\r\n        // まだ映像の表示準備が終わっていない (映像の幅/高さが 0 のまま)\r\n        if (this.player.video.videoWidth === 0 && this.player.video.videoHeight === 0) {\r\n            this.player.notice('読み込み中はキャプチャできません。', undefined, undefined, '#FF6F6A');\r\n            return;\r\n        }\r\n\r\n        // コメントが表示されていないのにコメント付きでキャプチャしようとした\r\n        if (is_comment_composite === true && this.player.danmaku!.showing === false) {\r\n            this.player.notice('コメントを付けてキャプチャするには、コメント表示をオンにしてください。', undefined, undefined, '#FF6F6A');\r\n            return;\r\n        }\r\n\r\n        // ***** キャプチャの事前準備 *****\r\n\r\n        // キャプチャ中はキャプチャボタンをハイライトする\r\n        this.addHighlight(is_comment_composite);\r\n\r\n        // aribb24js.CanvasID3Renderer のインスタンスを取得\r\n        // PlayerController での実装上、aribb24.js (字幕) は必ず有効になっている\r\n        const aribb24_caption = this.player.plugins.aribb24Caption!;\r\n        // aribb24.js (文字スーパー) はビデオ視聴では常に無効なほか、ライブ視聴でも設定によっては無効になる\r\n        const aribb24_superimpose = this.player.plugins.aribb24Superimpose ?? null;\r\n\r\n        // 字幕・文字スーパーの Canvas を取得\r\n        // getRawCanvas() で映像と同じ解像度の Canvas が取得できる\r\n        const caption_canvas = aribb24_caption.getRawCanvas()!;\r\n        const superimpose_canvas = aribb24_superimpose?.getRawCanvas() ?? null;\r\n\r\n        // 字幕/文字スーパーが表示されているか\r\n        const is_caption_showing = ((aribb24_caption as any).isShowing === true && aribb24_caption.isPresent());\r\n        const is_superimpose_showing = (aribb24_superimpose && (aribb24_superimpose as any).isShowing === true && aribb24_superimpose.isPresent());\r\n\r\n        // ***** キャプチャの実行・字幕/文字スーパー/コメントを合成 *****\r\n\r\n        // 高速化のため、Promise.all() で並列に実行する\r\n        const create_image_bitmap_results = await Promise.all([\r\n            // 現在再生中の動画のキャプチャを ImageBitmap として取得\r\n            createImageBitmap(this.player.video),\r\n            // 字幕が表示されていれば、字幕の Canvas を ImageBitmap として取得\r\n            is_caption_showing ? createImageBitmap(caption_canvas) : null,\r\n            // 文字スーパーが表示されていれば、文字スーパーの Canvas を ImageBitmap として取得\r\n            is_superimpose_showing ? createImageBitmap(superimpose_canvas!) : null,\r\n        ]);\r\n        const image_bitmaps = create_image_bitmap_results.filter((image_bitmap) => image_bitmap !== null) as ImageBitmap[];\r\n        const capture_image_bitmap = create_image_bitmap_results[0];\r\n        const caption_image_bitmap = create_image_bitmap_results[1];\r\n        const superimpose_image_bitmap = create_image_bitmap_results[2];\r\n\r\n        // キャプチャにコメントを合成する場合、コメントを取得する\r\n        const capture_comment_data = is_comment_composite ? this.createCaptureCommentData() : null;\r\n\r\n        // キャプチャに書き込む EXIF メタデータを取得\r\n        // is_caption_composited / is_comment_composited のみ、実際の状態に合わせて CaptureCompositor 側で上書きされる\r\n        const capture_exif_data = this.createCaptureExifData();\r\n\r\n        // キャプチャの合成を実行し、字幕なしキャプチャと字幕ありキャプチャを生成する\r\n        // Web Worker 側に ImageBitmap を移譲するため、Comlink.transfer() を使う\r\n        // 第二引数に (第一引数内のオブジェクトに含まれる) 移譲する Transferable オブジェクトを渡す\r\n        console.log('\\u001b[36m[CaptureManager] Composite start:');\r\n        const capture_compositor_start_time = Utils.time();\r\n        const capture_compositor = await new CaptureCompositorProxy(Comlink.transfer({\r\n            mode: settings_store.settings.capture_caption_mode,\r\n            capture: capture_image_bitmap,\r\n            caption: caption_image_bitmap,\r\n            superimpose: superimpose_image_bitmap,\r\n            capture_comment_data: capture_comment_data,\r\n            capture_exif_data: capture_exif_data,\r\n        }, image_bitmaps));\r\n        const result = await capture_compositor.composite();\r\n        console.log('\\u001b[36m[CaptureManager] Composite end:', Utils.mathFloor(Utils.time() - capture_compositor_start_time, 3), 'sec');\r\n\r\n        // ファイル名（拡張子なし）\r\n        // TODO: ファイル名パターンを設定で変更できるようにする\r\n        const filename_base = `Capture_${dayjs().format('YYYYMMDD-HHmmss')}`;\r\n        const filename_normal = `${filename_base}.jpg`;  // 字幕なしキャプチャ\r\n        const filename_caption = `${filename_base}_caption.jpg`;  // 字幕ありキャプチャ\r\n\r\n        // ***** キャプチャの保存 *****\r\n\r\n        // 字幕なしキャプチャ\r\n        // 必ず字幕なしキャプチャから保存する\r\n        if (result.capture_normal !== null) {\r\n\r\n            // 生成した Blob をイベントリスナーに送信する\r\n            player_store.event_emitter.emit('CaptureCompleted', {\r\n                capture: result.capture_normal,\r\n                filename: filename_normal,\r\n            });\r\n\r\n            // キャプチャの保存先: ブラウザでダウンロード or 両方\r\n            if (['Browser', 'Both'].includes(settings_store.settings.capture_save_mode)) {\r\n                Utils.downloadBlobData(result.capture_normal, filename_normal);\r\n            }\r\n\r\n            // キャプチャの保存先: KonomiTV サーバーにアップロード or 両方\r\n            // 時間がかかるし完了を待つ必要がないので非同期\r\n            if (['UploadServer', 'Both'].includes(settings_store.settings.capture_save_mode)) {\r\n                Captures.uploadCapture(result.capture_normal, filename_normal);\r\n            }\r\n        }\r\n\r\n        // 字幕ありキャプチャ\r\n        if (result.capture_caption !== null) {\r\n\r\n            // 生成した Blob をイベントリスナーに送信する\r\n            player_store.event_emitter.emit('CaptureCompleted', {\r\n                capture: result.capture_caption,\r\n                filename: filename_normal,\r\n            });\r\n\r\n            // キャプチャの保存先: ブラウザでダウンロード or 両方\r\n            if (['Browser', 'Both'].includes(settings_store.settings.capture_save_mode)) {\r\n                Utils.downloadBlobData(result.capture_caption, filename_caption);\r\n            }\r\n\r\n            // キャプチャの保存先: KonomiTV サーバーにアップロード or 両方\r\n            // アップロードに時間が掛かる上、完了を待つ必要もないので非同期\r\n            if (['UploadServer', 'Both'].includes(settings_store.settings.capture_save_mode)) {\r\n                Captures.uploadCapture(result.capture_caption, filename_caption);\r\n            }\r\n        }\r\n\r\n        // キャプチャが終わったので、キャプチャボタンのハイライトを削除する\r\n        // ただし、キャプチャに掛かった時間が 0.1 秒未満の場合は、0.1 秒経過後にハイライトを削除する (すぐに削除すると一瞬すぎて見えないため)\r\n        const total_time = Utils.mathFloor(Utils.time() - start_time, 3);\r\n        if (total_time < 0.1) {\r\n            setTimeout(() => this.removeHighlight(is_comment_composite), 100);\r\n        } else {\r\n            this.removeHighlight(is_comment_composite);\r\n        }\r\n        console.log('\\u001b[36m[CaptureManager] Total:', total_time, 'sec');\r\n\r\n        // ***** クリップボードへのキャプチャ画像のコピー *****\r\n\r\n        // キャプチャ画像をクリップボードにコピーする設定が有効な場合、クリップボードにコピーする\r\n        // クリップボードへのコピーにはかなり時間がかかるので、ハイライトを削除してからバックグラウンドで実行する\r\n        // 残念ながらクリップボード操作は Web Worker 上では行えないので、メインスレッド側で実行している\r\n        if (settings_store.settings.capture_copy_to_clipboard === true) {\r\n            for (const capture of [result.capture_normal, result.capture_caption]) {\r\n                if (capture !== null) {\r\n                    try {\r\n                        await copyBlobToClipboard(await convertBlobToPng(capture));\r\n                    } catch (error) {\r\n                        this.player.notice('クリップボードへのキャプチャのコピーに失敗しました。', undefined, undefined, '#FF6F6A');\r\n                        console.error(error);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 何もしない\r\n     * 本来であれば init() で動的に追加したキャプチャボタンの HTML 要素を削除するべきだが、\r\n     * 実装上 PlayerController の破棄が完了する前にボタンを削除してしまうと、キャプチャボタンだけ一瞬消える不恰好な状態になってしまう\r\n     * このため、代わりに init() 側にすでにキャプチャボタンが追加済みであれば一旦削除する処理を入れている\r\n     */\r\n    public async destroy(): Promise<void> {\r\n\r\n        // 何もしない\r\n        console.log('[CaptureManager] Destroyed.');\r\n    }\r\n}\r\n\r\nexport default CaptureManager;\r\n","\r\nimport { throttle } from '@github/mini-throttle';\r\nimport DPlayer, { DPlayerType } from 'dplayer';\r\n\r\nimport Channels from '@/services/Channels';\r\nimport PlayerManager from '@/services/player/PlayerManager';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport useUserStore from '@/stores/UserStore';\r\nimport Utils, { dayjs, CommentUtils } from '@/utils';\r\n\r\n\r\nexport interface ICommentData {\r\n    id: number;\r\n    text: string;\r\n    time: string;\r\n    playback_position: number;\r\n    user_id: string;\r\n    my_post: boolean;\r\n}\r\n\r\ninterface IWatchSessionInfo {\r\n    is_success: boolean;\r\n    detail: string;\r\n    message_server_url?: string;\r\n    thread_id?: string;\r\n    your_post_key?: string;\r\n}\r\n\r\n\r\n/**\r\n * ライブ視聴: ニコニコ実況からリアルタイムに受信したコメントを DPlayer やイベントリスナーに送信する PlayerManager\r\n */\r\nclass LiveCommentManager implements PlayerManager {\r\n\r\n    // ユーザー操作により DPlayer 側で画質が切り替わった際、この PlayerManager の再起動が必要かどうかを PlayerController に示す値\r\n    public readonly restart_required_when_quality_switched = false;\r\n\r\n    // DPlayer のインスタンス\r\n    // 設計上コンストラクタ以降で変更すべきでないため readonly にしている\r\n    private readonly player: DPlayer;\r\n\r\n    // 視聴セッションの WebSocket のインスタンス\r\n    private watch_session: WebSocket | null = null;\r\n\r\n    // コメントセッションの WebSocket のインスタンス\r\n    private comment_session: WebSocket | null = null;\r\n\r\n    // vpos を計算する基準となる時刻のタイムスタンプ\r\n    private vpos_base_timestamp: number = 0;\r\n\r\n    // 座席維持用のタイマーのインターバル ID\r\n    private keep_seat_interval_id: number | null = null;\r\n\r\n    // destroy() 時に EventListener を全解除するための AbortController\r\n    private abort_controller: AbortController = new AbortController();\r\n\r\n    // 破棄済みかどうか\r\n    private destroyed = false;\r\n\r\n    /**\r\n     * コンストラクタ\r\n     * @param player DPlayer のインスタンス\r\n     */\r\n    constructor(player: DPlayer) {\r\n        this.player = player;\r\n    }\r\n\r\n\r\n    /**\r\n     * ニコニコ実況に接続し、セッションを初期化する\r\n     */\r\n    public async init(): Promise<void> {\r\n        const player_store = usePlayerStore();\r\n        const user_store = useUserStore();\r\n\r\n        // 破棄済みかどうかのフラグを下ろす\r\n        this.destroyed = false;\r\n\r\n        // ユーザー情報を事前にキャッシュさせておく\r\n        await user_store.fetchUser();\r\n\r\n        // 視聴セッションを初期化\r\n        const watch_session_info = await this.initWatchSession();\r\n        if (watch_session_info.is_success === false) {\r\n\r\n            // 初期化に失敗した際のエラーメッセージを設定する\r\n            // UI 側のエラー表示に利用されるほか、null から string になったことで初期化に失敗したことを示す\r\n            player_store.live_comment_init_failed_message = watch_session_info.detail;\r\n            console.error(`[LiveCommentManager][WatchSession] Error: ${watch_session_info.detail}`);\r\n\r\n            // 通常発生しないエラーメッセージ (サーバーエラーなど) はプレイヤー側にも通知する\r\n            if ((watch_session_info.detail !== 'このチャンネルはニコニコ実況に対応していません。') &&\r\n                (watch_session_info.detail !== '現在放送中のニコニコ実況がありません。')) {\r\n                if (this.player.template.notice.textContent!.includes('再起動しています…') === false) {\r\n                    this.player.notice(watch_session_info.detail, undefined, undefined, '#FF6F6A');\r\n                }\r\n            }\r\n            return;\r\n        }\r\n\r\n        // 視聴セッションを初期化できた場合のみ、\r\n        // 取得したコメントサーバーへの接続情報を使い、非同期でコメントセッションを初期化\r\n        this.initCommentSession(watch_session_info);\r\n\r\n        console.log('[LiveCommentManager] Initialized.');\r\n    }\r\n\r\n\r\n    /**\r\n     * 視聴セッションを初期化する\r\n     * @returns コメントサーバーへの接続情報 or エラー情報\r\n     */\r\n    private async initWatchSession(): Promise<IWatchSessionInfo> {\r\n        const channels_store = useChannelsStore();\r\n\r\n        // サーバーから disconnect メッセージが送られてきた際のフラグ\r\n        let is_disconnect_message_received = false;\r\n\r\n        // セッション情報を取得\r\n        const watch_session_info = await Channels.fetchJikkyoSession(channels_store.channel.current.id);\r\n        if (watch_session_info === null) {\r\n            return {\r\n                is_success: false,\r\n                detail: 'ニコニコ実況のセッション情報を取得できませんでした。',\r\n            };\r\n        }\r\n        if (watch_session_info.is_success === false) {\r\n            return {\r\n                is_success: false,\r\n                detail: watch_session_info.detail,\r\n            };\r\n        }\r\n\r\n        // 視聴セッション WebSocket を開く\r\n        this.watch_session = new WebSocket(watch_session_info.audience_token!);\r\n\r\n        // 視聴セッションの接続が開かれたとき\r\n        this.watch_session.addEventListener('open', () => {\r\n\r\n            // 視聴セッションをリクエスト\r\n            // 公式ドキュメントいわく、stream フィールドは Optional らしい\r\n            // サーバー負荷軽減のため、映像が不要な場合は必ず省略してくださいとのこと\r\n            this.watch_session?.send(JSON.stringify({\r\n                type: 'startWatching',\r\n                data: {\r\n                    'reconnect': false,\r\n                },\r\n            }));\r\n\r\n        }, { signal: this.abort_controller.signal });\r\n\r\n        // 視聴セッションの接続が閉じられたとき（ネットワークが切断された場合など）\r\n        this.watch_session.addEventListener('close', async (event) => {\r\n\r\n            // すでに disconnect メッセージが送られてきている場合は何もしない\r\n            if (is_disconnect_message_received === true) {\r\n                return;\r\n            }\r\n\r\n            // 接続切断の理由を表示\r\n            if (this.player.template.notice.textContent!.includes('再起動しています…') === false) {\r\n                this.player.notice(`ニコニコ実況との接続が切断されました。(Code: ${event.code})`, undefined, undefined, '#FF6F6A');\r\n            }\r\n            console.error(`[LiveCommentManager][WatchSession] Connection closed. (Code: ${event.code})`);\r\n\r\n            // 10 秒ほど待ってから再接続する\r\n            // ニコ生側から切断された場合と異なりネットワークが切断された可能性が高いので、間を多めに取る\r\n            await Utils.sleep(10);\r\n            await this.reconnect();\r\n\r\n        }, { signal: this.abort_controller.signal });\r\n\r\n        // 視聴セッション WebSocket からメッセージを受信したとき\r\n        // 視聴セッションはコメント送信時のために維持し続ける必要がある\r\n        // 以下はいずれも視聴セッションを維持し続けたり、エラーが発生した際に再接続するための処理\r\n        this.watch_session.addEventListener('message', async (event) => {\r\n            if (this.watch_session === null) return;\r\n\r\n            // 各メッセージタイプに対応する処理を実行\r\n            const message = JSON.parse(event.data);\r\n            switch (message.type) {\r\n\r\n                // 座席情報\r\n                case 'seat': {\r\n                    // すでにタイマーが設定されている場合は何もしない\r\n                    if (this.keep_seat_interval_id !== null) {\r\n                        break;\r\n                    }\r\n                    // keepIntervalSec の秒数ごとに keepSeat を送信して座席を維持する\r\n                    this.keep_seat_interval_id = window.setInterval(() => {\r\n                        if (this.watch_session && this.watch_session.readyState === WebSocket.OPEN) {\r\n                            // セッションがまだ開いていれば、座席を維持する\r\n                            this.watch_session.send(JSON.stringify({type: 'keepSeat'}));\r\n                        } else {\r\n                            // セッションが閉じられている場合は、タイマーを停止する\r\n                            window.clearInterval(this.keep_seat_interval_id ?? 0);\r\n                        }\r\n                    }, message.data.keepIntervalSec * 1000);\r\n                    break;\r\n                }\r\n\r\n                // ping-pong\r\n                case 'ping': {\r\n                    // pong を返してセッションを維持する\r\n                    // 送り返さなかった場合、勝手にセッションが閉じられてしまう\r\n                    this.watch_session.send(JSON.stringify({type: 'pong'}));\r\n                    break;\r\n                }\r\n\r\n                // エラー情報\r\n                case 'error': {\r\n                    // COMMENT_POST_NOT_ALLOWED と INVALID_MESSAGE に関しては sendComment() の方で処理するので、ここでは何もしない\r\n                    if (message.data.code === 'COMMENT_POST_NOT_ALLOWED' || message.data.code === 'INVALID_MESSAGE') {\r\n                        break;\r\n                    }\r\n\r\n                    let error = `ニコニコ実況でエラーが発生しています。(Code: ${message.data.code})`;\r\n                    switch (message.data.code) {\r\n                        case 'CONNECT_ERROR':\r\n                            error = 'ニコニコ実況のコメントサーバーに接続できません。';\r\n                            break;\r\n                        case 'CONTENT_NOT_READY':\r\n                            error = 'ニコニコ実況が配信できない状態です。';\r\n                            break;\r\n                        case 'NO_THREAD_AVAILABLE':\r\n                            error = 'ニコニコ実況のコメントスレッドを取得できません。';\r\n                            break;\r\n                        case 'NO_ROOM_AVAILABLE':\r\n                            error = 'ニコニコ実況のコメント部屋を取得できません。';\r\n                            break;\r\n                        case 'NO_PERMISSION':\r\n                            error = 'ニコニコ実況の API にアクセスする権限がありません。';\r\n                            break;\r\n                        case 'NOT_ON_AIR':\r\n                            error = 'ニコニコ実況が放送中ではありません。';\r\n                            break;\r\n                        case 'BROADCAST_NOT_FOUND':\r\n                            error = 'ニコニコ実況の配信情報を取得できません。';\r\n                            break;\r\n                        case 'INTERNAL_SERVERERROR':\r\n                            error = 'ニコニコ実況でサーバーエラーが発生しています。';\r\n                            break;\r\n                    }\r\n\r\n                    // エラー情報を表示\r\n                    if (this.player.template.notice.textContent!.includes('再起動しています…') === false) {\r\n                        this.player.notice(error, undefined, undefined, '#FF6F6A');\r\n                    }\r\n                    console.error(`[LiveCommentManager][WatchSession] Error occurred. (Code: ${message.data.code})`);\r\n\r\n                    // 5 秒ほど待ってから再接続する\r\n                    await Utils.sleep(5);\r\n                    await this.reconnect();\r\n                    break;\r\n                }\r\n\r\n                // 再接続を求められた\r\n                case 'reconnect': {\r\n                    // waitTimeSec に記載の秒数だけ待ってから再接続する\r\n                    // 公式ドキュメントには reconnect で送られてくる audienceToken で再接続しろと書いてあるんだけど、\r\n                    // 確実性的な面で実装が面倒なので当面このままにしておく\r\n                    await this.reconnect();\r\n                    break;\r\n                }\r\n\r\n                // 視聴セッションが閉じられた（4時のリセットなど）\r\n                case 'disconnect': {\r\n                    // 実際に接続が閉じられる前に disconnect メッセージが送られてきたので、\r\n                    // WebSocket の close メッセージを実行させないようにする\r\n                    is_disconnect_message_received = true;\r\n\r\n                    // 接続切断の理由\r\n                    let disconnect_reason = `ニコニコ実況との接続が切断されました。(${message.data.reason})`;\r\n                    switch (message.data.reason) {\r\n                        case 'TAKEOVER':\r\n                            disconnect_reason = 'ニコニコ実況の番組から追い出されました。';\r\n                            break;\r\n                        case 'NO_PERMISSION':\r\n                            disconnect_reason = 'ニコニコ実況の番組の座席を取得できませんでした。';\r\n                            break;\r\n                        case 'END_PROGRAM':\r\n                            disconnect_reason = 'ニコニコ実況がリセットされたか、コミュニティの番組が終了しました。';\r\n                            break;\r\n                        case 'PING_TIMEOUT':\r\n                            disconnect_reason = 'コメントサーバーとの接続生存確認に失敗しました。';\r\n                            break;\r\n                        case 'TOO_MANY_CONNECTIONS':\r\n                            disconnect_reason = 'ニコニコ実況の同一ユーザからの接続数上限を越えています。';\r\n                            break;\r\n                        case 'TOO_MANY_WATCHINGS':\r\n                            disconnect_reason = 'ニコニコ実況の同一ユーザからの視聴番組数上限を越えています。';\r\n                            break;\r\n                        case 'CROWDED':\r\n                            disconnect_reason = 'ニコニコ実況の番組が満席です。';\r\n                            break;\r\n                        case 'MAINTENANCE_IN':\r\n                            disconnect_reason = 'ニコニコ実況はメンテナンス中です。';\r\n                            break;\r\n                        case 'SERVICE_TEMPORARILY_UNAVAILABLE':\r\n                            disconnect_reason = 'ニコニコ実況で一時的にサーバーエラーが発生しています。';\r\n                            break;\r\n                    }\r\n\r\n                    // 接続切断の理由を表示\r\n                    if (this.player.template.notice.textContent!.includes('再起動しています…') === false) {\r\n                        this.player.notice(disconnect_reason, undefined, undefined, '#FF6F6A');\r\n                    }\r\n                    console.error(`[LiveCommentManager][WatchSession] Disconnected. (Reason: ${message.data.reason})`);\r\n\r\n                    // 5 秒ほど待ってから再接続する\r\n                    await Utils.sleep(5);\r\n                    await this.reconnect();\r\n                    break;\r\n                }\r\n            }\r\n\r\n        }, { signal: this.abort_controller.signal });\r\n\r\n        // コメントサーバーへの接続情報を返す\r\n        // イベント内で値を返すため、Promise で包む\r\n        return new Promise((resolve) => {\r\n            this.watch_session!.addEventListener('message', async (event) => {\r\n                const message = JSON.parse(event.data);\r\n                if (message.type === 'room') {\r\n\r\n                    // vpos の基準時刻のタイムスタンプを取得 (ミリ秒単位)\r\n                    // vpos は番組開始時間からの累計秒数\r\n                    this.vpos_base_timestamp = dayjs(message.data.vposBaseTime).valueOf();\r\n\r\n                    // コメントサーバーへの接続情報を返す\r\n                    console.log(`[LiveCommentManager][WatchSession] Connected.\\nThread ID: ${message.data.threadId}\\n`);\r\n                    return resolve({\r\n                        is_success: true,\r\n                        detail: '視聴セッションを取得しました。',\r\n                        // コメントサーバーへの接続情報\r\n                        message_server_url: message.data.messageServer.uri,\r\n                        // コメントサーバー上のスレッド ID\r\n                        thread_id: message.data.threadId,\r\n                        // メッセージサーバーから受信するコメント (chat メッセージ) に yourpost フラグを付けるためのキー\r\n                        your_post_key: (message.data.yourPostKey ? message.data.yourPostKey : null),\r\n                    });\r\n                }\r\n            }, { signal: this.abort_controller.signal });\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * コメントセッションを初期化する\r\n     * @param comment_session_info コメントサーバーへの接続情報\r\n     */\r\n    private initCommentSession(comment_session_info: IWatchSessionInfo): void {\r\n        const player_store = usePlayerStore();\r\n\r\n        // 初回接続時に一括で送信されてくる過去コメントを受信し終えるまで格納するバッファ\r\n        const initial_comments_buffer: ICommentData[] = [];\r\n\r\n        // 初回接続時に一括で送信されてくる過去コメントを受信し終えたかどうかのフラグ\r\n        let initial_comments_received = false;\r\n\r\n        // 受信したコメントを一時的に格納するバッファ (スロットル用)\r\n        const comments_buffer: ICommentData[] = [];\r\n\r\n        // コメントセッション WebSocket を開く\r\n        this.comment_session = new WebSocket(comment_session_info.message_server_url!);\r\n\r\n        // コメントセッション WebSocket を開いたとき\r\n        this.comment_session.addEventListener('open', () => {\r\n            if (this.comment_session === null) return;\r\n\r\n            // コメント送信をリクエスト\r\n            // このコマンドを送らないとコメントが送信されてこない\r\n            this.comment_session.send(JSON.stringify([\r\n                {ping: {content: 'rs:0'}},\r\n                {ping: {content: 'ps:0'}},\r\n                {\r\n                    thread: {\r\n                        version: '20061206',  // 設定必須\r\n                        thread: comment_session_info.thread_id,  // スレッド ID\r\n                        threadkey: comment_session_info.your_post_key,  // スレッドキー\r\n                        user_id: '',  // ユーザー ID（設定不要らしい）\r\n                        res_from: -50,  // 最初にコメントを 50 個送信する\r\n                    }\r\n                },\r\n                {ping: {content: 'pf:0'}},\r\n                {ping: {content: 'rf:0'}},\r\n            ]));\r\n\r\n        }, { signal: this.abort_controller.signal });\r\n\r\n        // 受信したコメントをイベントリスナーに送信する関数\r\n        // スロットルを設定し、333ms 未満の間隔でイベントが発火しないようにする\r\n        const emit_comments = throttle(() => {\r\n            if (Utils.isSafari() === false) {\r\n                console.debug('[LiveCommentManager][CommentSession] Comments buffer length:', comments_buffer.length);\r\n            }\r\n            if (this.destroyed === false) {  // まだ破棄されていない場合のみイベントを発火\r\n                player_store.event_emitter.emit('CommentReceived', {\r\n                    is_initial_comments: false,\r\n                    comments: comments_buffer,\r\n                });\r\n            }\r\n            // バッファを空にする\r\n            comments_buffer.length = 0;\r\n        }, 333);\r\n\r\n        // コメントセッション WebSocket からメッセージを受信したとき\r\n        this.comment_session.addEventListener('message', async (event) => {\r\n\r\n            // メッセージを取得\r\n            const message = JSON.parse(event.data);\r\n\r\n            // 接続失敗\r\n            if (message.thread !== undefined) {\r\n                if (message.thread.resultcode !== 0) {\r\n                    console.error(`[LiveCommentManager][CommentSession] Connection failed. (Code: ${message.thread.resultcode})`);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            // ping メッセージのみ\r\n            // rf:0 が送られてきたら初回接続時に一括で送信されてくる過去コメントの受信は完了している\r\n            // この時点で初期コメントを一気にイベントリスナーに送信する\r\n            if (message.ping !== undefined && message.ping.content === 'rf:0') {\r\n                initial_comments_received = true;\r\n                if (this.destroyed === false) {  // まだ破棄されていない場合のみイベントを発火\r\n                    player_store.event_emitter.emit('CommentReceived', {\r\n                        is_initial_comments: true,\r\n                        comments: initial_comments_buffer,\r\n                    });\r\n                }\r\n                return;\r\n            }\r\n\r\n            // コメントデータを取得\r\n            const comment = message.chat;\r\n\r\n            // コメントデータが不正な場合 or 自分のコメントの場合は弾く\r\n            if ((comment === undefined || comment.content === undefined || comment.content === '') ||\r\n                (comment.yourpost && comment.yourpost === 1)) {\r\n                return;\r\n            }\r\n\r\n            // コメントコマンドをパース\r\n            const { color, position, size } = CommentUtils.parseCommentCommand(comment.mail);\r\n\r\n            // ミュート対象のコメントかどうかを判定し、もしそうならここで弾く\r\n            if (CommentUtils.isMutedComment(comment.content, comment.user_id, color, position, size)) {\r\n                return;\r\n            }\r\n\r\n            // コメントリストへ追加するオブジェクト\r\n            const comment_data: ICommentData = {\r\n                id: comment.no,\r\n                text: comment.content,\r\n                time: dayjs(comment.date * 1000).format('HH:mm:ss'),\r\n                playback_position: this.player.video.currentTime,\r\n                user_id: comment.user_id,\r\n                my_post: false,\r\n            };\r\n\r\n            // もしまだ初期コメントを受信し終えていないなら、バッファに格納して終了\r\n            // 初期コメントはプレイヤーには描画しないため問題ない\r\n            if (initial_comments_received === false) {\r\n                initial_comments_buffer.push(comment_data);\r\n                return;\r\n            }\r\n\r\n            // 配信で発生する遅延分待ってから\r\n            // おおよその遅延時間は video.buffered.end(0) - video.currentTime で取得できる\r\n            let buffered_end = 0;\r\n            if (this.player.video.buffered.length >= 1) {\r\n                buffered_end = this.player.video.buffered.end(0);\r\n            }\r\n            const comment_delay_time = Math.max(buffered_end - this.player.video.currentTime, 0);\r\n            if (Utils.isSafari() === false) {\r\n                console.debug(`[LiveCommentManager][CommentSession] Delay: ${comment_delay_time} sec.`);\r\n            }\r\n            await Utils.sleep(comment_delay_time);\r\n\r\n            // コメントを一時バッファに格納し、スロットルを設定してイベントリスナーに送信する\r\n            // コメントの受信間隔が 333ms 以上あれば、今回のコールバックで取得したコメントがダイレクトにイベントリスナーに送信される\r\n            comments_buffer.push(comment_data);\r\n            emit_comments();\r\n\r\n            // プレイヤーにコメントを描画する (映像再生時のみ)\r\n            if (this.player.video.paused === false) {\r\n                this.player.danmaku!.draw({\r\n                    text: comment.content,\r\n                    color: color,\r\n                    type: position,\r\n                    size: size,\r\n                });\r\n            }\r\n\r\n        }, { signal: this.abort_controller.signal });\r\n    }\r\n\r\n\r\n    /**\r\n     * ニコニコ実況にコメントを送信する\r\n     * @param options DPlayer のコメントオプション\r\n     */\r\n    public sendComment(options: DPlayerType.APIBackendSendOptions): void {\r\n        const player_store = usePlayerStore();\r\n        const user_store = useUserStore();\r\n\r\n        // 初期化に失敗しているときは実行せず、保存しておいたエラーメッセージを表示する\r\n        if (player_store.live_comment_init_failed_message !== null) {\r\n            options.error(player_store.live_comment_init_failed_message);\r\n            return;\r\n        }\r\n\r\n        // ログイン関連のバリデーション\r\n        if (user_store.user === null) {\r\n            options.error('コメントするには、KonomiTV アカウントにログインしてください。');\r\n            return;\r\n        }\r\n        if (user_store.user.niconico_user_id === null) {\r\n            options.error('コメントするには、ニコニコアカウントと連携してください。');\r\n            return;\r\n        }\r\n        if (user_store.user.niconico_user_premium === false && (options.data.type === 'top' || options.data.type === 'bottom')) {\r\n            options.error('コメントを上下に固定するには、ニコニコアカウントのプレミアム会員登録が必要です。');\r\n            return;\r\n        }\r\n        if (user_store.user.niconico_user_premium === false && options.data.size === 'big') {\r\n            options.error('コメントサイズを大きめに設定するには、ニコニコアカウントのプレミアム会員登録が必要です。');\r\n            return;\r\n        }\r\n\r\n        // 視聴セッションが null か、接続が既に切れている場合\r\n        if (this.watch_session === null || this.watch_session.readyState !== WebSocket.OPEN) {\r\n            console.error('[LiveCommentManager][WatchSession] Comment sending failed. (Connection is not established.)');\r\n            options.error('コメントの送信に失敗しました。WebSocket 接続が確立されていません。');\r\n            return;\r\n        }\r\n\r\n        // DPlayer 上のコメント色（カラーコード）とニコニコの色コマンド定義のマッピング\r\n        const color_table = {\r\n            '#FFEAEA': 'white',\r\n            '#F02840': 'red',\r\n            '#FD7E80': 'pink',\r\n            '#FDA708': 'orange',\r\n            '#FFE133': 'yellow',\r\n            '#64DD17': 'green',\r\n            '#00D4F5': 'cyan',\r\n            '#4763FF': 'blue',\r\n        };\r\n\r\n        // DPlayer 上のコメント位置を表す値とニコニコの位置コマンド定義のマッピング\r\n        const position_table = {\r\n            'top': 'ue',\r\n            'right': 'naka',\r\n            'bottom': 'shita',\r\n        };\r\n\r\n        // vpos を計算 (10ミリ秒単位)\r\n        // 番組開始時間からの累計秒らしいけど、なぜ指定しないといけないのかは不明\r\n        // 小数点以下は丸めないとコメントサーバー側で投稿エラーになる\r\n        const vpos = Math.round((dayjs().valueOf() - this.vpos_base_timestamp) / 10);\r\n\r\n        // コメントを送信\r\n        this.watch_session.send(JSON.stringify({\r\n            'type': 'postComment',\r\n            'data': {\r\n                // コメント本文\r\n                'text': options.data.text,\r\n                // コメントの色\r\n                'color': color_table[options.data.color.toUpperCase()],\r\n                // コメント位置\r\n                'position': position_table[options.data.type],\r\n                // コメントサイズ (DPlayer とニコニコで表現が共通なため、変換不要)\r\n                'size': options.data.size,\r\n                // 番組開始時間からの累計秒 (10ミリ秒単位)\r\n                'vpos': vpos,\r\n                // 匿名コメント (184) にするかどうか\r\n                'isAnonymous': true,\r\n            }\r\n        }));\r\n\r\n        // コメント送信のレスポンスを取得\r\n        const abort_controller = new AbortController();\r\n        this.watch_session.addEventListener('message', (event) => {\r\n            const message = JSON.parse(event.data);\r\n            switch (message.type) {\r\n\r\n                // postCommentResult が送られてきた → コメント送信に成功している\r\n                case 'postCommentResult': {\r\n                    // コメント成功を DPlayer にコールバックで通知\r\n                    options.success();\r\n\r\n                    // 送信したコメントを整形してコメントリストに送信\r\n                    player_store.event_emitter.emit('CommentSendCompleted', {\r\n                        comment: {\r\n                            id: Utils.time(),  // ID は取得できないので現在の時間をユニークな ID として利用する\r\n                            text: options.data.text,  // コメント本文\r\n                            time: dayjs().format('HH:mm:ss'),  // 現在時刻\r\n                            playback_position: this.player.video.currentTime,  // 現在の再生位置\r\n                            user_id: `${user_store.user!.niconico_user_id!}`,  // ニコニコユーザー ID\r\n                            my_post: true,  // 自分のコメントであることを示すフラグ\r\n                        }\r\n                    });\r\n\r\n                    // イベントリスナーを削除\r\n                    abort_controller.abort();\r\n                    break;\r\n                }\r\n\r\n                // コメント送信直後に error が送られてきた → コメント送信に失敗している\r\n                case 'error': {\r\n                    // コメント失敗を DPlayer にコールバックで通知\r\n                    let error = `コメントの送信に失敗しました。(${message.data.code})`;\r\n                    switch (message.data.code) {\r\n                        case 'COMMENT_POST_NOT_ALLOWED':\r\n                            error = 'コメントが許可されていません。';\r\n                            break;\r\n                        case 'INVALID_MESSAGE':\r\n                            error = 'コメント内容が無効です。';\r\n                            break;\r\n                    }\r\n                    console.error(`[LiveCommentManager][WatchSession] Comment sending failed. (Code: ${message.data.code})`);\r\n                    options.error(error);\r\n\r\n                    // イベントリスナーを解除\r\n                    abort_controller.abort();\r\n                    break;\r\n                }\r\n            }\r\n        }, { signal: abort_controller.signal });\r\n    }\r\n\r\n\r\n    /**\r\n     * 同じ設定でニコニコ実況に再接続する\r\n     */\r\n    private async reconnect(): Promise<void> {\r\n        const player_store = usePlayerStore();\r\n\r\n        // 再接続を開始\r\n        console.warn('[LiveCommentManager] Reconnecting...');\r\n        if (this.player.template.notice.textContent!.includes('再起動しています…') === false) {\r\n            this.player.notice('ニコニコ実況に再接続しています…');\r\n        }\r\n\r\n        // 前の視聴セッション・コメントセッションを破棄\r\n        await this.destroy();\r\n\r\n        // 視聴セッションを再初期化\r\n        const watch_session_info = await this.initWatchSession();\r\n        if (watch_session_info.is_success === false) {\r\n\r\n            // 初期化に失敗した際のエラーメッセージを設定する\r\n            // UI 側のエラー表示に利用されるほか、null から string になったことで初期化に失敗したことを示す\r\n            player_store.live_comment_init_failed_message = watch_session_info.detail;\r\n            console.error('[LiveCommentManager] Reconnection failed.');\r\n\r\n            // 無条件にエラーメッセージをプレイヤーに通知\r\n            if (this.player.template.notice.textContent!.includes('再起動しています…') === false) {\r\n                this.player.notice(watch_session_info.detail, undefined, undefined, '#FF6F6A');\r\n            }\r\n            return;\r\n        }\r\n\r\n        // 視聴セッションを初期化できた場合のみ、\r\n        // 取得したコメントサーバーへの接続情報を使い、非同期でコメントセッションを初期化\r\n        this.initCommentSession(watch_session_info);\r\n\r\n        console.warn('[LiveCommentManager] Reconnected.');\r\n    }\r\n\r\n\r\n    /**\r\n     * 視聴セッションとコメントセッションをそれぞれ閉じる\r\n     */\r\n    public async destroy(): Promise<void> {\r\n        const player_store = usePlayerStore();\r\n\r\n        // セッションに紐いているすべての EventListener を解除\r\n        // 再接続する場合に備えて AbortController を作り直す\r\n        this.abort_controller.abort();\r\n        this.abort_controller = new AbortController();\r\n\r\n        // 視聴セッションを閉じる\r\n        if (this.watch_session !== null) {\r\n            this.watch_session.close();  // WebSocket を閉じる\r\n            this.watch_session = null;  // null に戻す\r\n        }\r\n\r\n        // コメントセッションを閉じる\r\n        if (this.comment_session !== null) {\r\n            this.comment_session.close();  // WebSocket を閉じる\r\n            this.comment_session = null;  // null に戻す\r\n        }\r\n\r\n        // 座席保持用のタイマーをクリア\r\n        if (this.keep_seat_interval_id !== null) {\r\n            window.clearInterval(this.keep_seat_interval_id);\r\n            this.keep_seat_interval_id = null;\r\n        }\r\n        this.vpos_base_timestamp = 0;\r\n\r\n        // 初期化に失敗した際のエラーメッセージを削除\r\n        player_store.live_comment_init_failed_message = null;\r\n\r\n        // 破棄済みかどうかのフラグを立てる\r\n        this.destroyed = true;\r\n\r\n        console.log('[LiveCommentManager] Destroyed.');\r\n    }\r\n}\r\n\r\nexport default LiveCommentManager;\r\n","\r\nimport * as Comlink from 'comlink';\r\n\r\nimport { ILivePSIArchivedDataDecoderConstructor } from '@/workers/LivePSIArchivedDataDecoder';\r\n\r\n\r\n// LivePSIArchivedDataDecoder を Web Worker 上で動作させるためのラッパー\r\n// Comlink を経由し、Web Worker とメインスレッド間でオブジェクトをやり取りする\r\n// ラップ元と同じファイルに定義すると Webpack から Circler Dependency として警告されブラウザの挙動が不安定になるため、別ファイルに定義している\r\nconst worker = new Worker(new URL('@/workers/LivePSIArchivedDataDecoder', import.meta.url));\r\nconst LivePSIArchivedDataDecoderProxy = Comlink.wrap<ILivePSIArchivedDataDecoderConstructor>(worker);\r\nexport default LivePSIArchivedDataDecoderProxy;\r\n","\r\nimport * as Comlink from 'comlink';\r\nimport DPlayer from 'dplayer';\r\nimport { BMLBrowser, BMLBrowserFontFace } from 'web-bml/client/bml_browser';\r\nimport { AribKeyCode } from 'web-bml/client/content';\r\n\r\nimport router from '@/router';\r\nimport PlayerManager from '@/services/player/PlayerManager';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils, { PlayerUtils } from '@/utils';\r\nimport { ILivePSIArchivedDataDecoder } from '@/workers/LivePSIArchivedDataDecoder';\r\nimport LivePSIArchivedDataDecoderProxy from '@/workers/LivePSIArchivedDataDecoderProxy';\r\n\r\n\r\n/**\r\n * ライブ視聴: データ放送機能を管理する PlayerManager\r\n */\r\nclass LiveDataBroadcastingManager implements PlayerManager {\r\n\r\n    // ユーザー操作により DPlayer 側で画質が切り替わった際、この PlayerManager の再起動が必要かどうかを PlayerController に示す値\r\n    public readonly restart_required_when_quality_switched = true;\r\n\r\n    // BML 用フォント\r\n    private static readonly ROUND_GOTHIC: BMLBrowserFontFace = {\r\n        source: 'url(\"/assets/fonts/KosugiMaru-Regular.woff2\"), local(\"sans-serif\")',\r\n    };\r\n    private static readonly SQUARE_GOTHIC: BMLBrowserFontFace = {\r\n        source: 'url(\"/assets/fonts/Kosugi-Regular.woff2\"), local(\"sans-serif\")',\r\n    };\r\n\r\n    // DPlayer のインスタンス\r\n    // 設計上コンストラクタ以降で変更すべきでないため readonly にしている\r\n    private readonly player: DPlayer;\r\n\r\n    private readonly media_element: HTMLElement;\r\n    private container_element: HTMLElement | null = null;\r\n    private readonly remocon_element: HTMLElement;\r\n    private readonly remocon_data_broadcasting_element: HTMLElement;\r\n    private remocon_button_event_abort_controller: AbortController | null = null;\r\n\r\n    // DPlayer のリサイズを監視する ResizeObserver\r\n    private resize_observer: ResizeObserver | null = null;\r\n\r\n    // BML ブラウザのインスタンス\r\n    // Vue.js は data() で設定した変数を再帰的に監視するが、BMLBrowser 内の JS-Interpreter のインスタンスが\r\n    // Vue.js の監視対象に入ると謎のエラーが発生してしまうため、プロパティを Hard Private にして監視対象から外す\r\n    #bml_browser: BMLBrowser | null = null;\r\n\r\n    // BML ブラウザの幅と高さ\r\n    private bml_browser_width: number = 960;\r\n    private bml_browser_height: number = 540;\r\n\r\n    // BML ブラウザが数字キーを文字入力などに利用中かどうか\r\n    private is_bml_browser_using_numeric_key: boolean = false;\r\n\r\n    // BML ブラウザを破棄中かどうか\r\n    private is_bml_browser_destroying: boolean = false;\r\n\r\n    // 動画の要素が BML ブラウザ上に移動されているかどうか\r\n    private is_video_element_moved_to_bml_browser: boolean = false;\r\n\r\n    // PSI/SI アーカイブデータデコーダーのインスタンス\r\n    private live_psi_archived_data_decoder: Comlink.Remote<ILivePSIArchivedDataDecoder> | null = null;\r\n\r\n    /**\r\n     * コンストラクタ\r\n     * @param player DPlayer のインスタンス\r\n     */\r\n    constructor(player: DPlayer) {\r\n        this.player = player;\r\n\r\n        // 映像が入る DOM 要素\r\n        // DPlayer 内の dplayer-video-wrap-aspect をそのまま使う (中に映像と字幕が含まれる)\r\n        this.media_element = this.player.template.videoWrapAspect;\r\n\r\n        // リモコンの DOM 要素\r\n        this.remocon_element = document.querySelector('.remote-control')!;\r\n        this.remocon_data_broadcasting_element = this.remocon_element.querySelector('.remote-control-data-broadcasting')!;\r\n    }\r\n\r\n\r\n    /**\r\n     * LiveDataBroadcastingManager での処理を開始する\r\n     * EDCB Legacy WebUI での実装を参考にした\r\n     * ref: https://github.com/xtne6f/EDCB/blob/work-plus-s-230212/ini/HttpPublic/legacy/util.lua#L444-L497\r\n     */\r\n    public async init(): Promise<void> {\r\n        const channels_store = useChannelsStore();\r\n\r\n        const is_data_broadcasting_enabled = useSettingsStore().settings.tv_show_data_broadcasting;\r\n        console.log(`[LiveDataBroadcastingManager] BMLBrowser: ${is_data_broadcasting_enabled ? 'enabled' : 'disabled'}`);\r\n\r\n        // リモコンのボタンを初期化\r\n        this.initRemoconButtons();\r\n\r\n        // データ放送機能有効時のみ\r\n        if (is_data_broadcasting_enabled === true) {\r\n\r\n            // BML ブラウザが入る DOM 要素\r\n            // DPlayer 内の dplayer-video-wrap の中に動的に追加する (映像レイヤーより下)\r\n            // 要素のスタイルは Watch.vue で定義されている\r\n            this.container_element = document.createElement('div');\r\n            this.container_element.classList.add('dplayer-bml-browser');\r\n            this.container_element = this.player.template.videoWrap.insertAdjacentElement('afterbegin', this.container_element) as HTMLElement;\r\n\r\n            // リモコンのボタンを有効化\r\n            // データ放送機能無効時はボタンを無効のままにする\r\n            this.toggleRemoconButtonsEnabled(true);\r\n\r\n            // リモコンをローディング状態にする\r\n            this.toggleRemoconButtonsLoading(true);\r\n\r\n            // BML ブラウザの初期化\r\n            const this_ = this;\r\n            this.#bml_browser = new BMLBrowser({\r\n                mediaElement: document.createElement('p'),  // ここではダミーの p 要素を渡す\r\n                containerElement: this.container_element,\r\n                storagePrefix: 'KonomiTV-BMLBrowser_',\r\n                nvramPrefix: 'nvram_',\r\n                broadcasterDatabasePrefix: '',\r\n                videoPlaneModeEnabled: true,\r\n                fonts: {\r\n                    roundGothic: LiveDataBroadcastingManager.ROUND_GOTHIC,\r\n                    squareGothic: LiveDataBroadcastingManager.SQUARE_GOTHIC,\r\n                },\r\n                // ステータス更新時のイベント\r\n                indicator: {\r\n                    setUrl(name: string, loading: boolean) {\r\n                        this_.toggleRemoconButtonsLoading(loading);\r\n                    },\r\n                    setNetworkingGetStatus(connecting: boolean) {\r\n                        this_.toggleRemoconButtonsLoading(connecting);\r\n                    },\r\n                    setNetworkingPostStatus(connecting: boolean) {\r\n                        this_.toggleRemoconButtonsLoading(connecting);\r\n                    },\r\n                    setReceivingStatus(receiving: boolean) {\r\n                        // 何もしない\r\n                    },\r\n                    setEventName(name: string) {\r\n                        // 何もしない\r\n                    }\r\n                },\r\n                // Greg: 受信機の電源を切るまでグローバルに持続するメモリ\r\n                greg: {\r\n                    getReg(index: number) {\r\n                        let Greg: string[];\r\n                        if (window.sessionStorage.getItem('KonomiTV-BMLBrowser-Greg') === null) {\r\n                            // 初回は Greg を初期化する\r\n                            Greg = [...new Array(64)].map(_ => '');\r\n                        } else {\r\n                            // 2回目以降は SessionStorage 内の Greg を復元する\r\n                            Greg = JSON.parse(window.sessionStorage.getItem('KonomiTV-BMLBrowser-Greg')!);\r\n                        }\r\n                        return Greg[index] ?? '';\r\n                    },\r\n                    setReg(index: number, value: string) {\r\n                        let Greg: string[];\r\n                        if (window.sessionStorage.getItem('KonomiTV-BMLBrowser-Greg') === null) {\r\n                            // 初回は Greg を初期化する\r\n                            Greg = [...new Array(64)].map(_ => '');\r\n                        } else {\r\n                            // 2回目以降は SessionStorage 内の Greg を復元する\r\n                            Greg = JSON.parse(window.sessionStorage.getItem('KonomiTV-BMLBrowser-Greg')!);\r\n                        }\r\n                        Greg[index] = value;\r\n                        window.sessionStorage.setItem('KonomiTV-BMLBrowser-Greg', JSON.stringify(Greg));\r\n                    },\r\n                },\r\n                // データ放送からのチャンネル切り替え機能\r\n                epg: {\r\n                    tune(network_id: number, transport_stream_id: number, service_id: number): boolean {\r\n                        // 選局対象のチャンネルが現在視聴中のチャンネルと同じ場合\r\n                        if (channels_store.channel.current.network_id === network_id && channels_store.channel.current.service_id === service_id) {\r\n                            // 非同期で LiveDataBroadcastingManager を再起動\r\n                            // チャンネル切り替え後は BML ブラウザがフリーズするため\r\n                            (async () => {\r\n                                await this_.destroy();\r\n                                await this_.init();\r\n                            })();\r\n                            return true;\r\n                        }\r\n                        // チャンネルリストから network_id と service_id が一致するチャンネルを探す\r\n                        // transport_stream_id は Mirakurun バックエンドの場合は存在しないため使わない\r\n                        // network_id + service_id だけで一意になる\r\n                        for (const channels of Object.values(channels_store.channels_list)) {\r\n                            for (const channel of channels) {\r\n                                if (channel.network_id === network_id && channel.service_id === service_id) {\r\n                                    // 少し待ってからチャンネルを切り替える（チャンネル切り替え時にデータ放送側から音が鳴る可能性があるため）\r\n                                    Utils.sleep(0.3).then(() => router.push({path: `/tv/watch/${channel.display_channel_id}`}));\r\n                                    return true;\r\n                                }\r\n                            }\r\n                        }\r\n                        // network_id と service_id が一致するチャンネルが見つからなかった\r\n                        // 3秒間エラーメッセージを表示する\r\n                        console.error(`[LiveDataBroadcastingManager] Channel not found (network_id: ${network_id} / service_id: ${service_id})`);\r\n                        this_.player.notice(`切り替え先のチャンネルが見つかりませんでした。(network_id: ${network_id} / service_id: ${service_id})`, 3000, undefined, '#FF6F6A');\r\n                        // エラーメッセージを表示し終わったタイミングで、非同期で LiveDataBroadcastingManager を再起動\r\n                        // チャンネル切り替えに失敗すると BML ブラウザがフリーズするため\r\n                        Utils.sleep(3).then(async () => {\r\n                            await this_.destroy();\r\n                            await this_.init();\r\n                        });\r\n                        return false;\r\n                    }\r\n                },\r\n                // 双方向 (ネット接続) 機能\r\n                ip: {\r\n                    getConnectionType(): number {\r\n                        // ARIB STD-B24 第二分冊 (2/2) 第二編 付属3 5.6.5.2 表5-12\r\n                        // 1: PSTN\r\n                        // 100: ISDN\r\n                        // 200: PHS\r\n                        // 201: PHS (PIAFS2.0)\r\n                        // 202: PHS (PIAFS2.1)\r\n                        // 300: Mobile phone\r\n                        // 301: Mobile phone (PDC)\r\n                        // 302: Mobile phone (PDC-P)\r\n                        // 303: Mobile phone (DS-CDMA)\r\n                        // 304: Mobile phone(MC-CDMA)\r\n                        // 305: Mobile phone (CDMA CelluarSystem)\r\n                        // 401: Ethernet (PPPoE)\r\n                        // 402: Ethernet (Fixed IP)\r\n                        // 403: Ethernet (DHCP)\r\n                        // NaN: 失敗\r\n                        return 403;\r\n                    },\r\n                    isIPConnected(): number {\r\n                        // ARIB STD-B24 第二分冊 (2/2) 第二編 付属3 5.6.5.2 表5-14\r\n                        // 0: IP 接続は確立していない\r\n                        // 1: IP 接続は自動接続によって確立している\r\n                        // 2: IP 接続は connectPPP() / connectPPPWithISPParams() により確立している\r\n                        // NaN 失敗\r\n                        return 0;\r\n                    },\r\n                },\r\n                // エラー発生時のメッセージ表示\r\n                // 3秒間プレイヤーにエラーメッセージを表示する\r\n                showErrorMessage(title: string, message: string, code?: string): void {\r\n                    this_.player.notice(`${title}<br>${message} (${code})`, 3000, undefined, '#FF6F6A');\r\n                }\r\n            });\r\n            this.bml_browser_width = 960;\r\n            this.bml_browser_height = 540;\r\n\r\n            // BML ブラウザがロードされたときのイベント\r\n            this.#bml_browser.addEventListener('load', (event) => {\r\n                console.log('[LiveDataBroadcastingManager] BMLBrowser: load', event.detail);\r\n\r\n                // BML ブラウザの要素に幅と高さを設定\r\n                this.bml_browser_width = event.detail.resolution.width;\r\n                this.bml_browser_height = event.detail.resolution.height;\r\n                this.container_element?.style.setProperty('--bml-browser-width', `${this.bml_browser_width}px`);\r\n                this.container_element?.style.setProperty('--bml-browser-height', `${this.bml_browser_height}px`);\r\n\r\n                // データ放送画面の拡大/縮小率を再計算\r\n                this.calculateBMLBrowserScaleFactor(this.player.template.videoWrap.clientWidth, this.player.template.videoWrap.clientHeight);\r\n\r\n                // 映像の要素をデータ放送内に移動\r\n                this.moveVideoElementToBMLBrowser();\r\n            });\r\n\r\n            // BML ブラウザの表示状態が変化したときのイベント\r\n            this.#bml_browser.addEventListener('invisible', (event) => {\r\n                if (event.detail === true) {\r\n                    // 非表示状態\r\n                    // データ放送内に移動していた映像の要素を DPlayer に戻す\r\n                    console.log('[LiveDataBroadcastingManager] BMLBrowser: invisible');\r\n                    this.moveVideoElementToDPlayer();\r\n                    // BML ブラウザのコンテナ要素を display: none にする\r\n                    if (this.container_element !== null) {\r\n                        this.container_element.style.display = 'none';\r\n                    }\r\n                } else {\r\n                    // 表示状態\r\n                    // 映像の要素をデータ放送内に移動\r\n                    console.log('[LiveDataBroadcastingManager] BMLBrowser: visible');\r\n                    this.moveVideoElementToBMLBrowser();\r\n                    // BML ブラウザのコンテナ要素を display: block にする\r\n                    if (this.container_element !== null) {\r\n                        this.container_element.style.display = 'block';\r\n                    }\r\n                }\r\n            });\r\n\r\n            // 現在 BML ブラウザ上で利用しているボタンの一覧が変化したときのイベント\r\n            this.#bml_browser.addEventListener('usedkeylistchanged', (event) => {\r\n                // usedKeyList の中に numeric-tuning が含まれている場合は、データ放送が数字キーを利用中\r\n                this.is_bml_browser_using_numeric_key = [...event.detail.usedKeyList].includes('numeric-tuning');\r\n            });\r\n\r\n            // DPlayer のリサイズを監視する ResizeObserver を開始\r\n            this.resize_observer = new ResizeObserver((entries: ResizeObserverEntry[]) => {\r\n                // データ放送画面の拡大/縮小率を再計算\r\n                const entry = entries[0];\r\n                this.calculateBMLBrowserScaleFactor(entry.contentRect.width, entry.contentRect.height);\r\n            });\r\n            this.resize_observer.observe(this.player.template.videoWrap);\r\n        }\r\n\r\n        // ここからはデータ放送機能無効時も実行される\r\n        // PSI/SI アーカイブデータは、UI 上の番組情報をリアルタイムに更新する用途でも利用している\r\n\r\n        // ライブ PSI/SI アーカイブデータデコーダーを初期化\r\n        // Comlink を挟んでいる関係上、コンストラクタにも関わらず Promise を返すため await する必要がある\r\n        const api_quality = PlayerUtils.extractLiveAPIQualityFromDPlayer(this.player);\r\n        this.live_psi_archived_data_decoder = await new LivePSIArchivedDataDecoderProxy(channels_store.channel.current, api_quality);\r\n\r\n        // デコードを開始\r\n        // デコーダーは Web Worker 上で実行される (コールバックを Comlink.proxy() で包むのがポイント)\r\n        this.live_psi_archived_data_decoder.run(Comlink.proxy(async (message) => {\r\n\r\n            // データ放送有効時のみ\r\n            if (this.#bml_browser !== null) {\r\n\r\n                // PMT (Program Map Table) イベント\r\n                if (message.type === 'pmt') {\r\n\r\n                    // データ放送がチャンネルに含まれているかどうか\r\n                    // AdditionalAribBXMLInfo を含むコンポーネントが一つでも存在するかどうかで判定\r\n                    const is_bml_available = message.components.some((component) => component.bxmlInfo !== undefined);\r\n                    console.log(`[LiveDataBroadcastingManager] BMLBrowser: ${is_bml_available ? 'available' : 'unavailable'}`);\r\n\r\n                    // データ放送がチャンネルに含まれていない場合\r\n                    if (is_bml_available === false) {\r\n\r\n                        // リモコンのローディング状態を解除\r\n                        // PMT にデータ放送用情報が含まれるようになるまでは、データ放送が利用できる見込みはない\r\n                        this.toggleRemoconButtonsLoading(false);\r\n\r\n                        // リモコンのボタンを無効化\r\n                        this.toggleRemoconButtonsEnabled(false);\r\n\r\n                    // データ放送がチャンネルに含まれている場合\r\n                    // データ放送がチャンネルに含まれていなかったが、後から含まれるようになったケースを想定\r\n                    // この時点ではローディングは終わっていないので、ローディング状態は解除しない\r\n                    } else {\r\n\r\n                        // リモコンのボタンを有効化\r\n                        this.toggleRemoconButtonsEnabled(true);\r\n                    }\r\n                }\r\n\r\n                // TS ストリームのデコード結果を BML ブラウザにそのまま送信する\r\n                // IProgramPF は KonomiTV の UI 表示用の番組情報イベントなので、BML ブラウザには送信しない\r\n                if (message.type !== 'IProgramPF') {\r\n                    this.#bml_browser.emitMessage(message);\r\n                }\r\n            }\r\n\r\n            // 番組情報イベント (KonomiTV の UI 表示用)\r\n            // 現在放送中/次に放送される番組情報を ChannelsStore を経由し UI 側にリアルタイムに反映する\r\n            if (message.type === 'IProgramPF') {\r\n                if (message.present_or_following === 'Present') {\r\n                    channels_store.current_program_present = message.program;\r\n                } else if (message.present_or_following === 'Following') {\r\n                    channels_store.current_program_following = message.program;\r\n                }\r\n            }\r\n        }));\r\n\r\n        console.log('[LiveDataBroadcastingManager] Initialized.');\r\n    }\r\n\r\n\r\n    /**\r\n     * リモコンのボタンを初期化する\r\n     */\r\n    private initRemoconButtons(): void {\r\n        const channels_store = useChannelsStore();\r\n\r\n        // リモコンのボタンのクリックイベントを一括で削除するための AbortController\r\n        this.remocon_button_event_abort_controller = new AbortController();\r\n\r\n        // リモコンのボタンをクリックしたときのイベントを登録\r\n        const buttons = this.remocon_element.querySelectorAll('button');\r\n        for (const button of buttons) {\r\n            button.addEventListener('click', async () => {\r\n\r\n                // ARIB 仕様上のキーコード\r\n                const arib_key_code = (parseInt(button.dataset.aribKeyCode!) as AribKeyCode);\r\n\r\n                // リモコン ID (番号キーのみ)\r\n                const remocon_id = button.dataset.remoconId ? parseInt(button.dataset.remoconId) : null;\r\n\r\n                // 番号キーでかつ現在データ放送が番号キーを使っていない場合は、そのチャンネルに切り替える\r\n                if (remocon_id !== null && this.is_bml_browser_using_numeric_key === false) {\r\n\r\n                    // 切り替え先のチャンネルを取得する\r\n                    // チャンネルタイプは現在視聴中のチャンネルと同じ\r\n                    const switch_channel_type = channels_store.channel.current.type;\r\n                    const switch_channel = channels_store.getChannelByRemoconID(switch_channel_type, remocon_id);\r\n\r\n                    // チャンネルが取得できていれば、ルーティングをそのチャンネルに置き換える\r\n                    // 押されたキーに対応するリモコン ID のチャンネルがない場合や、現在と同じチャンネル ID の場合は何も起こらない\r\n                    if (switch_channel !== null && switch_channel.display_channel_id !== channels_store.display_channel_id) {\r\n                        router.push({path: `/tv/watch/${switch_channel.display_channel_id}`});\r\n                    }\r\n                    return;\r\n\r\n                // それ以外の場合は、BML ブラウザにキーイベントを送信する\r\n                // データ放送機能無効時は何もしない\r\n                // TODO: BML ブラウザがクラッシュした場合 processKeyDown() あたりから例外が送出されるが、途中で握り潰されている？のかキャッチできない\r\n                } else {\r\n                    if (this.#bml_browser !== null) {\r\n                        if (remocon_id === 10) {\r\n                            // リモコン番号が 10 の場合のみ、\"0\" のキーイベントも送信する\r\n                            this.#bml_browser.content.processKeyDown(AribKeyCode.Digit0);\r\n                            this.#bml_browser.content.processKeyUp(AribKeyCode.Digit0);\r\n                            await Utils.sleep(0.1);  // 若干待つのがポイント\r\n                        }\r\n                        this.#bml_browser.content.processKeyDown(arib_key_code);\r\n                        this.#bml_browser.content.processKeyUp(arib_key_code);\r\n                    }\r\n                }\r\n\r\n            }, {signal: this.remocon_button_event_abort_controller.signal});\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * リモコンのデータ放送ボタンの表示状態をローディングかどうかで切り替える\r\n     */\r\n    private toggleRemoconButtonsLoading(loading: boolean): void {\r\n        if (loading === true) {\r\n            this.remocon_data_broadcasting_element.classList.add('remote-control-data-broadcasting--loading');\r\n        } else {\r\n            this.remocon_data_broadcasting_element.classList.remove('remote-control-data-broadcasting--loading');\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * リモコンのデータ放送ボタンの有効/無効をローディングかどうかで切り替える\r\n     * 初期状態 (Vue SFC の HTML 上) では無効になっているので、BML ブラウザの初期化時に有効にする\r\n     */\r\n    private toggleRemoconButtonsEnabled(enabled: boolean): void {\r\n        if (enabled === true) {\r\n            this.remocon_data_broadcasting_element.classList.remove('remote-control-data-broadcasting--disabled');\r\n        } else {\r\n            this.remocon_data_broadcasting_element.classList.add('remote-control-data-broadcasting--disabled');\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * データ放送画面の拡大/縮小率を再計算し、CSS カスタムプロパティに設定する\r\n     * データ放送は 960×540 か 720×480 の固定サイズなので、レスポンシブにするために transform: scale() を使っている\r\n     * @param container_width BML ブラウザが入るコンテナ要素の幅\r\n     * @param container_height BML ブラウザが入るコンテナ要素の高さ\r\n     */\r\n    private calculateBMLBrowserScaleFactor(container_width: number, container_height: number): void {\r\n\r\n        // 高さは BML ブラウザの高さをそのまま利用するが、横幅は常に高さに対して常に 16:9 の比率になるようにする\r\n        // BML ブラウザのサイズが 960×540 なら問題ないが、720×480 の場合は 854×480 として計算される\r\n        const scale_factor_width = container_width / (this.bml_browser_height * 16 / 9);\r\n        const scale_factor_height = container_height / this.bml_browser_height;\r\n\r\n        // transform: scale() での拡大率を算出\r\n        const scale_factor = Math.min(scale_factor_width, scale_factor_height);\r\n\r\n        // (BMLブラウザの高さに対して 16:9 の比率の幅)÷(BMLブラウザの幅) で横に引き伸ばす倍率を算出\r\n        // 854÷720 の場合、約 1.185 倍になる\r\n        const magnification = (this.bml_browser_height * 16 / 9) / this.bml_browser_width;\r\n\r\n        // データ放送画面の拡大/縮小率を CSS カスタムプロパティとして設定\r\n        this.container_element?.style.setProperty('--bml-browser-scale-factor-width', `${scale_factor * magnification}`);\r\n        this.container_element?.style.setProperty('--bml-browser-scale-factor-height', `${scale_factor}`);\r\n    }\r\n\r\n\r\n    /**\r\n     * 映像の DOM 要素を DPlayer から BML ブラウザ (データ放送) 内に移動する\r\n     * データ放送が読み込まれるか、表示状態になるときに呼び出される\r\n     */\r\n    private moveVideoElementToBMLBrowser(): void {\r\n\r\n        // BML ブラウザの破棄中にイベントが発火した場合は何もしない\r\n        if (this.is_bml_browser_destroying) {\r\n            return;\r\n        }\r\n\r\n        // getVideoElement() に失敗した (=現在データ放送に映像が表示されていない) 場合は何もしない\r\n        if (this.#bml_browser?.getVideoElement() === null) {\r\n            return;\r\n        }\r\n\r\n        // ダミーで渡した p 要素があれば削除\r\n        if (this.#bml_browser?.getVideoElement()?.firstElementChild instanceof HTMLParagraphElement) {\r\n            this.#bml_browser?.getVideoElement()?.firstElementChild?.remove();\r\n        }\r\n\r\n        // データ放送内に映像の要素を入れる\r\n        this.#bml_browser?.getVideoElement()?.appendChild(this.media_element);\r\n\r\n        // データ放送内での表示用にスタイルを調整\r\n        this.media_element.style.width = '100%';\r\n        this.media_element.style.height = '100%';\r\n        for (const child of this.media_element.children) {\r\n            (child as HTMLElement).style.display = 'block';\r\n            (child as HTMLElement).style.visibility = 'visible';\r\n            if (child instanceof HTMLVideoElement) {\r\n                (child as HTMLVideoElement).style.width = '100%';\r\n                (child as HTMLVideoElement).style.height = '100%';\r\n                // BML ブラウザのアスペクト比が 16:9 以外のケース (運用上は 720×480 のみ該当) に限定して適用する\r\n                if (this.bml_browser_width / this.bml_browser_height !== 16 / 9) {\r\n                    const magnification = (this.bml_browser_height * 16 / 9) / this.bml_browser_width;\r\n                    (child as HTMLVideoElement).style.transform = `scaleY(${magnification})`;\r\n                    (child as HTMLVideoElement).style.transformOrigin = 'center center';\r\n                } else {\r\n                    (child as HTMLVideoElement).style.transform = '';\r\n                    (child as HTMLVideoElement).style.transformOrigin = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        this.is_video_element_moved_to_bml_browser = true;\r\n    }\r\n\r\n\r\n    /**\r\n     * 映像の DOM 要素を BML ブラウザ (データ放送) から DPlayer 内に移動する\r\n     * データ放送が非表示状態になるか、破棄されるときに呼び出される\r\n     */\r\n    private moveVideoElementToDPlayer(): void {\r\n\r\n        // BML ブラウザの破棄中にイベントが発火した場合は何もしない\r\n        if (this.is_bml_browser_destroying) {\r\n            return;\r\n        }\r\n\r\n        // 既に DPlayer 内に映像の要素がある場合は何もしない\r\n        if (this.is_video_element_moved_to_bml_browser === false) {\r\n            return;\r\n        }\r\n\r\n        // データ放送内に移動していた映像の要素を DPlayer に戻す (BML ブラウザより上のレイヤーに配置)\r\n        // BML ブラウザの破棄前に行う必要がある\r\n        if (this.container_element !== null) {\r\n            this.player.template.videoWrap.insertBefore(this.media_element, this.container_element.nextElementSibling);\r\n        }\r\n\r\n        // データ放送内での表示用に調整していたスタイルを戻す\r\n        this.media_element.style.width = '';\r\n        this.media_element.style.height = '';\r\n        for (const child of this.media_element.children) {\r\n            (child as HTMLElement).style.display = '';\r\n            (child as HTMLElement).style.visibility = '';\r\n            if (child instanceof HTMLVideoElement) {\r\n                (child as HTMLVideoElement).style.width = '';\r\n                (child as HTMLVideoElement).style.height = '';\r\n                (child as HTMLVideoElement).style.transform = '';\r\n                (child as HTMLVideoElement).style.transformOrigin = '';\r\n            }\r\n        }\r\n\r\n        this.is_video_element_moved_to_bml_browser = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * LiveDataBroadcastingManager での処理を終了し、破棄する\r\n     */\r\n    public async destroy(): Promise<void> {\r\n        const channels_store = useChannelsStore();\r\n\r\n        // ライブ PSI/SI アーカイブデータデコーダーを終了\r\n        if (this.live_psi_archived_data_decoder !== null) {\r\n            // タイミングの関係なのかチャンネル切り替え時の映像のフェードアウトが効かなくなるため、await してはいけない\r\n            this.live_psi_archived_data_decoder.destroy();\r\n            this.live_psi_archived_data_decoder = null;\r\n        }\r\n\r\n        // ChannelsStore に設定したリアルタイム番組情報を削除\r\n        // ここで削除しないと再度更新されるまで channels_store.channel.current で古い番組情報が参照され続けてしまう\r\n        // ストリーミングが開始され EPG から再度最新の番組情報を取得するまでの間は、サーバー API から取得した番組情報が表示される\r\n        channels_store.current_program_present = null;\r\n        channels_store.current_program_following = null;\r\n\r\n        // リモコンの各ボタンに登録していたリスナーを削除\r\n        if (this.remocon_button_event_abort_controller !== null) {\r\n            this.remocon_button_event_abort_controller.abort();\r\n            this.remocon_button_event_abort_controller = null;\r\n        }\r\n\r\n        // ここからはデータ放送機能有効時のみ実行\r\n        if (this.#bml_browser !== null) {\r\n\r\n            // リモコンのボタンを再び無効化\r\n            this.toggleRemoconButtonsEnabled(false);\r\n\r\n            // リモコンを再びローディング状態に戻す\r\n            this.toggleRemoconButtonsLoading(true);\r\n\r\n            // DPlayer のリサイズを監視する ResizeObserver を終了\r\n            if (this.resize_observer !== null) {\r\n                this.resize_observer.disconnect();\r\n                this.resize_observer = null;\r\n            }\r\n\r\n            // データ放送内に移動していた映像の要素を DPlayer に戻す\r\n            this.moveVideoElementToDPlayer();\r\n\r\n            // BML ブラウザを破棄\r\n            this.is_bml_browser_destroying = true;\r\n            await this.#bml_browser.destroy();\r\n            this.is_bml_browser_destroying = false;\r\n            this.#bml_browser = null;\r\n\r\n            // BML ブラウザの要素を削除\r\n            this.container_element?.remove();\r\n\r\n            console.log('[LiveDataBroadcastingManager] Destroyed.');\r\n        }\r\n    }\r\n}\r\n\r\nexport default LiveDataBroadcastingManager;\r\n","\r\n\r\nimport DPlayer from 'dplayer';\r\n\r\nimport PlayerManager from '@/services/player/PlayerManager';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport Utils, { PlayerUtils } from '@/utils';\r\n\r\n\r\n/** ライブストリームステータス API から受信するイベントのインターフェイス */\r\ninterface ILiveStreamStatusEvent {\r\n    // 現在のライブストリームのステータス\r\n    status: 'Offline' | 'Standby' | 'ONAir' | 'Idling' | 'Restart';\r\n    // 現在のライブストリームのステータス詳細\r\n    detail: string;\r\n    // ライブストリームの開始時刻 (UNIX タイムスタンプ)\r\n    started_at: number;\r\n    // ライブストリームの最終更新時刻 (UNIX タイムスタンプ)\r\n    updated_at: number;\r\n    // このライブストリームを視聴しているクライアント数\r\n    client_count: number;\r\n}\r\n\r\n\r\n/**\r\n * ライブ視聴: ライブストリームのステータスを監視し随時 UI に反映する PlayerManager\r\n */\r\nclass LiveEventManager implements PlayerManager {\r\n\r\n    // ユーザー操作により DPlayer 側で画質が切り替わった際、この PlayerManager の再起動が必要かどうかを PlayerController に示す値\r\n    public readonly restart_required_when_quality_switched = true;\r\n\r\n    // DPlayer のインスタンス\r\n    // 設計上コンストラクタ以降で変更すべきでないため readonly にしている\r\n    private readonly player: DPlayer;\r\n\r\n    // EventSource のインスタンス\r\n    private eventsource: EventSource | null = null;\r\n\r\n    // 破棄済みかどうか\r\n    private destroyed = false;\r\n\r\n    /**\r\n     * コンストラクタ\r\n     * @param player DPlayer のインスタンス\r\n     */\r\n    constructor(player: DPlayer) {\r\n        this.player = player;\r\n    }\r\n\r\n\r\n    /**\r\n     * サーバー側のライブストリームステータス API (Server-Sent Events) に接続し、ライブストリームのステータス監視を開始する\r\n     */\r\n    public async init(): Promise<void> {\r\n        const channels_store = useChannelsStore();\r\n        const player_store = usePlayerStore();\r\n\r\n        // 破棄済みかどうかのフラグを下ろす\r\n        this.destroyed = false;\r\n\r\n        // EventSource を初期化し、Server-Sent Events のストリーミングを開始する\r\n        // PlayerManager の設計上、同一の PlayerManager インスタンスはチャンネルが変更されない限り再利用される可能性がある\r\n        // 接続先の API URL は DPlayer 上で再生中の画質設定によって変化するため、\r\n        // 画質切り替え後の再起動も想定しコンストラクタではなくあえて init() 内で API URL を取得している\r\n        const api_quality = PlayerUtils.extractLiveAPIQualityFromDPlayer(this.player);\r\n        const eventsource_url = `${Utils.api_base_url}/streams/live/${channels_store.display_channel_id}/${api_quality}/events`;\r\n        this.eventsource = new EventSource(eventsource_url);\r\n\r\n        // EventSource 自体が開かれたときのイベント\r\n        let is_eventsource_opened = false;\r\n        this.eventsource.addEventListener('open', () => {\r\n            if (this.destroyed === true)  return;\r\n            if (is_eventsource_opened === false) {\r\n                console.log('\\u001b[33m[LiveEventManager]', 'EventSource opened.');\r\n            }\r\n            is_eventsource_opened = true;\r\n        });\r\n\r\n        // 初回接続時のイベント\r\n        this.eventsource.addEventListener('initial_update', (event_raw: MessageEvent) => {\r\n            if (this.destroyed === true)  return;\r\n\r\n            // イベントを取得\r\n            const event: ILiveStreamStatusEvent = JSON.parse(event_raw.data);\r\n            console.log('\\u001b[33m[LiveEventManager][initial_update]', `\\nStatus: ${event.status} / Detail: ${event.detail}`);\r\n\r\n            // ライブストリームのステータスを設定\r\n            player_store.live_stream_status = event.status;\r\n\r\n            // ステータスごとに処理を振り分け\r\n            switch (event.status) {\r\n\r\n                // Status: Standby\r\n                case 'Standby': {\r\n\r\n                    // バッファリング中の Progress Circular を表示\r\n                    player_store.is_video_buffering = true;\r\n\r\n                    // プレイヤーの背景を表示する\r\n                    player_store.is_background_display = true;\r\n\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n\r\n        // ステータスが更新されたときのイベント\r\n        this.eventsource.addEventListener('status_update', async (event_raw: MessageEvent) => {\r\n            if (this.destroyed === true)  return;\r\n\r\n            // イベントを取得\r\n            const event: ILiveStreamStatusEvent = JSON.parse(event_raw.data);\r\n            console.log('\\u001b[33m[LiveEventManager][status_update]', `\\nStatus: ${event.status} / Detail: ${event.detail}`);\r\n\r\n            // ライブストリームのステータスを設定\r\n            player_store.live_stream_status = event.status;\r\n\r\n            // 視聴者数を更新\r\n            channels_store.viewer_count = event.client_count;\r\n\r\n            // ステータスごとに処理を振り分け\r\n            switch (event.status) {\r\n\r\n                // Status: Standby\r\n                case 'Standby': {\r\n\r\n                    // ステータス詳細をプレイヤーに表示\r\n                    // 画質切り替え or エンコードタスクの再起動通知が既に表示されている場合は上書きしない\r\n                    if ((this.player.template.notice.textContent!.includes('画質を') === false &&\r\n                         this.player.template.notice.textContent!.includes('(ER-') === false)) {\r\n                        this.player.notice(event.detail, -1);\r\n                    }\r\n\r\n                    // バッファリング中の Progress Circular を表示\r\n                    player_store.is_video_buffering = true;\r\n\r\n                    // プレイヤーの背景を表示する\r\n                    player_store.is_background_display = true;\r\n\r\n                    break;\r\n                }\r\n\r\n                // Status: ONAir\r\n                case 'ONAir': {\r\n\r\n                    // ステータス詳細をプレイヤーから削除\r\n                    // 画質切り替えの通知が既に表示されている場合は上書きしない\r\n                    if (this.player.template.notice.textContent!.includes('画質を') === false) {\r\n                        this.player.hideNotice();\r\n                    }\r\n\r\n                    // ライブストリーミングが開始される前にチャンネルを切り替えた際、稀にコメントが流れないことがある不具合のワークアラウンド\r\n                    // TODO: リファクタリングで不要になってるかも？\r\n                    if (this.player.container.classList.contains('dplayer-paused')) {\r\n                        this.player.container.classList.remove('dplayer-paused');\r\n                        this.player.container.classList.add('dplayer-playing');\r\n                    }\r\n\r\n                    // 前のプレイヤーインスタンスの Picture-in-Picture ウインドウが残っている場合、終了させてからもう一度切り替える\r\n                    // チャンネル切り替えが完了しても前の Picture-in-Picture ウインドウは再利用されないため、一旦終了させるしかない\r\n                    if (document.pictureInPictureElement) {\r\n                        document.exitPictureInPicture();\r\n                        this.player.video.requestPictureInPicture();\r\n                    }\r\n\r\n                    break;\r\n                }\r\n\r\n                // Status: Idling\r\n                case 'Idling': {\r\n\r\n                    // 手動で再起動したのにタイミングの関係で破棄前に Idling イベントを受け取ってしまうことがあるので、\r\n                    // 1 秒ほど待機してから実行する (すでにプレイヤーが再起動中であれば PlayerRestartRequired イベントでは何も起こらない)\r\n                    if (this.destroyed === false) {\r\n                        await Utils.sleep(1);\r\n                    }\r\n\r\n                    // 本来誰も視聴していないことを示す Idling ステータスを受信している場合、何らかの理由で\r\n                    // ライブストリーミング API への接続が切断された可能性が高いので、PlayerController にプレイヤーの再起動を要求する\r\n                    player_store.event_emitter.emit('PlayerRestartRequired', {\r\n                        message: 'ストリーミング接続が切断されました。(Status: Idling) プレイヤーを再起動しています…',\r\n                    });\r\n\r\n                    break;\r\n                }\r\n\r\n                // Status: Restart\r\n                case 'Restart': {\r\n\r\n                    // エンコーダーがクラッシュしたなどの理由でライブストリームが再起動中なので、\r\n                    // PlayerController にプレイヤーの再起動を要求する\r\n                    player_store.event_emitter.emit('PlayerRestartRequired', {\r\n                        // ステータス詳細 (再起動に至った理由) をプレイヤーに表示\r\n                        message: event.detail,  // メッセージの末尾に「エンコードタスクを再起動しています… (ER-XX)」が入る\r\n                    });\r\n\r\n                    // バッファリング中の Progress Circular を表示 (不要だとは思うけど念のため)\r\n                    player_store.is_video_buffering = true;\r\n\r\n                    // プレイヤーの背景を表示する (不要だとは思うけど念のため)\r\n                    player_store.is_background_display = true;\r\n\r\n                    break;\r\n                }\r\n\r\n                // Status: Offline\r\n                // 基本的に Offline は放送休止中やエラーなどで復帰の見込みがない状態\r\n                case 'Offline': {\r\n\r\n                    // 「ライブストリームは Offline です。」のステータス詳細を受信すること自体が不正な状態\r\n                    // ストリーミング API への接続が切断された可能性が高いので、PlayerController にプレイヤーの再起動を要求する\r\n                    if (event.detail === 'ライブストリームは Offline です。') {\r\n                        player_store.event_emitter.emit('PlayerRestartRequired', {\r\n                            message: 'ストリーミング接続が切断されました。(Status: Offline) プレイヤーを再起動しています…',\r\n                        });\r\n                    }\r\n\r\n                    // ステータス詳細をプレイヤーに表示\r\n                    this.player.notice(event.detail, -1);\r\n                    this.player.video.onerror = () => {\r\n                        // 動画の読み込みエラーが送出された際に DPlayer に表示中の通知メッセージを上書きする\r\n                        this.player.notice(event.detail, -1);\r\n                        this.player.video.onerror = null;\r\n                    };\r\n\r\n                    // 既に描画されたコメントをクリア\r\n                    this.player.danmaku!.clear();\r\n\r\n                    // 動画を停止する\r\n                    this.player.video.pause();\r\n\r\n                    // プレイヤーの背景を表示する\r\n                    player_store.is_background_display = true;\r\n\r\n                    // バッファリング中の Progress Circular を非表示にする\r\n                    player_store.is_loading = false;\r\n                    player_store.is_video_buffering = false;\r\n\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n\r\n        // ステータス詳細が更新されたときのイベント\r\n        this.eventsource.addEventListener('detail_update', (event_raw: MessageEvent) => {\r\n            if (this.destroyed === true)  return;\r\n\r\n            // イベントを取得\r\n            const event: ILiveStreamStatusEvent = JSON.parse(event_raw.data);\r\n            console.log('\\u001b[33m[LiveEventManager][detail_update]', `\\nStatus: ${event.status} Detail:${event.detail}`);\r\n\r\n            // 視聴者数を更新\r\n            channels_store.viewer_count = event.client_count;\r\n\r\n            // ステータスごとに処理を振り分け\r\n            switch (event.status) {\r\n\r\n                // Status: Standby\r\n                case 'Standby': {\r\n\r\n                    // ステータス詳細をプレイヤーに表示\r\n                    // 画質切り替え or エンコードタスクの再起動通知が既に表示されている場合は上書きしない\r\n                    if ((this.player.template.notice.textContent!.includes('画質を') === false &&\r\n                         this.player.template.notice.textContent!.includes('(ER-') === false)) {\r\n                        this.player.notice(event.detail, -1);\r\n                    }\r\n\r\n                    // プレイヤーの背景を表示する\r\n                    player_store.is_background_display = true;\r\n\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n\r\n        // クライアント数 (だけ) が更新されたときのイベント\r\n        this.eventsource.addEventListener('clients_update', (event_raw: MessageEvent) => {\r\n            if (this.destroyed === true)  return;\r\n\r\n            // イベントを取得\r\n            const event: ILiveStreamStatusEvent = JSON.parse(event_raw.data);\r\n\r\n            // 視聴者数を更新\r\n            channels_store.viewer_count = event.client_count;\r\n        });\r\n\r\n        console.log('\\u001b[33m[LiveEventManager] Initialized.');\r\n\r\n        // 初期化から3秒後にまだ接続できていなかった場合、ネットワーク環境の遅延が酷いなどでなかなかサーバーに接続できていない状況とみなし、\r\n        // ユーザー体験向上のためプレイヤーの背景を表示する\r\n        (async () => {\r\n\r\n            // 3秒待機\r\n            await Utils.sleep(3);\r\n\r\n            // まだ接続できていなかった場合\r\n            if (is_eventsource_opened === false) {\r\n\r\n                // バッファリング中の Progress Circular を表示\r\n                player_store.is_video_buffering = true;\r\n\r\n                // プレイヤーの背景を表示する\r\n                player_store.is_background_display = true;\r\n            }\r\n        })();\r\n    }\r\n\r\n\r\n    /**\r\n     * サーバー側のライブストリームステータス API (Server-Sent Events) への接続を切断し、ライブストリームのステータス監視を停止する\r\n     */\r\n    public async destroy(): Promise<void> {\r\n        const channels_store = useChannelsStore();\r\n        const player_store = usePlayerStore();\r\n\r\n        // PlayerStore にセットしたライブストリームのステータスをリセット\r\n        player_store.live_stream_status = null;\r\n\r\n        // ChannelsStore にセットしたリアルタイム視聴者数をリセット\r\n        // ここで削除しないといつまで経っても古い番組情報が参照され続けてしまう\r\n        // ストリーミングが開始され Server-Sent Events から再度最新の視聴者数を取得するまでの間は、サーバー API から取得した視聴者数が表示される\r\n        channels_store.viewer_count = null;\r\n\r\n        // 破棄済みかどうかのフラグを立てる\r\n        // もしかすると EventSource の破棄に時間がかかるかもしれないので、先にフラグを立てておく\r\n        this.destroyed = true;\r\n\r\n        // EventSource を破棄し、Server-Sent Events のストリーミングを終了する\r\n        if (this.eventsource !== null) {\r\n            this.eventsource.close();\r\n            this.eventsource = null;\r\n        }\r\n\r\n        console.log('\\u001b[33m[LiveEventManager] Destroyed.');\r\n    }\r\n}\r\n\r\nexport default LiveEventManager;\r\n","\r\n\r\nimport DPlayer from 'dplayer';\r\n\r\nimport router from '@/router';\r\nimport PlayerManager from '@/services/player/PlayerManager';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport Utils from '@/utils';\r\n\r\n\r\n/**\r\n * MediaSession API を使いメディア通知を管理する PlayerManager\r\n */\r\nclass MediaSessionManager implements PlayerManager {\r\n\r\n    // ユーザー操作により DPlayer 側で画質が切り替わった際、この PlayerManager の再起動が必要かどうかを PlayerController に示す値\r\n    public readonly restart_required_when_quality_switched = false;\r\n\r\n    // DPlayer のインスタンス\r\n    // 設計上コンストラクタ以降で変更すべきでないため readonly にしている\r\n    private readonly player: DPlayer;\r\n\r\n    // 再生モード (Live: ライブ視聴, Video: ビデオ視聴)\r\n    private readonly playback_mode: 'Live' | 'Video';\r\n\r\n    // 破棄済みかどうか\r\n    private destroyed = false;\r\n\r\n    /**\r\n     * コンストラクタ\r\n     * @param player DPlayer のインスタンス\r\n     * @param playback_mode 再生モード (Live: ライブ視聴, Video: ビデオ視聴)\r\n     */\r\n    constructor(player: DPlayer, playback_mode: 'Live' | 'Video') {\r\n        this.player = player;\r\n        this.playback_mode = playback_mode;\r\n    }\r\n\r\n\r\n    /**\r\n     * MediaSession 情報をブラウザに登録する\r\n     * 再生中のチャンネル情報・番組情報・録画番組情報が変更された場合は、一度破棄してから再度実行する必要がある\r\n     */\r\n    public async init(): Promise<void> {\r\n        const channels_store = useChannelsStore();\r\n        const player_store = usePlayerStore();\r\n\r\n        // 破棄済みかどうかのフラグを下ろす\r\n        this.destroyed = false;\r\n\r\n        // MediaSession API を使い、メディア通知の表示をカスタマイズ\r\n        if ('mediaSession' in navigator) {\r\n\r\n            // ライブ視聴でアートワークとして表示するアイコン\r\n            const live_artwork = [\r\n                {src: '/assets/images/icons/icon-maskable-192px.png', sizes: '192x192', type: 'image/png'},\r\n                {src: '/assets/images/icons/icon-maskable-512px.png', sizes: '512x512', type: 'image/png'},\r\n            ];\r\n\r\n            // ビデオ視聴でアートワークとして表示する番組サムネイル\r\n            // TODO: ちゃんと録画番組のサムネイルを設定すべき\r\n            const video_artwork = [\r\n                {src: '/assets/images/icons/icon-maskable-192px.png', sizes: '192x192', type: 'image/png'},\r\n                {src: '/assets/images/icons/icon-maskable-512px.png', sizes: '512x512', type: 'image/png'},\r\n            ];\r\n\r\n            // メディア通知の表示をカスタマイズ\r\n            // ライブ視聴: 番組タイトル・チャンネル名・アイコンを表示\r\n            if (this.playback_mode === 'Live') {\r\n                navigator.mediaSession.metadata = new MediaMetadata({\r\n                    title: channels_store.channel.current.program_present?.title ?? '放送休止',\r\n                    artist: channels_store.channel.current.name,\r\n                    artwork: live_artwork,\r\n                });\r\n            // ビデオ視聴: 番組タイトル・シリーズタイトル・サムネイルを表示\r\n            // シリーズタイトルが取得できていない場合は番組タイトルが代わりに設定される\r\n            } else {\r\n                navigator.mediaSession.metadata = new MediaMetadata({\r\n                    title: player_store.recorded_program.title,\r\n                    artist: player_store.recorded_program.series_title ?? player_store.recorded_program.title,\r\n                    artwork: video_artwork,\r\n                });\r\n            }\r\n\r\n            // 再生速度や再生位置が変更された際に MediaSession の情報を更新する\r\n            // ライブ視聴時は再生位置自体が無限なので何も起こらない\r\n            this.player.on('ratechange', this.updateMediaSessionPositionState.bind(this));\r\n            this.player.on('seeking', this.updateMediaSessionPositionState.bind(this));\r\n            this.player.on('seeked', this.updateMediaSessionPositionState.bind(this));\r\n\r\n            // メディア通知上のボタンが押されたときのイベント\r\n            // 再生\r\n            navigator.mediaSession.setActionHandler('play', () => this.player?.play());\r\n            // 停止\r\n            navigator.mediaSession.setActionHandler('pause', () => this.player?.pause());\r\n            // 前/次の再生位置にシーク (ビデオ視聴時のみ)\r\n            if (this.playback_mode === 'Video') {\r\n                // 前の再生位置にシーク\r\n                navigator.mediaSession.setActionHandler('seekbackward', (details) => {\r\n                    const seek_offset = details.seekOffset ?? 10;  // デフォルト: 10 秒早戻し\r\n                    this.player.seek(this.player.video.currentTime - seek_offset);\r\n                });\r\n                // 次の再生位置にシーク\r\n                navigator.mediaSession.setActionHandler('seekforward', (details) => {\r\n                    const seek_offset = details.seekOffset ?? 10;  // デフォルト: 10 秒早送り\r\n                    this.player.seek(this.player.video.currentTime + seek_offset);\r\n                });\r\n                // イベントで渡された再生位置にシーク\r\n                navigator.mediaSession.setActionHandler('seekto', (details) => {\r\n                    this.player.seek(details.seekTime!);\r\n                });\r\n            }\r\n            // 前のトラックに移動\r\n            navigator.mediaSession.setActionHandler('previoustrack', async () => {\r\n                // ライブ視聴: 前のチャンネルに切り替え\r\n                if (this.playback_mode === 'Live') {\r\n                    navigator.mediaSession.metadata = new MediaMetadata({\r\n                        title: channels_store.channel.previous.program_present?.title ?? '放送休止',\r\n                        artist: channels_store.channel.previous.name,\r\n                        artwork: live_artwork,\r\n                    });\r\n                    // ルーティングを前のチャンネルに置き換える\r\n                    await router.push({path: `/tv/watch/${channels_store.channel.previous.display_channel_id}`});\r\n                // ビデオ視聴: シリーズ番組の前の話数に切り替え\r\n                } else {\r\n                    // TODO: 未実装\r\n                }\r\n            });\r\n            // 次のトラックに移動\r\n            navigator.mediaSession.setActionHandler('nexttrack', async () => {  // 次のチャンネルに切り替え\r\n                // ライブ視聴: 次のチャンネルに切り替え\r\n                if (this.playback_mode === 'Live') {\r\n                    navigator.mediaSession.metadata = new MediaMetadata({\r\n                        title: channels_store.channel.next.program_present?.title ?? '放送休止',\r\n                        artist: channels_store.channel.next.name,\r\n                        artwork: live_artwork,\r\n                    });\r\n                    // ルーティングを次のチャンネルに置き換える\r\n                    await router.push({path: `/tv/watch/${channels_store.channel.next.display_channel_id}`});\r\n                // ビデオ視聴: シリーズ番組の次の話数に切り替え\r\n                } else {\r\n                    // TODO: 未実装\r\n                }\r\n            });\r\n        }\r\n\r\n        console.log('[MediaSessionManager] Initialized.');\r\n    }\r\n\r\n\r\n    /**\r\n     * メディア通知上の再生位置を更新する\r\n     */\r\n    private updateMediaSessionPositionState(): void {\r\n\r\n        // 破棄済みなら何もしない\r\n        // DPlayer に登録したイベントから破棄後のタイミングでこのメソッドが呼ばれる可能性がなくもないので、念のため\r\n        if (this.destroyed === true) {\r\n            return;\r\n        }\r\n\r\n        if ('setPositionState' in navigator.mediaSession) {\r\n            // ビデオ視聴のみ\r\n            if (this.playback_mode === 'Video') {\r\n                navigator.mediaSession.setPositionState({\r\n                    // 現在の動画の長さ\r\n                    duration: this.player.video.duration,\r\n                    // 現在の動画の再生速度\r\n                    playbackRate: this.player.video.playbackRate,\r\n                    // 現在の動画の再生位置\r\n                    position: this.player.video.currentTime,\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * MediaSession 情報をブラウザから削除する\r\n     */\r\n    public async destroy(): Promise<void> {\r\n\r\n        // DPlayer からイベントを削除\r\n        this.player.off('ratechange', this.updateMediaSessionPositionState.bind(this));\r\n        this.player.off('seeking', this.updateMediaSessionPositionState.bind(this));\r\n        this.player.off('seeked', this.updateMediaSessionPositionState.bind(this));\r\n\r\n        // MediaSession API を使い、メディア通知の表示をリセット\r\n        if ('mediaSession' in navigator) {\r\n            navigator.mediaSession.metadata = null;\r\n            navigator.mediaSession.setActionHandler('play', null);\r\n            navigator.mediaSession.setActionHandler('pause', null);\r\n            navigator.mediaSession.setActionHandler('seekbackward', null);\r\n            navigator.mediaSession.setActionHandler('seekforward', null);\r\n            navigator.mediaSession.setActionHandler('previoustrack', null);\r\n            navigator.mediaSession.setActionHandler('nexttrack', null);\r\n            if ('setPositionState' in navigator.mediaSession) {\r\n                // Safari ではなぜかエラーになるので実行しない\r\n                if (Utils.isSafari() === false) {\r\n                    navigator.mediaSession.setPositionState({});  // 空のオブジェクトを渡して状態をリセット\r\n                }\r\n            }\r\n        }\r\n\r\n        // 破棄済みかどうかのフラグを立てる\r\n        this.destroyed = true;\r\n\r\n        console.log('[MediaSessionManager] Destroyed.');\r\n    }\r\n}\r\n\r\nexport default MediaSessionManager;\r\n","\r\nimport assert from 'assert';\r\n\r\nimport DPlayer, { DPlayerType } from 'dplayer';\r\nimport Hls from 'hls.js';\r\nimport mpegts from 'mpegts.js';\r\n\r\nimport KeyboardShortcutManager from './managers/KeyboardShortcutManager';\r\n\r\nimport APIClient from '@/services/APIClient';\r\nimport CaptureManager from '@/services/player/managers/CaptureManager';\r\nimport LiveCommentManager from '@/services/player/managers/LiveCommentManager';\r\nimport LiveDataBroadcastingManager from '@/services/player/managers/LiveDataBroadcastingManager';\r\nimport LiveEventManager from '@/services/player/managers/LiveEventManager';\r\nimport MediaSessionManager from '@/services/player/managers/MediaSessionManager';\r\nimport PlayerManager from '@/services/player/PlayerManager';\r\nimport Videos from '@/services/Videos';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport useSettingsStore, { LiveStreamingQuality, LIVE_STREAMING_QUALITIES, VideoStreamingQuality, VIDEO_STREAMING_QUALITIES } from '@/stores/SettingsStore';\r\nimport Utils, { dayjs, PlayerUtils } from '@/utils';\r\n\r\n\r\n/**\r\n * 動画プレイヤーである DPlayer に関連するロジックを丸ごとラップするクラスで、再生系ロジックの中核を担う\r\n * DPlayer の初期化後は DPlayer が発行するイベントなどに合わせ、各イベントハンドラーや PlayerManager を管理する\r\n *\r\n * このクラスはコンストラクタで指定されたチャンネル or 録画番組の再生に責任を持つ\r\n * await destroy() 後に再度 await init() すると、コンストラクタに渡したのと同じチャンネル or 録画番組のプレイヤーを再起動できる\r\n * 再生対象が他のチャンネル or 録画番組に切り替えられた際は、既存の PlayerController を破棄し、新たに PlayerController を作り直す必要がある\r\n * 実装上、このクラスのインスタンスは必ずアプリケーション上で1つだけ存在するように実装する必要がある\r\n */\r\nclass PlayerController {\r\n\r\n    // ライブ視聴: 低遅延モードオンでの再生バッファ (秒単位)\r\n    // 0.8 秒程度余裕を持たせる\r\n    private static readonly LIVE_PLAYBACK_BUFFER_SECONDS_LOW_LATENCY = 0.8;\r\n\r\n    // ライブ視聴: 低遅延モードオフでの再生バッファ (秒単位)\r\n    // 4 秒程度の遅延を許容する\r\n    private static readonly LIVE_PLAYBACK_BUFFER_SECONDS = 4.0;\r\n\r\n    // DPlayer のインスタンス\r\n    private player: DPlayer | null = null;\r\n\r\n    // それぞれの PlayerManager のインスタンスのリスト\r\n    private player_managers: PlayerManager[] = [];\r\n\r\n    // 再生モード (Live: ライブ視聴, Video: ビデオ視聴)\r\n    private readonly playback_mode: 'Live' | 'Video';\r\n\r\n    // ライブ視聴: 画質プロファイル\r\n    private readonly tv_streaming_quality: LiveStreamingQuality;\r\n    private readonly tv_data_saver_mode: boolean;\r\n    private readonly tv_low_latency_mode: boolean;\r\n\r\n    // ビデオ視聴: 画質プロファイル\r\n    private readonly video_streaming_quality: VideoStreamingQuality;\r\n    private readonly video_data_saver_mode: boolean;\r\n\r\n    // ライブ視聴: 許容する HTMLMediaElement の内部再生バッファの秒数\r\n    // 設計上コンストラクタ以降で変更すべきでないため readonly にしている\r\n    private readonly live_playback_buffer_seconds: number;\r\n\r\n    // ライブ視聴: mpegts.js のバッファ詰まり対策で定期的に強制シークするインターバルのタイマー ID\r\n    // 保持しておかないと clearInterval() でタイマーを止められない\r\n    private live_force_seek_interval_timer_id: number = 0;\r\n\r\n    // ビデオ視聴: ビデオストリームのアクティブ状態を維持するために Keep-Alive API にリクエストを送るインターバルのタイマー ID\r\n    // 保持しておかないと clearInterval() でタイマーを止められない\r\n    private video_keep_alive_interval_timer_id: number = 0;\r\n\r\n    // setupPlayerContainerResizeHandler() で利用する ResizeObserver\r\n    // 保持しておかないと disconnect() で ResizeObserver を止められない\r\n    private player_container_resize_observer: ResizeObserver | null = null;\r\n\r\n    // setControlDisplayTimer() で利用するタイマー ID\r\n    // 保持しておかないと clearTimeout() でタイマーを止められない\r\n    private player_control_ui_hide_timer_id: number = 0;\r\n\r\n    // RomSound の AudioContext と AudioBuffer のリスト\r\n    private readonly romsounds_context: AudioContext = new AudioContext();\r\n    private readonly romsounds_buffers: AudioBuffer[] = [];\r\n\r\n    // 破棄中かどうか\r\n    // 破棄中は destroy() が呼ばれても何もしない\r\n    private destroying = false;\r\n\r\n    // 破棄済みかどうか\r\n    private destroyed = false;\r\n\r\n\r\n    /**\r\n     * コンストラクタ\r\n     * 実際の DPlayer の初期化処理は await init() で行われる\r\n     */\r\n    constructor(playback_mode: 'Live' | 'Video') {\r\n\r\n        // 再生モードをセット\r\n        this.playback_mode = playback_mode;\r\n\r\n        // ネットワーク回線が Cellular (モバイル回線) であれば、モバイル回線用の画質プロファイルを適用する\r\n        // Wi-Fi or 取得できなかった場合は、通常の画質プロファイルを適用する\r\n        const settings_store = useSettingsStore();\r\n        const network_circuit_type = PlayerUtils.getNetworkCircuitType();\r\n        // ライブ視聴の画質プロファイル\r\n        this.tv_streaming_quality = network_circuit_type === 'Cellular' ?\r\n            settings_store.settings.tv_streaming_quality_cellular : settings_store.settings.tv_streaming_quality;\r\n        this.tv_data_saver_mode = network_circuit_type === 'Cellular' ?\r\n            settings_store.settings.tv_data_saver_mode_cellular : settings_store.settings.tv_data_saver_mode;\r\n        this.tv_low_latency_mode = network_circuit_type === 'Cellular' ?\r\n            settings_store.settings.tv_low_latency_mode_cellular : settings_store.settings.tv_low_latency_mode;\r\n        // ビデオ視聴の画質プロファイル\r\n        this.video_streaming_quality = network_circuit_type === 'Cellular' ?\r\n            settings_store.settings.video_streaming_quality_cellular : settings_store.settings.video_streaming_quality;\r\n        this.video_data_saver_mode = network_circuit_type === 'Cellular' ?\r\n            settings_store.settings.video_data_saver_mode_cellular : settings_store.settings.video_data_saver_mode;\r\n\r\n        // 低遅延モードであれば低遅延向けの再生バッファを、そうでなければ通常の再生バッファをセット (秒単位)\r\n        this.live_playback_buffer_seconds = this.tv_low_latency_mode ?\r\n            PlayerController.LIVE_PLAYBACK_BUFFER_SECONDS_LOW_LATENCY : PlayerController.LIVE_PLAYBACK_BUFFER_SECONDS;\r\n\r\n        // Safari の Media Source Extensions API の実装はどうもバッファの揺らぎが大きい (?) ようなので、バッファ詰まり対策で\r\n        // さらに 0.3 秒程度余裕を持たせる\r\n        if (Utils.isSafari() === true) {\r\n            this.live_playback_buffer_seconds += 0.3;\r\n        }\r\n\r\n        // 01 ~ 14 まですべての RomSound を読み込む\r\n        for (let index = 1; index <= 14; index++) {\r\n            (async () => {\r\n                // ArrayBuffer をデコードして AudioBuffer にし、すぐ呼び出せるように貯めておく\r\n                // ref: https://ics.media/entry/200427/\r\n                const romsound_url = `/assets/romsounds/${index.toString().padStart(2, '0')}.wav`;\r\n                const romsound_response = await APIClient.get<ArrayBuffer>(romsound_url, {\r\n                    baseURL: '',  // BaseURL を明示的にクライアントのルートに設定\r\n                    responseType: 'arraybuffer',\r\n                });\r\n                if (romsound_response.type === 'success') {\r\n                    this.romsounds_buffers.push(await this.romsounds_context.decodeAudioData(romsound_response.data));\r\n                }\r\n            })();\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * DPlayer と PlayerManager を初期化し、再生準備を行う\r\n     */\r\n    public async init(): Promise<void> {\r\n        const channels_store = useChannelsStore();\r\n        const player_store = usePlayerStore();\r\n        const settings_store = useSettingsStore();\r\n        console.log('\\u001b[31m[PlayerController] Initializing...');\r\n\r\n        // 破棄済みかどうかのフラグを下ろす\r\n        this.destroyed = false;\r\n\r\n        // PlayerStore にプレイヤーを初期化したことを通知する\r\n        // 実際にはこの時点ではプレイヤーの初期化は完了していないが、PlayerController.init() を実行したことが通知されることが重要\r\n        // ライブ視聴かつザッピングを経てチャンネルが確定した場合、破棄を遅らせていた以前の PlayerController に紐づく\r\n        // KeyboardShortcutManager がこのタイミングで破棄される\r\n        player_store.is_player_initialized = true;\r\n\r\n        // mpegts.js と hls.js を window 直下に入れる\r\n        // こうしないと DPlayer が mpegts.js / hls.js を認識できない\r\n        (window as any).mpegts = mpegts;\r\n        (window as any).Hls = Hls;\r\n\r\n        // 文字スーパーの表示設定\r\n        // ライブ視聴とビデオ視聴で設定キーが異なる\r\n        const is_show_superimpose = this.playback_mode === 'Live' ?\r\n            settings_store.settings.tv_show_superimpose : settings_store.settings.video_show_superimpose;\r\n\r\n        // DPlayer を初期化\r\n        this.player = new DPlayer({\r\n            // DPlayer を配置する要素\r\n            container: document.querySelector<HTMLDivElement>('.watch-player__dplayer')!,\r\n            // テーマカラー\r\n            theme: '#E64F97',\r\n            // 言語 (日本語固定)\r\n            lang: 'ja-jp',\r\n            // ライブモード (ビデオ視聴では無効)\r\n            live: this.playback_mode === 'Live' ? true : false,\r\n            // ライブモードで同期する際の最小バッファサイズ\r\n            liveSyncMinBufferSize: this.live_playback_buffer_seconds - 0.1,\r\n            // ループ再生 (ライブ視聴では無効)\r\n            loop: this.playback_mode === 'Live' ? false : true,\r\n            // 自動再生\r\n            autoplay: true,\r\n            // AirPlay 機能 (うまく動かないため無効化)\r\n            airplay: false,\r\n            // ショートカットキー（こちらで制御するため無効化）\r\n            hotkey: false,\r\n            // スクリーンショット (こちらで制御するため無効化)\r\n            screenshot: false,\r\n            // CORS を有効化\r\n            crossOrigin: 'anonymous',\r\n            // 音量の初期値\r\n            volume: 1.0,\r\n\r\n            // 動画の設定\r\n            video: (() => {\r\n\r\n                // 画質リスト\r\n                const qualities: DPlayerType.VideoQuality[] = [];\r\n\r\n                // ブラウザが H.265 / HEVC の再生に対応していて、かつ通信節約モードが有効なとき\r\n                // API に渡す画質に -hevc のプレフィックスをつける\r\n                let hevc_prefix = '';\r\n                if (PlayerUtils.isHEVCVideoSupported() &&\r\n                    ((this.playback_mode === 'Live' && this.tv_data_saver_mode === true) ||\r\n                     (this.playback_mode === 'Video' && this.video_data_saver_mode === true))) {\r\n                    hevc_prefix = '-hevc';\r\n                }\r\n\r\n                // ライブ視聴: チャンネル情報がセットされているはず\r\n                if (this.playback_mode === 'Live') {\r\n\r\n                    // ライブストリーミング API のベース URL\r\n                    const streaming_api_base_url = `${Utils.api_base_url}/streams/live/${channels_store.channel.current.display_channel_id}`;\r\n\r\n                    // ラジオチャンネルの場合\r\n                    // API が受け付ける画質の値は通常のチャンネルと同じだが (手抜き…)、実際の画質は 48KHz/192kbps で固定される\r\n                    // ラジオチャンネルの場合は、1080p と渡しても 48kHz/192kbps 固定の音声だけの MPEG-TS が配信される\r\n                    if (channels_store.channel.current.is_radiochannel === true) {\r\n                        qualities.push({\r\n                            name: '48kHz/192kbps',\r\n                            type: 'mpegts',\r\n                            url: `${streaming_api_base_url}/1080p/mpegts`,\r\n                        });\r\n\r\n                    // 通常のチャンネルの場合\r\n                    } else {\r\n\r\n                        // 画質リストを作成\r\n                        for (const quality_name of LIVE_STREAMING_QUALITIES) {\r\n                            qualities.push({\r\n                                // 1080p-60fps のみ、見栄えの観点から表示上 \"1080p (60fps)\" と表示する\r\n                                name: quality_name === '1080p-60fps' ? '1080p (60fps)' : quality_name,\r\n                                type: 'mpegts',\r\n                                url: `${streaming_api_base_url}/${quality_name}${hevc_prefix}/mpegts`,\r\n                            });\r\n                        }\r\n                    }\r\n\r\n                    // デフォルトの画質\r\n                    // ラジオチャンネルのみ常に 48KHz/192kbps に固定する\r\n                    let default_quality: string = this.tv_streaming_quality;\r\n                    if (channels_store.channel.current.is_radiochannel) {\r\n                        default_quality = '48kHz/192kbps';\r\n                    }\r\n\r\n                    return {\r\n                        quality: qualities,\r\n                        defaultQuality: default_quality,\r\n                    };\r\n\r\n                // ビデオ視聴: 録画番組情報がセットされているはず\r\n                } else {\r\n\r\n                    // ビデオストリーミング API のベース URL\r\n                    const streaming_api_base_url = `${Utils.api_base_url}/streams/video/${player_store.recorded_program.id}`;\r\n\r\n                    // 画質リストを作成\r\n                    for (const quality_name of VIDEO_STREAMING_QUALITIES) {\r\n                        qualities.push({\r\n                            // 1080p-60fps のみ、見栄えの観点から表示上 \"1080p (60fps)\" と表示する\r\n                            name: quality_name === '1080p-60fps' ? '1080p (60fps)' : quality_name,\r\n                            type: 'hls',\r\n                            url: `${streaming_api_base_url}/${quality_name}${hevc_prefix}/playlist`,\r\n                        });\r\n                    }\r\n\r\n                    // デフォルトの画質\r\n                    // 録画ではラジオは考慮しない\r\n                    const default_quality: string = this.video_streaming_quality;\r\n\r\n                    return {\r\n                        quality: qualities,\r\n                        defaultQuality: default_quality,\r\n                    };\r\n                }\r\n            })(),\r\n\r\n            // コメントの設定\r\n            danmaku: {\r\n                // コメントするユーザー名: 便宜上 KonomiTV に固定 (実際には利用されない)\r\n                user: 'KonomiTV',\r\n                // コメントの流れる速度\r\n                speedRate: settings_store.settings.comment_speed_rate,\r\n                // コメントのフォントサイズ\r\n                fontSize: settings_store.settings.comment_font_size,\r\n                // コメント送信後にコメントフォームを閉じるかどうか\r\n                closeCommentFormAfterSend: settings_store.settings.close_comment_form_after_sending,\r\n            },\r\n\r\n            // コメント API バックエンドの設定\r\n            apiBackend: {\r\n                // コメント取得時\r\n                read: async (options) => {\r\n                    if (this.playback_mode === 'Live') {\r\n                        // ライブ視聴: 空の配列を返す\r\n                        // ライブ視聴では LiveCommentManager 側でリアルタイムにコメントを受信して直接描画するため、ここでは一旦コメント0件として認識させる\r\n                        options.success([]);\r\n                    } else {\r\n                        // ビデオ視聴: 過去ログコメントを取得して返す\r\n                        const jikkyo_comments = await Videos.fetchVideoJikkyoComments(player_store.recorded_program.id);\r\n                        if (jikkyo_comments.is_success === false) {\r\n                            // 取得に失敗した場合はコメントリストにエラーメッセージを表示する\r\n                            // ただし「この録画番組の過去ログコメントは存在しないか、現在取得中です。」の場合はエラー扱いしない\r\n                            player_store.video_comment_init_failed_message = jikkyo_comments.detail;\r\n                            if (jikkyo_comments.detail !== 'この録画番組の過去ログコメントは存在しないか、現在取得中です。') {\r\n                                options.error(jikkyo_comments.detail);\r\n                            } else {\r\n                                options.success([]);\r\n                            }\r\n                        } else {\r\n                            // 過去ログコメントを取得できているということは、recording_start_time は null ではないはず\r\n                            const recording_start_time = player_store.recorded_program.recorded_video.recording_start_time!;\r\n                            // コメントリストに取得した過去ログコメントを送る\r\n                            // コメ番は重複している可能性がないとも言い切れないので、別途連番を振る\r\n                            let count = 0;\r\n                            player_store.event_emitter.emit('CommentReceived', {\r\n                                is_initial_comments: true,\r\n                                comments: jikkyo_comments.comments.map((comment) => ({\r\n                                    id: count++,\r\n                                    text: comment.text,\r\n                                    time: dayjs(recording_start_time).add(comment.time, 'seconds').format('MM/DD HH:mm:ss'),\r\n                                    playback_position: comment.time,\r\n                                    user_id: comment.author,\r\n                                    my_post: false,\r\n                                })),\r\n                            });\r\n                            options.success(jikkyo_comments.comments);\r\n                        }\r\n                    }\r\n                },\r\n                // コメント送信時\r\n                send: async (options) => {\r\n                    if (this.playback_mode === 'Live') {\r\n                        // ライブ視聴: コメントを送信する\r\n                        // PlayerManager に登録されているはずの LiveCommentManager を探し、コメントを送信する\r\n                        for (const player_manager of this.player_managers) {\r\n                            if (player_manager instanceof LiveCommentManager) {\r\n                                player_manager.sendComment(options);  // options.success() は LiveCommentManager 側で呼ばれる\r\n                                return;\r\n                            }\r\n                        }\r\n                    } else {\r\n                        // ビデオ視聴: 過去ログにはコメントできないのでエラーを返す\r\n                        options.error('録画番組にはコメントできません。');\r\n                    }\r\n                },\r\n            },\r\n\r\n            // 字幕の設定\r\n            subtitle: {\r\n                type: 'aribb24',  // aribb24.js を有効化\r\n            },\r\n\r\n            // 再生プラグインの設定\r\n            pluginOptions: {\r\n                // mpegts.js\r\n                mpegts: {\r\n                    config: {\r\n                        // Web Worker を有効にする\r\n                        enableWorker: true,\r\n                        // Media Source Extensions API 向けの Web Worker を有効にする\r\n                        // メインスレッドから再生処理を分離することで、低スペック端末で DOM 描画の遅延が影響して映像再生が詰まる問題が解消される\r\n                        // MSE in Workers が使えるかは MediaSource.canConstructInDedicatedWorker が true かどうかで判定できる\r\n                        // MediaSource.canConstructInDedicatedWorker は TypeScript の仕様上型定義の追加が難しいため any で回避している\r\n                        // ref: https://developer.mozilla.org/en-US/docs/Web/API/MediaSource/canConstructInDedicatedWorker_static\r\n                        enableWorkerForMSE: window.MediaSource && (window.MediaSource as any).canConstructInDedicatedWorker === true,\r\n                        // 再生開始まで 2048KB のバッファを貯める (?)\r\n                        // あまり大きくしすぎてもどうも効果がないようだが、小さくしたり無効化すると特に Safari で不安定になる\r\n                        enableStashBuffer: true,\r\n                        stashInitialSize: Math.floor(2048 * 1024),\r\n                        // HTMLMediaElement の内部バッファによるライブストリームの遅延を追跡する\r\n                        // liveBufferLatencyChasing と異なり、いきなり再生時間をスキップするのではなく、\r\n                        // 再生速度を少しだけ上げることで再生を途切れさせることなく遅延を追跡する\r\n                        liveSync: this.tv_low_latency_mode,\r\n                        // 許容する HTMLMediaElement の内部バッファの最大値 (秒単位, 3秒)\r\n                        liveSyncMaxLatency: 3,\r\n                        // HTMLMediaElement の内部バッファ (遅延) が liveSyncMaxLatency を超えたとき、ターゲットとする遅延時間 (秒単位)\r\n                        liveSyncTargetLatency: this.live_playback_buffer_seconds,\r\n                        // ライブストリームの遅延の追跡に利用する再生速度 (x1.1)\r\n                        // 遅延が 3 秒を超えたとき、遅延が playback_buffer_sec を下回るまで再生速度が x1.1 に設定される\r\n                        liveSyncPlaybackRate: 1.1,\r\n                    }\r\n                },\r\n                // hls.js\r\n                hls: {\r\n                    ...Hls.DefaultConfig,\r\n                    // デバッグログを有効化\r\n                    debug: true,\r\n                    // Web Worker を有効にする\r\n                    enableWorker: true,\r\n                    // MediaSource が存在しない場合のみ ManagedMediaSource を利用する\r\n                    preferManagedMediaSource: false,\r\n                    // プレイリスト / セグメントのリクエスト時のタイムアウトを回避する\r\n                    manifestLoadPolicy: {\r\n                        default: {\r\n                            maxTimeToFirstByteMs: 1000000,  // 適当に大きな値を設定\r\n                            maxLoadTimeMs: 1000000,  // 適当に大きな値を設定\r\n                            timeoutRetry: {\r\n                                maxNumRetry: 2,\r\n                                retryDelayMs: 0,\r\n                                maxRetryDelayMs: 0,\r\n                            },\r\n                            errorRetry: {\r\n                                maxNumRetry: 1,\r\n                                retryDelayMs: 1000,\r\n                                maxRetryDelayMs: 8000,\r\n                            },\r\n                        },\r\n                    },\r\n                    playlistLoadPolicy: {\r\n                        default: {\r\n                            maxTimeToFirstByteMs: 1000000,  // 適当に大きな値を設定\r\n                            maxLoadTimeMs: 1000000,  // 適当に大きな値を設定\r\n                            timeoutRetry: {\r\n                                maxNumRetry: 2,\r\n                                retryDelayMs: 0,\r\n                                maxRetryDelayMs: 0,\r\n                            },\r\n                            errorRetry: {\r\n                                maxNumRetry: 2,\r\n                                retryDelayMs: 1000,\r\n                                maxRetryDelayMs: 8000,\r\n                            }\r\n                        }\r\n                    },\r\n                    fragLoadPolicy: {\r\n                        default: {\r\n                            maxTimeToFirstByteMs: 1000000,  // 適当に大きな値を設定\r\n                            maxLoadTimeMs: 1000000,  // 適当に大きな値を設定\r\n                            timeoutRetry: {\r\n                                maxNumRetry: 4,\r\n                                retryDelayMs: 0,\r\n                                maxRetryDelayMs: 0,\r\n                            },\r\n                            errorRetry: {\r\n                                maxNumRetry: 6,\r\n                                retryDelayMs: 1000,\r\n                                maxRetryDelayMs: 8000,\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                // aribb24.js\r\n                aribb24: {\r\n                    // 文字スーパーレンダラーを無効にするかどうか\r\n                    disableSuperimposeRenderer: is_show_superimpose === false,\r\n                    // 描画フォント\r\n                    normalFont: `\"${settings_store.settings.caption_font}\", \"Rounded M+ 1m for ARIB\", sans-serif`,\r\n                    // 縁取りする色\r\n                    forceStrokeColor: settings_store.settings.always_border_caption_text,\r\n                    // 背景色\r\n                    forceBackgroundColor: (() => {\r\n                        if (settings_store.settings.specify_caption_opacity === true) {\r\n                            const opacity = settings_store.settings.caption_opacity;\r\n                            return `rgba(0, 0, 0, ${opacity})`;\r\n                        } else {\r\n                            return undefined;\r\n                        }\r\n                    })(),\r\n                    // DRCS 文字を対応する Unicode 文字に置換\r\n                    drcsReplacement: true,\r\n                    // 高解像度の字幕 Canvas を取得できるように\r\n                    enableRawCanvas: true,\r\n                    // 縁取りに strokeText API を利用\r\n                    useStroke: true,\r\n                    // Unicode 領域の代わりに私用面の領域を利用 (Windows TV 系フォントのみ)\r\n                    usePUA: (() => {\r\n                        const font = settings_store.settings.caption_font;\r\n                        const context = document.createElement('canvas').getContext('2d')!;\r\n                        context.font = '10px \"Rounded M+ 1m for ARIB\"';\r\n                        context.fillText('Test', 0, 0);\r\n                        context.font = `10px \"${font}\"`;\r\n                        context.fillText('Test', 0, 0);\r\n                        if (font.startsWith('Windows TV')) {\r\n                            return true;\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                    })(),\r\n                    // 文字スーパーの PRA (内蔵音再生コマンド) のコールバックを指定\r\n                    PRACallback: async (index: number) => {\r\n\r\n                        // 設定で文字スーパーが無効なら実行しない\r\n                        if (is_show_superimpose === false) return;\r\n\r\n                        // index に応じた内蔵音を鳴らす\r\n                        // ref: https://ics.media/entry/200427/\r\n                        // ref: https://www.ipentec.com/document/javascript-web-audio-api-change-volume\r\n\r\n                        // 自動再生ポリシーに引っかかったなどで AudioContext が一時停止されている場合、一度 resume() する必要がある\r\n                        // resume() するまでに何らかのユーザーのジェスチャーが行われているはず…\r\n                        // なくても動くこともあるみたいだけど、念のため\r\n                        if (this.romsounds_context.state === 'suspended') {\r\n                            await this.romsounds_context.resume();\r\n                        }\r\n\r\n                        // index で指定された音声データを読み込み\r\n                        const buffer_source_node = this.romsounds_context.createBufferSource();\r\n                        buffer_source_node.buffer = this.romsounds_buffers[index];\r\n\r\n                        // GainNode につなげる\r\n                        const gain_node = this.romsounds_context.createGain();\r\n                        buffer_source_node.connect(gain_node);\r\n\r\n                        // 出力につなげる\r\n                        gain_node.connect(this.romsounds_context.destination);\r\n\r\n                        // 音量を元の wav の3倍にする (1倍だと結構小さめ)\r\n                        gain_node.gain.value = 3;\r\n\r\n                        // 再生開始\r\n                        buffer_source_node.start(0);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        // デバッグ用にプレイヤーインスタンスも window 直下に入れる\r\n        (window as any).player = this.player;\r\n\r\n        // この時点で DPlayer のコンテナ要素に dplayer-mobile クラスが付与されている場合、\r\n        // DPlayer は音量コントロールがないスマホ向けの UI になっている\r\n        // 通常の UI で DPlayer の音量を 1.0 以外に設定した後スマホ向け UI になった場合、DPlayer の音量を変更できず OS の音量を上げるしかなくなる\r\n        // そこで、スマホ向けの UI が表示されている場合のみ常に音量を 1.0 に設定する\r\n        if (this.player.container.classList.contains('dplayer-mobile') === true) {\r\n            // player.volume() を用いることで、単に音量を変更するだけでなく LocalStorage に音量を保存する処理も実行される\r\n            // 第3引数を true に設定すると、通知を表示せずに音量を変更できる\r\n            this.player.volume(1.0, undefined, true);\r\n        }\r\n\r\n        // DPlayer 側のコントロール UI 非表示タイマーを無効化（上書き）\r\n        // 無効化しておかないと、PlayerController.setControlDisplayTimer() の処理と競合してしまう\r\n        // 上書き元のコードは https://github.com/tsukumijima/DPlayer/blob/v1.30.2/src/ts/controller.ts#L397-L405 にある\r\n        this.player.controller.setAutoHide = (time: number) => {};\r\n\r\n        // DPlayer に動画再生系のイベントハンドラーを登録する\r\n        this.setupVideoPlaybackHandler();\r\n\r\n        // DPlayer のフルスクリーン関係のメソッドを無理やり上書きし、KonomiTV の UI と統合する\r\n        this.setupFullscreenHandler();\r\n\r\n        // DPlayer の設定パネルを無理やり拡張し、KonomiTV 独自の項目を追加する\r\n        this.setupSettingPanelHandler();\r\n\r\n        // KonomiTV 本体の UI を含むプレイヤー全体のコンテナ要素がリサイズされたときのイベントハンドラーを登録する\r\n        this.setupPlayerContainerResizeHandler();\r\n\r\n        // プレイヤーのコントロール UI を表示する (初回実行)\r\n        this.setControlDisplayTimer();\r\n\r\n        // UI コンポーネントからプレイヤーに通知メッセージの送信を要求されたときのイベントハンドラーを登録する\r\n        // このイベントは常にアプリケーション上で1つだけ登録されていなければならない\r\n        player_store.event_emitter.off('SendNotification');  // SendNotification イベントの全てのイベントハンドラーを削除\r\n        player_store.event_emitter.on('SendNotification', (event) => {\r\n            if (this.destroyed === true || this.player === null) return;\r\n            this.player.notice(event.message, event.duration, event.opacity, event.color);\r\n        });\r\n\r\n        // PlayerManager からプレイヤーの再起動が必要になったことを通知されたときのイベントハンドラーを登録する\r\n        // このイベントは常にアプリケーション上で1つだけ登録されていなければならない\r\n        // さもなければ使い終わった破棄済みの PlayerController が再起動イベントにより復活し、現在利用中の PlayerController と競合してしまう\r\n        let is_player_restarting = false;  // 現在再起動中かどうか\r\n        player_store.event_emitter.off('PlayerRestartRequired');  // PlayerRestartRequired イベントの全てのイベントハンドラーを削除\r\n        player_store.event_emitter.on('PlayerRestartRequired', async (event) => {\r\n\r\n            // すでに破棄済みであれば何もしない\r\n            if (this.destroyed === true || this.player === null) return;\r\n            console.warn('\\u001b[31m[PlayerController] PlayerRestartRequired event received. Message: ', event.message);\r\n\r\n            // ライブ視聴: iOS 17.0 以下で mpegts.js がサポートされていない場合は再起動できない\r\n            if (this.playback_mode === 'Live' && mpegts.isSupported() !== true) {  // mpegts.js 非対応環境では undefined が返る\r\n                console.warn('\\u001b[31m[PlayerController] PlayerRestartRequired event received, but mpegts.js is not supported. Ignored.');\r\n                // iOS 17.0 以下は mpegts.js がサポートされていないため、再生できない\r\n                this.player?.notice('iOS (Safari) 17.0 以下での視聴には対応していません。速やかに iOS を 17.1 以降に更新してください。', -1, undefined, '#FF6F6A');\r\n                return;\r\n            }\r\n\r\n            // 既に再起動中であれば何もしない (再起動が重複して行われるのを防ぐ)\r\n            if (is_player_restarting === true) {\r\n                console.warn('\\u001b[31m[PlayerController] PlayerRestartRequired event received, but already restarting. Ignored.');\r\n                return;\r\n            }\r\n            is_player_restarting = true;\r\n\r\n            // PlayerController 自身を破棄\r\n            await this.destroy();\r\n\r\n            // 即座に再起動すると諸々問題があるので、少し待つ\r\n            await Utils.sleep(0.5);\r\n\r\n            // PlayerController 自身を再初期化\r\n            // この時点で PlayerRestartRequired のイベントハンドラーは再登録されているはず\r\n            await this.init();\r\n\r\n            // プレイヤー側にイベントの発火元から送られたメッセージ (プレイヤーを再起動中である旨) を通知する\r\n            // 再初期化により、作り直した DPlayer が再び this.player にセットされているはず\r\n            // 通知を表示してから PlayerController を破棄すると DPlayer の DOM 要素ごと消えてしまうので、DPlayer を作り直した後に通知を表示する\r\n            assert(this.player !== null);\r\n            if (event.message) {\r\n                // 明示的にエラーメッセージではないことが指定されていればデフォルトの色で通知を表示する\r\n                const color = event.is_error_message === false ? undefined : '#FF6F6A';\r\n                this.player.notice(event.message, undefined, undefined, color);\r\n            }\r\n            is_player_restarting = false;\r\n        });\r\n\r\n        // PlayerController.setControlDisplayTimer() の呼び出しを要求されたときのイベントハンドラーを登録する\r\n        // このイベントは常にアプリケーション上で1つだけ登録されていなければならない\r\n        player_store.event_emitter.off('SetControlDisplayTimer');  // SetControlDisplayTimer イベントの全てのイベントハンドラーを削除\r\n        player_store.event_emitter.on('SetControlDisplayTimer', (event) => {\r\n            this.setControlDisplayTimer(event.event, event.is_player_region_event);\r\n        });\r\n\r\n        // プレイヤー再起動ボタンを DPlayer の UI に追加する (再生が止まった際などに利用する想定)\r\n        // insertAdjacentHTML で .dplayer-icons-right の一番左側に配置する\r\n        this.player.container.querySelector('.dplayer-icons.dplayer-icons-right')!.insertAdjacentHTML('afterbegin', `\r\n            <div class=\"dplayer-icon dplayer-player-restart-icon\" aria-label=\"プレイヤーを再起動\"\r\n                data-balloon-nofocus=\"\" data-balloon-pos=\"up\">\r\n                <span class=\"dplayer-icon-content\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M12 5V3.21c0-.45-.54-.67-.85-.35l-2.8 2.79c-.2.2-.2.51 0 .71l2.79 2.79c.32.31.86.09.86-.36V7c3.31 0 6 2.69 6 6c0 2.72-1.83 5.02-4.31 5.75c-.42.12-.69.52-.69.95c0 .65.62 1.16 1.25.97A7.991 7.991 0 0 0 20 13c0-4.42-3.58-8-8-8zm-6 8c0-1.34.44-2.58 1.19-3.59c.3-.4.26-.95-.09-1.31c-.42-.42-1.14-.38-1.5.1a7.991 7.991 0 0 0 4.15 12.47c.63.19 1.25-.32 1.25-.97c0-.43-.27-.83-.69-.95C7.83 18.02 6 15.72 6 13z\"/></svg>\r\n                </span>\r\n            </div>\r\n        `);\r\n        // PlayerRestartRequired イベントとは異なり、通知メッセージなしで即座に PlayerController を再起動する\r\n        this.player.container.querySelector('.dplayer-player-restart-icon')!.addEventListener('click', async () => {\r\n            await this.destroy();\r\n            await this.init();\r\n            this.player?.notice('プレイヤーを再起動しました。', undefined, undefined, undefined);\r\n        });\r\n\r\n        // 各 PlayerManager を初期化・登録\r\n        // ライブ視聴とビデオ視聴で必要な PlayerManager が異なる\r\n        // この初期化順序は意図的 (入れ替えても動作するものもあるが、CaptureManager は KeyboardShortcutManager より先に初期化する必要がある)\r\n        if (this.playback_mode === 'Live') {\r\n            // ライブ視聴時に設定する PlayerManager\r\n            this.player_managers = [\r\n                new LiveEventManager(this.player),\r\n                new LiveCommentManager(this.player),\r\n                new LiveDataBroadcastingManager(this.player),\r\n                new CaptureManager(this.player, this.playback_mode),\r\n                new KeyboardShortcutManager(this.player, this.playback_mode),\r\n                new MediaSessionManager(this.player, this.playback_mode),\r\n            ];\r\n        } else {\r\n            // ビデオ視聴時に設定する PlayerManager\r\n            this.player_managers = [\r\n                new CaptureManager(this.player, this.playback_mode),\r\n                new KeyboardShortcutManager(this.player, this.playback_mode),\r\n                new MediaSessionManager(this.player, this.playback_mode),\r\n            ];\r\n        }\r\n\r\n        // 登録されている PlayerManager をすべて初期化\r\n        // これにより各 PlayerManager での実際の処理が開始される\r\n        // 同期処理すると時間が掛かるので、並行して実行する\r\n        await Promise.all(this.player_managers.map((player_manager) => player_manager.init()));\r\n\r\n        console.log('\\u001b[31m[PlayerController] Initialized.');\r\n    }\r\n\r\n\r\n    /**\r\n     * ライブ視聴: 現在の DPlayer の再生バッファを再生位置とバッファ秒数の差から取得する\r\n     * ビデオ視聴時と、取得に失敗した場合は 0 を返す\r\n     * @returns バッファ秒数\r\n     */\r\n    private getPlaybackBufferSeconds(): number {\r\n        if (this.player === null) return 0;\r\n        if (this.playback_mode === 'Live') {\r\n            try {\r\n                const buffered_range_count = this.player.video.buffered.length;\r\n                const buffer_remain = this.player.video.buffered.end(buffered_range_count - 1) - this.player.video.currentTime;\r\n                return Utils.mathFloor(buffer_remain, 3);\r\n            } catch (error) {\r\n                return 0;\r\n            }\r\n        } else {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * まだ再生が開始できていない場合 (HTMLVideoElement.readyState < HAVE_FUTURE_DATA) に再生状態の復旧を試みる\r\n     * 処理の完了を待つ必要はないので、基本 await せず非同期で実行すべき\r\n     * 基本 Safari だとなぜか再生開始がうまく行かないことが多いので（自動再生まわりが影響してる？）、その対策として用意した処理\r\n     */\r\n    private async recoverPlayback(): Promise<void> {\r\n        assert(this.player !== null);\r\n        const player_store = usePlayerStore();\r\n\r\n        // 1 秒待つ\r\n        await Utils.sleep(1);\r\n\r\n        // この時点で映像が停止していて、かつ readyState が HAVE_FUTURE_DATA な場合、復旧を試みる\r\n        // Safari ではタイミングによっては this.player.video が null になる場合があるらしいので ? を付ける\r\n        if (player_store.is_video_buffering === true && this.player?.video?.readyState < 3) {\r\n            console.warn('\\u001b[31m[PlayerController] Video still buffering. (HTMLVideoElement.readyState < HAVE_FUTURE_DATA) trying to recover.');\r\n\r\n            // 一旦停止して、0.25 秒間を置く\r\n            this.player.video.pause();\r\n            await Utils.sleep(0.25);\r\n\r\n            // 再度再生を試みる\r\n            try {\r\n                await this.player.video.play();\r\n            } catch (error) {\r\n                assert(this.player !== null);\r\n                console.warn('\\u001b[31m[PlayerController] HTMLVideoElement.play() rejected. paused.');\r\n                this.player.pause();\r\n                return;  // 再生開始がリジェクトされた場合はここで終了\r\n            }\r\n\r\n            // さらに 0.5 秒待った時点で映像が停止している場合、復旧を試みる\r\n            await Utils.sleep(0.5);\r\n            if (player_store.is_video_buffering === true && this.player?.video?.readyState < 3) {\r\n                console.warn('\\u001b[31m[PlayerController] Video still buffering. (HTMLVideoElement.readyState < HAVE_FUTURE_DATA) trying to recover.');\r\n\r\n                // 一旦停止して、0.25 秒間を置く\r\n                this.player.video.pause();\r\n                await Utils.sleep(0.25);\r\n\r\n                // 再度再生を試みる\r\n                try {\r\n                    await this.player.video.play();\r\n                } catch (error) {\r\n                    assert(this.player !== null);\r\n                    console.warn('\\u001b[31m[PlayerController] (retry) HTMLVideoElement.play() rejected. paused.');\r\n                    this.player.pause();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * DPlayer に動画再生系のイベントハンドラーを登録する\r\n     * 特にライブ視聴ではここで適切に再生状態の管理 (再生可能かどうか、エラーが発生していないかなど) を行う必要がある\r\n     */\r\n    private setupVideoPlaybackHandler(): void {\r\n        assert(this.player !== null);\r\n        const channels_store = useChannelsStore();\r\n        const player_store = usePlayerStore();\r\n\r\n        // ライブ視聴: 再生停止状態かつ現在の再生位置からバッファが 30 秒以上離れていないかを 60 秒おきに監視し、そうなっていたら強制的にシークする\r\n        // mpegts.js の仕様上、MSE 側に未再生のバッファが貯まり過ぎると新規に SourceBuffer が追加できなくなるため、強制的に接続が切断されてしまう\r\n        // 再生停止状態でも定期的にシークすることで、バッファが貯まりすぎないように調節する\r\n        if (this.playback_mode === 'Live') {\r\n            this.live_force_seek_interval_timer_id = window.setInterval(() => {\r\n                if (this.player === null) return;\r\n                if ((this.player.video.paused && this.player.video.buffered.length >= 1) &&\r\n                    (this.player.video.buffered.end(0) - this.player.video.currentTime > 30)) {\r\n                    this.player.sync();\r\n                }\r\n            }, 60 * 1000);\r\n        }\r\n\r\n        // ビデオ視聴: ビデオストリームのアクティブ状態を維持するために 15 秒おきに Keep-Alive API にリクエストを送る\r\n        // HLS プレイリストやセグメントのリクエストが行われたタイミングでも Keep-Alive が行われるが、\r\n        // それだけではタイミング次第では十分ではないため、定期的に Keep-Alive を行う\r\n        // Keep-Alive が行われなくなったタイミングで、サーバー側で自動的にビデオストリームの終了処理 (エンコードタスクの停止) が行われる\r\n        if (this.playback_mode === 'Video') {\r\n            this.video_keep_alive_interval_timer_id = window.setInterval(async () => {\r\n                // 画質切り替えでベース URL が変わることも想定し、あえて毎回 API URL を取得している\r\n                if (this.player === null) return;\r\n                const api_quality = PlayerUtils.extractVideoAPIQualityFromDPlayer(this.player);\r\n                await APIClient.put(`${Utils.api_base_url}/streams/video/${player_store.recorded_program.id}/${api_quality}/keep-alive`);\r\n            }, 15 * 1000);\r\n        }\r\n\r\n        // 再生/停止されたときのイベント\r\n        // デバイスの通知バーからの制御など、ブラウザの画面以外から動画の再生/停止が行われる事もあるため必要\r\n        const on_play_or_pause = () => {\r\n            if (this.player === null) return;\r\n            player_store.is_video_paused = this.player.video.paused;\r\n            // 停止された場合、ロード中でなければ Progress Circular を非表示にする\r\n            if (this.player.video.paused === true && player_store.is_loading === false) {\r\n                player_store.is_video_buffering = false;\r\n            }\r\n            // まだ設定パネルが表示されていたら非表示にする\r\n            this.player.setting.hide();\r\n            // プレイヤーのコントロール UI を表示する\r\n            this.setControlDisplayTimer();\r\n        };\r\n        this.player.on('play', on_play_or_pause);\r\n        this.player.on('pause', on_play_or_pause);\r\n\r\n        // 再生が一時的に止まってバッファリングしているとき/再び再生されはじめたときのイベント\r\n        // バッファリングの Progress Circular の表示を制御する\r\n        this.player.on('waiting', () => {\r\n            // Progress Circular を表示する\r\n            player_store.is_video_buffering = true;\r\n        });\r\n        this.player.on('playing', () => {\r\n            // ロード中 (映像が表示されていない) でなければ Progress Circular を非表示にする\r\n            if (player_store.is_loading === false) {\r\n                player_store.is_video_buffering = false;\r\n            }\r\n            // 再生が開始できていない場合に再生状態の復旧を試みる\r\n            this.recoverPlayback();\r\n        });\r\n\r\n        // 今回 (DPlayer 初期化直後) と画質切り替え開始時の両方のタイミングで実行する必要がある処理\r\n        // mpegts.js などの DPlayer のプラグインは画質切り替え時に一旦破棄されるため、再度イベントハンドラーを登録する必要がある\r\n        const on_init_or_quality_change = async () => {\r\n            assert(this.player !== null);\r\n\r\n            // ローディング中の背景画像をランダムに変更\r\n            player_store.background_url = PlayerUtils.generatePlayerBackgroundURL();\r\n\r\n            // 実装上画質切り替え後にそのまま対応できない PlayerManager (LiveDataBroadcastingManager など) をここで再起動する\r\n            // 初回実行時はそもそもまだ PlayerManager が一つも初期化されていないので、何も起こらない\r\n            for (const player_manager of this.player_managers) {\r\n                if (player_manager.restart_required_when_quality_switched === true) {\r\n                    player_manager.destroy().then(() => player_manager.init());  // 非同期で実行\r\n                }\r\n            }\r\n\r\n            // ライブ視聴時のみ\r\n            if (this.playback_mode === 'Live') {\r\n\r\n                // mpegts.js のエラーログハンドラーを登録\r\n                // 再生中に mpegts.js 内部でエラーが発生した際 (例: デバイスの通信が一時的に切断され、API からのストリーミングが途切れた際) に呼び出される\r\n                // このエラーハンドラーでエラーをキャッチして、PlayerController の再起動を要求する\r\n                // PlayerController 内部なので直接再起動してもいいのだが、PlayerController を再起動させる処理は共通化しておきたい\r\n                this.player.plugins.mpegts?.on(mpegts.Events.ERROR, async (error_type: string, detail: string) => {\r\n\r\n                    // DPlayer がすでに破棄されている場合は何もしない\r\n                    if (this.player === null) {\r\n                        return;\r\n                    }\r\n\r\n                    // すぐ再起動すると問題があるケースがあるので、少し待機する\r\n                    await Utils.sleep(1);\r\n\r\n                    // もしこの時点でオフラインの場合、ネットワーク接続の変更による接続切断の可能性が高いので、オンラインになるまで待機する\r\n                    if (navigator.onLine === false) {\r\n                        this.player.notice('現在ネットワーク接続がありません。オンラインになるまで待機しています…', undefined, undefined, '#FF6F6A');\r\n                        console.warn('\\u001b[31m[PlayerController] mpegts.js error event: Network error. Waiting for online...');\r\n                        await Utils.waitUntilOnline();\r\n                    }\r\n\r\n                    // PlayerController の再起動を要求する\r\n                    console.error('\\u001b[31m[PlayerController] mpegts.js error event:', error_type, detail);\r\n                    player_store.event_emitter.emit('PlayerRestartRequired', {\r\n                        message: `再生中にエラーが発生しました。(${error_type}: ${detail}) プレイヤーを再起動しています…`,\r\n                    });\r\n                });\r\n\r\n                // HTMLVideoElement ネイティブの再生時エラーのイベントハンドラーを登録\r\n                // mpegts.js が予期せずクラッシュした場合など、意図せず発生してしまうことがある\r\n                // Offline 以外であれば PlayerController の再起動を要求する\r\n                this.player.on('error', async (event: MediaError) => {\r\n\r\n                    // DPlayer がすでに破棄されているか、現在ライブストリームが Offline であれば何もしない\r\n                    if (this.player === null || player_store.live_stream_status === 'Offline') {\r\n                        return;\r\n                    }\r\n\r\n                    // すぐ再起動すると問題があるケースがあるので、少し待機する\r\n                    await Utils.sleep(1);\r\n\r\n                    // MediaError オブジェクトは場合によっては存在しないことがあるらしい…\r\n                    // 存在しない場合は unknown error として扱う\r\n                    if (this.player.video.error) {\r\n                        console.error('\\u001b[31m[PlayerController] HTMLVideoElement error event:', this.player.video.error);\r\n                        player_store.event_emitter.emit('PlayerRestartRequired', {\r\n                            message: `再生中にエラーが発生しました。(Native: ${this.player.video.error.code}: ${this.player.video.error.message}) プレイヤーを再起動しています…`,\r\n                        });\r\n                    } else {\r\n                        player_store.event_emitter.emit('PlayerRestartRequired', {\r\n                            message: '再生中にエラーが発生しました。(Native: unknown error) プレイヤーを再起動しています…',\r\n                        });\r\n                    }\r\n                });\r\n\r\n                // 必ず最初はローディング状態とする\r\n                player_store.is_loading = true;\r\n\r\n                // 一旦音量をミュートする\r\n                this.player.video.muted = true;\r\n\r\n                // 再生準備ができた段階で再生バッファを調整し、再生準備ができた段階でローディング中の背景画像を非表示にするイベントハンドラーを登録\r\n                let on_canplay_called = false;\r\n                const on_canplay = async () => {\r\n\r\n                    // 重複実行を回避する\r\n                    if (this.player === null) return;\r\n                    if (on_canplay_called === true) return;\r\n                    this.player.video.oncanplaythrough = null;\r\n                    on_canplay_called = true;\r\n\r\n                    // 再生バッファ調整のため、一旦停止させる\r\n                    // this.player.video.pause() を使うとプレイヤーの UI アイコンが停止してしまうので、代わりに playbackRate を使う\r\n                    console.log('\\u001b[31m[PlayerController] buffering...');\r\n                    this.player.video.playbackRate = 0;\r\n\r\n                    // 再生バッファが live_playback_buffer_seconds を超えるまで 0.1 秒おきに再生バッファをチェックする\r\n                    // 再生バッファが live_playback_buffer_seconds を切ると再生が途切れやすくなるので (特に動きの激しい映像)、\r\n                    // 再生開始までの時間を若干犠牲にして、再生バッファの調整と同期に時間を割く\r\n                    // live_playback_buffer_seconds の値は mpegts.js の liveSyncTargetLatency 設定に渡す値と共通\r\n                    let current_playback_buffer_sec = this.getPlaybackBufferSeconds();\r\n                    while (current_playback_buffer_sec < this.live_playback_buffer_seconds) {\r\n                        await Utils.sleep(0.1);\r\n                        current_playback_buffer_sec = this.getPlaybackBufferSeconds();\r\n                    }\r\n\r\n                    // 再生バッファ調整のため一旦停止していた再生を再び開始\r\n                    this.player.video.playbackRate = 1;\r\n                    console.log('\\u001b[31m[PlayerController] buffering completed.');\r\n\r\n                    // ローディング状態を解除し、映像を表示する\r\n                    player_store.is_loading = false;\r\n\r\n                    // バッファリング中の Progress Circular を非表示にする\r\n                    player_store.is_video_buffering = false;\r\n\r\n                    // この時点で再生が開始できていない場合、再生状態の復旧を試みる\r\n                    this.recoverPlayback();\r\n\r\n                    if (channels_store.channel.current.is_radiochannel === true) {\r\n                        // ラジオチャンネルでは引き続き映像の代わりとしてローディング中の背景画像を表示し続ける\r\n                        player_store.is_background_display = true;\r\n                    } else {\r\n                        // ローディング中の背景画像をフェードアウト\r\n                        player_store.is_background_display = false;\r\n                    }\r\n\r\n                    // 再生開始時に音量を徐々に上げる (いきなり再生されるよりも体験が良い)\r\n                    // ミュートを解除した上で即座に音量を 0 に設定し、そこから徐々に上げていく\r\n                    this.player.video.muted = false;\r\n                    this.player.video.volume = 0;\r\n                    // 0.5 秒間かけて 0 から current_volume まで音量を上げる\r\n                    const current_volume = this.player.user.get('volume');\r\n                    const volume_step = current_volume / 10;\r\n                    for (let i = 0; i < 10; i++) {\r\n                        await Utils.sleep(0.5 / 10);\r\n                        // 音量が current_volume を超えないようにする\r\n                        this.player.video.volume = Math.min(Utils.mathFloor(this.player.video.volume + volume_step, 2), current_volume);\r\n                    }\r\n                };\r\n                this.player.video.oncanplaythrough = on_canplay;\r\n\r\n                // 万が一 canplaythrough が発火しなかった場合のための処理\r\n                // 非同期で 0.05 秒おきに直接 readyState === HAVE_ENOUGH_DATA かどうかを確認する\r\n                // この処理は先に canplaythrough が発火した場合は実行されない\r\n                (async () => {\r\n                    while (this.player !== null && this.player.video.readyState < 4) {\r\n                        await Utils.sleep(0.05);\r\n                    }\r\n                    // さらに 0.1 秒待ってから実行\r\n                    await Utils.sleep(0.1);\r\n                    if (on_canplay_called === false) {\r\n                        console.warn('\\u001b[31m[PlayerController] canplaythrough event not fired. trying to recover.');\r\n                        on_canplay();\r\n                    }\r\n                })();\r\n\r\n                // もしライブストリームのステータスが ONAir にも関わらず 15 秒以上バッファリング中で canplaythrough が発火しない場合、\r\n                // ロードに失敗したとみなし PlayerController の再起動を要求する\r\n                await Utils.sleep(15);\r\n                if (this.destroyed === true || this.player === null) return;\r\n                if (player_store.live_stream_status === 'ONAir' && player_store.is_video_buffering === true && on_canplay_called === false) {\r\n                    player_store.event_emitter.emit('PlayerRestartRequired', {\r\n                        message: '再生開始までに時間が掛かっています。プレイヤーを再起動しています…',\r\n                    });\r\n                }\r\n\r\n            // ビデオ視聴のみ\r\n            } else {\r\n\r\n                // 必ず最初はローディング状態で、背景画像を表示する\r\n                player_store.is_loading = true;\r\n                player_store.is_background_display = true;\r\n\r\n                // 再生準備ができた段階でローディング中の背景画像を非表示にするイベントハンドラーを登録\r\n                let on_canplay_called = false;\r\n                const on_canplay = async () => {\r\n\r\n                    // 重複実行を回避する\r\n                    if (this.player === null) return;\r\n                    if (on_canplay_called === true) return;\r\n                    this.player.video.oncanplaythrough = null;\r\n                    on_canplay_called = true;\r\n\r\n                    // ローディング状態を解除し、映像を表示する\r\n                    player_store.is_loading = false;\r\n\r\n                    // バッファリング中の Progress Circular を非表示にする\r\n                    player_store.is_video_buffering = false;\r\n\r\n                    // ローディング中の背景画像をフェードアウト\r\n                    player_store.is_background_display = false;\r\n                };\r\n                this.player.video.oncanplaythrough = on_canplay;\r\n            }\r\n        };\r\n\r\n        // 初回実行\r\n        on_init_or_quality_change();\r\n\r\n        // 画質切り替え開始時のイベント\r\n        this.player.on('quality_start', on_init_or_quality_change);\r\n\r\n        // 動画の統計情報の表示/非表示を切り替える隠しコマンドのイベントハンドラーを登録\r\n        // iOS / iPadOS Safari では DPlayer 側の contextmenu が長押ししても発火しないため、代替の表示手段として用意\r\n        // 番組情報タブ内の NEXT >> を 500ms 以内に3回連続でタップすると統計情報の表示/非表示が切り替わる\r\n        // イベントを重複定義しないように、あえて ontouchstart を使う\r\n        let tap_count = 0;\r\n        let last_tap = 0;\r\n        const element = document.querySelector<HTMLDivElement>('.program-info__next');\r\n        if (element !== null) {\r\n            element.ontouchstart = () => {\r\n                if (this.player === null) return;\r\n                const current_time = new Date().getTime();\r\n                const time_difference = current_time - last_tap;\r\n                if (time_difference < 500 && time_difference > 0) {\r\n                    tap_count++;\r\n                    if (tap_count === 3) {\r\n                        this.player.infoPanel.toggle();\r\n                        tap_count = 0;\r\n                    }\r\n                }\r\n                last_tap = current_time;\r\n            };\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * DPlayer のフルスクリーン関係のメソッドを無理やり上書きし、KonomiTV の UI と統合する\r\n     * 上書き元のコードは https://github.com/tsukumijima/DPlayer/blob/master/src/ts/fullscreen.ts にある\r\n     */\r\n    private setupFullscreenHandler(): void {\r\n        assert(this.player !== null);\r\n        const player_store = usePlayerStore();\r\n\r\n        // フルスクリーンにするコンテナ要素 (ページ全体)\r\n        const fullscreen_container = document.querySelector('.v-application')!;\r\n\r\n        // フルスクリーンかどうか\r\n        this.player.fullScreen.isFullScreen = (type?: DPlayerType.FullscreenType) => {\r\n            return !!(document.fullscreenElement || document.webkitFullscreenElement);\r\n        };\r\n\r\n        // フルスクリーンをリクエスト\r\n        this.player.fullScreen.request = (type?: DPlayerType.FullscreenType) => {\r\n            assert(this.player !== null);\r\n            // すでにフルスクリーンだったらキャンセルする\r\n            if (this.player.fullScreen.isFullScreen()) {\r\n                this.player.fullScreen.cancel();\r\n                return;\r\n            }\r\n            // フルスクリーンをリクエスト\r\n            // Safari は webkit のベンダープレフィックスが必要\r\n            fullscreen_container.requestFullscreen = fullscreen_container.requestFullscreen || fullscreen_container.webkitRequestFullscreen;\r\n            if (fullscreen_container.requestFullscreen) {\r\n                fullscreen_container.requestFullscreen();\r\n            } else {\r\n                // フルスクリーンがサポートされていない場合はエラーを表示\r\n                this.player.notice('iPhone Safari は動画のフルスクリーン表示に対応していません。', undefined, undefined, '#FF6F6A');\r\n                return;\r\n            }\r\n            // 画面の向きを横に固定 (Screen Orientation API がサポートされている場合)\r\n            if (screen.orientation) {\r\n                screen.orientation.lock('landscape').catch(() => {});\r\n            }\r\n        };\r\n\r\n        // フルスクリーンをキャンセル\r\n        this.player.fullScreen.cancel = (type?: DPlayerType.FullscreenType) => {\r\n            // フルスクリーンを終了\r\n            // Safari は webkit のベンダープレフィックスが必要\r\n            document.exitFullscreen = document.exitFullscreen || document.webkitExitFullscreen;\r\n            if (document.exitFullscreen) {\r\n                document.exitFullscreen();\r\n            }\r\n            // 画面の向きの固定を解除\r\n            if (screen.orientation) {\r\n                screen.orientation.unlock();\r\n            }\r\n        };\r\n\r\n        // フルスクリーン状態が変化した時のイベントハンドラーを登録\r\n        // 複数のイベントを重複登録しないよう、あえて onfullscreenchange を使う\r\n        const fullscreen_handler = () => {\r\n            assert(this.player !== null);\r\n            player_store.is_fullscreen = this.player.fullScreen.isFullScreen() === true;\r\n        };\r\n        if (fullscreen_container.onfullscreenchange !== undefined) {\r\n            fullscreen_container.onfullscreenchange = fullscreen_handler;\r\n        } else if (fullscreen_container.onwebkitfullscreenchange !== undefined) {\r\n            fullscreen_container.onwebkitfullscreenchange = fullscreen_handler;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * DPlayer の設定パネルを無理やり拡張し、KonomiTV 独自の項目を追加する\r\n     */\r\n    private setupSettingPanelHandler(): void {\r\n        assert(this.player !== null);\r\n        const player_store = usePlayerStore();\r\n\r\n        // 設定パネルにショートカット一覧を表示するボタンを動的に追加する\r\n        // スマホなどのタッチデバイスでは基本キーボードが使えないため、タッチデバイスの場合はボタンを表示しない\r\n        if (Utils.isTouchDevice() === false) {\r\n            this.player.template.settingOriginPanel.insertAdjacentHTML('beforeend', `\r\n            <div class=\"dplayer-setting-item dplayer-setting-keyboard-shortcut\">\r\n                <span class=\"dplayer-label\">キーボードショートカット</span>\r\n                <div class=\"dplayer-toggle\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 32 32\">\r\n                        <path d=\"M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z\"></path>\r\n                    </svg>\r\n                </div>\r\n            </div>`);\r\n\r\n            // ショートカット一覧モーダルを表示するボタンがクリックされたときのイベントハンドラーを登録\r\n            this.player.template.settingOriginPanel.querySelector('.dplayer-setting-keyboard-shortcut')!.addEventListener('click', () => {\r\n                assert(this.player !== null);\r\n                // 設定パネルを閉じる\r\n                this.player.setting.hide();\r\n                // ショートカットキー一覧モーダルを表示する\r\n                player_store.shortcut_key_modal = true;\r\n            });\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * KonomiTV 本体の UI を含むプレイヤー全体のコンテナ要素がリサイズされたときのイベントハンドラーを登録する\r\n     */\r\n    private setupPlayerContainerResizeHandler(): void {\r\n\r\n        // 監視対象のプレイヤー全体のコンテナ要素\r\n        const player_container_element = document.querySelector('.watch-player')!;\r\n\r\n        // プレイヤー全体のコンテナ要素がリサイズされた際に発火するイベント\r\n        const resize_handler = () => {\r\n\r\n            // コメント描画領域の要素\r\n            if (this.player === null) return;\r\n            const comment_area_element = this.player.danmaku!.container;\r\n\r\n            // コメント描画領域の幅から算出した、映像の要素の幅/高さ (px)\r\n            // 実際の映像の要素の幅は BML ブラウザの ShadowDOM 内に入ると正確な算出ができないため、代わりにコメント描画領域の幅を使って算出する\r\n            const video_element_width = comment_area_element.clientWidth;\r\n            const video_element_height = comment_area_element.clientWidth * (9 / 16);\r\n\r\n            // プレイヤー全体と映像の高さの差（レターボックス）から、コメント描画領域の高さを狭める必要があるかを判定する\r\n            // 2で割っているのは単体の差を測るため\r\n            if (player_container_element === null || player_container_element.clientHeight === null) return;\r\n            const letter_box_height = (player_container_element.clientHeight - video_element_height) / 2;\r\n\r\n            // コメント描画領域の高さがしきい値より小さい場合、コメント描画領域のアスペクト比を狭める\r\n            // しきい値はデバイスの画面サイズや向きによって異なる\r\n            // スマホ縦画面ではコメント描画領域を狭める必要がある上部のヘッダーがないため、しきい値を 0 にする\r\n            const threshold = Utils.isSmartphoneVertical() ? 0 : Utils.isSmartphoneHorizontal() ? 50 : 66;\r\n            if (letter_box_height < threshold) {\r\n\r\n                // コメント描画領域に必要な上下マージン\r\n                const comment_area_vertical_margin = (threshold - letter_box_height) * 2;\r\n\r\n                // 狭めるコメント描画領域の幅\r\n                // 映像の要素の幅をそのまま利用する\r\n                const comment_area_width = video_element_width;\r\n\r\n                // 狭めるコメント描画領域の高さ\r\n                const comment_area_height = video_element_height - comment_area_vertical_margin;\r\n\r\n                // 狭めるコメント描画領域のアスペクト比を求める\r\n                // https://tech.arc-one.jp/asepct-ratio/\r\n                const gcd = (x: number, y: number) => {  // 最大公約数を求める関数\r\n                    if (y === 0) return x;\r\n                    return gcd(y, x % y);\r\n                };\r\n                // 幅と高さの最大公約数を求める\r\n                const gcd_result = gcd(comment_area_width, comment_area_height);\r\n                // 幅と高さをそれぞれ最大公約数で割ってアスペクト比を算出\r\n                const comment_area_height_aspect = `${comment_area_width / gcd_result} / ${comment_area_height / gcd_result}`;\r\n\r\n                // 一時的に transition を無効化する\r\n                // アスペクト比の設定は連続して行われるが、その際に transition が適用されるとワンテンポ遅れたアニメーションになってしまう\r\n                comment_area_element.style.transition = 'none';\r\n\r\n                // コメント描画領域に算出したアスペクト比を設定する\r\n                comment_area_element.style.setProperty('--comment-area-aspect-ratio', comment_area_height_aspect);\r\n\r\n                // コメント描画領域に必要な上下マージンを設定する\r\n                comment_area_element.style.setProperty('--comment-area-vertical-margin', `${comment_area_vertical_margin}px`);\r\n\r\n                // 0.2秒後に再び transition を有効化する\r\n                // 0.2秒より前にもう一度リサイズイベントが来た場合はタイマーがクリアされるため実行されない\r\n                window.setTimeout(() => comment_area_element.style.transition = '', 0.2 * 1000);\r\n\r\n            } else {\r\n\r\n                // コメント描画領域に設定したアスペクト比・上下マージンを削除する\r\n                comment_area_element.style.removeProperty('--comment-area-aspect-ratio');\r\n                comment_area_element.style.removeProperty('--comment-area-vertical-margin');\r\n            }\r\n        };\r\n\r\n        // 初回実行\r\n        resize_handler();\r\n\r\n        // 要素の監視を開始\r\n        this.player_container_resize_observer = new ResizeObserver(resize_handler);\r\n        this.player_container_resize_observer.observe(player_container_element);\r\n    }\r\n\r\n\r\n    /**\r\n     * 一定の条件に基づいてプレイヤーのコントロール UI の表示状態を切り替える\r\n     * マウスが動いたりタップされた時に実行するタイマー関数で、3秒間何も操作がなければプレイヤーのコントロール UI を非表示にする\r\n     * 本来は View 側に実装すべきだが、プレイヤー側のロジックとも密接に関連しているため PlayerController に実装した\r\n     * @param event マウスやタッチイベント (手動実行する際は省略する)\r\n     * @param is_player_region_event プレイヤー画面の中で発火したイベントなら true に設定する\r\n     */\r\n    private setControlDisplayTimer(event: Event | null = null, is_player_region_event: boolean = false): void {\r\n        const player_store = usePlayerStore();\r\n\r\n        // タッチデバイスで mousemove 、あるいはタッチデバイス以外で touchmove か click が発火した時は実行じない\r\n        if (Utils.isTouchDevice() === true  && event !== null && (event.type === 'mousemove')) return;\r\n        if (Utils.isTouchDevice() === false && event !== null && (event.type === 'touchmove' || event.type === 'click')) return;\r\n\r\n        // 以前セットされたタイマーを止める\r\n        window.clearTimeout(this.player_control_ui_hide_timer_id);\r\n\r\n        // 実行された際にプレイヤーのコントロール UI を非表示にするタイマー関数 (setTimeout に渡すコールバック関数)\r\n        const player_control_ui_hide_timer = () => {\r\n\r\n            // 万が一実行されたタイミングですでに DPlayer が破棄されていたら何もしない\r\n            if (this.player === null) return;\r\n\r\n            // コメント入力フォームが表示されているときは実行しない\r\n            // タイマーを掛け直してから抜ける\r\n            if (this.player.template.controller.classList.contains('dplayer-controller-comment')) {\r\n                this.player_control_ui_hide_timer_id = window.setTimeout(player_control_ui_hide_timer, 3 * 1000);  // 3秒後に再実行\r\n                return;\r\n            }\r\n\r\n            // コントロールを非表示にする\r\n            player_store.is_control_display = false;\r\n\r\n            // プレイヤーのコントロールと設定パネルを非表示にする\r\n            this.player.controller.hide();\r\n            this.player.setting.hide();\r\n        };\r\n\r\n        // 万が一実行されたタイミングですでに DPlayer が破棄されていたら何もしない\r\n        if (this.player === null) return;\r\n\r\n        // タッチデバイスかつプレイヤー画面の中がタップされたとき\r\n        if (Utils.isTouchDevice() === true && is_player_region_event === true) {\r\n\r\n            // DPlayer 側のコントロール UI の表示状態に合わせる\r\n            if (this.player.controller.isShow()) {\r\n\r\n                // コントロールを表示する\r\n                player_store.is_control_display = true;\r\n\r\n                // プレイヤーのコントロールを表示する\r\n                this.player.controller.show();\r\n\r\n                // 3秒間何も操作がなければコントロールを非表示にする\r\n                // 3秒間の間一度でもタッチされればタイマーが解除されてやり直しになる\r\n                this.player_control_ui_hide_timer_id = window.setTimeout(player_control_ui_hide_timer, 3 * 1000);\r\n\r\n            } else {\r\n\r\n                // コントロール UI を非表示にする\r\n                player_store.is_control_display = false;\r\n\r\n                // DPlayer 側のコントロール UI と設定パネルを非表示にする\r\n                this.player.controller.hide();\r\n                this.player.setting.hide();\r\n            }\r\n\r\n        // それ以外の画面がクリックされたとき\r\n        } else {\r\n\r\n            // コントロール UI を表示する\r\n            player_store.is_control_display = true;\r\n\r\n            // DPlayer 側のコントロール UI を表示する\r\n            this.player.controller.show();\r\n\r\n            // 3秒間何も操作がなければコントロールを非表示にする\r\n            // 3秒間の間一度でもマウスが動けばタイマーが解除されてやり直しになる\r\n            this.player_control_ui_hide_timer_id = window.setTimeout(player_control_ui_hide_timer, 3 * 1000);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * DPlayer と PlayerManager を破棄し、再生を終了する\r\n     * 常に init() で作成したものが destroy() ですべてクリーンアップされるように実装すべき\r\n     * PlayerController の再起動を行う場合、基本外部から直接 await destroy() と await init() は呼び出さず、代わりに\r\n     * player_store.event_emitter.emit('PlayerRestartRequired', 'プレイヤーを再起動しています…') のようにイベントを発火させるべき\r\n     */\r\n    public async destroy(): Promise<void> {\r\n        const player_store = usePlayerStore();\r\n\r\n        // すでに破棄されているのに再度実行してはならない\r\n        if (this.destroyed === true) {\r\n            return;\r\n        }\r\n\r\n        // すでに破棄中なら何もしない\r\n        if (this.destroying === true) {\r\n            return;\r\n        }\r\n        this.destroying = true;\r\n\r\n        console.log('\\u001b[31m[PlayerController] Destroying...');\r\n\r\n        // 登録されている PlayerManager をすべて破棄\r\n        // CSS アニメーションの関係上、ローディング状態にする前に破棄する必要がある (特に LiveDataBroadcastingManager)\r\n        // 同期処理すると時間が掛かるので、並行して実行する\r\n        await Promise.all(this.player_managers.map(async (player_manager) => player_manager.destroy()));\r\n        this.player_managers = [];\r\n\r\n        // ローディング中の背景画像を隠す\r\n        player_store.is_background_display = false;\r\n\r\n        // 再びローディング状態にする\r\n        player_store.is_loading = true;\r\n\r\n        // コメントの取得に失敗した際のエラーメッセージを削除\r\n        player_store.live_comment_init_failed_message = null;\r\n        player_store.video_comment_init_failed_message = null;\r\n\r\n        // 映像がフェードアウトするアニメーション (0.2秒) 分待ってから実行\r\n        // この 0.2 秒の間に音量をフェードアウトさせる\r\n        if (this.player !== null) {\r\n            // 0.2 秒間かけて current_volume から 0 まで音量を下げる\r\n            const current_volume = this.player.user.get('volume');\r\n            const volume_step = current_volume / 10;\r\n            for (let i = 0; i < 10; i++) {\r\n                await Utils.sleep(0.2 / 10);\r\n                // ごく稀に映像が既に破棄されている or まだ再生開始されていない場合がある (?) ので、その場合は実行しない\r\n                if (this.player && this.player.video) {\r\n                    // 音量が 0 より小さくならないようにする\r\n                    this.player.video.volume = Math.max(Utils.mathFloor(this.player.video.volume - volume_step, 2), 0);\r\n                }\r\n            }\r\n        }\r\n\r\n        // タイマーを破棄\r\n        window.clearInterval(this.live_force_seek_interval_timer_id);\r\n        window.clearInterval(this.video_keep_alive_interval_timer_id);\r\n        window.clearTimeout(this.player_control_ui_hide_timer_id);\r\n\r\n        // プレイヤー全体のコンテナ要素の監視を停止\r\n        if (this.player_container_resize_observer !== null) {\r\n            this.player_container_resize_observer.disconnect();\r\n            this.player_container_resize_observer = null;\r\n        }\r\n\r\n        // DPlayer 本体を破棄\r\n        // なぜか例外が出ることがあるので try-catch で囲む\r\n        if (this.player !== null) {\r\n            // プレイヤーの破棄を実行する前に、DPlayer 側に登録された HTMLVideoElement の error イベントハンドラーを全て削除\r\n            // Safari のみ、削除しておかないと「動画の読み込みに失敗しました」というエラーが発生する\r\n            if (this.player.events.events['error']) {\r\n                this.player.events.events['error'] = [];\r\n            }\r\n            // 通常 this.player.destroy() が実行された後 mpegts.js も自動的に破棄されるのだが、Safari のみ\r\n            // なぜか video.src = '' を実行した後に mpegts.js を破棄するとエラーというか挙動不審になるので、\r\n            // あえて mpegts.js を明示的に先に破棄しておいて Safari の地雷を回避する\r\n            if (this.player.plugins.mpegts) {\r\n                try {\r\n                    this.player.plugins.mpegts.unload();\r\n                    this.player.plugins.mpegts.detachMediaElement();\r\n                    this.player.plugins.mpegts.destroy();\r\n                } catch (e) {\r\n                    // 何もしない\r\n                }\r\n            }\r\n            // 引数に true を指定して、破棄後も DPlayer 側の HTML 要素を保持する\r\n            // これにより、チャンネルを切り替えるなどして再度初期化されるまでの僅かな間もプレイヤーのコントロール UI が表示される (動作はしない)\r\n            // ここで HTML 要素を削除してしまうと、プレイヤーのコントロール UI が一瞬削除されることでちらつきが発生して見栄えが悪い\r\n            // HTML 要素を保持する分、破棄中に描画されていたコメントも残ってしまうので、破棄前にコメントを全て削除する\r\n            this.player.danmaku!.clear();\r\n            try {\r\n                this.player.destroy(true);\r\n            } catch (e) {\r\n                // 何もしない\r\n            }\r\n            this.player = null;\r\n        }\r\n\r\n        // 破棄済みかどうかのフラグを立てる\r\n        this.destroying = false;\r\n        this.destroyed = true;\r\n\r\n        // PlayerStore にプレイヤーを破棄したことを通知\r\n        player_store.is_player_initialized = false;\r\n\r\n        console.log('\\u001b[31m[PlayerController] Destroyed.');\r\n    }\r\n}\r\n\r\nexport default PlayerController;\r\n","<template>\r\n    <Watch :playback_mode=\"'Live'\" />\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport Vue from 'vue';\r\n\r\nimport Watch from '@/components/Watch/Watch.vue';\r\nimport PlayerController from '@/services/player/PlayerController';\r\nimport useChannelsStore from '@/stores/ChannelsStore';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\nimport Utils from '@/utils';\r\n\r\n// PlayerController のインスタンス\r\n// data() 内に記述すると再帰的にリアクティブ化され重くなる上リアクティブにする必要自体がないので、グローバル変数にしている\r\nlet player_controller: PlayerController | null = null;\r\n\r\nexport default Vue.extend({\r\n    name: 'TV-Watch',\r\n    components: {\r\n        Watch,\r\n    },\r\n    data() {\r\n        return {\r\n            // インターバル ID\r\n            // ページ遷移時に setInterval(), setTimeout() の実行を止めるのに使う\r\n            // setInterval(), setTimeout() の返り値を登録する\r\n            interval_ids: [] as number[],\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapStores(useChannelsStore, usePlayerStore, useSettingsStore),\r\n    },\r\n    // 開始時に実行\r\n    created() {\r\n\r\n        // 下記以外の視聴画面の開始処理は Watch コンポーネントの方で自動的に行われる\r\n\r\n        // チャンネル ID をセット\r\n        this.channelsStore.display_channel_id = this.$route.params.display_channel_id;\r\n\r\n        // 再生セッションを初期化\r\n        this.init();\r\n    },\r\n    // チャンネル切り替え時に実行\r\n    // コンポーネント（インスタンス）は再利用される\r\n    // ref: https://v3.router.vuejs.org/ja/guide/advanced/navigation-guards.html#%E3%83%AB%E3%83%BC%E3%83%88%E5%8D%98%E4%BD%8D%E3%82%AB%E3%82%99%E3%83%BC%E3%83%88%E3%82%99\r\n    beforeRouteUpdate(to, from, next) {\r\n\r\n        // 前の再生セッションを破棄して終了する\r\n        // このとき this.interval_ids に登録された setTimeout がキャンセルされるため、\r\n        // 後述の 0.5 秒の間にザッピングにより他のチャンネルに切り替えた場合は this.init() は実行されない\r\n        const destroy_promise = this.destroy();\r\n\r\n        // チャンネル ID を次のチャンネルのものに切り替える\r\n        this.channelsStore.display_channel_id = to.params.display_channel_id;\r\n\r\n        (async () => {\r\n\r\n            // ザッピング（「前/次のチャンネル」ボタン or 上下キーショートカット）によるチャンネル移動時のみ、\r\n            // 0.5秒だけ待ってから新しい再生セッションを初期化する\r\n            // 連続してチャンネルを切り替えた際に毎回再生処理を開始しないように猶予を設ける\r\n            if (this.playerStore.is_zapping === true) {\r\n                this.playerStore.is_zapping = false;\r\n                this.interval_ids.push(window.setTimeout(() => {\r\n                    destroy_promise.then(() => this.init());  // destroy() の実行完了を待ってから初期化する\r\n                }, 0.5 * 1000));\r\n\r\n            // 通常のチャンネル移動時は、すぐに再生セッションを初期化する\r\n            } else {\r\n                destroy_promise.then(() => this.init());  // destroy() の実行完了を待ってから初期化する\r\n            }\r\n        })();\r\n\r\n        // 次のルートに置き換え\r\n        next();\r\n    },\r\n    // 終了前に実行\r\n    beforeDestroy() {\r\n\r\n        // destroy() を実行\r\n        // 別のページへ遷移するため、DPlayer のインスタンスを確実に破棄する\r\n        // さもなければ、ブラウザがリロードされるまでバックグラウンドで永遠に再生され続けてしまう\r\n        this.destroy();\r\n\r\n        // このページから離れるので、チャンネル ID を gr000 (ダミー値) に戻す\r\n        this.channelsStore.display_channel_id = 'gr000';\r\n\r\n        // 上記以外の視聴画面の終了処理は Watch コンポーネントの方で自動的に行われる\r\n    },\r\n    methods: {\r\n\r\n        // 再生セッションを初期化する\r\n        async init() {\r\n\r\n            // 00秒までの残り秒数を取得\r\n            // 現在 16:01:34 なら 26 (秒) になる\r\n            const residue_second = 60 - new Date().getSeconds();\r\n\r\n            // 00秒になるまで待ってから実行するタイマー\r\n            // 番組は基本1分単位で組まれているため、20秒や45秒など中途半端な秒数で更新してしまうと番組情報の反映が遅れてしまう\r\n            this.interval_ids.push(window.setTimeout(() => {\r\n\r\n                // この時点で00秒なので、チャンネル情報を更新\r\n                this.channelsStore.update(true);\r\n\r\n                // 以降、30秒おきにチャンネル情報を更新\r\n                this.interval_ids.push(window.setInterval(() => {\r\n                    this.channelsStore.update(true);\r\n                }, 30 * 1000));\r\n\r\n            }, residue_second * 1000));\r\n\r\n            // チャンネル情報を更新 (初回)\r\n            await this.channelsStore.update();\r\n\r\n            // URL 上のチャンネル ID が未定義なら実行しない (フェイルセーフ)\r\n            // 基本あり得ないはずだが、念のため\r\n            if (this.$route.params.display_channel_id === undefined) {\r\n                this.$router.push({path: '/not-found/'});\r\n                return;\r\n            }\r\n\r\n            // もしこの時点でチャンネル名が「チャンネル情報取得エラー」の場合、\r\n            // URL で指定された display_channel_id に紐づくチャンネル情報がないことを示しているので、404 ページにリダイレクト\r\n            if (this.channelsStore.channel.current.name === 'チャンネル情報取得エラー') {\r\n                await Utils.sleep(3);  // 3秒待機\r\n                this.$router.push({path: '/not-found/'});\r\n                return;\r\n            }\r\n\r\n            // PlayerController を初期化\r\n            player_controller = new PlayerController('Live');\r\n            await player_controller.init();\r\n        },\r\n\r\n        // 再生セッションを破棄する\r\n        // チャンネルを切り替える際に実行される\r\n        async destroy() {\r\n\r\n            // clearInterval() ですべての setInterval(), setTimeout() の実行を止める\r\n            // clearInterval() と clearTimeout() は中身共通なので問題ない\r\n            for (const interval_id of this.interval_ids) {\r\n                window.clearInterval(interval_id);\r\n            }\r\n\r\n            // interval_ids をクリア\r\n            this.interval_ids = [];\r\n\r\n            // PlayerController を破棄\r\n            if (player_controller !== null) {\r\n                await player_controller.destroy();\r\n                player_controller = null;\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Watch.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Watch.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Watch.vue?vue&type=template&id=6789d581\"\nimport script from \"./Watch.vue?vue&type=script&lang=ts\"\nexport * from \"./Watch.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('Watch',{attrs:{\"playback_mode\":'Video'}})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <Watch :playback_mode=\"'Video'\" />\r\n</template>\r\n<script lang=\"ts\">\r\n\r\nimport { mapStores } from 'pinia';\r\nimport Vue from 'vue';\r\n\r\nimport Watch from '@/components/Watch/Watch.vue';\r\nimport PlayerController from '@/services/player/PlayerController';\r\nimport Videos from '@/services/Videos';\r\nimport usePlayerStore from '@/stores/PlayerStore';\r\nimport useSettingsStore from '@/stores/SettingsStore';\r\n\r\n// PlayerController のインスタンス\r\n// data() 内に記述すると再帰的にリアクティブ化され重くなる上リアクティブにする必要自体がないので、グローバル変数にしている\r\nlet player_controller: PlayerController | null = null;\r\n\r\nexport default Vue.extend({\r\n    name: 'Video-Watch',\r\n    components: {\r\n        Watch,\r\n    },\r\n    computed: {\r\n        ...mapStores(usePlayerStore, useSettingsStore),\r\n    },\r\n    // 開始時に実行\r\n    created() {\r\n\r\n        // 下記以外の視聴画面の開始処理は Watch コンポーネントの方で自動的に行われる\r\n\r\n        // 再生セッションを初期化\r\n        this.init();\r\n    },\r\n    // チャンネル切り替え時に実行\r\n    // コンポーネント（インスタンス）は再利用される\r\n    // ref: https://v3.router.vuejs.org/ja/guide/advanced/navigation-guards.html#%E3%83%AB%E3%83%BC%E3%83%88%E5%8D%98%E4%BD%8D%E3%82%AB%E3%82%99%E3%83%BC%E3%83%88%E3%82%99\r\n    beforeRouteUpdate(to, from, next) {\r\n\r\n        // 前の再生セッションを破棄して終了し、完了を待ってから再度初期化する\r\n        const destroy_promise = this.destroy();\r\n        destroy_promise.then(() => this.init());\r\n\r\n        // 次のルートに置き換え\r\n        next();\r\n    },\r\n    // 終了前に実行\r\n    beforeDestroy() {\r\n\r\n        // destroy() を実行\r\n        // 別のページへ遷移するため、DPlayer のインスタンスを確実に破棄する\r\n        // さもなければ、ブラウザがリロードされるまでバックグラウンドで永遠に再生され続けてしまう\r\n        this.destroy();\r\n\r\n        // 上記以外の視聴画面の終了処理は Watch コンポーネントの方で自動的に行われる\r\n    },\r\n    methods: {\r\n\r\n        // 再生セッションを初期化する\r\n        async init() {\r\n\r\n            // URL 上の録画番組 ID が未定義なら実行しない (フェイルセーフ)\r\n            // 基本あり得ないはずだが、念のため\r\n            if (this.$route.params.video_id === undefined) {\r\n                this.$router.push({path: '/not-found/'});\r\n                return;\r\n            }\r\n\r\n            // 録画番組情報を更新する\r\n            const recorded_program = await Videos.fetchVideo(parseFloat(this.$route.params.video_id));\r\n            if (recorded_program === null) {\r\n                this.$router.push({path: '/not-found/'});\r\n                return;\r\n            }\r\n            this.playerStore.recorded_program = recorded_program;\r\n\r\n            // PlayerController を初期化\r\n            player_controller = new PlayerController('Video');\r\n            await player_controller.init();\r\n        },\r\n\r\n        // 再生セッションを破棄する\r\n        // 再生する録画番組を切り替える際にも実行される\r\n        async destroy() {\r\n\r\n            // PlayerController を破棄\r\n            if (player_controller !== null) {\r\n                await player_controller.destroy();\r\n                player_controller = null;\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Watch.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-41.use[0]!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[3]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Watch.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Watch.vue?vue&type=template&id=f46813c8\"\nimport script from \"./Watch.vue?vue&type=script&lang=ts\"\nexport * from \"./Watch.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\r\nimport Vue from 'vue';\r\nimport VueRouter from 'vue-router';\r\n\r\nimport Utils from '@/utils';\r\nimport Login from '@/views/Login.vue';\r\nimport NotFound from '@/views/NotFound.vue';\r\nimport Register from '@/views/Register.vue';\r\nimport SettingsAccount from '@/views/Settings/Account.vue';\r\nimport SettingsCaption from '@/views/Settings/Caption.vue';\r\nimport SettingsCapture from '@/views/Settings/Capture.vue';\r\nimport SettingsDataBroadcasting from '@/views/Settings/DataBroadcasting.vue';\r\nimport SettingsGeneral from '@/views/Settings/General.vue';\r\nimport SettingsIndex from '@/views/Settings/Index.vue';\r\nimport SettingsJikkyo from '@/views/Settings/Jikkyo.vue';\r\nimport SettingsQuality from '@/views/Settings/Quality.vue';\r\nimport SettingsServer from '@/views/Settings/Server.vue';\r\nimport SettingsTwitter from '@/views/Settings/Twitter.vue';\r\nimport TVHome from '@/views/TV/Home.vue';\r\nimport TVWatch from '@/views/TV/Watch.vue';\r\nimport VideosWatch from '@/views/Videos/Watch.vue';\r\n\r\nVue.use(VueRouter);\r\n\r\nconst router = new VueRouter({\r\n\r\n    // History API モード\r\n    mode: 'history',\r\n\r\n    // ルーティングのベース URL\r\n    base: process.env.BASE_URL,\r\n\r\n    // ルーティング設定\r\n    routes: [\r\n        {\r\n            path: '/',\r\n            redirect: '/tv/',\r\n        },\r\n        {\r\n            path: '/tv/',\r\n            name: 'TV Home',\r\n            component: TVHome,\r\n        },\r\n        {\r\n            path: '/tv/watch/:display_channel_id',\r\n            name: 'TV Watch',\r\n            component: TVWatch,\r\n        },\r\n        {\r\n            path: '/videos/watch/:video_id',\r\n            name: 'Videos Watch',\r\n            component: VideosWatch,\r\n        },\r\n        {\r\n            path: '/settings/',\r\n            name: 'Settings Index',\r\n            component: SettingsIndex,\r\n            beforeEnter: (to, from, next) => {\r\n\r\n                // スマホ縦画面・スマホ横画面・タブレット縦画面では設定一覧画面を表示する（画面サイズの関係）\r\n                if (Utils.isSmartphoneVertical() || Utils.isSmartphoneHorizontal() || Utils.isTabletVertical()) {\r\n                    next();  // 通常通り遷移\r\n                    return;\r\n                }\r\n\r\n                // それ以外の画面サイズでは全般設定にリダイレクト\r\n                next({path: '/settings/general/'});\r\n            }\r\n        },\r\n        {\r\n            path: '/settings/general',\r\n            name: 'Settings General',\r\n            component: SettingsGeneral,\r\n        },\r\n        {\r\n            path: '/settings/quality',\r\n            name: 'Settings Quality',\r\n            component: SettingsQuality,\r\n        },\r\n        {\r\n            path: '/settings/caption',\r\n            name: 'Settings Caption',\r\n            component: SettingsCaption,\r\n        },\r\n        {\r\n            path: '/settings/data-broadcasting',\r\n            name: 'Settings Data Broadcasting',\r\n            component: SettingsDataBroadcasting,\r\n        },\r\n        {\r\n            path: '/settings/capture',\r\n            name: 'Settings Capture',\r\n            component: SettingsCapture,\r\n        },\r\n        {\r\n            path: '/settings/account',\r\n            name: 'Settings Account',\r\n            component: SettingsAccount,\r\n        },\r\n        {\r\n            path: '/settings/jikkyo',\r\n            name: 'Settings Jikkyo',\r\n            component: SettingsJikkyo,\r\n        },\r\n        {\r\n            path: '/settings/twitter',\r\n            name: 'Settings Twitter',\r\n            component: SettingsTwitter,\r\n        },\r\n        {\r\n            path: '/settings/server',\r\n            name: 'Settings Server',\r\n            component: SettingsServer,\r\n        },\r\n        {\r\n            path: '/login/',\r\n            name: 'Login',\r\n            component: Login,\r\n        },\r\n        {\r\n            path: '/register/',\r\n            name: 'Register',\r\n            component: Register,\r\n        },\r\n        {\r\n            path: '*',\r\n            name: 'NotFound',\r\n            component: NotFound,\r\n        },\r\n    ],\r\n\r\n    // ページ遷移時のスクロールの挙動の設定\r\n    // ref: https://v3.router.vuejs.org/ja/guide/advanced/scroll-behavior.html\r\n    scrollBehavior (to, from, savedPosition) {\r\n        if (savedPosition) {\r\n            // 戻る/進むボタンが押されたときは保存されたスクロール位置を使う\r\n            return savedPosition;\r\n        } else {\r\n            // それ以外は常に先頭にスクロールする\r\n            return {x: 0, y: 0};\r\n        }\r\n    }\r\n});\r\n\r\nexport default router;\r\n","/* eslint-disable no-console */\r\n\r\nimport { register } from 'register-service-worker';\r\n\r\nimport Message from '@/message';\r\nimport Utils from '@/utils';\r\n\r\n\r\nif (process.env.NODE_ENV === 'production') {\r\n    register(`${process.env.BASE_URL}service-worker.js`, {\r\n        ready() {\r\n            console.log(\r\n                'App is being served from cache by a service worker.\\n' +\r\n                'For more details, visit https://goo.gl/AFskqB'\r\n            );\r\n        },\r\n        registered() {\r\n            console.log('Service worker has been registered.');\r\n        },\r\n        cached() {\r\n            console.log('Content has been cached for offline use.');\r\n        },\r\n        updatefound() {\r\n            console.log('New content is downloading.');\r\n        },\r\n        updated(registration: ServiceWorkerRegistration) {\r\n            console.log('New content is available; please refresh.');\r\n            Message.show({\r\n                message: 'クライアントが新しいバージョンに更新されました。5秒後にリロードします。',\r\n                timeout: 10000,  // リロードするまで表示し続ける\r\n            });\r\n            // PWA (Service Worker) を更新する\r\n            if (registration.waiting === null) {\r\n                return;\r\n            }\r\n            registration.waiting.postMessage({type: 'SKIP_WAITING'});\r\n            registration.waiting.addEventListener('statechange', async (event) => {\r\n                if ((event.target as ServiceWorker).state === 'activated') {\r\n                    await Utils.sleep(4);  // activated になるまで少し時間がかかるので、1秒減らして4秒待つ\r\n                    location.reload(true);\r\n                }\r\n            });\r\n        },\r\n        offline() {\r\n            console.log('No internet connection found. App is running in offline mode.');\r\n        },\r\n        error(error) {\r\n            console.error('Error during service worker registration:', error);\r\n        }\r\n    });\r\n}\r\n","\r\nimport { Icon } from '@iconify/vue2';\r\nimport '@mdi/font/css/materialdesignicons.css';\r\nimport { createPinia, PiniaVuePlugin } from 'pinia';\r\nimport { polyfill as SeamlessScrollPolyfill } from 'seamless-scroll-polyfill';\r\nimport VTooltip from 'v-tooltip';\r\nimport 'v-tooltip/dist/v-tooltip.css';\r\nimport Vue from 'vue';\r\nimport VueVirtualScroller from 'vue-virtual-scroller';\r\nimport 'vue-virtual-scroller/dist/vue-virtual-scroller.css';\r\nimport VuetifyMessageSnackbar from 'vuetify-message-snackbar';\r\n\r\nimport App from '@/App.vue';\r\nimport VTabItem from '@/components/Vuetify/VTabItem';\r\nimport VTabs from '@/components/Vuetify/VTabs';\r\nimport VTabsItems from '@/components/Vuetify/VTabsItems';\r\nimport vuetify from '@/plugins/vuetify';\r\nimport router from '@/router';\r\nimport useSettingsStore, { setLocalStorageSettings } from '@/stores/SettingsStore';\r\nimport '@/service-worker';\r\nimport Utils from '@/utils';\r\n\r\n\r\n// スムーズスクロール周りの API の polyfill を適用\r\n// Element.scrollInfoView() のオプション指定を使うために必要\r\nSeamlessScrollPolyfill();\r\n\r\n// Production Tip を非表示にする\r\nVue.config.productionTip = false;\r\n\r\n// 常に Vue.js devtools を有効にする\r\nVue.config.devtools = true;\r\n\r\n// Pinia を使う\r\n// ref: https://pinia.vuejs.org/cookbook/options-api.html\r\nVue.use(PiniaVuePlugin);\r\nconst pinia = createPinia();\r\n\r\n// vue-virtual-scroller を使う\r\nVue.use(VueVirtualScroller);\r\n\r\n// vuetify-message-snackbar を使う\r\n// マイナーな OSS（しかも中国語…）だけど、Snackbar を関数で呼びたかったのでちょうどよかった\r\n// ref: https://github.com/thinkupp/vuetify-message-snackbar\r\nVue.use(VuetifyMessageSnackbar, {\r\n    // 画面上に配置しない\r\n    top: false,\r\n    // 画面下に配置する\r\n    bottom: true,\r\n    // デフォルトの背景色\r\n    color: '#433532',\r\n    // ダークテーマを適用する\r\n    dark: true,\r\n    // 影 (Elevation) の設定\r\n    elevation: 8,\r\n    // 2.5秒でタイムアウト\r\n    timeout: 2500,\r\n    // 要素が非表示になった後に DOM から要素を削除する\r\n    autoRemove: true,\r\n    // 閉じるボタンのテキスト\r\n    closeButtonContent: '閉じる',\r\n    // Vuetify のインスタンス\r\n    vuetifyInstance: vuetify,\r\n});\r\n\r\n// VTooltip を使う\r\n// タッチデバイスでは無効化する\r\n// ref: https://v-tooltip.netlify.app/guide/config.html#default-values\r\nconst trigger = Utils.isTouchDevice() ? [] : ['hover', 'focus', 'touch'];\r\nVTooltip.options.themes.tooltip.showTriggers = trigger;\r\nVTooltip.options.themes.tooltip.hideTriggers = trigger;\r\nVTooltip.options.themes.tooltip.delay.show = 0;\r\nVTooltip.options.offset = [0, 7];\r\nVue.use(VTooltip);\r\n\r\n// Iconify（アイコン）のグローバルコンポーネント\r\nVue.component('Icon', Icon);\r\n\r\n// VTabItem / VTabs / VTabsItems の挙動を改善するグローバルコンポーネント\r\nVue.component('v-tab-item-fix', VTabItem);\r\nVue.component('v-tabs-fix', VTabs);\r\nVue.component('v-tabs-items-fix', VTabsItems);\r\n\r\n// Vue を初期化\r\n(window as any).KonomiTVVueInstance = new Vue({\r\n    pinia,\r\n    router,\r\n    vuetify,\r\n    render: h => h(App),\r\n}).$mount('#app');\r\n\r\n// 設定データをサーバーにアップロード中かどうか\r\nlet is_uploading_settings = false;\r\n\r\n// 設定データの変更を監視する\r\nconst settings_store = useSettingsStore();\r\nsettings_store.$subscribe(async () => {\r\n\r\n    // 設定データをアップロード中の場合は何もしない\r\n    if (is_uploading_settings === true) {\r\n        return;\r\n    }\r\n\r\n    // 設定データを LocalStorage に保存\r\n    console.log('Client Settings Changed:', settings_store.settings);\r\n    setLocalStorageSettings(settings_store.settings);\r\n\r\n    // このクライアントの設定をサーバーに同期する (ログイン時かつ同期が有効な場合のみ実行される)\r\n    await settings_store.syncClientSettingsToServer();\r\n\r\n}, {detached: true});\r\n\r\n// ログイン時かつ設定の同期が有効な場合、ページ遷移に関わらず、常に3秒おきにサーバーから設定を取得する\r\n// 初回のページレンダリングに間に合わないのは想定内（同期の完了を待つこともできるが、それだと表示速度が遅くなるのでしょうがない）\r\nwindow.setInterval(async () => {\r\n    if (Utils.getAccessToken() !== null && settings_store.settings.sync_settings === true) {\r\n\r\n        // サーバーに保存されている設定データをこのクライアントに同期する\r\n        is_uploading_settings = true;\r\n        await settings_store.syncClientSettingsFromServer();\r\n        is_uploading_settings = false;\r\n\r\n        // 設定データを LocalStorage に保存\r\n        setLocalStorageSettings(settings_store.settings);\r\n    }\r\n}, 3 * 1000);  // 3秒おき\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"assets/js/\" + chunkId + \".\" + {\"91\":\"a4158f51\",\"692\":\"ee41d475\"}[chunkId] + \".js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/\";","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkKonomiTV\"] = self[\"webpackChunkKonomiTV\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(54678); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["_c","_self","attrs","staticRenderFns","script","component","render","VTabItem","extend","h","props","name","this","computedTransition","on","beforeEnter","onBeforeTransition","afterEnter","onAfterTransition","enterCancelled","onTransitionCancelled","beforeLeave","afterLeave","leaveCancelled","enter","onEnter","genWindowItem","VTabsBar","data","items","methods","register","item","activeItem","internalIndex","push","sort","a","b","index_a","$slots","default","findIndex","element","$vnode","key","index_b","$on","onClick","mandatory","selectedValues","length","updateMandatory","updateItem","indexOf","undefined","updateInternalValue","unregister","constructor","super","options","call","VTabs","genBar","slider","style","height","convertToUnit","activeClass","centerActive","dark","light","optional","mobileBreakpoint","nextIcon","prevIcon","showArrows","value","internalValue","callSlider","change","val","ref","setTextColor","computedColor","setBackgroundColor","backgroundColor","$createElement","genSlider","VTabsItems","updateReverse","oldVal","itemsLength","lastIndex","continuous","Vue","use","Vuetify","VSnackbar","VBtn","VIcon","theme","themes","primary","secondary","twitter","base","lighten1","lighten2","gray","black","background","lighten3","text","darken1","darken2","darken3","customProperties","Utils","getAccessToken","localStorage","getItem","saveAccessToken","access_token","setItem","deleteAccessToken","removeItem","AltOrOption","isMacOS","CtrlOrCmd","deepObjectFreeze","object","Object","keys","forEach","prop","isFrozen","freeze","downloadBlobData","blob","filename","blob_url","URL","createObjectURL","link","document","createElement","download","href","click","revokeObjectURL","escapeHTML","content","html_escape_table","replace","match","getWindowFeatures","popupSizeWidth","popupSizeHeight","window","screen","posTop","posLeft","width","hasActiveElementClass","class_name","activeElement","classList","contains","isFirefox","test","navigator","userAgent","isSafari","isMobileDevice","isTabletHorizontal","matchMedia","matches","isTabletVertical","isSmartphoneHorizontal","isSmartphoneVertical","isTouchDevice","mathFloor","Math","floor","sleep","seconds","Promise","resolve","setTimeout","time","Date","now","typeof","prototype","toString","slice","toLowerCase","URLtoLink","pattern","waitUntilOnline","addEventListener","_defineProperty","process","self","location","protocol","host","ChannelUtils","getChannelType","display_channel_id","result","groups","channel_type","toUpperCase","e","getChannelForceType","jikkyo_force","getChannelHashtag","channel_name","startsWith","includes","success","message","KonomiTVVueInstance","$message","info","warning","error","show","Users","createUser","user_create_request","response","APIClient","post","type","detail","Message","showGenericError","createUserAccessToken","username","password","URLSearchParams","fetchUser","get","fetchUserIcon","responseType","updateUser","user_update_request","put","updateUserIcon","icon","form_data","FormData","append","headers","deleteUser","delete","useUserStore","defineStore","state","is_logged_in","user","user_icon_url","getters","user_niconico_icon_url","niconico_user_id","user_id_slice","actions","console","log","login","silent","logout","settings_store","useSettingsStore","settings","sync_settings","force","request","baseURL","api_base_url","url","version","timeout","transitional","clarifyTimeoutError","axios","catch","AxiosError","status","NaN","config","method","error_response","template","user_store","Number","isNaN","code","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","Settings","fetchClientSettings","updateClientSettings","LIVE_STREAMING_QUALITIES","VIDEO_STREAMING_QUALITIES","sync_settings_keys","default_settings","pinned_channel_ids","showed_panel_last_time","selected_twitter_account_id","saved_twitter_hashtags","panel_display_state","tv_panel_active_tab","video_panel_active_tab","tv_channel_selection_requires_alt_key","tv_streaming_quality","tv_streaming_quality_cellular","tv_data_saver_mode","tv_data_saver_mode_cellular","tv_low_latency_mode","tv_low_latency_mode_cellular","video_streaming_quality","video_streaming_quality_cellular","video_data_saver_mode","video_data_saver_mode_cellular","caption_font","always_border_caption_text","specify_caption_opacity","caption_opacity","tv_show_superimpose","video_show_superimpose","tv_show_data_broadcasting","capture_copy_to_clipboard","capture_save_mode","capture_caption_mode","comment_speed_rate","comment_font_size","close_comment_form_after_sending","muted_comment_keywords","muted_niconico_user_ids","mute_vulgar_comments","mute_abusive_discriminatory_prejudiced_comments","mute_big_size_comments","mute_fixed_comments","mute_colored_comments","mute_consecutive_same_characters_comments","fold_panel_after_sending_tweet","reset_hashtag_when_program_switches","auto_add_watching_channel_hashtag","twitter_active_tab","tweet_hashtag_position","tweet_capture_watermark_position","getLocalStorageSettings","JSON","parse","setLocalStorageSettings","stringify","getNormalizedSettings","new_settings","default_settings_key","importClientSettings","file","settings_json","syncClientSettingsToServer","resetClientSettings","default_settings_modified","getSyncableClientSettings","sync_settings_key","syncClientSettingsFromServer","settings_server","settings_server_key","settings_server_value","entries","CommentUtils","getCommentColor","color","color_table","getCommentPosition","position","getCommentSize","size","parseCommentCommand","comment_mail","commands","split","command","parsed_color","parsed_position","parsed_size","isMutedComment","comment","user_id","special_command_comments_pattern","mute_vulgar_comments_pattern","mute_abusive_discriminatory_prejudiced_comments_pattern","mute_consecutive_same_characters_comments_pattern","muted_comment_keyword","endsWith","RegExp","annoying_statistical_comments_pattern","addMutedKeywords","addMutedNiconicoUserIDs","Buffer","from","PlayerUtils","extractLiveAPIQualityFromDPlayer","player","quality","regex","extractVideoAPIQualityFromDPlayer","generatePlayerBackgroundURL","background_count","random","padStart","getNetworkCircuitType","connection","warn","isHEVCVideoSupported","canPlayType","ProgramUtils","decorateProgramInfo","program","mark","pattern1","pattern2","dayjs","pause_time_start","hour","minute","second","pause_time_end","pause_time_start_23","pause_time_end_23","isSameOrAfter","isSameOrBefore","getProgramProgress","progress","diff","start_time","duration","Infinity","getProgramTime","is_short","end_time","format","round","formatString","string","format_string_translation_map","replaceAll","buildFormatStringTranslationMap","zenkaku_table","hankaku_table","merged_table","i","symbol_zenkaku_table","symbol_hankaku_table","enclosed_characters_table","getISO639LanguageCodeName","iso639_language_code","dayjsOriginal","isBetween","utc","timezone","ja","setDefault","date","staticClass","$event","model","callback","expression","_vm","password_showing","directives","rawName","_setup","_v","staticStyle","class","Version","fetchServerVersion","useVersionStore","server_version_info","last_updated_at","client_version","server_version","latest_version","is_client_develop_version","is_server_develop_version","is_update_available","is_version_mismatch","version_info","defineComponent","components","BottomNavigation","computed","mapStores","created","versionStore","Header","Navigation","is_form_dense","userStore","$router","path","_setupProxy","_m","password_validation","username_validation","$refs","validate","is_admin","overrideServerSettingsFromClient","sync_settings_dialog","preventDefault","settings_username","settings_icon","$$v","settings_password_showing","settings_password","scopedSlots","account_delete_confirm_dialog","SettingsBase","is_loading","settings_username_validation","settings_password_validation","watch","settingsStore","sync_settings_json","server_sync_settings","server_sync_settings_json","overrideClientSettingsFromServer","updateAccountInfo","update_type","updateAccountIcon","deleteAccount","$set","resetNVRAMSettings","NVRAM_LOCAL_STORAGE_PREFIX","data_broadcasting_zip_code","data_broadcasting_zip_code_validation","data_broadcasting_prefecture","data_broadcasting_prefectures","new_value","zip_code_raw","btoa","prefecture_number","parseInt","prefecture_raw","String","fromCharCode","region_code_number","region_code_raw","atob","prefecture","charCodeAt","pinned_channel_settings_modal","import_settings_file","channelsStore","channel","IProgramDefault","id","channel_id","network_id","service_id","event_id","title","description","is_free","genres","video_type","video_codec","video_resolution","primary_audio_type","primary_audio_language","primary_audio_sampling_rate","secondary_audio_type","secondary_audio_language","secondary_audio_sampling_rate","ILiveChannelDefault","transport_stream_id","remocon_id","channel_number","is_subchannel","is_radiochannel","is_watchable","is_display","viewer_count","program_present","program_following","Channels","fetchAll","fetch","fetchJikkyoSession","useChannelsStore","channels_list","GR","BS","CS","CATV","SKY","STARDIGIO","is_channels_list_initial_updated","current_program_present","current_program_following","previous","current","next","IProgramError","ILiveChannelError","channels","current_channel_index","previous_channel_index","index","next_channel_index","current_channel","structuredClone","channels_list_with_pinned","Map","set","map","find","filter","pinned_channels","some","has","channels_list_with_pinned_for_watch","getChannelByRemoconID","update","async","draggable","modelValue","Boolean","required","emits","$emit","PinnedChannelSettings","exportSettings","settings_json_blob","Blob","importSettings","go","resetSettings","comment_mute_settings_modal","muted_comment_keyword_match_type","Niconico","fetchAuthorizationURL","authorization_url","logoutAccount","CommentMuteSettings","hash","params","authorization_status","authorization_detail","onOAuthCallbackReceived","history","replaceState","loginNiconicoAccount","popup_window","open","onMessage","closed","event","close","removeEventListener","logoutNiconicoAccount","network_circuit","_e","QUALITY_H264","QUALITY_H265","tab","network_circuits","immediate","handler","twitter_account","loginTwitterAccountWithPasswordForm","twitter_password_auth_dialog","twitter_screen_name","twitter_password_showing","twitter_password","Twitter","authWithPassword","twitter_password_auth_request","screen_name","sendTweet","captures","tweet_capture","is_error","is_success","is_twitter_password_auth_sending","loginTwitterAccountWithPassword","twitter_form","current_twitter_account","twitter_accounts","updated_at","reset","logoutTwitterAccount","Array","channels_type","removePinnedChannel","stopPropagation","_s","domProps","interval_ids","residue_second","getSeconds","setInterval","beforeDestroy","interval_id","clearInterval","addPinnedChannel","splice","isPinnedChannel","playerStore","is_control_display","is_panel_display","is_fullscreen","playback_mode","event_emitter","emit","is_player_region_event","recorded_program","IRecordedVideoDefault","file_path","file_hash","file_size","recording_start_time","recording_end_time","container_format","video_codec_profile","video_scan_type","video_frame_rate","video_resolution_width","video_resolution_height","primary_audio_codec","primary_audio_channel","secondary_audio_codec","secondary_audio_channel","cm_sections","IRecordedProgramDefault","recorded_video","recording_start_margin","recording_end_margin","is_partially_recorded","series_id","series_broadcast_period_id","series_title","episode_number","subtitle","Videos","fetchVideo","video_id","fetchVideoJikkyoComments","comments","author","usePlayerStore","is_watching","is_player_initialized","mitt","is_virtual_keyboard_display","is_remocon_display","is_zapping","is_video_buffering","is_video_paused","is_background_display","background_url","shortcut_key_modal","live_stream_status","live_comment_init_failed_message","video_comment_init_failed_message","twitter_captures","twitter_zoom_capture_modal","twitter_zoom_capture","startWatching","stopWatching","time_interval_id","beforeUnmount","shortcut_key_column_name","shortcut_keys","icon_height","shortcut","_l","key_name","LIVE_SHORTCUT_LIST","left_column","shortcuts","right_column","VIDEO_SHORTCUT_LIST","live_shortcut_list","video_shortcut_list","shortcut_list","unshift","modifiers","is_comment_list_dropdown_display","fn","active","is_manual_scroll","is_auto_scrolling","comment_list","comment_list_element","comment_list_dropdown_top","comment_list_dropdown_comment","visibilitychange_listener","mounted","$el","querySelector","is_user_scrolling","onmousedown","x","clientX","getBoundingClientRect","left","clientWidth","onmouseup","on_user_scrolling","is_dragging","ontouchstart","ontouchend","ontouchmove","onwheel","onscroll","scrollTop","offsetHeight","scrollHeight","comment_list_buffer","max_comment_count","is_initial_comments","scrollCommentList","visibilityState","max","comment_list_and_buffer_length","off","showCommentListDropdown","comment_list_wrapper_rect","comment_list_wrapper","comment_list_dropdown_height","comment_button_rect","currentTarget","top","hideCommentListDropdown","copyTextToClipboard","clipboard","writeText","addMutedNiconicoUserIds","smooth","requestAnimationFrame","scrollTo","behavior","genre","genre_index","major","middle","detail_text","detail_heading","comment_count","capture","clickCapture","target","tweet_hashtag","is_tweet_hashtag_form_focused","updateTweetLetterCount","tweet_text","is_tweet_text_form_focused","is_logged_in_twitter","tweet_letter_remain_count","editing","hashtag","updateSelectedTwitterAccount","selected_twitter_account","is_twitter_account_list_display","is_hashtag_list_display","captures_element","tweet_captures","is_tweet_sending","new_channel_name","old_channel_name","old_channel_hashtag","formatHashtag","deep","new_program","old_program","twitter_account_index","addCaptureList","image_url","pasteClipboardData","clipboardData","clipboard_item","getAsFile","clickHashtagListButton","clickHashtag","clickAccountButton","fullscreenElement","exitFullscreen","selected","shift","focused","$nextTick","drawProgramTitleOnCapture","image_bitmap","createImageBitmap","canvas","OffscreenCanvas","context","getContext","alpha","desynchronized","willReadFrequently","drawImage","font","fillStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textAlign","textBaseline","fillText","convertToBlob","reject","toBlob","from_hashtag_list","tweet_hashtag_array","trim","channel_hashtag","join","new_tweet_captures","then","blur","Channel","Comment","Program","RecordedProgram","Remocon","Series","panel_active_tab","backgroundImage","KeyboardShortcutList","WatchHeader","WatchNavigation","WatchPanel","WatchPlayer","virtualKeyboard","overlaysContent","ongeometrychange","boundingRect","KeyboardShortcutManager","init","channels_store","player_store","abort_controller","AbortController","route_container_element","capture_button_element","container","comment_capture_button_element","tweet_form_element","tweet_button_element","mode","repeat","ctrl","alt","router","toggle","video","paused","pause","currentTime","volume","muted","volumeButtonIcon","notice","sync","is_error_message","fullScreen","pictureInPictureEnabled","pipButton","tran","showDanmaku","showDanmakuToggle","checked","controller","commentInput","focus","last_key_pressed_at","isComposing","keyCode","is_repeat","is_ctrl_or_cmd_pressed","metaKey","ctrlKey","is_shift_pressed","shiftKey","is_alt_pressed","altKey","is_form_focused","HTMLInputElement","HTMLTextAreaElement","switch_channel_type","switch_remocon_id","switch_channel","hide","scrollLeft","focused_capture_index","focused_capture","focused_capture_element","parentElement","scrollIntoView","block","inline","signal","destroy","unwatch_zapping","old_value","unwatch_watching","abort","Captures","uploadCapture","worker","Worker","CaptureCompositorProxy","Comlink","CaptureManager","current_capture_button","current_comment_capture_button","remove","insertAdjacentHTML","capture_button","comment_capture_button","captureAndSave","loadFonts","addHighlight","comment_capture_button_instead","assert","add","removeHighlight","createCaptureCommentData","capture_comment_data","container_width","danmaku","offsetWidth","container_height","opacity","_opacity","selector","comment_element","querySelectorAll","textContent","computed_style","getComputedStyle","font_size","parseFloat","fontSize","createCaptureExifData","captured_at","aribb24_caption","plugins","aribb24Caption","is_caption_showing","isShowing","isPresent","caption_text","getTextContent","capture_exif_data","captured_playback_position","is_caption_composited","is_comment_composited","is_comment_composite","videoWidth","videoHeight","showing","aribb24_superimpose","aribb24Superimpose","caption_canvas","getRawCanvas","superimpose_canvas","is_superimpose_showing","create_image_bitmap_results","all","image_bitmaps","capture_image_bitmap","caption_image_bitmap","superimpose_image_bitmap","capture_compositor_start_time","capture_compositor","caption","superimpose","composite","filename_base","filename_normal","filename_caption","capture_normal","capture_caption","total_time","copyBlobToClipboard","convertBlobToPng","LiveCommentManager","destroyed","watch_session_info","initWatchSession","initCommentSession","is_disconnect_message_received","watch_session","WebSocket","audience_token","send","reconnect","keep_seat_interval_id","readyState","OPEN","keepIntervalSec","disconnect_reason","reason","vpos_base_timestamp","vposBaseTime","valueOf","threadId","message_server_url","messageServer","uri","thread_id","your_post_key","yourPostKey","comment_session_info","initial_comments_buffer","initial_comments_received","comments_buffer","comment_session","ping","thread","threadkey","res_from","emit_comments","throttle","debug","resultcode","chat","yourpost","mail","comment_data","no","playback_position","my_post","buffered_end","buffered","end","comment_delay_time","draw","sendComment","niconico_user_premium","position_table","vpos","LivePSIArchivedDataDecoderProxy","_bml_browser","WeakMap","LiveDataBroadcastingManager","_classPrivateFieldInitSpec","writable","media_element","videoWrapAspect","remocon_element","remocon_data_broadcasting_element","is_data_broadcasting_enabled","initRemoconButtons","container_element","videoWrap","insertAdjacentElement","toggleRemoconButtonsEnabled","toggleRemoconButtonsLoading","this_","_classPrivateFieldSet","BMLBrowser","mediaElement","containerElement","storagePrefix","nvramPrefix","broadcasterDatabasePrefix","videoPlaneModeEnabled","fonts","roundGothic","ROUND_GOTHIC","squareGothic","SQUARE_GOTHIC","indicator","setUrl","loading","setNetworkingGetStatus","connecting","setNetworkingPostStatus","setReceivingStatus","receiving","setEventName","greg","getReg","Greg","sessionStorage","_","setReg","epg","tune","values","ip","getConnectionType","isIPConnected","showErrorMessage","bml_browser_width","bml_browser_height","_classPrivateFieldGet","resolution","setProperty","calculateBMLBrowserScaleFactor","clientHeight","moveVideoElementToBMLBrowser","moveVideoElementToDPlayer","display","is_bml_browser_using_numeric_key","usedKeyList","resize_observer","ResizeObserver","entry","contentRect","observe","api_quality","live_psi_archived_data_decoder","run","is_bml_available","bxmlInfo","emitMessage","present_or_following","remocon_button_event_abort_controller","buttons","button","arib_key_code","dataset","aribKeyCode","remoconId","processKeyDown","AribKeyCode","Digit0","processKeyUp","enabled","scale_factor_width","scale_factor_height","scale_factor","min","magnification","is_bml_browser_destroying","getVideoElement","firstElementChild","HTMLParagraphElement","appendChild","child","children","visibility","HTMLVideoElement","transform","transformOrigin","is_video_element_moved_to_bml_browser","insertBefore","nextElementSibling","disconnect","source","LiveEventManager","eventsource_url","eventsource","EventSource","is_eventsource_opened","event_raw","client_count","hideNotice","pictureInPictureElement","exitPictureInPicture","requestPictureInPicture","onerror","clear","MediaSessionManager","live_artwork","src","sizes","video_artwork","mediaSession","metadata","MediaMetadata","artist","artwork","updateMediaSessionPositionState","bind","setActionHandler","play","details","seek_offset","seekOffset","seek","seekTime","setPositionState","playbackRate","PlayerController","AudioContext","network_circuit_type","live_playback_buffer_seconds","LIVE_PLAYBACK_BUFFER_SECONDS_LOW_LATENCY","LIVE_PLAYBACK_BUFFER_SECONDS","romsound_url","romsound_response","romsounds_buffers","romsounds_context","decodeAudioData","mpegts","Hls","is_show_superimpose","DPlayer","lang","live","liveSyncMinBufferSize","loop","autoplay","airplay","hotkey","screenshot","crossOrigin","qualities","hevc_prefix","streaming_api_base_url","quality_name","default_quality","defaultQuality","speedRate","closeCommentFormAfterSend","apiBackend","read","jikkyo_comments","count","player_manager","player_managers","pluginOptions","enableWorker","enableWorkerForMSE","MediaSource","canConstructInDedicatedWorker","enableStashBuffer","stashInitialSize","liveSync","liveSyncMaxLatency","liveSyncTargetLatency","liveSyncPlaybackRate","hls","DefaultConfig","preferManagedMediaSource","manifestLoadPolicy","maxTimeToFirstByteMs","maxLoadTimeMs","timeoutRetry","maxNumRetry","retryDelayMs","maxRetryDelayMs","errorRetry","playlistLoadPolicy","fragLoadPolicy","aribb24","disableSuperimposeRenderer","normalFont","forceStrokeColor","forceBackgroundColor","drcsReplacement","enableRawCanvas","useStroke","usePUA","PRACallback","resume","buffer_source_node","createBufferSource","buffer","gain_node","createGain","connect","destination","gain","start","setAutoHide","setupVideoPlaybackHandler","setupFullscreenHandler","setupSettingPanelHandler","setupPlayerContainerResizeHandler","setControlDisplayTimer","is_player_restarting","getPlaybackBufferSeconds","buffered_range_count","buffer_remain","recoverPlayback","live_force_seek_interval_timer_id","video_keep_alive_interval_timer_id","on_play_or_pause","setting","on_init_or_quality_change","restart_required_when_quality_switched","ERROR","error_type","onLine","on_canplay_called","on_canplay","oncanplaythrough","current_playback_buffer_sec","current_volume","volume_step","tap_count","last_tap","current_time","getTime","time_difference","infoPanel","fullscreen_container","isFullScreen","webkitFullscreenElement","cancel","requestFullscreen","webkitRequestFullscreen","orientation","lock","webkitExitFullscreen","unlock","fullscreen_handler","onfullscreenchange","onwebkitfullscreenchange","settingOriginPanel","player_container_element","resize_handler","comment_area_element","video_element_width","video_element_height","letter_box_height","threshold","comment_area_vertical_margin","comment_area_width","comment_area_height","gcd","y","gcd_result","comment_area_height_aspect","transition","removeProperty","player_container_resize_observer","clearTimeout","player_control_ui_hide_timer_id","player_control_ui_hide_timer","isShow","destroying","events","unload","detachMediaElement","player_controller","Watch","$route","beforeRouteUpdate","to","destroy_promise","VueRouter","routes","redirect","TVHome","TVWatch","VideosWatch","SettingsIndex","SettingsGeneral","SettingsQuality","SettingsCaption","SettingsDataBroadcasting","SettingsCapture","SettingsAccount","SettingsJikkyo","SettingsTwitter","SettingsServer","Login","Register","NotFound","scrollBehavior","savedPosition","ready","registered","cached","updatefound","updated","registration","waiting","postMessage","reload","offline","SeamlessScrollPolyfill","productionTip","devtools","PiniaVuePlugin","pinia","createPinia","VueVirtualScroller","VuetifyMessageSnackbar","bottom","elevation","autoRemove","closeButtonContent","vuetifyInstance","vuetify","trigger","VTooltip","tooltip","showTriggers","hideTriggers","delay","offset","Icon","App","$mount","is_uploading_settings","$subscribe","detached","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","loaded","__webpack_modules__","m","deferred","O","chunkIds","priority","notFulfilled","fulfilled","j","every","r","n","getter","__esModule","d","definition","o","defineProperty","enumerable","u","chunkId","g","globalThis","Function","obj","hasOwnProperty","Symbol","toStringTag","nmd","paths","p","baseURI","installedChunks","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}